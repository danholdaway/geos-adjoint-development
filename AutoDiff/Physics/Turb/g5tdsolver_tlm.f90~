!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.11 (r5903) - 14 Dec 2015 10:32
!
!  Differentiation of g5tdsolver in forward (tangent) mode:
!   variations   of useful results: y
!   with respect to varying inputs: y
!   RW status of diff variables: y:in-out
SUBROUTINE G5TDSOLVER_TLM(im, jm, lm, a, b, c, y, y_tl)
  IMPLICIT NONE
!Arguments
  INTEGER, INTENT(IN) :: im, jm, lm
  REAL, DIMENSION(im, jm, lm), INTENT(IN) :: a, b, c
  REAL, DIMENSION(im, jm, lm), INTENT(INOUT) :: y
  REAL, DIMENSION(im, jm, lm), INTENT(INOUT) :: y_tl
!Locals
  INTEGER :: l
! Sweep down, modifying rhs with multiplier A
  DO l=2,lm
    y_tl(:, :, l) = y_tl(:, :, l) - a(:, :, l)*y_tl(:, :, l-1)
    y(:, :, l) = y(:, :, l) - y(:, :, l-1)*a(:, :, l)
  END DO
! Sweep up, solving for updated value. Note B has the inverse of the main diagonal
  y_tl(:, :, lm) = b(:, :, lm-1)*y_tl(:, :, lm)/(b(:, :, lm-1)-a(:, :, &
&   lm)*(1.0+c(:, :, lm-1)*b(:, :, lm-1)))
  y(:, :, lm) = y(:, :, lm)*b(:, :, lm-1)/(b(:, :, lm-1)-a(:, :, lm)*(&
&   1.0+c(:, :, lm-1)*b(:, :, lm-1)))
  DO l=lm-1,1,-1
    y_tl(:, :, l) = b(:, :, l)*(y_tl(:, :, l)-c(:, :, l)*y_tl(:, :, l+1)&
&     )
    y(:, :, l) = (y(:, :, l)-c(:, :, l)*y(:, :, l+1))*b(:, :, l)
  END DO
END SUBROUTINE G5TDSOLVER_TLM
