!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.11 (r5903) - 14 Dec 2015 10:32
!
!  Differentiation of g5tdsolver in reverse (adjoint) mode:
!   gradient     of useful results: y
!   with respect to varying inputs: y
!   RW status of diff variables: y:in-out
SUBROUTINE G5TDSOLVER_ADM(im, jm, lm, a, b, c, y, y_ad)
  IMPLICIT NONE
!Arguments
  INTEGER, INTENT(IN) :: im, jm, lm
  REAL, DIMENSION(im, jm, lm), INTENT(IN) :: a, b, c
  REAL, DIMENSION(im, jm, lm), INTENT(INOUT) :: y
  REAL, DIMENSION(im, jm, lm), INTENT(INOUT) :: y_ad
!Locals
  INTEGER :: l
  REAL :: temp_ad(im, jm)
  DO l=1,lm-1,1
    temp_ad = b(:, :, l)*y_ad(:, :, l)
    y_ad(:, :, l+1) = y_ad(:, :, l+1) - c(:, :, l)*temp_ad
    y_ad(:, :, l) = temp_ad
  END DO
  y_ad(:, :, lm) = b(:, :, lm-1)*y_ad(:, :, lm)/(b(:, :, lm-1)-a(:, :, &
&   lm)*(c(:, :, lm-1)*b(:, :, lm-1)+1.0))
  DO l=lm,2,-1
    y_ad(:, :, l-1) = y_ad(:, :, l-1) - a(:, :, l)*y_ad(:, :, l)
  END DO
END SUBROUTINE G5TDSOLVER_ADM
