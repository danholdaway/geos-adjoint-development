!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53
!
!  Differentiation of aeroopt in reverse (adjoint) mode:
!   gradient     of useful results: ssaa_irt taua_sot ssaa_sot
!                asya_irt asya_sot taua_irt
!   with respect to varying inputs: ssaa_irt taua_sot ssaa_sot
!                aerot asya_irt asya_sot taua_irt
!   RW status of diff variables: ssaa_irt:in-zero taua_sot:in-zero
!                ssaa_sot:in-zero aerot:out asya_irt:in-zero asya_sot:in-zero
!                taua_irt:in-zero
SUBROUTINE AEROOPT_B(im, jm, lm, na, nbchou_ir, nbchou_so, aerot, aerop&
& , ple, taua_ir_c, ssaa_ir_c, asya_ir_c, taua_irt, taua_irp, ssaa_irt&
& , ssaa_irp, asya_irt, asya_irp, taua_so_c, ssaa_so_c, asya_so_c, &
& taua_sot, taua_sop, ssaa_sot, ssaa_sop, asya_sot, asya_sop)
  IMPLICIT NONE
  INTEGER, INTENT(IN) :: im, jm, lm
  INTEGER, INTENT(IN) :: na, nbchou_ir, nbchou_so
  REAL, PARAMETER :: mapl_grav=9.81
!Inputs
  REAL, DIMENSION(im, jm, lm, na), INTENT(IN) :: aerot
  REAL, DIMENSION(im, jm, lm, na) :: aerop
  REAL, DIMENSION(im, jm, 0:lm), INTENT(IN) :: ple
  REAL, DIMENSION(im, jm, lm, nbchou_ir, na), INTENT(IN) :: taua_ir_c, &
& ssaa_ir_c, asya_ir_c
  REAL, DIMENSION(im, jm, lm, nbchou_so, na), INTENT(IN) :: taua_so_c, &
& ssaa_so_c, asya_so_c
!Outputs
  REAL, DIMENSION(im, jm, lm, nbchou_ir) :: taua_irt, ssaa_irt, asya_irt
  REAL, DIMENSION(im, jm, lm, nbchou_ir) :: taua_irp, ssaa_irp, &
& asya_irp
  REAL, DIMENSION(im, jm, lm, nbchou_so) :: taua_sot, ssaa_sot, asya_sot
  REAL, DIMENSION(im, jm, lm, nbchou_so) :: taua_sop, ssaa_sop, &
& asya_sop
!Locals
  INTEGER :: i, j, l, ai
  REAL :: x
  REAL, DIMENSION(im, jm, lm, na) :: saerot
  REAL, DIMENSION(im, jm, lm, na) :: saerop
  DO l=1,lm
    DO j=1,jm
      DO i=1,im
        CALL PUSHREAL4(x)
        x = (ple(i, j, l)-ple(i, j, l-1))*0.01*(100./mapl_grav)
      END DO
    END DO
  END DO
  saerop = 0.0
  DO j=nbchou_so,1,-1
    DO l=na,1,-1
      saerop(:, :, :, l) = saerop(:, :, :, l) + taua_so_c(:, :, :, j, &
&       l)*ssaa_so_c(:, :, :, j, l)*ssaa_sop(:, :, :, j) + taua_so_c(:&
&       , :, :, j, l)*taua_sop(:, :, :, j) + taua_so_c(:, :, :, j, l)*&
&       ssaa_so_c(:, :, :, j, l)*asya_ir_c(:, :, :, j, l)*asya_sop(:, :&
&       , :, j)
    END DO
  END DO
  DO j=nbchou_ir,1,-1
    DO l=na,1,-1
      saerop(:, :, :, l) = saerop(:, :, :, l) + taua_ir_c(:, :, :, j, &
&       l)*ssaa_ir_c(:, :, :, j, l)*ssaa_irp(:, :, :, j) + taua_ir_c(:&
&       , :, :, j, l)*taua_irp(:, :, :, j) + taua_ir_c(:, :, :, j, l)*&
&       ssaa_ir_c(:, :, :, j, l)*asya_ir_c(:, :, :, j, l)*asya_irp(:, :&
&       , :, j)
    END DO
  END DO
  aerop = 0.0
  DO l=lm,1,-1
    DO j=jm,1,-1
      DO i=im,1,-1
        DO ai=na,1,-1
          aerop(i, j, l, ai) = aerop(i, j, l, ai) + x*saerop(i, j, l&
&           , ai)
          saerop(i, j, l, ai) = 0.0
        END DO
        CALL POPREAL4(x)
      END DO
    END DO
  END DO
  ssaa_irp = 0.0
  taua_sop = 0.0
  ssaa_sop = 0.0
  asya_irp = 0.0
  asya_sop = 0.0
  taua_irp = 0.0
END SUBROUTINE AEROOPT_B

