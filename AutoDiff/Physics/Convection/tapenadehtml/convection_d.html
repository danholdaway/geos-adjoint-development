<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="rase_d"></a><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code>
<code class="comment">!</code>
<a href="convection.html#rase" target="origFile"><code class="comment">!  Differentiation of rase in forward (tangent) mode:</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   variations   of useful results: clw cnv_prc3 tho qho vho cnv_updfrc</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                uho flxd</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   with respect to varying inputs: tho qho vho uho</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   RW status of diff variables: clw:out cnv_prc3:out tho:in-out</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                qho:in-out vho:in-out cnv_updfrc:out uho:in-out</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                flxd:out</code></a>
<a href="convection.html#rase" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RASE_D</code>(<code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code>, <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code>, <code class="vardecl">seedras</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">sige</code>, <code class="vardecl">kcbl</code>, <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code>, <code class="vardecl">frland</code>, <code class="vardecl">ts</code>, <code class="vardecl">tho</code>, <code class="vardecl">thod</code>, <code class="vardecl">qho</code>, <code class="vardecl">qhod</code>, <code class="vardecl">uho</code>, <code class="vardecl">uhod</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">vho</code>, <code class="vardecl">vhod</code>, <code class="vardecl">co_auto</code>, <code class="vardecl">ple</code>, <code class="vardecl">clw</code>, <code class="vardecl">clwd</code>, <code class="vardecl">flxd</code>, <code class="vardecl">flxdd</code>, <code class="vardecl">cnv_prc3</code>, <code class="vardecl">cnv_prc3d</code>, <code class="label">&</code></a>
<a name="rase_di88"></a><a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">cnv_updfrc</code>, <code class="vardecl">cnv_updfrcd</code>, <code class="vardecl">rasparams</code>, <code class="vardecl">estblx</code>)</a>
  <a href="convection.html#rase" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="rase_di89"></a><a href="convection.html#rasei88" target="origFile"><code class="comment">!INPUTS</code></a>
<a name="rase_di90"></a>  <a href="convection.html#rasei88" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code></a>
<a name="rase_di91"></a>  <a href="convection.html#rasei89" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ple</code></a>
<a name="rase_di92"></a>  <a href="convection.html#rasei90" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">sige</code></a>
<a name="rase_di93"></a>  <a href="convection.html#rasei91" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code></a>
<a name="rase_di94"></a>  <a href="convection.html#rasei92" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code></a>
<a name="rase_di95"></a>  <a href="convection.html#rasei93" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">seedras</code></a>
<a name="rase_di96"></a>  <a href="convection.html#rasei94" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kcbl</code></a>
<a name="rase_di97"></a>  <a href="convection.html#rasei95" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ts</code>, <code class="vardecl">frland</code></a>
<a name="rase_di98"></a>  <a href="convection.html#rasei96" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">co_auto</code></a>
<a name="rase_di99"></a>  <a href="convection.html#rasei97" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code></a>
<a name="rase_di100"></a>  <a href="convection.html#rasei98" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rasparams</code></a>
  <a href="convection.html#rasei99" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">estblx</code></a>
<a href="convection.html#rasei100" target="origFile"><code class="comment">!OUTPUTS</code></a>
<a name="rase_di101"></a>  <a href="convection.html#rasei100" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">clw</code>, <code class="vardecl">flxd</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">clwd</code>, <code class="vardecl">flxdd</code></a>
<a name="rase_di102"></a>  <a href="convection.html#rasei101" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_prc3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_prc3d</code></a>
<a name="rase_di103"></a>  <a href="convection.html#rasei102" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_updfrc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_updfrcd</code></a>
<a href="convection.html#rasei103" target="origFile"><code class="comment">!PROGNOSTIC</code></a>
<a name="rase_di104"></a>  <a href="convection.html#rasei103" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">thod</code>, <code class="vardecl">qhod</code>, <code class="vardecl">uhod</code>, <code class="vardecl">vhod</code></a>
<a name="rase_di105"></a><a href="convection.html#rasei104" target="origFile"><code class="comment">!LOCALS</code></a>
  <a href="convection.html#rasei104" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">ic</code>, <code class="vardecl">l</code>, <code class="vardecl">kk</code>, <code class="vardecl">k</code></a>
<a name="rase_di106"></a><a href="convection.html#rasei105" target="origFile"><code class="comment">!Parameters</code></a>
<a name="rase_di107"></a>  <a href="convection.html#rasei105" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">onepkap</code>=<code class="constant">1.</code>+<code class="constant">2.</code>/<code class="constant">7.</code>, <code class="vardecl">daylen</code>=<code class="constant">86400.0</code></a>
<a name="rase_di108"></a>  <a href="convection.html#rasei106" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">rhmax</code>=<code class="constant">0.9999</code></a>
<a name="rase_di109"></a>  <a href="convection.html#rasei107" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_qpert</code>=<code class="constant">0.0</code>, <code class="vardecl">cbl_tpert</code>=<code class="constant">1.0</code></a>
  <a href="convection.html#rasei108" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_tpert_mxocn</code>=<code class="constant">2.0</code>, <code class="vardecl">cbl_tpert_mxlnd</code>=<code class="constant">4.0</code></a>
<a name="rase_di110"></a><a href="convection.html#rasei109" target="origFile"><code class="comment">!Constants</code></a>
  <a href="convection.html#rasei109" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">grav</code>, <code class="vardecl">cp</code>, <code class="vardecl">alhl</code>, <code class="vardecl">cpbg</code>, <code class="vardecl">alhi</code>, <code class="vardecl">cpi</code>, <code class="vardecl">gravi</code>, <code class="vardecl">ddt</code>, <code class="vardecl">lbcp</code></a>
<a name="rase_di111"></a><a href="convection.html#rasei110" target="origFile"><code class="comment">!Rasparams</code></a>
<a name="rase_di112"></a>  <a href="convection.html#rasei110" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fricfac</code>, <code class="vardecl">cli_crit</code>, <code class="vardecl">rasal1</code>, <code class="vardecl">rasal2</code></a>
<a name="rase_di113"></a>  <a href="convection.html#rasei111" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">friclambda</code></a>
<a name="rase_di114"></a>  <a href="convection.html#rasei112" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sdqv2</code>, <code class="vardecl">sdqv3</code>, <code class="vardecl">sdqvt1</code></a>
<a name="rase_di115"></a>  <a href="convection.html#rasei113" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">acritfac</code>, <code class="vardecl">pblfrac</code>, <code class="vardecl">autorampb</code></a>
<a name="rase_di116"></a>  <a href="convection.html#rasei114" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxdallowed</code>, <code class="vardecl">rhmn</code>, <code class="vardecl">rhmx</code></a>
  <a href="convection.html#rasei115" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">mxdiam</code></a>
<a name="rase_di117"></a>  <a href="convection.html#rasei116" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2</code>, <code class="vardecl">tx3</code>, <code class="vardecl">akm</code>, <code class="vardecl">acr</code>, <code class="vardecl">alm</code>, <code class="vardecl">tth</code>, <code class="vardecl">qqh</code>, <code class="vardecl">dqx</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2d</code>, <code class="vardecl">tx3d</code>, <code class="vardecl">akmd</code>, <code class="vardecl">almd</code></a>
<a name="rase_di118"></a>  <a href="convection.html#rasei117" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfn</code>, <code class="vardecl">tem</code>, <code class="vardecl">trg</code>, <code class="vardecl">trgexp</code>, <code class="vardecl">evp</code>, <code class="vardecl">wlq</code>, <code class="vardecl">qcc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfnd</code>, <code class="vardecl">temd</code>, <code class="vardecl">trgd</code>, <code class="vardecl">wlqd</code>, <code class="vardecl">qccd</code></a>
<a name="rase_di119"></a>  <a href="convection.html#rasei118" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cli</code>, <code class="vardecl">te_a</code>, <code class="vardecl">c00_x</code>, <code class="vardecl">cli_crit_x</code>, <code class="vardecl">toki</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">clid</code>, <code class="vardecl">te_ad</code>, <code class="vardecl">c00_xd</code>, <code class="vardecl">cli_crit_xd</code>, <code class="vardecl">tokid</code></a>
<a name="rase_di120"></a>  <a href="convection.html#rasei119" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyr</code>, <code class="vardecl">rate</code>, <code class="vardecl">cvw_x</code>, <code class="vardecl">closs</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>, <code class="vardecl">f4</code></a>
<a name="rase_di121"></a>  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyrd</code>, <code class="vardecl">rated</code>, <code class="vardecl">cvw_xd</code>, <code class="vardecl">clossd</code>, <code class="vardecl">f2d</code></a>
<a name="rase_di122"></a>  <a href="convection.html#rasei120" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wght0</code>, <code class="vardecl">prcbl</code>, <code class="vardecl">rndu</code></a>
  <a href="convection.html#rasei121" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">lambda_min</code>, <code class="vardecl">lambda_max</code></a>
<a name="rase_di123"></a>  <a href="convection.html#rasei122" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpert</code>, <code class="vardecl">qpert</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpertd</code></a>
<a name="rase_di124"></a>  <a href="convection.html#rasei123" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uht</code>, <code class="vardecl">vht</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uhtd</code>, <code class="vardecl">vhtd</code></a>
<a name="rase_di125"></a>  <a href="convection.html#rasei124" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_sv</code>, <code class="vardecl">qoi_sv</code>, <code class="vardecl">uoi_sv</code>, <code class="vardecl">voi_sv</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poi_svd</code>, <code class="vardecl">qoi_svd</code>, <code class="vardecl">uoi_svd</code>, <code class="vardecl">voi_svd</code></a>
  <a href="convection.html#rasei125" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi</code>, <code class="vardecl">qoi</code>, <code class="vardecl">uoi</code>, <code class="vardecl">voi</code>, <code class="vardecl">dqq</code>, <code class="vardecl">bet</code>, <code class="vardecl">gam</code>, <code class="vardecl">cll</code></a>
<a name="rase_di126"></a>  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poid</code>, <code class="vardecl">qoid</code>, <code class="vardecl">uoid</code>, <code class="vardecl">void0</code>, <code class="vardecl">dqqd</code>, <code class="vardecl">betd</code>, <code class="vardecl">gamd</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">clld</code></a>
<a name="rase_di127"></a>  <a href="convection.html#rasei126" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_c</code>, <code class="vardecl">qoi_c</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poi_cd</code>, <code class="vardecl">qoi_cd</code></a>
<a name="rase_di128"></a>  <a href="convection.html#rasei127" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">prh</code>, <code class="vardecl">pri</code>, <code class="vardecl">ght</code>, <code class="vardecl">dpt</code>, <code class="vardecl">dpb</code>, <code class="vardecl">pki</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">prhd</code>, <code class="vardecl">prid</code>, <code class="vardecl">ghtd</code>, <code class="vardecl">dptd</code>, <code class="vardecl">dpbd</code>, <code class="vardecl">pkid</code></a>
<a name="rase_di129"></a>  <a href="convection.html#rasei128" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">ucu</code>, <code class="vardecl">vcu</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">ucud</code>, <code class="vardecl">vcud</code></a>
<a name="rase_di130"></a>  <a href="convection.html#rasei129" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">cln</code>, <code class="vardecl">rns</code>, <code class="vardecl">pol</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">rnsd</code>, <code class="vardecl">pold</code></a>
<a name="rase_di131"></a>  <a href="convection.html#rasei130" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qst</code>, <code class="vardecl">ssl</code>, <code class="vardecl">rmf</code>, <code class="vardecl">rnn</code>, <code class="vardecl">rn1</code>, <code class="vardecl">rmfc</code>, <code class="vardecl">rmfp</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">qstd</code>, <code class="vardecl">ssld</code>, <code class="vardecl">rnnd</code>, <code class="vardecl">rmfpd</code></a>
<a name="rase_di132"></a>  <a href="convection.html#rasei131" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">gms</code>, <code class="vardecl">eta</code>, <code class="vardecl">gmh</code>, <code class="vardecl">eht</code>, <code class="vardecl">gm1</code>, <code class="vardecl">hcc</code>, <code class="vardecl">rmfd</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">gmsd</code>, <code class="vardecl">etad</code>, <code class="vardecl">gmhd</code>, <code class="vardecl">ehtd</code>, <code class="vardecl">gm1d</code>, <code class="vardecl">hccd</code>, <code class="vardecl">rmfdd</code></a>
<a name="rase_di133"></a>  <a href="convection.html#rasei132" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">hol</code>, <code class="vardecl">hst</code>, <code class="vardecl">qol</code>, <code class="vardecl">zol</code>, <code class="vardecl">hcld</code>, <code class="vardecl">cll0</code>, <code class="vardecl">cllx</code>, <code class="vardecl">clli</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">hold</code>, <code class="vardecl">hstd</code>, <code class="vardecl">qold</code>, <code class="vardecl">zold</code>, <code class="vardecl">hcldd</code>, <code class="vardecl">cll0d</code></a>
<a name="rase_di134"></a>  <a href="convection.html#rasei133" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">bke</code>, <code class="vardecl">cvw</code>, <code class="vardecl">updfrc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">cvwd</code>, <code class="vardecl">updfrcd</code></a>
<a name="rase_di135"></a>  <a href="convection.html#rasei134" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">rasal</code>, <code class="vardecl">updfrp</code>, <code class="vardecl">bk2</code>, <code class="vardecl">dll0</code>, <code class="vardecl">dllx</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">rasald</code>, <code class="vardecl">updfrpd</code>, <code class="vardecl">bk2d</code></a>
<a name="rase_di136"></a>  <a href="convection.html#rasei135" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">wght</code>, <code class="vardecl">massf</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">wghtd</code></a>
<a name="rase_di137"></a>  <a href="convection.html#rasei136" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qss</code>, <code class="vardecl">dqs</code>, <code class="vardecl">pf</code>, <code class="vardecl">pk</code>, <code class="vardecl">tempf</code>, <code class="vardecl">zlo</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">qssd</code>, <code class="vardecl">dqsd</code>, <code class="vardecl">tempfd</code>, <code class="vardecl">zlod</code></a>
<a name="rase_di138"></a>  <a href="convection.html#rasei137" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">prj</code>, <code class="vardecl">prs</code>, <code class="vardecl">qht</code>, <code class="vardecl">sht</code>, <code class="vardecl">zet</code>, <code class="vardecl">zle</code>, <code class="vardecl">pke</code></a>
<a name="rase_di139"></a>  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">prjd</code>, <code class="vardecl">prsd</code>, <code class="vardecl">qhtd</code>, <code class="vardecl">shtd</code>, <code class="vardecl">zetd</code>, <code class="vardecl">zled</code></a>
<a name="rase_di140"></a>  <a href="convection.html#rasei138" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="rase_di141"></a>  <a href="convection.html#rasei139" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="rase_di142"></a>  <a href="convection.html#rasei140" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
<a name="rase_di143"></a>  <a href="convection.html#rasei141" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
<a name="rase_di144"></a>  <a href="convection.html#rasei142" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
<a name="rase_di145"></a>  <a href="convection.html#rasei143" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">pwx1</code></a>
<a name="rase_di146"></a>  <a href="convection.html#rasei144" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwy1</code></a>
<a name="rase_di147"></a>  <a href="convection.html#rasei145" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">pwx10</code></a>
<a name="rase_di148"></a>  <a href="convection.html#rasei146" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwx11</code></a>
  <a href="convection.html#rasei147" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwr1</code></a>
  <a href="convection.html#rasei148" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1d</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2d</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1d</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1d</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2</code></a>
<a name="rase_di149"></a>  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">y1</code></a>
<a name="rase_di150"></a><a href="convection.html#rasei149" target="origFile"><code class="comment">!Initialize Local Arrays</code></a>
<a name="rase_di151"></a>  <a href="convection.html#rasei149" target="origFile">poi = <code class="constant">0.0</code></a>
<a name="rase_di152"></a>  <a href="convection.html#rasei150" target="origFile">qoi = <code class="constant">0.0</code></a>
<a name="rase_di153"></a>  <a href="convection.html#rasei151" target="origFile">uoi = <code class="constant">0.0</code></a>
<a name="rase_di154"></a>  <a href="convection.html#rasei152" target="origFile">voi = <code class="constant">0.0</code></a>
<a name="rase_di155"></a>  <a href="convection.html#rasei153" target="origFile">dqq = <code class="constant">0.0</code></a>
<a name="rase_di156"></a>  <a href="convection.html#rasei154" target="origFile">bet = <code class="constant">0.0</code></a>
<a name="rase_di157"></a>  <a href="convection.html#rasei155" target="origFile">gam = <code class="constant">0.0</code></a>
<a name="rase_di158"></a>  <a href="convection.html#rasei156" target="origFile">poi_c = <code class="constant">0.0</code></a>
<a name="rase_di159"></a>  <a href="convection.html#rasei157" target="origFile">qoi_c = <code class="constant">0.0</code></a>
<a name="rase_di160"></a>  <a href="convection.html#rasei158" target="origFile">prh = <code class="constant">0.0</code></a>
<a name="rase_di161"></a>  <a href="convection.html#rasei159" target="origFile">pri = <code class="constant">0.0</code></a>
<a name="rase_di162"></a>  <a href="convection.html#rasei160" target="origFile">ght = <code class="constant">0.0</code></a>
<a name="rase_di163"></a>  <a href="convection.html#rasei161" target="origFile">dpt = <code class="constant">0.0</code></a>
<a name="rase_di164"></a>  <a href="convection.html#rasei162" target="origFile">dpb = <code class="constant">0.0</code></a>
<a name="rase_di165"></a>  <a href="convection.html#rasei163" target="origFile">pki = <code class="constant">0.0</code></a>
<a name="rase_di166"></a>  <a href="convection.html#rasei164" target="origFile">ucu = <code class="constant">0.0</code></a>
<a name="rase_di167"></a>  <a href="convection.html#rasei165" target="origFile">vcu = <code class="constant">0.0</code></a>
<a name="rase_di168"></a>  <a href="convection.html#rasei166" target="origFile">cln = <code class="constant">0.0</code></a>
<a name="rase_di169"></a>  <a href="convection.html#rasei167" target="origFile">pol = <code class="constant">0.0</code></a>
<a name="rase_di170"></a>  <a href="convection.html#rasei168" target="origFile">qst = <code class="constant">0.0</code></a>
<a name="rase_di171"></a>  <a href="convection.html#rasei169" target="origFile">ssl = <code class="constant">0.0</code></a>
<a name="rase_di172"></a>  <a href="convection.html#rasei170" target="origFile">rmf = <code class="constant">0.0</code></a>
<a name="rase_di173"></a>  <a href="convection.html#rasei171" target="origFile">rnn = <code class="constant">0.0</code></a>
<a name="rase_di174"></a>  <a href="convection.html#rasei172" target="origFile">rn1 = <code class="constant">0.0</code></a>
<a name="rase_di175"></a>  <a href="convection.html#rasei173" target="origFile">gms = <code class="constant">0.0</code></a>
<a name="rase_di176"></a>  <a href="convection.html#rasei174" target="origFile">eta = <code class="constant">0.0</code></a>
<a name="rase_di177"></a>  <a href="convection.html#rasei175" target="origFile">gmh = <code class="constant">0.0</code></a>
<a name="rase_di178"></a>  <a href="convection.html#rasei176" target="origFile">eht = <code class="constant">0.0</code></a>
<a name="rase_di179"></a>  <a href="convection.html#rasei177" target="origFile">gm1 = <code class="constant">0.0</code></a>
<a name="rase_di180"></a>  <a href="convection.html#rasei178" target="origFile">hcc = <code class="constant">0.0</code></a>
<a name="rase_di181"></a>  <a href="convection.html#rasei179" target="origFile">hol = <code class="constant">0.0</code></a>
<a name="rase_di182"></a>  <a href="convection.html#rasei180" target="origFile">hst = <code class="constant">0.0</code></a>
<a name="rase_di183"></a>  <a href="convection.html#rasei181" target="origFile">qol = <code class="constant">0.0</code></a>
<a name="rase_di184"></a>  <a href="convection.html#rasei182" target="origFile">zol = <code class="constant">0.0</code></a>
<a name="rase_di185"></a>  <a href="convection.html#rasei183" target="origFile">hcld = <code class="constant">0.0</code></a>
<a name="rase_di186"></a>  <a href="convection.html#rasei184" target="origFile">bke = <code class="constant">0.0</code></a>
<a name="rase_di187"></a>  <a href="convection.html#rasei185" target="origFile">cvw = <code class="constant">0.0</code></a>
<a name="rase_di188"></a>  <a href="convection.html#rasei186" target="origFile">updfrc = <code class="constant">0.0</code></a>
<a name="rase_di189"></a>  <a href="convection.html#rasei187" target="origFile">rasal = <code class="constant">0.0</code></a>
<a name="rase_di190"></a>  <a href="convection.html#rasei188" target="origFile">updfrp = <code class="constant">0.0</code></a>
<a name="rase_di191"></a>  <a href="convection.html#rasei189" target="origFile">bk2 = <code class="constant">0.0</code></a>
<a name="rase_di192"></a>  <a href="convection.html#rasei190" target="origFile">wght = <code class="constant">0.0</code></a>
<a name="rase_di193"></a>  <a href="convection.html#rasei191" target="origFile">massf = <code class="constant">0.0</code></a>
<a name="rase_di194"></a>  <a href="convection.html#rasei192" target="origFile">qss = <code class="constant">0.0</code></a>
<a name="rase_di195"></a>  <a href="convection.html#rasei193" target="origFile">dqs = <code class="constant">0.0</code></a>
<a name="rase_di196"></a>  <a href="convection.html#rasei194" target="origFile">pf = <code class="constant">0.0</code></a>
<a name="rase_di197"></a>  <a href="convection.html#rasei195" target="origFile">pk = <code class="constant">0.0</code></a>
<a name="rase_di198"></a>  <a href="convection.html#rasei196" target="origFile">tempf = <code class="constant">0.0</code></a>
<a name="rase_di199"></a>  <a href="convection.html#rasei197" target="origFile">zlo = <code class="constant">0.0</code></a>
<a name="rase_di200"></a>  <a href="convection.html#rasei198" target="origFile">prj = <code class="constant">0.0</code></a>
<a name="rase_di201"></a>  <a href="convection.html#rasei199" target="origFile">prs = <code class="constant">0.0</code></a>
<a name="rase_di202"></a>  <a href="convection.html#rasei200" target="origFile">qht = <code class="constant">0.0</code></a>
<a name="rase_di203"></a>  <a href="convection.html#rasei201" target="origFile">sht = <code class="constant">0.0</code></a>
<a name="rase_di204"></a>  <a href="convection.html#rasei202" target="origFile">zet = <code class="constant">0.0</code></a>
<a name="rase_di205"></a>  <a href="convection.html#rasei203" target="origFile">zle = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei204" target="origFile">pke = <code class="constant">0.0</code></a>
<a name="rase_di206"></a><a href="convection.html#rasei205" target="origFile"><code class="comment">!Initialize Outputs</code></a>
<a name="rase_di207"></a>  <a href="convection.html#rasei205" target="origFile">cnv_prc3 = <code class="constant">0.</code></a>
<a name="rase_di208"></a>  <a href="convection.html#rasei206" target="origFile">cnv_updfrc = <code class="constant">0.</code></a>
<a name="rase_di209"></a>  <a href="convection.html#rasei207" target="origFile">flxd = <code class="constant">0.</code></a>
  <a href="convection.html#rasei208" target="origFile">clw = <code class="constant">0.</code></a>
<a name="rase_di210"></a><a href="convection.html#rasei209" target="origFile"><code class="comment">!  ---  1</code></a>
  <a href="convection.html#rasei209" target="origFile">fricfac = rasparams(<code class="constant">1</code>)</a>
<a name="rase_di211"></a><a href="convection.html#rasei210" target="origFile"><code class="comment">!  ---  4</code></a>
  <a href="convection.html#rasei210" target="origFile">cli_crit = rasparams(<code class="constant">4</code>)</a>
<a name="rase_di212"></a><a href="convection.html#rasei211" target="origFile"><code class="comment">!  ---  5</code></a>
  <a href="convection.html#rasei211" target="origFile">rasal1 = rasparams(<code class="constant">5</code>)</a>
<a name="rase_di213"></a><a href="convection.html#rasei212" target="origFile"><code class="comment">!  ---  6</code></a>
  <a href="convection.html#rasei212" target="origFile">rasal2 = rasparams(<code class="constant">6</code>)</a>
<a name="rase_di214"></a><a href="convection.html#rasei213" target="origFile"><code class="comment">!  --- 11</code></a>
  <a href="convection.html#rasei213" target="origFile">friclambda = rasparams(<code class="constant">11</code>)</a>
<a name="rase_di215"></a><a href="convection.html#rasei214" target="origFile"><code class="comment">!  --- 14</code></a>
  <a href="convection.html#rasei214" target="origFile">sdqv2 = rasparams(<code class="constant">14</code>)</a>
<a name="rase_di216"></a><a href="convection.html#rasei215" target="origFile"><code class="comment">!  --- 15</code></a>
  <a href="convection.html#rasei215" target="origFile">sdqv3 = rasparams(<code class="constant">15</code>)</a>
<a name="rase_di217"></a><a href="convection.html#rasei216" target="origFile"><code class="comment">!  --- 16</code></a>
  <a href="convection.html#rasei216" target="origFile">sdqvt1 = rasparams(<code class="constant">16</code>)</a>
<a name="rase_di218"></a><a href="convection.html#rasei217" target="origFile"><code class="comment">!  --- 17</code></a>
  <a href="convection.html#rasei217" target="origFile">acritfac = rasparams(<code class="constant">17</code>)</a>
<a name="rase_di219"></a><a href="convection.html#rasei218" target="origFile"><code class="comment">!  --- 20</code></a>
  <a href="convection.html#rasei218" target="origFile">pblfrac = rasparams(<code class="constant">20</code>)</a>
<a name="rase_di220"></a><a href="convection.html#rasei219" target="origFile"><code class="comment">!  --- 21</code></a>
  <a href="convection.html#rasei219" target="origFile">autorampb = rasparams(<code class="constant">21</code>)</a>
<a name="rase_di221"></a><a href="convection.html#rasei220" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection.html#rasei220" target="origFile">rhmn = rasparams(<code class="constant">24</code>)</a>
<a name="rase_di222"></a><a href="convection.html#rasei221" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection.html#rasei221" target="origFile">maxdallowed = rasparams(<code class="constant">23</code>)</a>
<a name="rase_di223"></a><a href="convection.html#rasei222" target="origFile"><code class="comment">!  --- 25</code></a>
<a name="rase_di224"></a>  <a href="convection.html#rasei222" target="origFile">rhmx = rasparams(<code class="constant">25</code>)</a>
<a name="rase_di225"></a>  <a href="convection.html#rasei223" target="origFile">grav = cons_grav</a>
<a name="rase_di226"></a>  <a href="convection.html#rasei224" target="origFile">alhl = cons_alhl</a>
<a name="rase_di227"></a>  <a href="convection.html#rasei225" target="origFile">cp = cons_cp</a>
<a name="rase_di228"></a>  <a href="convection.html#rasei226" target="origFile">cpi = <code class="constant">1.0</code>/cp</a>
<a name="rase_di229"></a>  <a href="convection.html#rasei227" target="origFile">alhi = <code class="constant">1.0</code>/alhl</a>
<a name="rase_di230"></a>  <a href="convection.html#rasei228" target="origFile">gravi = <code class="constant">1.0</code>/grav</a>
<a name="rase_di231"></a>  <a href="convection.html#rasei229" target="origFile">cpbg = cp*gravi</a>
<a name="rase_di232"></a>  <a href="convection.html#rasei230" target="origFile">ddt = daylen/dt</a>
<a name="rase_di233"></a>  <a href="convection.html#rasei231" target="origFile">lbcp = alhl*cpi</a>
  <a href="convection.html#rasei232" target="origFile">i = <code class="constant">1</code></a>
<a name="rase_di234"></a><a href="convection.html#rasei233" target="origFile"><code class="comment">!CALL FINDBASE</code></a>
<a name="rase_di235"></a>  <a href="convection.html#rasei233" target="origFile">k = kcbl(i)</a>
  <a href="convection.html#rasei234" target="origFile"><code class="keyword">IF</code> (k .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_di236"></a><a href="convection.html#rasei235" target="origFile"><code class="comment">!Get saturation specific humidity and gradient wrt to T</code></a>
<a name="rase_di237"></a>    <a href="convection.html#rasei235" target="origFile">pwx1 = ple(i, :)/<code class="constant">1000.</code></a>
<a name="rase_di238"></a>    <a href="convection.html#rasei236" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_di239"></a>    <a href="convection.html#rasei237" target="origFile">pke = pwx1**pwy1</a>
<a name="rase_di240"></a>    <a href="convection.html#rasei238" target="origFile">pf = <code class="constant">0.5</code>*(ple(i, <code class="constant">1</code>:k0)+ple(i, <code class="constant">2</code>:k0+<code class="constant">1</code>))</a>
<a name="rase_di241"></a>    <a href="convection.html#rasei239" target="origFile">pwx10 = pf/<code class="constant">1000.</code></a>
<a name="rase_di242"></a>    <a href="convection.html#rasei240" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_di242"></a>    <a href="convection.html#rasei241" target="origFile">pk = pwx10**pwy1</a>
<a name="rase_di243"></a>    <a href="convection.html#rasei242" target="origFile">tempfd = pk*thod(i, :)</a>
<a name="rase_di244"></a>    <a href="convection.html#rasei242" target="origFile">tempf = tho(i, :)*pk</a>
<a name="rase_di245"></a>    <a href="convection.html#rasei243" target="origFile">zle = <code class="constant">0.0</code></a>
<a name="rase_di245"></a>    <a href="convection.html#rasei244" target="origFile">zlo = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei245" target="origFile">zled(k0+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei245" target="origFile">zle(k0+<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_di249"></a>    <a href="convection.html#rasei234" target="origFile">zlod = <code class="constant">0.0_8</code></a>
<a name="rase_di246"></a>    <a href="convection.html#rasei234" target="origFile">zled = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei249" target="origFile"><code class="keyword">DO </code>l=k0,<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_di246"></a>      <a href="convection.html#rasei246" target="origFile">zled(l) = thod(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l)) + tho(i, l)*<code class="label">&</code></a>
<a name="rase_di247"></a><a href="convection.html#rasei246" target="origFile"><code class="label">&       </code>cons_vireps*qhod(i, l)</a>
<a name="rase_di247"></a>      <a href="convection.html#rasei246" target="origFile">zle(l) = tho(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l))</a>
<a name="rase_di248"></a>      <a href="convection.html#rasei247" target="origFile">zlod(l) = zled(l+<code class="constant">1</code>) + cons_cp*(pke(l+<code class="constant">1</code>)-pk(l))*zled(l)/cons_grav</a>
<a name="rase_di248"></a>      <a href="convection.html#rasei247" target="origFile">zlo(l) = zle(l+<code class="constant">1</code>) + cons_cp/cons_grav*(pke(l+<code class="constant">1</code>)-pk(l))*zle(l)</a>
      <a href="convection.html#rasei248" target="origFile">zled(l) = zlod(l) + cons_cp*(pk(l)-pke(l))*zled(l)/cons_grav</a>
<a name="rase_di250"></a>      <a href="convection.html#rasei248" target="origFile">zle(l) = zlo(l) + cons_cp/cons_grav*(pk(l)-pke(l))*zle(l)</a>
<a name="rase_di250"></a>    <a href="convection.html#rasei249" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di251"></a>    <a href="convection.html#rasei250" target="origFile">tpertd = cbl_tpert*(-tempfd(k0)-cons_grav*zlod(k0)/cons_cp)</a>
    <a href="convection.html#rasei250" target="origFile">tpert = cbl_tpert*(ts(i)-(tempf(k0)+cons_grav*zlo(k0)/cons_cp))</a>
<a name="rase_di252"></a><a href="convection.html#rasei251" target="origFile"><code class="comment">!* ( QSSFC - Q(:,:,K0) ) [CBL_QPERT = 0.0]</code></a>
<a name="rase_di253"></a>    <a href="convection.html#rasei251" target="origFile">qpert = cbl_qpert</a>
    <a href="convection.html#rasei252" target="origFile"><code class="keyword">IF</code> (tpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei253" target="origFile">tpert = <code class="constant">0.0</code></a>
<a name="rase_di254"></a>      <a href="convection.html#rasei252" target="origFile">tpertd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei252" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di255"></a>      <a href="convection.html#rasei254" target="origFile">tpert = tpert</a>
<a name="rase_di256"></a>    <a href="convection.html#rasei252" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei255" target="origFile"><code class="keyword">IF</code> (qpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_di257"></a>      <a href="convection.html#rasei256" target="origFile">qpert = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei255" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di258"></a>      <a href="convection.html#rasei257" target="origFile">qpert = qpert</a>
<a name="rase_di259"></a>    <a href="convection.html#rasei255" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di260"></a>    <a href="convection.html#rasei258" target="origFile"><code class="keyword">IF</code> (frland(i) .LT. <code class="constant">0.1</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei259" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxocn) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei260" target="origFile">tpert = cbl_tpert_mxocn</a>
<a name="rase_di261"></a>        <a href="convection.html#rasei259" target="origFile">tpertd = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei259" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di262"></a>        <a href="convection.html#rasei261" target="origFile">tpert = tpert</a>
<a name="rase_di263"></a>      <a href="convection.html#rasei259" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei258" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#rasei262" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxlnd) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei263" target="origFile">tpert = cbl_tpert_mxlnd</a>
<a name="rase_di264"></a>      <a href="convection.html#rasei262" target="origFile">tpertd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei262" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di265"></a>      <a href="convection.html#rasei264" target="origFile">tpert = tpert</a>
    <a href="convection.html#rasei258" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di267"></a>    <a href="convection.html#rasei265" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS_D</code>(dqs, dqsd, qss, qssd, tempf, tempfd, pf, k0, estblx<code class="label">&</code></a>
<a name="rase_di266"></a><a href="convection.html#rasei265" target="origFile"><code class="label">&              </code>, cons_h2omw, cons_airmw)</a>
<a name="rase_di266"></a>    <a href="convection.html#rasei267" target="origFile"><code class="keyword">DO </code>kk=icmin,k+<code class="constant">1</code></a>
      <a href="convection.html#rasei266" target="origFile">prjd(kk) = <code class="constant">0.0_8</code></a>
<a name="rase_di268"></a>      <a href="convection.html#rasei266" target="origFile">prj(kk) = pke(kk)</a>
<a name="rase_di268"></a>    <a href="convection.html#rasei267" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei268" target="origFile">prsd(icmin:k0+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di269"></a>    <a href="convection.html#rasei268" target="origFile">prs(icmin:k0+<code class="constant">1</code>) = ple(i, icmin:k0+<code class="constant">1</code>)</a>
<a name="rase_di269"></a>    <a href="convection.html#rasei269" target="origFile">poid = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei269" target="origFile">poid(icmin:k) = thod(i, icmin:k)</a>
<a name="rase_di270"></a>    <a href="convection.html#rasei269" target="origFile">poi(icmin:k) = tho(i, icmin:k)</a>
<a name="rase_di270"></a>    <a href="convection.html#rasei270" target="origFile">qoid = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei270" target="origFile">qoid(icmin:k) = qhod(i, icmin:k)</a>
<a name="rase_di271"></a>    <a href="convection.html#rasei270" target="origFile">qoi(icmin:k) = qho(i, icmin:k)</a>
<a name="rase_di271"></a>    <a href="convection.html#rasei271" target="origFile">uoid = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei271" target="origFile">uoid(icmin:k) = uhod(i, icmin:k)</a>
<a name="rase_di272"></a>    <a href="convection.html#rasei271" target="origFile">uoi(icmin:k) = uho(i, icmin:k)</a>
<a name="rase_di272"></a>    <a href="convection.html#rasei272" target="origFile">void0 = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei272" target="origFile">void0(icmin:k) = vhod(i, icmin:k)</a>
<a name="rase_di273"></a>    <a href="convection.html#rasei272" target="origFile">voi(icmin:k) = vho(i, icmin:k)</a>
<a name="rase_di273"></a>    <a href="convection.html#rasei273" target="origFile">qstd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei273" target="origFile">qstd(icmin:k) = qssd(icmin:k)</a>
<a name="rase_di274"></a>    <a href="convection.html#rasei273" target="origFile">qst(icmin:k) = qss(icmin:k)</a>
<a name="rase_di274"></a>    <a href="convection.html#rasei274" target="origFile">dqqd = <code class="constant">0.0_8</code></a>
<a name="rase_di275"></a>    <a href="convection.html#rasei274" target="origFile">dqqd(icmin:k) = dqsd(icmin:k)</a>
    <a href="convection.html#rasei274" target="origFile">dqq(icmin:k) = dqs(icmin:k)</a>
<a name="rase_di276"></a><a href="convection.html#rasei275" target="origFile"><code class="comment">!Mass fraction of each layer below cloud base</code></a>
    <a href="convection.html#rasei275" target="origFile">massf(:) = wgt0(i, :)</a>
<a name="rase_di278"></a><a href="convection.html#rasei276" target="origFile"><code class="comment">!RESET PRESSURE at bottom edge of CBL </code></a>
<a name="rase_di277"></a>    <a href="convection.html#rasei276" target="origFile">prcbl = prs(k)</a>
    <a href="convection.html#rasei278" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_di279"></a>      <a href="convection.html#rasei277" target="origFile">prcbl = prcbl + massf(l)*(prs(l+<code class="constant">1</code>)-prs(l))</a>
<a name="rase_di279"></a>    <a href="convection.html#rasei278" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di280"></a>    <a href="convection.html#rasei279" target="origFile">prsd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di281"></a>    <a href="convection.html#rasei279" target="origFile">prs(k+<code class="constant">1</code>) = prcbl</a>
<a name="rase_di282"></a>    <a href="convection.html#rasei280" target="origFile">pwx11 = prs(k+<code class="constant">1</code>)/<code class="constant">1000.</code></a>
<a name="rase_di282"></a>    <a href="convection.html#rasei281" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_di289"></a>    <a href="convection.html#rasei282" target="origFile">prjd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di283"></a>    <a href="convection.html#rasei282" target="origFile">prj(k+<code class="constant">1</code>) = pwx11**pwy1</a>
<a name="rase_di283"></a>    <a href="convection.html#rasei289" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_di284"></a>      <a href="convection.html#rasei283" target="origFile">pold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di284"></a>      <a href="convection.html#rasei283" target="origFile">pol(l) = <code class="constant">0.5</code>*(prs(l)+prs(l+<code class="constant">1</code>))</a>
      <a href="convection.html#rasei284" target="origFile">prhd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di285"></a>      <a href="convection.html#rasei284" target="origFile">prh(l) = (prs(l+<code class="constant">1</code>)*prj(l+<code class="constant">1</code>)-prs(l)*prj(l))/(onepkap*(prs(l+<code class="constant">1</code>)-prs(<code class="label">&</code></a>
<a name="rase_di285"></a><a href="convection.html#rasei284" target="origFile"><code class="label">&       </code>l)))</a>
<a name="rase_di286"></a>      <a href="convection.html#rasei285" target="origFile">pkid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di286"></a>      <a href="convection.html#rasei285" target="origFile">pki(l) = <code class="constant">1.0</code>/prh(l)</a>
<a name="rase_di287"></a>      <a href="convection.html#rasei286" target="origFile">dptd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di287"></a>      <a href="convection.html#rasei286" target="origFile">dpt(l) = prh(l) - prj(l)</a>
<a name="rase_di288"></a>      <a href="convection.html#rasei287" target="origFile">dpbd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di288"></a>      <a href="convection.html#rasei287" target="origFile">dpb(l) = prj(l+<code class="constant">1</code>) - prh(l)</a>
      <a href="convection.html#rasei288" target="origFile">prid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di290"></a>      <a href="convection.html#rasei288" target="origFile">pri(l) = <code class="constant">.01</code>/(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection.html#rasei289" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di291"></a><a href="convection.html#rasei290" target="origFile"><code class="comment">!RECALCULATE PROFILE QUAN. IN LOWEST STRAPPED LAYER</code></a>
<a name="rase_di291"></a>    <a href="convection.html#rasei290" target="origFile"><code class="keyword">IF</code> (k .LE. k0) <code class="keyword">THEN</code></a>
<a name="rase_di292"></a>      <a href="convection.html#rasei291" target="origFile">poid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di292"></a>      <a href="convection.html#rasei291" target="origFile">poi(k) = <code class="constant">0.</code></a>
<a name="rase_di293"></a>      <a href="convection.html#rasei292" target="origFile">qoid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di293"></a>      <a href="convection.html#rasei292" target="origFile">qoi(k) = <code class="constant">0.</code></a>
<a name="rase_di294"></a>      <a href="convection.html#rasei293" target="origFile">uoid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di294"></a>      <a href="convection.html#rasei293" target="origFile">uoi(k) = <code class="constant">0.</code></a>
<a name="rase_di295"></a>      <a href="convection.html#rasei294" target="origFile">void0(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei294" target="origFile">voi(k) = <code class="constant">0.</code></a>
<a name="rase_di297"></a><a href="convection.html#rasei295" target="origFile"><code class="comment">!SPECIFY WEIGHTS GIVEN TO EACH LAYER WITHIN SUBCLOUD "SUPERLAYER"</code></a>
<a name="rase_di296"></a>      <a href="convection.html#rasei295" target="origFile">wght = <code class="constant">0.</code></a>
<a name="rase_di296"></a>      <a href="convection.html#rasei297" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection.html#rasei296" target="origFile">wghtd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di302"></a>        <a href="convection.html#rasei296" target="origFile">wght(l) = massf(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))/(prs(k+<code class="constant">1</code>)-prs(k))</a>
<a name="rase_di298"></a>      <a href="convection.html#rasei297" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di298"></a>      <a href="convection.html#rasei302" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_di299"></a>        <a href="convection.html#rasei298" target="origFile">poid(k) = poid(k) + wght(l)*thod(i, l)</a>
<a name="rase_di299"></a>        <a href="convection.html#rasei298" target="origFile">poi(k) = poi(k) + wght(l)*tho(i, l)</a>
<a name="rase_di300"></a>        <a href="convection.html#rasei299" target="origFile">qoid(k) = qoid(k) + wght(l)*qhod(i, l)</a>
<a name="rase_di300"></a>        <a href="convection.html#rasei299" target="origFile">qoi(k) = qoi(k) + wght(l)*qho(i, l)</a>
<a name="rase_di301"></a>        <a href="convection.html#rasei300" target="origFile">uoid(k) = uoid(k) + wght(l)*uhod(i, l)</a>
<a name="rase_di301"></a>        <a href="convection.html#rasei300" target="origFile">uoi(k) = uoi(k) + wght(l)*uho(i, l)</a>
        <a href="convection.html#rasei301" target="origFile">void0(k) = void0(k) + wght(l)*vhod(i, l)</a>
<a name="rase_di303"></a>        <a href="convection.html#rasei301" target="origFile">voi(k) = voi(k) + wght(l)*vho(i, l)</a>
      <a href="convection.html#rasei302" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei303" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS_D</code>(dqq(k), dqqd(k), qst(k), qstd(k), poi(k)*prh(k)<code class="label">&</code></a>
<a href="convection.html#rasei303" target="origFile"><code class="label">&                 </code>, prh(k)*poid(k), pol(k), estblx, cons_h2omw, <code class="label">&</code></a>
<a name="rase_di304"></a><a href="convection.html#rasei303" target="origFile"><code class="label">&                 </code>cons_airmw)</a>
<a name="rase_di305"></a>    <a href="convection.html#rasei290" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei304" target="origFile"><code class="keyword">IF</code> (seedras(i)/<code class="constant">1000000. </code>.LT. <code class="constant">1e-6</code>) <code class="keyword">THEN</code></a>
<a name="rase_di306"></a>      <a href="convection.html#rasei305" target="origFile">rndu = <code class="constant">1e-6</code></a>
    <a href="convection.html#rasei304" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di307"></a>      <a href="convection.html#rasei306" target="origFile">rndu = seedras(i)/<code class="constant">1000000.</code></a>
<a name="rase_di308"></a>    <a href="convection.html#rasei304" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei307" target="origFile">pwr1 = rndu**(-(<code class="constant">1.</code>/<code class="constant">2.</code>))</a>
    <a href="convection.html#rasei308" target="origFile">mxdiam = maxdallowed*pwr1</a>
    <a href="convection.html#rasei234" target="origFile">gm1d = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">ghtd = <code class="constant">0.0_8</code></a>
<a name="rase_di314"></a>    <a href="convection.html#rasei234" target="origFile">betd = <code class="constant">0.0_8</code></a>
<a name="rase_di309"></a>    <a href="convection.html#rasei234" target="origFile">gamd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei314" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_di309"></a><a href="convection.html#rasei309" target="origFile"><code class="comment">!*</code></a>
<a name="rase_di310"></a>      <a href="convection.html#rasei309" target="origFile">betd(l) = pki(l)*dqqd(l)</a>
      <a href="convection.html#rasei309" target="origFile">bet(l) = dqq(l)*pki(l)</a>
<a name="rase_di310"></a><a href="convection.html#rasei310" target="origFile"><code class="comment">!*</code></a>
<a name="rase_di311"></a>      <a href="convection.html#rasei310" target="origFile">gamd(l) = -(pki(l)*lbcp*dqqd(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))**<code class="constant">2</code>)</a>
<a name="rase_di312"></a>      <a href="convection.html#rasei310" target="origFile">gam(l) = pki(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))</a>
<a name="rase_di312"></a>      <a href="convection.html#rasei311" target="origFile"><code class="keyword">IF</code> (l .LT. k) <code class="keyword">THEN</code></a>
<a name="rase_di313"></a>        <a href="convection.html#rasei312" target="origFile">ghtd(l+<code class="constant">1</code>) = dpb(l)*gamd(l) + dpt(l+<code class="constant">1</code>)*gamd(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei312" target="origFile">ght(l+<code class="constant">1</code>) = gam(l)*dpb(l) + gam(l+<code class="constant">1</code>)*dpt(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei313" target="origFile">gm1d(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*((dqqd(l)*alhl*(<code class="constant">1.0</code>+lbcp*dqq(l))-dqq(l)*<code class="label">&</code></a>
<a href="convection.html#rasei313" target="origFile"><code class="label">&         </code>alhl*lbcp*dqqd(l))/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))**<code class="constant">2</code>+(dqqd(l+<code class="constant">1</code>)*alhl<code class="label">&</code></a>
<a name="rase_di313"></a><a href="convection.html#rasei313" target="origFile"><code class="label">&         </code>*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))-dqq(l+<code class="constant">1</code>)*alhl*lbcp*dqqd(l+<code class="constant">1</code>))/(alhl*(<code class="constant">1.0</code>+<code class="label">&</code></a>
<a href="convection.html#rasei313" target="origFile"><code class="label">&         </code>lbcp*dqq(l+<code class="constant">1</code>)))**<code class="constant">2</code>)</a>
        <a href="convection.html#rasei313" target="origFile">gm1(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*(dqq(l)/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))+dqq(l+<code class="constant">1</code>)/(<code class="label">&</code></a>
<a href="convection.html#rasei313" target="origFile"><code class="label">&         </code>alhl*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))))</a>
<a name="rase_di315"></a>      <a href="convection.html#rasei311" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di316"></a>    <a href="convection.html#rasei314" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di317"></a>    <a href="convection.html#rasei315" target="origFile">rns = <code class="constant">0.</code></a>
<a name="rase_di318"></a>    <a href="convection.html#rasei316" target="origFile">cll = <code class="constant">0.</code></a>
<a name="rase_di319"></a>    <a href="convection.html#rasei317" target="origFile">rmf = <code class="constant">0.</code></a>
<a name="rase_di320"></a>    <a href="convection.html#rasei318" target="origFile">rmfd = <code class="constant">0.</code></a>
<a name="rase_di321"></a>    <a href="convection.html#rasei319" target="origFile">rmfc = <code class="constant">0.</code></a>
<a name="rase_di322"></a>    <a href="convection.html#rasei320" target="origFile">rmfp = <code class="constant">0.</code></a>
<a name="rase_di323"></a>    <a href="convection.html#rasei321" target="origFile">cll0 = <code class="constant">0.</code></a>
<a name="rase_di324"></a>    <a href="convection.html#rasei322" target="origFile">dll0 = <code class="constant">0.</code></a>
<a name="rase_di325"></a>    <a href="convection.html#rasei323" target="origFile">cllx = <code class="constant">0.</code></a>
<a name="rase_di326"></a>    <a href="convection.html#rasei324" target="origFile">dllx = <code class="constant">0.</code></a>
<a name="rase_di326"></a>    <a href="convection.html#rasei325" target="origFile">clli = <code class="constant">0.</code></a>
<a name="rase_di327"></a>    <a href="convection.html#rasei326" target="origFile">poi_svd = poid</a>
<a name="rase_di327"></a>    <a href="convection.html#rasei326" target="origFile">poi_sv = poi</a>
<a name="rase_di328"></a>    <a href="convection.html#rasei327" target="origFile">qoi_svd = qoid</a>
<a name="rase_di328"></a>    <a href="convection.html#rasei327" target="origFile">qoi_sv = qoi</a>
<a name="rase_di329"></a>    <a href="convection.html#rasei328" target="origFile">uoi_svd = uoid</a>
<a name="rase_di329"></a>    <a href="convection.html#rasei328" target="origFile">uoi_sv = uoi</a>
<a name="rase_di330"></a>    <a href="convection.html#rasei329" target="origFile">voi_svd = void0</a>
<a name="rase_di331"></a>    <a href="convection.html#rasei329" target="origFile">voi_sv = voi</a>
<a name="rase_di332"></a>    <a href="convection.html#rasei330" target="origFile">cvw = <code class="constant">0.0</code></a>
<a name="rase_di333"></a>    <a href="convection.html#rasei331" target="origFile">updfrc = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei332" target="origFile">updfrp = <code class="constant">0.0</code></a>
<a name="rase_di334"></a><a href="convection.html#rasei333" target="origFile"><code class="comment">! HOL initialized here in order not to confuse Valgrind debugger</code></a>
<a name="rase_di334"></a>    <a href="convection.html#rasei333" target="origFile">hol = <code class="constant">0.</code></a>
    <a href="convection.html#rasei334" target="origFile">zetd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di335"></a>    <a href="convection.html#rasei334" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0</code></a>
<a name="rase_di335"></a>    <a href="convection.html#rasei335" target="origFile">shtd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei335" target="origFile">shtd(k+<code class="constant">1</code>) = cp*prj(k+<code class="constant">1</code>)*poid(k)</a>
    <a href="convection.html#rasei335" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi(k)*prj(k+<code class="constant">1</code>)</a>
    <a href="convection.html#rasei234" target="origFile">hstd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">qold = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">ssld = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">zetd = <code class="constant">0.0_8</code></a>
<a name="rase_di348"></a>    <a href="convection.html#rasei234" target="origFile">zold = <code class="constant">0.0_8</code></a>
<a name="rase_di336"></a>    <a href="convection.html#rasei234" target="origFile">hold = <code class="constant">0.0_8</code></a>
<a name="rase_di337"></a>    <a href="convection.html#rasei348" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_di337"></a>      <a href="convection.html#rasei336" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi(l)) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei337" target="origFile">qold(l) = qoid(l)</a>
<a name="rase_di338"></a>        <a href="convection.html#rasei337" target="origFile">qol(l) = qoi(l)</a>
<a name="rase_di338"></a>      <a href="convection.html#rasei336" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei338" target="origFile">qold(l) = rhmax*qstd(l)</a>
<a name="rase_di339"></a>        <a href="convection.html#rasei338" target="origFile">qol(l) = qst(l)*rhmax</a>
<a name="rase_di340"></a>      <a href="convection.html#rasei336" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei339" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
<a name="rase_di341"></a>        <a href="convection.html#rasei340" target="origFile">qol(l) = qol(l)</a>
<a name="rase_di341"></a>      <a href="convection.html#rasei339" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei341" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di342"></a>        <a href="convection.html#rasei341" target="origFile">qol(l) = <code class="constant">0.000</code></a>
<a name="rase_di342"></a>      <a href="convection.html#rasei339" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di343"></a>      <a href="convection.html#rasei342" target="origFile">ssld(l) = cp*prj(l+<code class="constant">1</code>)*poid(l) + grav*zetd(l+<code class="constant">1</code>)</a>
<a name="rase_di343"></a>      <a href="convection.html#rasei342" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi(l) + grav*zet(l+<code class="constant">1</code>)</a>
<a name="rase_di344"></a>      <a href="convection.html#rasei343" target="origFile">hold(l) = ssld(l) + alhl*qold(l)</a>
<a name="rase_di344"></a>      <a href="convection.html#rasei343" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
<a name="rase_di345"></a>      <a href="convection.html#rasei344" target="origFile">hstd(l) = ssld(l) + alhl*qstd(l)</a>
<a name="rase_di345"></a>      <a href="convection.html#rasei344" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
<a name="rase_di346"></a>      <a href="convection.html#rasei345" target="origFile">temd = (prj(l+<code class="constant">1</code>)-prj(l))*cpbg*poid(l)</a>
<a name="rase_di346"></a>      <a href="convection.html#rasei345" target="origFile">tem = poi(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
<a name="rase_di347"></a>      <a href="convection.html#rasei346" target="origFile">zetd(l) = zetd(l+<code class="constant">1</code>) + temd</a>
<a name="rase_di347"></a>      <a href="convection.html#rasei346" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
      <a href="convection.html#rasei347" target="origFile">zold(l) = zetd(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*cpbg*poid(l)</a>
      <a href="convection.html#rasei347" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi(l)*cpbg</a>
    <a href="convection.html#rasei348" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei234" target="origFile">ehtd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">hccd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">f2d = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">cvwd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">ucud = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">qhtd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">bk2d = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">rasald = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">hcldd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">etad = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">gmhd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">rnnd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">gmsd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">updfrcd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">rnsd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">vcud = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">rmfdd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">updfrpd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">cll0d = <code class="constant">0.0_8</code></a>
<a name="rase_di533"></a>    <a href="convection.html#rasei234" target="origFile">clld = <code class="constant">0.0_8</code></a>
<a name="rase_di349"></a>    <a href="convection.html#rasei234" target="origFile">rmfpd = <code class="constant">0.0_8</code></a>
<a name="rase_di349"></a>    <a href="convection.html#rasei533" target="origFile"><code class="keyword">DO </code>ic=k,icmin+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_di350"></a>      <a href="convection.html#rasei349" target="origFile">ucud(icmin:) = <code class="constant">0.0_8</code></a>
<a name="rase_di350"></a>      <a href="convection.html#rasei349" target="origFile">ucu(icmin:) = <code class="constant">0.</code></a>
<a name="rase_di351"></a>      <a href="convection.html#rasei350" target="origFile">vcud(icmin:) = <code class="constant">0.0_8</code></a>
<a name="rase_di352"></a>      <a href="convection.html#rasei350" target="origFile">vcu(icmin:) = <code class="constant">0.</code></a>
<a name="rase_di353"></a>      <a href="convection.html#rasei351" target="origFile">alm = <code class="constant">0.</code></a>
<a name="rase_di353"></a>      <a href="convection.html#rasei352" target="origFile"><code class="keyword">IF</code> (<code class="constant">1. </code>.GT. (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei353" target="origFile">trgd = (qoid(k)*qst(k)-qoi(k)*qstd(k))/qst(k)**<code class="constant">2</code>/(rhmx-rhmn)</a>
<a name="rase_di354"></a>        <a href="convection.html#rasei353" target="origFile">trg = (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)</a>
      <a href="convection.html#rasei352" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei354" target="origFile">trg = <code class="constant">1.</code></a>
<a name="rase_di355"></a>        <a href="convection.html#rasei352" target="origFile">trgd = <code class="constant">0.0_8</code></a>
<a name="rase_di356"></a>      <a href="convection.html#rasei352" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei355" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.0 </code>.LT. (autorampb-sige(ic))/<code class="constant">0.2</code>) <code class="keyword">THEN</code></a>
<a name="rase_di357"></a>        <a href="convection.html#rasei356" target="origFile">y1 = (autorampb-sige(ic))/<code class="constant">0.2</code></a>
      <a href="convection.html#rasei355" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di358"></a>        <a href="convection.html#rasei357" target="origFile">y1 = <code class="constant">0.0</code></a>
<a name="rase_di359"></a>      <a href="convection.html#rasei355" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei358" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.0 </code>.GT. y1) <code class="keyword">THEN</code></a>
<a name="rase_di360"></a>        <a href="convection.html#rasei359" target="origFile">f4 = y1</a>
      <a href="convection.html#rasei358" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di361"></a>        <a href="convection.html#rasei360" target="origFile">f4 = <code class="constant">1.0</code></a>
<a name="rase_di362"></a>      <a href="convection.html#rasei358" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei361" target="origFile"><code class="keyword">IF</code> (trg .GT. <code class="constant">1.0e-5</code>) <code class="keyword">THEN</code></a>
<a href="convection.html#rasei362" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di362"></a><a href="convection.html#rasei362" target="origFile"><code class="comment">!RECOMPUTE SOUNDING UP TO DETRAINMENT LEVEL</code></a>
<a name="rase_di363"></a>        <a href="convection.html#rasei362" target="origFile">poi_cd = poid</a>
<a name="rase_di363"></a>        <a href="convection.html#rasei362" target="origFile">poi_c = poi</a>
<a name="rase_di364"></a>        <a href="convection.html#rasei363" target="origFile">qoi_cd = qoid</a>
<a name="rase_di364"></a>        <a href="convection.html#rasei363" target="origFile">qoi_c = qoi</a>
<a name="rase_di365"></a>        <a href="convection.html#rasei364" target="origFile">poi_cd(k) = poi_cd(k) + tpertd</a>
<a name="rase_di366"></a>        <a href="convection.html#rasei364" target="origFile">poi_c(k) = poi_c(k) + tpert</a>
<a name="rase_di366"></a>        <a href="convection.html#rasei365" target="origFile">qoi_c(k) = qoi_c(k) + qpert</a>
<a name="rase_di367"></a>        <a href="convection.html#rasei366" target="origFile">zetd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di367"></a>        <a href="convection.html#rasei366" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_di380"></a>        <a href="convection.html#rasei367" target="origFile">shtd(k+<code class="constant">1</code>) = cp*prj(k+<code class="constant">1</code>)*poi_cd(k)</a>
<a name="rase_di368"></a>        <a href="convection.html#rasei367" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi_c(k)*prj(k+<code class="constant">1</code>)</a>
<a name="rase_di369"></a>        <a href="convection.html#rasei380" target="origFile"><code class="keyword">DO </code>l=k,ic,-<code class="constant">1</code></a>
<a name="rase_di369"></a>          <a href="convection.html#rasei368" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi_c(l)) <code class="keyword">THEN</code></a>
            <a href="convection.html#rasei369" target="origFile">qold(l) = qoi_cd(l)</a>
<a name="rase_di370"></a>            <a href="convection.html#rasei369" target="origFile">qol(l) = qoi_c(l)</a>
<a name="rase_di370"></a>          <a href="convection.html#rasei368" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection.html#rasei370" target="origFile">qold(l) = rhmax*qstd(l)</a>
<a name="rase_di371"></a>            <a href="convection.html#rasei370" target="origFile">qol(l) = qst(l)*rhmax</a>
<a name="rase_di372"></a>          <a href="convection.html#rasei368" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection.html#rasei371" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
<a name="rase_di373"></a>            <a href="convection.html#rasei372" target="origFile">qol(l) = qol(l)</a>
<a name="rase_di373"></a>          <a href="convection.html#rasei371" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection.html#rasei373" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di374"></a>            <a href="convection.html#rasei373" target="origFile">qol(l) = <code class="constant">0.000</code></a>
<a name="rase_di374"></a>          <a href="convection.html#rasei371" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di375"></a>          <a href="convection.html#rasei374" target="origFile">ssld(l) = cp*prj(l+<code class="constant">1</code>)*poi_cd(l) + grav*zetd(l+<code class="constant">1</code>)</a>
<a name="rase_di375"></a>          <a href="convection.html#rasei374" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi_c(l) + grav*zet(l+<code class="constant">1</code>)</a>
<a name="rase_di376"></a>          <a href="convection.html#rasei375" target="origFile">hold(l) = ssld(l) + alhl*qold(l)</a>
<a name="rase_di376"></a>          <a href="convection.html#rasei375" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
<a name="rase_di377"></a>          <a href="convection.html#rasei376" target="origFile">hstd(l) = ssld(l) + alhl*qstd(l)</a>
<a name="rase_di377"></a>          <a href="convection.html#rasei376" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
<a name="rase_di378"></a>          <a href="convection.html#rasei377" target="origFile">temd = (prj(l+<code class="constant">1</code>)-prj(l))*cpbg*poi_cd(l)</a>
<a name="rase_di378"></a>          <a href="convection.html#rasei377" target="origFile">tem = poi_c(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
<a name="rase_di379"></a>          <a href="convection.html#rasei378" target="origFile">zetd(l) = zetd(l+<code class="constant">1</code>) + temd</a>
<a name="rase_di379"></a>          <a href="convection.html#rasei378" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
          <a href="convection.html#rasei379" target="origFile">zold(l) = zetd(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*cpbg*poi_cd(l)</a>
<a name="rase_di384"></a>          <a href="convection.html#rasei379" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi_c(l)*cpbg</a>
<a name="rase_di381"></a>        <a href="convection.html#rasei380" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di382"></a>        <a href="convection.html#rasei384" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
<a name="rase_di382"></a>          <a href="convection.html#rasei381" target="origFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
<a name="rase_di383"></a>          <a href="convection.html#rasei382" target="origFile">shtd(l) = ssld(l-<code class="constant">1</code>) + tem*(ssld(l)-ssld(l-<code class="constant">1</code>))</a>
<a name="rase_di383"></a>          <a href="convection.html#rasei382" target="origFile">sht(l) = ssl(l-<code class="constant">1</code>) + tem*(ssl(l)-ssl(l-<code class="constant">1</code>))</a>
          <a href="convection.html#rasei383" target="origFile">qhtd(l) = <code class="constant">.5</code>*(qold(l)+qold(l-<code class="constant">1</code>))</a>
<a name="rase_di385"></a>          <a href="convection.html#rasei383" target="origFile">qht(l) = <code class="constant">.5</code>*(qol(l)+qol(l-<code class="constant">1</code>))</a>
        <a href="convection.html#rasei384" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di386"></a><a href="convection.html#rasei385" target="origFile"><code class="comment">!CALCULATE LAMBDA, ETA, AND WORKFUNCTION</code></a>
<a name="rase_di387"></a>        <a href="convection.html#rasei385" target="origFile">lambda_min = <code class="constant">.2</code>/mxdiam</a>
<a name="rase_di388"></a>        <a href="convection.html#rasei386" target="origFile">lambda_max = <code class="constant">.2</code>/<code class="constant">200.</code></a>
        <a href="convection.html#rasei387" target="origFile"><code class="keyword">IF</code> (hol(k) .GT. hst(ic)) <code class="keyword">THEN</code></a>
<a href="convection.html#rasei388" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection.html#rasei388" target="origFile"><code class="comment">!LAMBDA CALCULATION: MS-A18</code></a>
<a name="rase_di388"></a>          <a href="convection.html#rasei388" target="origFile">temd = (hstd(ic)-hold(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>)) + (hst(ic)-hol(<code class="label">&</code></a>
<a name="rase_di390"></a><a href="convection.html#rasei388" target="origFile"><code class="label">&           </code>ic))*(zold(ic)-zetd(ic+<code class="constant">1</code>))</a>
<a name="rase_di389"></a>          <a href="convection.html#rasei388" target="origFile">tem = (hst(ic)-hol(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>))</a>
          <a href="convection.html#rasei390" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k-<code class="constant">1</code></a>
<a name="rase_di389"></a>            <a href="convection.html#rasei389" target="origFile">temd = temd + (hstd(ic)-hold(l))*(zet(l)-zet(l+<code class="constant">1</code>)) + (hst(ic<code class="label">&</code></a>
<a href="convection.html#rasei389" target="origFile"><code class="label">&             </code>)-hol(l))*(zetd(l)-zetd(l+<code class="constant">1</code>))</a>
<a name="rase_di391"></a>            <a href="convection.html#rasei389" target="origFile">tem = tem + (hst(ic)-hol(l))*(zet(l)-zet(l+<code class="constant">1</code>))</a>
<a name="rase_di392"></a>          <a href="convection.html#rasei390" target="origFile"><code class="keyword">END DO</code></a>
          <a href="convection.html#rasei391" target="origFile"><code class="keyword">IF</code> (tem .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_di392"></a><a href="convection.html#rasei392" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di393"></a>            <a href="convection.html#rasei392" target="origFile">almd = ((hold(k)-hstd(ic))*tem-(hol(k)-hst(ic))*temd)/tem**<code class="constant">2</code></a>
<a name="rase_di394"></a>            <a href="convection.html#rasei392" target="origFile">alm = (hol(k)-hst(ic))/tem</a>
            <a href="convection.html#rasei393" target="origFile"><code class="keyword">IF</code> (alm .LE. lambda_max) <code class="keyword">THEN</code></a>
<a name="rase_di395"></a><a href="convection.html#rasei394" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di396"></a>              <a href="convection.html#rasei394" target="origFile">toki = <code class="constant">1.0</code></a>
<a name="rase_di396"></a>              <a href="convection.html#rasei395" target="origFile"><code class="keyword">IF</code> (alm .LT. lambda_min) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei396" target="origFile">tokid = <code class="constant">2</code>*alm*almd/lambda_min**<code class="constant">2</code></a>
                <a href="convection.html#rasei396" target="origFile">toki = (alm/lambda_min)**<code class="constant">2</code></a>
              <a href="convection.html#rasei395" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di398"></a>                <a href="convection.html#rasei395" target="origFile">tokid = <code class="constant">0.0_8</code></a>
              <a href="convection.html#rasei395" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di397"></a><a href="convection.html#rasei398" target="origFile"><code class="comment">!ETA CALCULATION: MS-A2</code></a>
<a name="rase_di397"></a>              <a href="convection.html#rasei398" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
                <a href="convection.html#rasei397" target="origFile">etad(l) = almd*(zet(l)-zet(k)) + alm*(zetd(l)-zetd(k))</a>
<a name="rase_di399"></a>                <a href="convection.html#rasei397" target="origFile">eta(l) = <code class="constant">1.0 </code>+ alm*(zet(l)-zet(k))</a>
<a name="rase_di399"></a>              <a href="convection.html#rasei398" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di400"></a>              <a href="convection.html#rasei399" target="origFile">etad(ic) = almd*(zol(ic)-zet(k)) + alm*(zold(ic)-zetd(k))</a>
              <a href="convection.html#rasei399" target="origFile">eta(ic) = <code class="constant">1.0 </code>+ alm*(zol(ic)-zet(k))</a>
<a name="rase_di401"></a><a href="convection.html#rasei400" target="origFile"><code class="comment">!WORKFUNCTION CALCULATION:  MS-A22</code></a>
<a name="rase_di401"></a>              <a href="convection.html#rasei400" target="origFile">wfn = <code class="constant">0.0</code></a>
              <a href="convection.html#rasei401" target="origFile">hccd(k) = hold(k)</a>
<a name="rase_di406"></a>              <a href="convection.html#rasei401" target="origFile">hcc(k) = hol(k)</a>
<a name="rase_di402"></a>              <a href="convection.html#rasei393" target="origFile">wfnd = <code class="constant">0.0_8</code></a>
              <a href="convection.html#rasei406" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_di402"></a>                <a href="convection.html#rasei402" target="origFile">hccd(l) = hccd(l+<code class="constant">1</code>) + (etad(l)-etad(l+<code class="constant">1</code>))*hol(l) + (eta(<code class="label">&</code></a>
<a name="rase_di403"></a><a href="convection.html#rasei402" target="origFile"><code class="label">&                 </code>l)-eta(l+<code class="constant">1</code>))*hold(l)</a>
<a name="rase_di403"></a>                <a href="convection.html#rasei402" target="origFile">hcc(l) = hcc(l+<code class="constant">1</code>) + (eta(l)-eta(l+<code class="constant">1</code>))*hol(l)</a>
<a name="rase_di404"></a>                <a href="convection.html#rasei403" target="origFile">temd = dpb(l)*hccd(l+<code class="constant">1</code>) + dpt(l)*hccd(l)</a>
<a name="rase_di404"></a>                <a href="convection.html#rasei403" target="origFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
<a name="rase_di405"></a>                <a href="convection.html#rasei404" target="origFile">ehtd(l) = dpb(l)*etad(l+<code class="constant">1</code>) + dpt(l)*etad(l)</a>
                <a href="convection.html#rasei404" target="origFile">eht(l) = eta(l+<code class="constant">1</code>)*dpb(l) + eta(l)*dpt(l)</a>
<a name="rase_di405"></a>                <a href="convection.html#rasei405" target="origFile">wfnd = wfnd + (temd-ehtd(l)*hst(l)-eht(l)*hstd(l))*gam(l<code class="label">&</code></a>
<a href="convection.html#rasei405" target="origFile"><code class="label">&                 </code>) + (tem-eht(l)*hst(l))*gamd(l)</a>
<a name="rase_di407"></a>                <a href="convection.html#rasei405" target="origFile">wfn = wfn + (tem-eht(l)*hst(l))*gam(l)</a>
<a name="rase_di407"></a>              <a href="convection.html#rasei406" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di408"></a>              <a href="convection.html#rasei407" target="origFile">hccd(ic) = hstd(ic)*eta(ic) + hst(ic)*etad(ic)</a>
              <a href="convection.html#rasei407" target="origFile">hcc(ic) = hst(ic)*eta(ic)</a>
              <a href="convection.html#rasei408" target="origFile">wfnd = wfnd + dpb(ic)*((hccd(ic+<code class="constant">1</code>)-hstd(ic)*eta(ic+<code class="constant">1</code>)-hst(<code class="label">&</code></a>
<a name="rase_di408"></a><a href="convection.html#rasei408" target="origFile"><code class="label">&               </code>ic)*etad(ic+<code class="constant">1</code>))*gam(ic)+(hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*<code class="label">&</code></a>
<a name="rase_di409"></a><a href="convection.html#rasei408" target="origFile"><code class="label">&               </code>gamd(ic))</a>
              <a href="convection.html#rasei408" target="origFile">wfn = wfn + (hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*gam(ic)*dpb(ic)</a>
<a name="rase_di409"></a><a href="convection.html#rasei409" target="origFile"><code class="comment">!VERTICAL VELOCITY/KE CALCULATION (ADDED 12/2001 JTB)</code></a>
<a name="rase_di410"></a>              <a href="convection.html#rasei409" target="origFile">bk2d(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di411"></a>              <a href="convection.html#rasei409" target="origFile">bk2(k) = <code class="constant">0.0</code></a>
<a name="rase_di411"></a>              <a href="convection.html#rasei410" target="origFile">bke(k) = <code class="constant">0.0</code></a>
<a name="rase_di423"></a>              <a href="convection.html#rasei411" target="origFile">hcldd(k) = hold(k)</a>
<a name="rase_di412"></a>              <a href="convection.html#rasei411" target="origFile">hcld(k) = hol(k)</a>
              <a href="convection.html#rasei423" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                <a href="convection.html#rasei412" target="origFile">hcldd(l) = ((etad(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+eta(l+<code class="constant">1</code>)*hcldd(l+<code class="constant">1</code>)+(<code class="label">&</code></a>
<a href="convection.html#rasei412" target="origFile"><code class="label">&                 </code>etad(l)-etad(l+<code class="constant">1</code>))*hol(l)+(eta(l)-eta(l+<code class="constant">1</code>))*hold(l))*<code class="label">&</code></a>
<a name="rase_di412"></a><a href="convection.html#rasei412" target="origFile"><code class="label">&                 </code>eta(l)-(eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))*<code class="label">&</code></a>
<a href="convection.html#rasei412" target="origFile"><code class="label">&                 </code>etad(l))/eta(l)**<code class="constant">2</code></a>
<a name="rase_di413"></a>                <a href="convection.html#rasei412" target="origFile">hcld(l) = (eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))/<code class="label">&</code></a>
<a href="convection.html#rasei412" target="origFile"><code class="label">&                 </code>eta(l)</a>
                <a href="convection.html#rasei413" target="origFile">temd = (((hcldd(l)-hstd(l))*(zet(l)-zet(l+<code class="constant">1</code>))+(hcld(l)-<code class="label">&</code></a>
<a href="convection.html#rasei413" target="origFile"><code class="label">&                 </code>hst(l))*(zetd(l)-zetd(l+<code class="constant">1</code>)))*(<code class="constant">1.0</code>+lbcp*dqq(l))-(hcld(l<code class="label">&</code></a>
<a name="rase_di413"></a><a href="convection.html#rasei413" target="origFile"><code class="label">&                 </code>)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))*lbcp*dqqd(l))/(<code class="constant">1.0</code>+lbcp*<code class="label">&</code></a>
<a href="convection.html#rasei413" target="origFile"><code class="label">&                 </code>dqq(l))**<code class="constant">2</code></a>
<a name="rase_di414"></a>                <a href="convection.html#rasei413" target="origFile">tem = (hcld(l)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))/(<code class="constant">1.0</code>+lbcp*dqq(l<code class="label">&</code></a>
<a name="rase_di415"></a><a href="convection.html#rasei413" target="origFile"><code class="label">&                 </code>))</a>
<a name="rase_di416"></a>                <a href="convection.html#rasei414" target="origFile">bke(l) = bke(l+<code class="constant">1</code>) + grav*tem/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection.html#rasei415" target="origFile"><code class="keyword">IF</code> (tem .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei416" target="origFile">max1 = <code class="constant">0.0</code></a>
<a name="rase_di417"></a>                  <a href="convection.html#rasei415" target="origFile">max1d = <code class="constant">0.0_8</code></a>
<a name="rase_di417"></a>                <a href="convection.html#rasei415" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei417" target="origFile">max1d = temd</a>
<a name="rase_di418"></a>                  <a href="convection.html#rasei417" target="origFile">max1 = tem</a>
                <a href="convection.html#rasei415" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di418"></a>                <a href="convection.html#rasei418" target="origFile">bk2d(l) = bk2d(l+<code class="constant">1</code>) + (grav*max1d*cp*prj(l+<code class="constant">1</code>)*poi(l)-<code class="label">&</code></a>
<a name="rase_di419"></a><a href="convection.html#rasei418" target="origFile"><code class="label">&                 </code>grav*max1*cp*prj(l+<code class="constant">1</code>)*poid(l))/(cp*prj(l+<code class="constant">1</code>)*poi(l))**<code class="constant">2</code></a>
<a name="rase_di420"></a>                <a href="convection.html#rasei418" target="origFile">bk2(l) = bk2(l+<code class="constant">1</code>) + grav*max1/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection.html#rasei419" target="origFile"><code class="keyword">IF</code> (bk2(l) .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei420" target="origFile">max2 = <code class="constant">0.0</code></a>
<a name="rase_di421"></a>                  <a href="convection.html#rasei419" target="origFile">max2d = <code class="constant">0.0_8</code></a>
<a name="rase_di421"></a>                <a href="convection.html#rasei419" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei421" target="origFile">max2d = bk2d(l)</a>
<a name="rase_di422"></a>                  <a href="convection.html#rasei421" target="origFile">max2 = bk2(l)</a>
                <a href="convection.html#rasei419" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei422" target="origFile"><code class="keyword">IF</code> (<code class="constant">2.0</code>*max2 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei422" target="origFile">cvwd(l) = <code class="constant">0.0_8</code></a>
                <a href="convection.html#rasei422" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di422"></a>                  <a href="convection.html#rasei422" target="origFile">cvwd(l) = max2d/<code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
                <a href="convection.html#rasei422" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di424"></a>                <a href="convection.html#rasei422" target="origFile">cvw(l) = <code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
              <a href="convection.html#rasei423" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di425"></a><a href="convection.html#rasei424" target="origFile"><code class="comment">!ALPHA CALCULATION </code></a>
<a name="rase_di425"></a>              <a href="convection.html#rasei424" target="origFile"><code class="keyword">IF</code> (zet(ic) .LT. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei425" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_di426"></a>                <a href="convection.html#rasei425" target="origFile">rasal(ic) = rasal1</a>
<a name="rase_di427"></a>              <a href="convection.html#rasei424" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di427"></a>              <a href="convection.html#rasei426" target="origFile"><code class="keyword">IF</code> (zet(ic) .GE. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei427" target="origFile">rasald(ic) = (rasal2-rasal1)*zetd(ic)/<code class="constant">8000.</code></a>
                <a href="convection.html#rasei427" target="origFile">rasal(ic) = rasal1 + (rasal2-rasal1)*(zet(ic)-<code class="constant">2000.</code>)/<code class="label">&</code></a>
<a name="rase_di428"></a><a href="convection.html#rasei427" target="origFile"><code class="label">&                 </code><code class="constant">8000.</code></a>
<a name="rase_di429"></a>              <a href="convection.html#rasei426" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di429"></a>              <a href="convection.html#rasei428" target="origFile"><code class="keyword">IF</code> (rasal(ic) .GT. <code class="constant">1.0e5</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei429" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_di430"></a>                <a href="convection.html#rasei429" target="origFile">rasal(ic) = <code class="constant">1.0e5</code></a>
              <a href="convection.html#rasei428" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di431"></a>                <a href="convection.html#rasei430" target="origFile">rasal(ic) = rasal(ic)</a>
<a name="rase_di431"></a>              <a href="convection.html#rasei428" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di435"></a>              <a href="convection.html#rasei431" target="origFile">rasald(ic) = -(dt*rasald(ic)/rasal(ic)**<code class="constant">2</code>)</a>
<a name="rase_di432"></a>              <a href="convection.html#rasei431" target="origFile">rasal(ic) = dt/rasal(ic)</a>
<a name="rase_di433"></a>              <a href="convection.html#rasei435" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
<a name="rase_di433"></a>                <a href="convection.html#rasei432" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei433" target="origFile">cvwd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di434"></a>                  <a href="convection.html#rasei433" target="origFile">cvw(l) = <code class="constant">1.00</code></a>
                <a href="convection.html#rasei432" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei434" target="origFile">cvw(l) = cvw(l)</a>
<a name="rase_di436"></a>                <a href="convection.html#rasei432" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di437"></a>              <a href="convection.html#rasei435" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di438"></a>              <a href="convection.html#rasei436" target="origFile"><code class="keyword">CALL </code><code class="funcname">ACRITN</code>(pol(ic), prs(k), acr, acritfac)</a>
              <a href="convection.html#rasei437" target="origFile"><code class="keyword">IF</code> (wfn .GT. acr) <code class="keyword">THEN</code></a>
<a name="rase_di438"></a><a href="convection.html#rasei438" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di439"></a>                <a href="convection.html#rasei438" target="origFile">wlqd = qold(k)</a>
<a name="rase_di439"></a>                <a href="convection.html#rasei438" target="origFile">wlq = qol(k)</a>
<a name="rase_di440"></a>                <a href="convection.html#rasei439" target="origFile">uhtd = uoid(k)</a>
<a name="rase_di440"></a>                <a href="convection.html#rasei439" target="origFile">uht = uoi(k)</a>
<a name="rase_di441"></a>                <a href="convection.html#rasei440" target="origFile">vhtd = void0(k)</a>
<a name="rase_di441"></a>                <a href="convection.html#rasei440" target="origFile">vht = voi(k)</a>
<a name="rase_di442"></a>                <a href="convection.html#rasei441" target="origFile">rnnd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di442"></a>                <a href="convection.html#rasei441" target="origFile">rnn(k) = <code class="constant">0.</code></a>
<a name="rase_di477"></a>                <a href="convection.html#rasei442" target="origFile">cll0d(k) = <code class="constant">0.0_8</code></a>
<a name="rase_di443"></a>                <a href="convection.html#rasei442" target="origFile">cll0(k) = <code class="constant">0.</code></a>
<a name="rase_di443"></a>                <a href="convection.html#rasei477" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
<a name="rase_di444"></a>                  <a href="convection.html#rasei443" target="origFile">temd = etad(l) - etad(l+<code class="constant">1</code>)</a>
<a name="rase_di444"></a>                  <a href="convection.html#rasei443" target="origFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
<a name="rase_di445"></a>                  <a href="convection.html#rasei444" target="origFile">wlqd = wlqd + temd*qol(l) + tem*qold(l)</a>
<a name="rase_di445"></a>                  <a href="convection.html#rasei444" target="origFile">wlq = wlq + tem*qol(l)</a>
<a name="rase_di446"></a>                  <a href="convection.html#rasei445" target="origFile">uhtd = uhtd + temd*uoi(l) + tem*uoid(l)</a>
<a name="rase_di446"></a>                  <a href="convection.html#rasei445" target="origFile">uht = uht + tem*uoi(l)</a>
<a name="rase_di447"></a>                  <a href="convection.html#rasei446" target="origFile">vhtd = vhtd + temd*voi(l) + tem*void0(l)</a>
<a name="rase_di448"></a>                  <a href="convection.html#rasei446" target="origFile">vht = vht + tem*voi(l)</a>
                  <a href="convection.html#rasei447" target="origFile"><code class="keyword">IF</code> (l .GT. ic) <code class="keyword">THEN</code></a>
<a name="rase_di448"></a>                    <a href="convection.html#rasei448" target="origFile">tx2d = <code class="constant">0.5</code>*((qstd(l)+qstd(l-<code class="constant">1</code>))*eta(l)+(qst(l)+qst(l<code class="label">&</code></a>
<a name="rase_di449"></a><a href="convection.html#rasei448" target="origFile"><code class="label">&                     </code>-<code class="constant">1</code>))*etad(l))</a>
                    <a href="convection.html#rasei448" target="origFile">tx2 = <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*eta(l)</a>
<a name="rase_di449"></a>                    <a href="convection.html#rasei449" target="origFile">tx3d = <code class="constant">0.5</code>*((hstd(l)+hstd(l-<code class="constant">1</code>))*eta(l)+(hst(l)+hst(l<code class="label">&</code></a>
<a name="rase_di450"></a><a href="convection.html#rasei449" target="origFile"><code class="label">&                     </code>-<code class="constant">1</code>))*etad(l))</a>
                    <a href="convection.html#rasei449" target="origFile">tx3 = <code class="constant">0.5</code>*(hst(l)+hst(l-<code class="constant">1</code>))*eta(l)</a>
<a name="rase_di450"></a>                    <a href="convection.html#rasei450" target="origFile">qccd = tx2d + gm1d(l)*(hcc(l)-tx3) + gm1(l)*(hccd(l)<code class="label">&</code></a>
<a name="rase_di451"></a><a href="convection.html#rasei450" target="origFile"><code class="label">&                     </code>-tx3d)</a>
<a name="rase_di451"></a>                    <a href="convection.html#rasei450" target="origFile">qcc = tx2 + gm1(l)*(hcc(l)-tx3)</a>
                    <a href="convection.html#rasei451" target="origFile">cll0d(l) = wlqd - qccd</a>
<a name="rase_di452"></a>                    <a href="convection.html#rasei451" target="origFile">cll0(l) = wlq - qcc</a>
                  <a href="convection.html#rasei447" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di452"></a>                    <a href="convection.html#rasei452" target="origFile">cll0d(l) = wlqd - qstd(ic)*eta(ic) - qst(ic)*etad(ic<code class="label">&</code></a>
<a href="convection.html#rasei452" target="origFile"><code class="label">&                     </code>)</a>
<a name="rase_di453"></a>                    <a href="convection.html#rasei452" target="origFile">cll0(l) = wlq - qst(ic)*eta(ic)</a>
<a name="rase_di454"></a>                  <a href="convection.html#rasei447" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di454"></a>                  <a href="convection.html#rasei453" target="origFile"><code class="keyword">IF</code> (cll0(l) .LT. <code class="constant">0.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei454" target="origFile">cll0d(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di455"></a>                    <a href="convection.html#rasei454" target="origFile">cll0(l) = <code class="constant">0.00</code></a>
                  <a href="convection.html#rasei453" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di456"></a>                    <a href="convection.html#rasei455" target="origFile">cll0(l) = cll0(l)</a>
<a name="rase_di456"></a>                  <a href="convection.html#rasei453" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di457"></a>                  <a href="convection.html#rasei456" target="origFile">clid = (cll0d(l)*eta(l)-cll0(l)*etad(l))/eta(l)**<code class="constant">2</code></a>
<a name="rase_di457"></a>                  <a href="convection.html#rasei456" target="origFile">cli = cll0(l)/eta(l)</a>
<a name="rase_di458"></a>                  <a href="convection.html#rasei457" target="origFile">te_ad = prh(l)*poid(l)</a>
                  <a href="convection.html#rasei457" target="origFile">te_a = poi(l)*prh(l)</a>
<a name="rase_di459"></a>                  <a href="convection.html#rasei458" target="origFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE_D</code>(te_a, te_ad, sdqv2, sdqv3, sdqvt1, <code class="label">&</code></a>
<a name="rase_di459"></a><a href="convection.html#rasei458" target="origFile"><code class="label">&                             </code>f2, f2d, f3)</a>
<a name="rase_di460"></a>                  <a href="convection.html#rasei459" target="origFile">c00_xd = co_auto(i)*f3*f4*f2d</a>
<a name="rase_di460"></a>                  <a href="convection.html#rasei459" target="origFile">c00_x = co_auto(i)*f2*f3*f4</a>
<a name="rase_di461"></a>                  <a href="convection.html#rasei460" target="origFile">cli_crit_xd = -(cli_crit*f3*f2d/(f2*f3)**<code class="constant">2</code>)</a>
                  <a href="convection.html#rasei460" target="origFile">cli_crit_x = cli_crit/(f2*f3)</a>
<a name="rase_di461"></a>                  <a href="convection.html#rasei461" target="origFile">arg1d = -((<code class="constant">2</code>*cli*clid*cli_crit_x**<code class="constant">2</code>-cli**<code class="constant">2</code>*<code class="constant">2</code>*<code class="label">&</code></a>
<a name="rase_di462"></a><a href="convection.html#rasei461" target="origFile"><code class="label">&                   </code>cli_crit_x*cli_crit_xd)/(cli_crit_x**<code class="constant">2</code>)**<code class="constant">2</code>)</a>
<a name="rase_di462"></a>                  <a href="convection.html#rasei461" target="origFile">arg1 = -(cli**<code class="constant">2</code>/cli_crit_x**<code class="constant">2</code>)</a>
<a name="rase_di463"></a>                  <a href="convection.html#rasei462" target="origFile">rated = c00_xd*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(arg1)) - c00_x*arg1d*<code class="funcname">EXP</code>(arg1)</a>
<a name="rase_di464"></a>                  <a href="convection.html#rasei462" target="origFile">rate = c00_x*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(arg1))</a>
                  <a href="convection.html#rasei463" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei464" target="origFile">cvw_x = <code class="constant">1.00</code></a>
<a name="rase_di465"></a>                    <a href="convection.html#rasei463" target="origFile">cvw_xd = <code class="constant">0.0_8</code></a>
<a name="rase_di465"></a>                  <a href="convection.html#rasei463" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei465" target="origFile">cvw_xd = cvwd(l)</a>
<a name="rase_di466"></a>                    <a href="convection.html#rasei465" target="origFile">cvw_x = cvw(l)</a>
                  <a href="convection.html#rasei463" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di466"></a>                  <a href="convection.html#rasei466" target="origFile">dt_lyrd = ((zetd(l)-zetd(l+<code class="constant">1</code>))*cvw_x-(zet(l)-zet(l+<code class="constant">1</code>))<code class="label">&</code></a>
<a name="rase_di467"></a><a href="convection.html#rasei466" target="origFile"><code class="label">&                   </code>*cvw_xd)/cvw_x**<code class="constant">2</code></a>
                  <a href="convection.html#rasei466" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
<a name="rase_di467"></a>                  <a href="convection.html#rasei467" target="origFile">clossd = cll0d(l)*rate*dt_lyr + cll0(l)*(rated*dt_lyr+<code class="label">&</code></a>
<a name="rase_di468"></a><a href="convection.html#rasei467" target="origFile"><code class="label">&                   </code>rate*dt_lyrd)</a>
<a name="rase_di469"></a>                  <a href="convection.html#rasei467" target="origFile">closs = cll0(l)*rate*dt_lyr</a>
<a name="rase_di469"></a>                  <a href="convection.html#rasei468" target="origFile"><code class="keyword">IF</code> (closs .GT. cll0(l)) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei469" target="origFile">clossd = cll0d(l)</a>
<a name="rase_di470"></a>                    <a href="convection.html#rasei469" target="origFile">closs = cll0(l)</a>
                  <a href="convection.html#rasei468" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di471"></a>                    <a href="convection.html#rasei470" target="origFile">closs = closs</a>
<a name="rase_di471"></a>                  <a href="convection.html#rasei468" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di472"></a>                  <a href="convection.html#rasei471" target="origFile">cll0d(l) = cll0d(l) - clossd</a>
<a name="rase_di473"></a>                  <a href="convection.html#rasei471" target="origFile">cll0(l) = cll0(l) - closs</a>
<a name="rase_di474"></a>                  <a href="convection.html#rasei472" target="origFile">dll0(l) = closs</a>
<a name="rase_di474"></a>                  <a href="convection.html#rasei473" target="origFile"><code class="keyword">IF</code> (closs .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="rase_di475"></a>                    <a href="convection.html#rasei474" target="origFile">wlqd = wlqd - clossd</a>
<a name="rase_di475"></a>                    <a href="convection.html#rasei474" target="origFile">wlq = wlq - closs</a>
                    <a href="convection.html#rasei475" target="origFile">rnnd(l) = clossd</a>
<a name="rase_di476"></a>                    <a href="convection.html#rasei475" target="origFile">rnn(l) = closs</a>
<a name="rase_di476"></a>                  <a href="convection.html#rasei473" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei476" target="origFile">rnnd(l) = <code class="constant">0.0_8</code></a>
                    <a href="convection.html#rasei476" target="origFile">rnn(l) = <code class="constant">0.</code></a>
<a name="rase_di478"></a>                  <a href="convection.html#rasei473" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di478"></a>                <a href="convection.html#rasei477" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di479"></a>                <a href="convection.html#rasei478" target="origFile">wlqd = wlqd - qstd(ic)*eta(ic) - qst(ic)*etad(ic)</a>
                <a href="convection.html#rasei478" target="origFile">wlq = wlq - qst(ic)*eta(ic)</a>
<a name="rase_di479"></a><a href="convection.html#rasei479" target="origFile"><code class="comment">!CALCULATE GAMMAS AND KERNEL</code></a>
<a name="rase_di480"></a>                <a href="convection.html#rasei479" target="origFile">gmsd(k) = pri(k)*(shtd(k)-ssld(k))</a>
<a name="rase_di480"></a>                <a href="convection.html#rasei479" target="origFile">gms(k) = (sht(k)-ssl(k))*pri(k)</a>
<a name="rase_di481"></a>                <a href="convection.html#rasei480" target="origFile">gmhd(k) = gmsd(k) + pri(k)*alhl*(qhtd(k)-qold(k))</a>
<a name="rase_di481"></a>                <a href="convection.html#rasei480" target="origFile">gmh(k) = gms(k) + (qht(k)-qol(k))*pri(k)*alhl</a>
<a name="rase_di482"></a>                <a href="convection.html#rasei481" target="origFile">akmd = dpb(k-<code class="constant">1</code>)*(gmhd(k)*gam(k-<code class="constant">1</code>)+gmh(k)*gamd(k-<code class="constant">1</code>))</a>
<a name="rase_di482"></a>                <a href="convection.html#rasei481" target="origFile">akm = gmh(k)*gam(k-<code class="constant">1</code>)*dpb(k-<code class="constant">1</code>)</a>
<a name="rase_di487"></a>                <a href="convection.html#rasei482" target="origFile">tx2d = gmhd(k)</a>
<a name="rase_di483"></a>                <a href="convection.html#rasei482" target="origFile">tx2 = gmh(k)</a>
                <a href="convection.html#rasei487" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                  <a href="convection.html#rasei483" target="origFile">gmsd(l) = pri(l)*(etad(l)*(sht(l)-ssl(l))+eta(l)*(shtd<code class="label">&</code></a>
<a name="rase_di483"></a><a href="convection.html#rasei483" target="origFile"><code class="label">&                   </code>(l)-ssld(l))+etad(l+<code class="constant">1</code>)*(ssl(l)-sht(l+<code class="constant">1</code>))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a href="convection.html#rasei483" target="origFile"><code class="label">&                   </code>ssld(l)-shtd(l+<code class="constant">1</code>)))</a>
<a name="rase_di484"></a>                  <a href="convection.html#rasei483" target="origFile">gms(l) = (eta(l)*(sht(l)-ssl(l))+eta(l+<code class="constant">1</code>)*(ssl(l)-sht(<code class="label">&</code></a>
<a href="convection.html#rasei483" target="origFile"><code class="label">&                   </code>l+<code class="constant">1</code>)))*pri(l)</a>
                  <a href="convection.html#rasei484" target="origFile">gmhd(l) = gmsd(l) + alhl*pri(l)*(etad(l)*(qht(l)-qol(l<code class="label">&</code></a>
<a name="rase_di484"></a><a href="convection.html#rasei484" target="origFile"><code class="label">&                   </code>))+eta(l)*(qhtd(l)-qold(l))+etad(l+<code class="constant">1</code>)*(qol(l)-qht(l+<code class="label">&</code></a>
<a href="convection.html#rasei484" target="origFile"><code class="label">&                   </code><code class="constant">1</code>))+eta(l+<code class="constant">1</code>)*(qold(l)-qhtd(l+<code class="constant">1</code>)))</a>
<a name="rase_di485"></a>                  <a href="convection.html#rasei484" target="origFile">gmh(l) = gms(l) + (eta(l)*(qht(l)-qol(l))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a href="convection.html#rasei484" target="origFile"><code class="label">&                   </code>qol(l)-qht(l+<code class="constant">1</code>)))*alhl*pri(l)</a>
<a name="rase_di485"></a>                  <a href="convection.html#rasei485" target="origFile">tx2d = tx2d + (etad(l)-etad(l+<code class="constant">1</code>))*gmh(l) + (eta(l)-eta<code class="label">&</code></a>
<a name="rase_di486"></a><a href="convection.html#rasei485" target="origFile"><code class="label">&                   </code>(l+<code class="constant">1</code>))*gmhd(l)</a>
                  <a href="convection.html#rasei485" target="origFile">tx2 = tx2 + (eta(l)-eta(l+<code class="constant">1</code>))*gmh(l)</a>
<a name="rase_di486"></a>                  <a href="convection.html#rasei486" target="origFile">akmd = akmd - pki(l)*(gmsd(l)*eht(l)+gms(l)*ehtd(l)) +<code class="label">&</code></a>
<a href="convection.html#rasei486" target="origFile"><code class="label">&                   </code>tx2d*ght(l) + tx2*ghtd(l)</a>
<a name="rase_di488"></a>                  <a href="convection.html#rasei486" target="origFile">akm = akm - gms(l)*eht(l)*pki(l) + tx2*ght(l)</a>
                <a href="convection.html#rasei487" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di488"></a>                <a href="convection.html#rasei488" target="origFile">gmsd(ic) = pri(ic)*(etad(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))+eta(<code class="label">&</code></a>
<a name="rase_di489"></a><a href="convection.html#rasei488" target="origFile"><code class="label">&                 </code>ic+<code class="constant">1</code>)*(ssld(ic)-shtd(ic+<code class="constant">1</code>)))</a>
                <a href="convection.html#rasei488" target="origFile">gms(ic) = eta(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*pri(ic)</a>
<a name="rase_di489"></a>                <a href="convection.html#rasei489" target="origFile">akmd = akmd - dpb(ic)*pki(ic)*(gmsd(ic)*eta(ic+<code class="constant">1</code>)+gms(ic<code class="label">&</code></a>
<a name="rase_di490"></a><a href="convection.html#rasei489" target="origFile"><code class="label">&                 </code>)*etad(ic+<code class="constant">1</code>))</a>
                <a href="convection.html#rasei489" target="origFile">akm = akm - gms(ic)*eta(ic+<code class="constant">1</code>)*dpb(ic)*pki(ic)</a>
                <a href="convection.html#rasei490" target="origFile">gmhd(ic) = gmsd(ic) + pri(ic)*(alhl*(etad(ic+<code class="constant">1</code>)*(qol(ic)<code class="label">&</code></a>
<a name="rase_di490"></a><a href="convection.html#rasei490" target="origFile"><code class="label">&                 </code>-qht(ic+<code class="constant">1</code>))+eta(ic+<code class="constant">1</code>)*(qold(ic)-qhtd(ic+<code class="constant">1</code>)))+etad(ic)*<code class="label">&</code></a>
<a href="convection.html#rasei490" target="origFile"><code class="label">&                 </code>(hst(ic)-hol(ic))+eta(ic)*(hstd(ic)-hold(ic)))</a>
<a name="rase_di491"></a>                <a href="convection.html#rasei490" target="origFile">gmh(ic) = gms(ic) + (eta(ic+<code class="constant">1</code>)*(qol(ic)-qht(ic+<code class="constant">1</code>))*alhl+<code class="label">&</code></a>
<a href="convection.html#rasei490" target="origFile"><code class="label">&                 </code>eta(ic)*(hst(ic)-hol(ic)))*pri(ic)</a>
<a name="rase_di492"></a><a href="convection.html#rasei491" target="origFile"><code class="comment">!CLOUD BASE MASS FLUX</code></a>
                <a href="convection.html#rasei491" target="origFile"><code class="keyword">IF</code> (.NOT.(akm .GE. <code class="constant">0.0 </code>.OR. wlq .LT. <code class="constant">0.0</code>)) <code class="keyword">THEN</code></a>
<a name="rase_di492"></a><a href="convection.html#rasei492" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di493"></a>                  <a href="convection.html#rasei492" target="origFile">wfnd = -((wfnd*akm-(wfn-acr)*akmd)/akm**<code class="constant">2</code>)</a>
                  <a href="convection.html#rasei492" target="origFile">wfn = -((wfn-acr)/akm)</a>
<a name="rase_di493"></a>                  <a href="convection.html#rasei493" target="origFile">x1d = (rasald(ic)*wfn+rasal(ic)*wfnd)*trg*toki + rasal<code class="label">&</code></a>
<a name="rase_di494"></a><a href="convection.html#rasei493" target="origFile"><code class="label">&                   </code>(ic)*wfn*(trgd*toki+trg*tokid)</a>
<a name="rase_di495"></a>                  <a href="convection.html#rasei493" target="origFile">x1 = rasal(ic)*trg*toki*wfn</a>
                  <a href="convection.html#rasei494" target="origFile"><code class="keyword">IF</code> (x1 .GT. (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei495" target="origFile">wfn = (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)</a>
<a name="rase_di496"></a>                    <a href="convection.html#rasei494" target="origFile">wfnd = <code class="constant">0.0_8</code></a>
<a name="rase_di496"></a>                  <a href="convection.html#rasei494" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei496" target="origFile">wfnd = x1d</a>
<a name="rase_di497"></a>                    <a href="convection.html#rasei496" target="origFile">wfn = x1</a>
                  <a href="convection.html#rasei494" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di497"></a><a href="convection.html#rasei497" target="origFile"><code class="comment">!CUMULATIVE PRECIP AND CLOUD-BASE MASS FLUX FOR OUTPUT</code></a>
<a name="rase_di498"></a>                  <a href="convection.html#rasei497" target="origFile">temd = gravi*wfnd</a>
<a name="rase_di498"></a>                  <a href="convection.html#rasei497" target="origFile">tem = wfn*gravi</a>
<a name="rase_di499"></a>                  <a href="convection.html#rasei498" target="origFile">clld(ic) = clld(ic) + wlqd*tem + wlq*temd</a>
<a name="rase_di500"></a>                  <a href="convection.html#rasei498" target="origFile">cll(ic) = cll(ic) + wlq*tem</a>
<a name="rase_di500"></a>                  <a href="convection.html#rasei499" target="origFile">rmf(ic) = rmf(ic) + tem</a>
<a name="rase_di509"></a>                  <a href="convection.html#rasei500" target="origFile">rmfdd(ic) = rmfdd(ic) + temd*eta(ic) + tem*etad(ic)</a>
<a name="rase_di501"></a>                  <a href="convection.html#rasei500" target="origFile">rmfd(ic) = rmfd(ic) + tem*eta(ic)</a>
<a name="rase_di501"></a>                  <a href="convection.html#rasei509" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
<a name="rase_di502"></a>                    <a href="convection.html#rasei501" target="origFile">rmfpd(l) = temd*eta(l) + tem*etad(l)</a>
<a name="rase_di503"></a>                    <a href="convection.html#rasei501" target="origFile">rmfp(l) = tem*eta(l)</a>
<a name="rase_di504"></a>                    <a href="convection.html#rasei502" target="origFile">rmfc(l) = rmfc(l) + rmfp(l)</a>
<a name="rase_di505"></a>                    <a href="convection.html#rasei503" target="origFile">dllx(l) = dllx(l) + tem*dll0(l)</a>
                    <a href="convection.html#rasei504" target="origFile"><code class="keyword">IF</code> (cvw(l) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                      <a href="convection.html#rasei505" target="origFile">updfrpd(l) = (ddt*<code class="constant">1000.</code>*rmfpd(l)*cvw(l)*prs(l)/<code class="label">&</code></a>
<a name="rase_di505"></a><a href="convection.html#rasei505" target="origFile"><code class="label">&                       </code>daylen-rmfp(l)*ddt*<code class="constant">1000.</code>*prs(l)*cvwd(l)/daylen)/<code class="label">&</code></a>
<a href="convection.html#rasei505" target="origFile"><code class="label">&                       </code>(cvw(l)*prs(l))**<code class="constant">2</code></a>
                      <a href="convection.html#rasei505" target="origFile">updfrp(l) = rmfp(l)*(ddt/daylen)*<code class="constant">1000.</code>/(cvw(l)*prs<code class="label">&</code></a>
<a name="rase_di506"></a><a href="convection.html#rasei505" target="origFile"><code class="label">&                       </code>(l))</a>
<a name="rase_di506"></a>                    <a href="convection.html#rasei504" target="origFile"><code class="keyword">ELSE</code></a>
                      <a href="convection.html#rasei506" target="origFile">updfrpd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_di507"></a>                      <a href="convection.html#rasei506" target="origFile">updfrp(l) = <code class="constant">0.0</code></a>
<a name="rase_di508"></a>                    <a href="convection.html#rasei504" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di508"></a>                    <a href="convection.html#rasei507" target="origFile">clli(l) = cll0(l)/eta(l)</a>
                    <a href="convection.html#rasei508" target="origFile">updfrcd(l) = updfrcd(l) + updfrpd(l)</a>
<a name="rase_di516"></a>                    <a href="convection.html#rasei508" target="origFile">updfrc(l) = updfrc(l) + updfrp(l)</a>
                  <a href="convection.html#rasei509" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di510"></a><a href="convection.html#rasei516" target="origFile"><code class="comment">!THETA AND Q CHANGE DUE TO CLOUD TYPE IC</code></a>
<a name="rase_di510"></a>                  <a href="convection.html#rasei516" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
<a name="rase_di511"></a>                    <a href="convection.html#rasei510" target="origFile">rnsd(l) = rnsd(l) + rnnd(l)*tem + rnn(l)*temd</a>
<a name="rase_di511"></a>                    <a href="convection.html#rasei510" target="origFile">rns(l) = rns(l) + rnn(l)*tem</a>
<a name="rase_di512"></a>                    <a href="convection.html#rasei511" target="origFile">gmhd(l) = gmhd(l)*wfn + gmh(l)*wfnd</a>
<a name="rase_di512"></a>                    <a href="convection.html#rasei511" target="origFile">gmh(l) = gmh(l)*wfn</a>
<a name="rase_di513"></a>                    <a href="convection.html#rasei512" target="origFile">gmsd(l) = gmsd(l)*wfn + gms(l)*wfnd</a>
<a name="rase_di513"></a>                    <a href="convection.html#rasei512" target="origFile">gms(l) = gms(l)*wfn</a>
<a name="rase_di514"></a>                    <a href="convection.html#rasei513" target="origFile">qoid(l) = qoid(l) + alhi*(gmhd(l)-gmsd(l))</a>
<a name="rase_di514"></a>                    <a href="convection.html#rasei513" target="origFile">qoi(l) = qoi(l) + (gmh(l)-gms(l))*alhi</a>
<a name="rase_di515"></a>                    <a href="convection.html#rasei514" target="origFile">poid(l) = poid(l) + pki(l)*cpi*gmsd(l)</a>
                    <a href="convection.html#rasei514" target="origFile">poi(l) = poi(l) + gms(l)*pki(l)*cpi</a>
<a name="rase_di515"></a>                    <a href="convection.html#rasei515" target="origFile">qstd(l) = qstd(l) + cpi*(gmsd(l)*bet(l)+gms(l)*betd(<code class="label">&</code></a>
<a href="convection.html#rasei515" target="origFile"><code class="label">&                     </code>l))</a>
<a name="rase_di517"></a>                    <a href="convection.html#rasei515" target="origFile">qst(l) = qst(l) + gms(l)*bet(l)*cpi</a>
                  <a href="convection.html#rasei516" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di517"></a><a href="convection.html#rasei517" target="origFile"><code class="comment">!*FRICFAC*0.5</code></a>
<a name="rase_di518"></a>                  <a href="convection.html#rasei517" target="origFile">wfnd = <code class="constant">0.5</code>*wfnd</a>
                  <a href="convection.html#rasei517" target="origFile">wfn = wfn*<code class="constant">0.5</code>*<code class="constant">1.0</code></a>
<a name="rase_di519"></a><a href="convection.html#rasei518" target="origFile"><code class="comment">!CUMULUS FRICTION</code></a>
                  <a href="convection.html#rasei518" target="origFile"><code class="keyword">IF</code> (fricfac .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a href="convection.html#rasei519" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_di519"></a>                    <a href="convection.html#rasei519" target="origFile">wfnd = fricfac*(wfnd*<code class="funcname">EXP</code>(-(alm/friclambda))-wfn*almd<code class="label">&</code></a>
<a name="rase_di520"></a><a href="convection.html#rasei519" target="origFile"><code class="label">&                     </code>*<code class="funcname">EXP</code>(-(alm/friclambda))/friclambda)</a>
<a name="rase_di520"></a>                    <a href="convection.html#rasei519" target="origFile">wfn = wfn*fricfac*<code class="funcname">EXP</code>(-(alm/friclambda))</a>
<a name="rase_di521"></a>                    <a href="convection.html#rasei520" target="origFile">temd = pri(k)*wfnd</a>
                    <a href="convection.html#rasei520" target="origFile">tem = wfn*pri(k)</a>
<a name="rase_di521"></a>                    <a href="convection.html#rasei521" target="origFile">ucud(k) = ucud(k) + temd*(uoi(k-<code class="constant">1</code>)-uoi(k)) + tem*(<code class="label">&</code></a>
<a name="rase_di522"></a><a href="convection.html#rasei521" target="origFile"><code class="label">&                     </code>uoid(k-<code class="constant">1</code>)-uoid(k))</a>
                    <a href="convection.html#rasei521" target="origFile">ucu(k) = ucu(k) + tem*(uoi(k-<code class="constant">1</code>)-uoi(k))</a>
<a name="rase_di522"></a>                    <a href="convection.html#rasei522" target="origFile">vcud(k) = vcud(k) + temd*(voi(k-<code class="constant">1</code>)-voi(k)) + tem*(<code class="label">&</code></a>
<a name="rase_di526"></a><a href="convection.html#rasei522" target="origFile"><code class="label">&                     </code>void0(k-<code class="constant">1</code>)-void0(k))</a>
<a name="rase_di523"></a>                    <a href="convection.html#rasei522" target="origFile">vcu(k) = vcu(k) + tem*(voi(k-<code class="constant">1</code>)-voi(k))</a>
<a name="rase_di523"></a>                    <a href="convection.html#rasei526" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_di524"></a>                      <a href="convection.html#rasei523" target="origFile">temd = pri(l)*wfnd</a>
                      <a href="convection.html#rasei523" target="origFile">tem = wfn*pri(l)</a>
                      <a href="convection.html#rasei524" target="origFile">ucud(l) = ucud(l) + temd*((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)<code class="label">&</code></a>
<a href="convection.html#rasei524" target="origFile"><code class="label">&                       </code>+(uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>)) + tem*((uoid(l-<code class="constant">1</code>)-<code class="label">&</code></a>
<a href="convection.html#rasei524" target="origFile"><code class="label">&                       </code>uoid(l))*eta(l)+(uoi(l-<code class="constant">1</code>)-uoi(l))*etad(l)+(uoid(<code class="label">&</code></a>
<a name="rase_di524"></a><a href="convection.html#rasei524" target="origFile"><code class="label">&                       </code>l)-uoid(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>)+(uoi(l)-uoi(l+<code class="constant">1</code>))*etad(l+<code class="label">&</code></a>
<a href="convection.html#rasei524" target="origFile"><code class="label">&                       </code><code class="constant">1</code>))</a>
<a name="rase_di525"></a>                      <a href="convection.html#rasei524" target="origFile">ucu(l) = ucu(l) + tem*((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection.html#rasei524" target="origFile"><code class="label">&                       </code>uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                      <a href="convection.html#rasei525" target="origFile">vcud(l) = vcud(l) + temd*((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)<code class="label">&</code></a>
<a href="convection.html#rasei525" target="origFile"><code class="label">&                       </code>+(voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>)) + tem*((void0(l-<code class="constant">1</code>)-<code class="label">&</code></a>
<a href="convection.html#rasei525" target="origFile"><code class="label">&                       </code>void0(l))*eta(l)+(voi(l-<code class="constant">1</code>)-voi(l))*etad(l)+(<code class="label">&</code></a>
<a name="rase_di525"></a><a href="convection.html#rasei525" target="origFile"><code class="label">&                       </code>void0(l)-void0(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>)+(voi(l)-voi(l+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="convection.html#rasei525" target="origFile"><code class="label">&                       </code>etad(l+<code class="constant">1</code>))</a>
                      <a href="convection.html#rasei525" target="origFile">vcu(l) = vcu(l) + tem*((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)+(<code class="label">&</code></a>
<a name="rase_di527"></a><a href="convection.html#rasei525" target="origFile"><code class="label">&                       </code>voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
<a name="rase_di527"></a>                    <a href="convection.html#rasei526" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di528"></a>                    <a href="convection.html#rasei527" target="origFile">temd = pri(ic)*wfnd</a>
                    <a href="convection.html#rasei527" target="origFile">tem = wfn*pri(ic)</a>
                    <a href="convection.html#rasei528" target="origFile">ucud(ic) = ucud(ic) + (<code class="constant">2.</code>*(uhtd-uoid(ic)*(eta(ic)-<code class="label">&</code></a>
<a href="convection.html#rasei528" target="origFile"><code class="label">&                     </code>eta(ic+<code class="constant">1</code>))-uoi(ic)*(etad(ic)-etad(ic+<code class="constant">1</code>)))-(uoid(ic<code class="label">&</code></a>
<a href="convection.html#rasei528" target="origFile"><code class="label">&                     </code>)+uoid(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>)-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*etad(<code class="label">&</code></a>
<a name="rase_di528"></a><a href="convection.html#rasei528" target="origFile"><code class="label">&                     </code>ic+<code class="constant">1</code>))*tem + (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic+<code class="constant">1</code>)))<code class="label">&</code></a>
<a href="convection.html#rasei528" target="origFile"><code class="label">&                     </code>-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*temd</a>
<a name="rase_di529"></a>                    <a href="convection.html#rasei528" target="origFile">ucu(ic) = ucu(ic) + (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection.html#rasei528" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
                    <a href="convection.html#rasei529" target="origFile">vcud(ic) = vcud(ic) + (<code class="constant">2.</code>*(vhtd-void0(ic)*(eta(ic)-<code class="label">&</code></a>
<a href="convection.html#rasei529" target="origFile"><code class="label">&                     </code>eta(ic+<code class="constant">1</code>))-voi(ic)*(etad(ic)-etad(ic+<code class="constant">1</code>)))-(void0(<code class="label">&</code></a>
<a href="convection.html#rasei529" target="origFile"><code class="label">&                     </code>ic)+void0(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>)-(voi(ic)+voi(ic+<code class="constant">1</code>))*<code class="label">&</code></a>
<a name="rase_di529"></a><a href="convection.html#rasei529" target="origFile"><code class="label">&                     </code>etad(ic+<code class="constant">1</code>))*tem + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection.html#rasei529" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*temd</a>
<a name="rase_di532"></a>                    <a href="convection.html#rasei529" target="origFile">vcu(ic) = vcu(ic) + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a name="rase_di530"></a><a href="convection.html#rasei529" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
<a name="rase_di530"></a>                    <a href="convection.html#rasei532" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
<a name="rase_di531"></a>                      <a href="convection.html#rasei530" target="origFile">uoid(l) = uoid(l) + ucud(l)</a>
<a name="rase_di531"></a>                      <a href="convection.html#rasei530" target="origFile">uoi(l) = uoi(l) + ucu(l)</a>
                      <a href="convection.html#rasei531" target="origFile">void0(l) = void0(l) + vcud(l)</a>
                      <a href="convection.html#rasei531" target="origFile">voi(l) = voi(l) + vcu(l)</a>
                    <a href="convection.html#rasei532" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection.html#rasei518" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei491" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei437" target="origFile"><code class="keyword">END IF</code></a>
            <a href="convection.html#rasei393" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection.html#rasei391" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei387" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di534"></a>      <a href="convection.html#rasei361" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei533" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection.html#rasei534" target="origFile"><code class="comment">!CLOUD LOOP</code></a>
<a name="rase_di537"></a>    <a href="convection.html#rasei534" target="origFile"><code class="keyword">IF</code> (<code class="funcname">SUM</code>(rmf(icmin:k)) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_di535"></a>      <a href="convection.html#rasei534" target="origFile">cnv_prc3d = <code class="constant">0.0_8</code></a>
<a name="rase_di536"></a>      <a href="convection.html#rasei537" target="origFile"><code class="keyword">DO </code>l=icmin,k</a>
<a name="rase_di536"></a>        <a href="convection.html#rasei535" target="origFile">tem = pri(l)*grav</a>
        <a href="convection.html#rasei536" target="origFile">cnv_prc3d(i, l) = tem*rnsd(l)</a>
<a name="rase_di538"></a>        <a href="convection.html#rasei536" target="origFile">cnv_prc3(i, l) = rns(l)*tem</a>
<a name="rase_di538"></a>      <a href="convection.html#rasei537" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di539"></a>      <a href="convection.html#rasei538" target="origFile">thod(i, icmin:k-<code class="constant">1</code>) = poid(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di539"></a>      <a href="convection.html#rasei538" target="origFile">tho(i, icmin:k-<code class="constant">1</code>) = poi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di540"></a>      <a href="convection.html#rasei539" target="origFile">qhod(i, icmin:k-<code class="constant">1</code>) = qoid(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di540"></a>      <a href="convection.html#rasei539" target="origFile">qho(i, icmin:k-<code class="constant">1</code>) = qoi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di541"></a>      <a href="convection.html#rasei540" target="origFile">uhod(i, icmin:k-<code class="constant">1</code>) = uoid(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di541"></a>      <a href="convection.html#rasei540" target="origFile">uho(i, icmin:k-<code class="constant">1</code>) = uoi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei541" target="origFile">vhod(i, icmin:k-<code class="constant">1</code>) = void0(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di542"></a>      <a href="convection.html#rasei541" target="origFile">vho(i, icmin:k-<code class="constant">1</code>) = voi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di542"></a>      <a href="convection.html#rasei542" target="origFile">cnv_updfrcd = <code class="constant">0.0_8</code></a>
<a name="rase_di543"></a>      <a href="convection.html#rasei542" target="origFile">cnv_updfrcd(i, icmin:k-<code class="constant">1</code>) = updfrcd(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei542" target="origFile">cnv_updfrc(i, icmin:k-<code class="constant">1</code>) = updfrc(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_di544"></a><a href="convection.html#rasei543" target="origFile"><code class="comment">!De-strap tendencies from RAS</code></a>
      <a href="convection.html#rasei543" target="origFile">wght = wgt1(i, :)</a>
<a name="rase_di546"></a><a href="convection.html#rasei544" target="origFile"><code class="comment">!Scale properly by layer masses</code></a>
<a name="rase_di545"></a>      <a href="convection.html#rasei544" target="origFile">wght0 = <code class="constant">0.</code></a>
      <a href="convection.html#rasei546" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_di547"></a>        <a href="convection.html#rasei545" target="origFile">wght0 = wght0 + wght(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))</a>
<a name="rase_di548"></a>      <a href="convection.html#rasei546" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di553"></a>      <a href="convection.html#rasei547" target="origFile">wght0 = (prs(k+<code class="constant">1</code>)-prs(k))/wght0</a>
<a name="rase_di549"></a>      <a href="convection.html#rasei548" target="origFile">wght = wght0*wght</a>
<a name="rase_di549"></a>      <a href="convection.html#rasei553" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_di550"></a>        <a href="convection.html#rasei549" target="origFile">thod(i, l) = thod(i, l) + wght(l)*(poid(k)-poi_svd(k))</a>
<a name="rase_di550"></a>        <a href="convection.html#rasei549" target="origFile">tho(i, l) = tho(i, l) + wght(l)*(poi(k)-poi_sv(k))</a>
<a name="rase_di551"></a>        <a href="convection.html#rasei550" target="origFile">qhod(i, l) = qhod(i, l) + wght(l)*(qoid(k)-qoi_svd(k))</a>
<a name="rase_di551"></a>        <a href="convection.html#rasei550" target="origFile">qho(i, l) = qho(i, l) + wght(l)*(qoi(k)-qoi_sv(k))</a>
<a name="rase_di552"></a>        <a href="convection.html#rasei551" target="origFile">uhod(i, l) = uhod(i, l) + wght(l)*(uoid(k)-uoi_svd(k))</a>
<a name="rase_di552"></a>        <a href="convection.html#rasei551" target="origFile">uho(i, l) = uho(i, l) + wght(l)*(uoi(k)-uoi_sv(k))</a>
        <a href="convection.html#rasei552" target="origFile">vhod(i, l) = vhod(i, l) + wght(l)*(void0(k)-voi_svd(k))</a>
        <a href="convection.html#rasei552" target="origFile">vho(i, l) = vho(i, l) + wght(l)*(voi(k)-voi_sv(k))</a>
<a name="rase_di554"></a>      <a href="convection.html#rasei553" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_di554"></a>      <a href="convection.html#rasei554" target="origFile">flxdd = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei554" target="origFile">flxdd(i, icmin:k) = ddt*rmfdd(icmin:k)/daylen</a>
<a name="rase_di555"></a>      <a href="convection.html#rasei554" target="origFile">flxd(i, icmin:k) = rmfd(icmin:k)*ddt/daylen</a>
<a name="rase_di555"></a>      <a href="convection.html#rasei555" target="origFile">clwd = <code class="constant">0.0_8</code></a>
<a name="rase_di556"></a>      <a href="convection.html#rasei555" target="origFile">clwd(i, icmin:k) = ddt*clld(icmin:k)/daylen</a>
<a name="rase_di556"></a>      <a href="convection.html#rasei555" target="origFile">clw(i, icmin:k) = cll(icmin:k)*ddt/daylen</a>
<a name="rase_di557"></a>      <a href="convection.html#rasei556" target="origFile">flxdd(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di557"></a>      <a href="convection.html#rasei556" target="origFile">flxd(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_di558"></a>      <a href="convection.html#rasei557" target="origFile">clwd(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_di559"></a>      <a href="convection.html#rasei557" target="origFile">clw(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_di559"></a>      <a href="convection.html#rasei558" target="origFile"><code class="keyword">IF</code> (k .LT. k0) <code class="keyword">THEN</code></a>
<a name="rase_di560"></a>        <a href="convection.html#rasei559" target="origFile">flxdd(i, k:k0) = <code class="constant">0.0_8</code></a>
<a name="rase_di560"></a>        <a href="convection.html#rasei559" target="origFile">flxd(i, k:k0) = <code class="constant">0.</code></a>
        <a href="convection.html#rasei560" target="origFile">clwd(i, k:k0) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei560" target="origFile">clw(i, k:k0) = <code class="constant">0.</code></a>
<a name="rase_di561"></a>      <a href="convection.html#rasei558" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di561"></a>    <a href="convection.html#rasei534" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di562"></a>      <a href="convection.html#rasei561" target="origFile">flxdd(i, :) = <code class="constant">0.0_8</code></a>
<a name="rase_di562"></a>      <a href="convection.html#rasei561" target="origFile">flxd(i, :) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei562" target="origFile">clwd(i, :) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei562" target="origFile">clw(i, :) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei534" target="origFile">clwd = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei534" target="origFile">cnv_prc3d = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei534" target="origFile">cnv_updfrcd = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei534" target="origFile">flxdd = <code class="constant">0.0_8</code></a>
<a name="rase_di563"></a>    <a href="convection.html#rasei534" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_di563"></a>  <a href="convection.html#rasei234" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_di564"></a>    <a href="convection.html#rasei563" target="origFile">flxdd(i, :) = <code class="constant">0.0_8</code></a>
<a name="rase_di564"></a>    <a href="convection.html#rasei563" target="origFile">flxd(i, :) = <code class="constant">0.</code></a>
    <a href="convection.html#rasei564" target="origFile">clwd(i, :) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei564" target="origFile">clw(i, :) = <code class="constant">0.</code></a>
    <a href="convection.html#rasei234" target="origFile">clwd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">cnv_prc3d = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">cnv_updfrcd = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei234" target="origFile">flxdd = <code class="constant">0.0_8</code></a>
  <a href="convection.html#rasei234" target="origFile"><code class="keyword">END IF</code></a>
<a name="sundq3_ice_d"></a><a href="convection.html#rase" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RASE_D</code></a>

<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!  Differentiation of sundq3_ice in forward (tangent) mode:</code></a>
<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!   variations   of useful results: f2</code></a>
<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!   with respect to varying inputs: temp f2</code></a>
<a name="sundq3_ice_di71"></a><a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SUNDQ3_ICE_D</code>(<code class="vardecl">temp</code>, <code class="vardecl">tempd</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code>, <code class="vardecl">f2</code>, <code class="vardecl">f2d</code>, <code class="vardecl">f3</code>)</a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="sundq3_ice_di72"></a>  <a href="convection.html#sundq3_icei71" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">tempd</code></a>
<a name="sundq3_ice_di73"></a>  <a href="convection.html#sundq3_icei72" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">f2</code>, <code class="vardecl">f3</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">f2d</code></a>
<a name="sundq3_ice_di74"></a><a href="convection.html#sundq3_icei73" target="origFile"><code class="comment">!,RATE2,RATE3,TE1</code></a>
<a name="sundq3_ice_di75"></a>  <a href="convection.html#sundq3_icei73" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">xx</code>, <code class="vardecl">yy</code>, <code class="vardecl">te0</code>, <code class="vardecl">te2</code>, <code class="vardecl">jump1</code></a>
<a name="sundq3_ice_di76"></a>  <a href="convection.html#sundq3_icei74" target="origFile">te0 = <code class="constant">273.</code></a>
<a name="sundq3_ice_di77"></a>  <a href="convection.html#sundq3_icei75" target="origFile">te2 = <code class="constant">200.</code></a>
  <a href="convection.html#sundq3_icei76" target="origFile">jump1 = (rate2-<code class="constant">1.0</code>)/(te0-te1)**<code class="constant">0.333</code></a>
<a name="sundq3_ice_di78"></a><a href="convection.html#sundq3_icei77" target="origFile"><code class="comment">! Ice - phase treatment</code></a>
<a name="sundq3_ice_di79"></a>  <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">IF</code> (temp .GE. te0) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei78" target="origFile">f2 = <code class="constant">1.0</code></a>
    <a href="convection.html#sundq3_icei79" target="origFile">f3 = <code class="constant">1.0</code></a>
<a name="sundq3_ice_di80"></a>    <a href="convection.html#sundq3_icei77" target="origFile">f2d = <code class="constant">0.0_8</code></a>
<a name="sundq3_ice_di81"></a>  <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">END IF</code></a>
<a name="sundq3_ice_di81"></a>  <a href="convection.html#sundq3_icei80" target="origFile"><code class="keyword">IF</code> (temp .GE. te1 .AND. temp .LT. te0) <code class="keyword">THEN</code></a>
<a name="sundq3_ice_di82"></a>    <a href="convection.html#sundq3_icei81" target="origFile">f2d = -(jump1*<code class="constant">0.3333</code>*(te0-temp)**(<code class="constant">-0.6667</code>)*tempd)</a>
    <a href="convection.html#sundq3_icei81" target="origFile">f2 = <code class="constant">1.0 </code>+ jump1*(te0-temp)**<code class="constant">0.3333</code></a>
<a name="sundq3_ice_di83"></a>    <a href="convection.html#sundq3_icei82" target="origFile">f3 = <code class="constant">1.0</code></a>
<a name="sundq3_ice_di84"></a>  <a href="convection.html#sundq3_icei80" target="origFile"><code class="keyword">END IF</code></a>
<a name="sundq3_ice_di84"></a>  <a href="convection.html#sundq3_icei83" target="origFile"><code class="keyword">IF</code> (temp .LT. te1) <code class="keyword">THEN</code></a>
<a name="sundq3_ice_di85"></a>    <a href="convection.html#sundq3_icei84" target="origFile">f2d = (-((rate3-rate2)*tempd))/(te1-te2)</a>
    <a href="convection.html#sundq3_icei84" target="origFile">f2 = rate2 + (rate3-rate2)*(te1-temp)/(te1-te2)</a>
<a name="sundq3_ice_di86"></a>    <a href="convection.html#sundq3_icei85" target="origFile">f3 = <code class="constant">1.0</code></a>
<a name="sundq3_ice_di87"></a>  <a href="convection.html#sundq3_icei83" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#sundq3_icei86" target="origFile"><code class="keyword">IF</code> (f2 .GT. <code class="constant">27.0</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei87" target="origFile">f2 = <code class="constant">27.0</code></a>
    <a href="convection.html#sundq3_icei86" target="origFile">f2d = <code class="constant">0.0_8</code></a>
  <a href="convection.html#sundq3_icei86" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsat_ras_d"></a><a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SUNDQ3_ICE_D</code></a>

<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!  Differentiation of dqsat_ras in forward (tangent) mode:</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!   variations   of useful results: dqsi qssi</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!   with respect to varying inputs: temp</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSAT_RAS_D</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">dqsid</code>, <code class="vardecl">qssi</code>, <code class="vardecl">qssid</code>, <code class="vardecl">temp</code>, <code class="vardecl">tempd</code>, <code class="vardecl">plo</code>, <code class="vardecl">lm</code>, <code class="label">&</code></a>
<a name="dqsat_ras_di34"></a><a href="convection.html#dqsat_ras" target="origFile"><code class="label">& </code><code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>)</a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="dqsat_ras_di35"></a><a href="convection.html#dqsat_rasi34" target="origFile"><code class="comment">!Inputs</code></a>
  <a href="convection.html#dqsat_rasi34" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">lm</code></a>
<a name="dqsat_ras_di36"></a>  <a href="convection.html#dqsat_rasi35" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
<a name="dqsat_ras_di37"></a>  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(lm) :: <code class="vardecl">tempd</code></a>
<a name="dqsat_ras_di38"></a>  <a href="convection.html#dqsat_rasi36" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection.html#dqsat_rasi37" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection.html#dqsat_rasi38" target="origFile"><code class="comment">!Outputs</code></a>
<a name="dqsat_ras_di39"></a>  <a href="convection.html#dqsat_rasi38" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(lm) :: <code class="vardecl">dqsid</code>, <code class="vardecl">qssid</code></a>
<a name="dqsat_ras_di40"></a><a href="convection.html#dqsat_rasi39" target="origFile"><code class="comment">!Locals</code></a>
<a name="dqsat_ras_di41"></a>  <a href="convection.html#dqsat_rasi39" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
<a name="dqsat_ras_di42"></a>  <a href="convection.html#dqsat_rasi40" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
  <a href="convection.html#dqsat_rasi41" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">k</code></a>
<a name="dqsat_ras_di43"></a>  <a href="convection.html#dqsat_rasi42" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
<a name="dqsat_ras_di44"></a>  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tld</code>, <code class="vardecl">ttd</code>, <code class="vardecl">tid</code>, <code class="vardecl">dqsatd</code>, <code class="vardecl">qsatd</code>, <code class="vardecl">qqd</code>, <code class="vardecl">ddd</code></a>
<a name="dqsat_ras_di45"></a>  <a href="convection.html#dqsat_rasi43" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
<a name="dqsat_ras_di46"></a>  <a href="convection.html#dqsat_rasi44" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
<a name="dqsat_ras_di47"></a>  <a href="convection.html#dqsat_rasi45" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
<a name="dqsat_ras_di48"></a>  <a href="convection.html#dqsat_rasi46" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
<a name="dqsat_ras_di49"></a>  <a href="convection.html#dqsat_rasi47" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
  <a href="convection.html#dqsat_rasi48" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
  <a href="convection.html#dqsat_rasi49" target="origFile">esfac = cons_h2omw/cons_airmw</a>
<a name="dqsat_ras_di70"></a>  <a href="convection.html#dqsat_ras" target="origFile">dqsid = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di50"></a>  <a href="convection.html#dqsat_ras" target="origFile">qssid = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di50"></a>  <a href="convection.html#dqsat_rasi70" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,lm</a>
<a name="dqsat_ras_di51"></a>    <a href="convection.html#dqsat_rasi50" target="origFile">tld = tempd(k)</a>
<a name="dqsat_ras_di52"></a>    <a href="convection.html#dqsat_rasi50" target="origFile">tl = temp(k)</a>
<a name="dqsat_ras_di53"></a>    <a href="convection.html#dqsat_rasi51" target="origFile">pl = plo(k)</a>
<a name="dqsat_ras_di54"></a>    <a href="convection.html#dqsat_rasi52" target="origFile">pp = pl*<code class="constant">100.0</code></a>
    <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
<a name="dqsat_ras_di55"></a>      <a href="convection.html#dqsat_rasi54" target="origFile">ti = tmintbl</a>
<a name="dqsat_ras_di56"></a>      <a href="convection.html#dqsat_rasi53" target="origFile">tid = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di56"></a>    <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#dqsat_rasi55" target="origFile"><code class="keyword">IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_rasi56" target="origFile">tid = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di57"></a>      <a href="convection.html#dqsat_rasi56" target="origFile">ti = tmaxtbl - <code class="constant">.001</code></a>
<a name="dqsat_ras_di57"></a>    <a href="convection.html#dqsat_rasi55" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#dqsat_rasi57" target="origFile">tid = tld</a>
<a name="dqsat_ras_di58"></a>      <a href="convection.html#dqsat_rasi57" target="origFile">ti = tl</a>
<a name="dqsat_ras_di58"></a>    <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsat_ras_di59"></a>    <a href="convection.html#dqsat_rasi58" target="origFile">ttd = degsubs*tid</a>
<a name="dqsat_ras_di60"></a>    <a href="convection.html#dqsat_rasi58" target="origFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
<a name="dqsat_ras_di61"></a>    <a href="convection.html#dqsat_rasi59" target="origFile">it = <code class="funcname">INT</code>(tt)</a>
<a name="dqsat_ras_di61"></a>    <a href="convection.html#dqsat_rasi60" target="origFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
<a name="dqsat_ras_di62"></a>    <a href="convection.html#dqsat_rasi61" target="origFile">qqd = dqq*ttd</a>
<a name="dqsat_ras_di63"></a>    <a href="convection.html#dqsat_rasi61" target="origFile">qq = (tt-it)*dqq + estblx(it)</a>
<a name="dqsat_ras_di64"></a>    <a href="convection.html#dqsat_rasi62" target="origFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_rasi63" target="origFile">qsat = max_mixing_ratio</a>
      <a href="convection.html#dqsat_rasi64" target="origFile">dqsat = <code class="constant">0.0</code></a>
      <a href="convection.html#dqsat_rasi62" target="origFile">qsatd = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di65"></a>      <a href="convection.html#dqsat_rasi62" target="origFile">dqsatd = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_di65"></a>    <a href="convection.html#dqsat_rasi62" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsat_ras_di66"></a>      <a href="convection.html#dqsat_rasi65" target="origFile">ddd = -((-((<code class="constant">1.0</code>-esfac)*qqd))/(pp-(<code class="constant">1.0</code>-esfac)*qq)**<code class="constant">2</code>)</a>
<a name="dqsat_ras_di66"></a>      <a href="convection.html#dqsat_rasi65" target="origFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
<a name="dqsat_ras_di67"></a>      <a href="convection.html#dqsat_rasi66" target="origFile">qsatd = esfac*(qqd*dd+qq*ddd)</a>
<a name="dqsat_ras_di67"></a>      <a href="convection.html#dqsat_rasi66" target="origFile">qsat = esfac*qq*dd</a>
      <a href="convection.html#dqsat_rasi67" target="origFile">dqsatd = esfac*degsubs*dqq*pp*(ddd*dd+dd*ddd)</a>
<a name="dqsat_ras_di68"></a>      <a href="convection.html#dqsat_rasi67" target="origFile">dqsat = esfac*degsubs*dqq*pp*(dd*dd)</a>
<a name="dqsat_ras_di68"></a>    <a href="convection.html#dqsat_rasi62" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsat_ras_di69"></a>    <a href="convection.html#dqsat_rasi68" target="origFile">dqsid(k) = dqsatd</a>
<a name="dqsat_ras_di69"></a>    <a href="convection.html#dqsat_rasi68" target="origFile">dqsi(k) = dqsat</a>
    <a href="convection.html#dqsat_rasi69" target="origFile">qssid(k) = qsatd</a>
    <a href="convection.html#dqsat_rasi69" target="origFile">qssi(k) = qsat</a>
  <a href="convection.html#dqsat_rasi70" target="origFile"><code class="keyword">END DO</code></a>
<a name="dqsats_ras_d"></a><a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSAT_RAS_D</code></a>

<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!  Differentiation of dqsats_ras in forward (tangent) mode:</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!   variations   of useful results: dqsi qssi</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!   with respect to varying inputs: temp</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSATS_RAS_D</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">dqsid</code>, <code class="vardecl">qssi</code>, <code class="vardecl">qssid</code>, <code class="vardecl">temp</code>, <code class="vardecl">tempd</code>, <code class="vardecl">plo</code>, <code class="label">&</code></a>
<a name="dqsats_ras_di0"></a><a href="convection.html#dqsats_ras" target="origFile"><code class="label">& </code><code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>)</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection.html#dqsats_rasi0" target="origFile"><code class="comment">!Inputs</code></a>
<a name="dqsats_ras_di1"></a>  <a href="convection.html#dqsats_rasi0" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
<a name="dqsats_ras_di2"></a>  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempd</code></a>
<a name="dqsats_ras_di3"></a>  <a href="convection.html#dqsats_rasi1" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection.html#dqsats_rasi2" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection.html#dqsats_rasi3" target="origFile"><code class="comment">!Outputs</code></a>
<a name="dqsats_ras_di4"></a>  <a href="convection.html#dqsats_rasi3" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dqsid</code>, <code class="vardecl">qssid</code></a>
<a name="dqsats_ras_di5"></a><a href="convection.html#dqsats_rasi4" target="origFile"><code class="comment">!Locals</code></a>
<a name="dqsats_ras_di6"></a>  <a href="convection.html#dqsats_rasi4" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
  <a href="convection.html#dqsats_rasi5" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
<a name="dqsats_ras_di7"></a>  <a href="convection.html#dqsats_rasi6" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
<a name="dqsats_ras_di8"></a>  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tld</code>, <code class="vardecl">ttd</code>, <code class="vardecl">tid</code>, <code class="vardecl">dqsatd</code>, <code class="vardecl">qsatd</code>, <code class="vardecl">qqd</code>, <code class="vardecl">ddd</code></a>
<a name="dqsats_ras_di9"></a>  <a href="convection.html#dqsats_rasi7" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
<a name="dqsats_ras_di10"></a>  <a href="convection.html#dqsats_rasi8" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
<a name="dqsats_ras_di11"></a>  <a href="convection.html#dqsats_rasi9" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
<a name="dqsats_ras_di12"></a>  <a href="convection.html#dqsats_rasi10" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
<a name="dqsats_ras_di13"></a>  <a href="convection.html#dqsats_rasi11" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
<a name="dqsats_ras_di14"></a>  <a href="convection.html#dqsats_rasi12" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
<a name="dqsats_ras_di14"></a>  <a href="convection.html#dqsats_rasi13" target="origFile">esfac = cons_h2omw/cons_airmw</a>
<a name="dqsats_ras_di15"></a>  <a href="convection.html#dqsats_rasi14" target="origFile">tld = tempd</a>
<a name="dqsats_ras_di16"></a>  <a href="convection.html#dqsats_rasi14" target="origFile">tl = temp</a>
<a name="dqsats_ras_di17"></a>  <a href="convection.html#dqsats_rasi15" target="origFile">pl = plo</a>
<a name="dqsats_ras_di18"></a>  <a href="convection.html#dqsats_rasi16" target="origFile">pp = pl*<code class="constant">100.0</code></a>
  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
<a name="dqsats_ras_di19"></a>    <a href="convection.html#dqsats_rasi18" target="origFile">ti = tmintbl</a>
<a name="dqsats_ras_di20"></a>    <a href="convection.html#dqsats_rasi17" target="origFile">tid = <code class="constant">0.0_8</code></a>
  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_rasi20" target="origFile">ti = tmaxtbl - <code class="constant">.001</code></a>
<a name="dqsats_ras_di21"></a>    <a href="convection.html#dqsats_rasi19" target="origFile">tid = <code class="constant">0.0_8</code></a>
<a name="dqsats_ras_di21"></a>  <a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#dqsats_rasi21" target="origFile">tid = tld</a>
<a name="dqsats_ras_di22"></a>    <a href="convection.html#dqsats_rasi21" target="origFile">ti = tl</a>
<a name="dqsats_ras_di22"></a>  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsats_ras_di23"></a>  <a href="convection.html#dqsats_rasi22" target="origFile">ttd = degsubs*tid</a>
<a name="dqsats_ras_di24"></a>  <a href="convection.html#dqsats_rasi22" target="origFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
<a name="dqsats_ras_di25"></a>  <a href="convection.html#dqsats_rasi23" target="origFile">it = <code class="funcname">INT</code>(tt)</a>
<a name="dqsats_ras_di25"></a>  <a href="convection.html#dqsats_rasi24" target="origFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
<a name="dqsats_ras_di26"></a>  <a href="convection.html#dqsats_rasi25" target="origFile">qqd = dqq*ttd</a>
<a name="dqsats_ras_di27"></a>  <a href="convection.html#dqsats_rasi25" target="origFile">qq = (tt-it)*dqq + estblx(it)</a>
<a name="dqsats_ras_di28"></a>  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_rasi27" target="origFile">qsat = max_mixing_ratio</a>
    <a href="convection.html#dqsats_rasi28" target="origFile">dqsat = <code class="constant">0.0</code></a>
    <a href="convection.html#dqsats_rasi26" target="origFile">qsatd = <code class="constant">0.0_8</code></a>
<a name="dqsats_ras_di29"></a>    <a href="convection.html#dqsats_rasi26" target="origFile">dqsatd = <code class="constant">0.0_8</code></a>
<a name="dqsats_ras_di29"></a>  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsats_ras_di30"></a>    <a href="convection.html#dqsats_rasi29" target="origFile">ddd = -((-((<code class="constant">1.0</code>-esfac)*qqd))/(pp-(<code class="constant">1.0</code>-esfac)*qq)**<code class="constant">2</code>)</a>
<a name="dqsats_ras_di30"></a>    <a href="convection.html#dqsats_rasi29" target="origFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
<a name="dqsats_ras_di31"></a>    <a href="convection.html#dqsats_rasi30" target="origFile">qsatd = esfac*(qqd*dd+qq*ddd)</a>
<a name="dqsats_ras_di31"></a>    <a href="convection.html#dqsats_rasi30" target="origFile">qsat = esfac*qq*dd</a>
    <a href="convection.html#dqsats_rasi31" target="origFile">dqsatd = esfac*degsubs*dqq*pp*(ddd*dd+dd*ddd)</a>
<a name="dqsats_ras_di32"></a>    <a href="convection.html#dqsats_rasi31" target="origFile">dqsat = esfac*degsubs*dqq*pp*(dd*dd)</a>
<a name="dqsats_ras_di32"></a>  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsats_ras_di33"></a>  <a href="convection.html#dqsats_rasi32" target="origFile">dqsid = dqsatd</a>
<a name="dqsats_ras_di33"></a>  <a href="convection.html#dqsats_rasi32" target="origFile">dqsi = dqsat</a>
  <a href="convection.html#dqsats_rasi33" target="origFile">qssid = qsatd</a>
  <a href="convection.html#dqsats_rasi33" target="origFile">qssi = qsat</a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSATS_RAS_D</code></a>

</pre>
</body>
