<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="rase_tracer_b"></a><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code>
<code class="comment">!</code>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!  Differentiation of rase_tracer in reverse (adjoint) mode:</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   gradient     of useful results: xho</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   with respect to varying inputs: xho</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   RW status of diff variables: xho:in-out</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RASE_TRACER_B</code>(<code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code>, <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code>, <code class="vardecl">seedras</code>, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">sige</code>, <code class="vardecl">kcbl</code>, <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code>, <code class="vardecl">frland</code>, <code class="vardecl">ts</code>, <code class="vardecl">thoin</code>, <code class="vardecl">qhoin</code>, <code class="vardecl">uhoin</code>, <code class="vardecl">vhoin</code>, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">co_auto</code>, <code class="vardecl">ple</code>, <code class="vardecl">rasparams</code>, <code class="vardecl">estblx</code>, <code class="vardecl">itrcr</code>, <code class="vardecl">xho</code>, <code class="vardecl">xhob</code>, <code class="vardecl">fscav</code>)</a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection_tracer.html#rase_traceri0" target="origFile"><code class="comment">!INPUTS</code></a>
  <a href="convection_tracer.html#rase_traceri0" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code></a>
  <a href="convection_tracer.html#rase_traceri1" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ple</code></a>
  <a href="convection_tracer.html#rase_traceri2" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">sige</code></a>
  <a href="convection_tracer.html#rase_traceri3" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code></a>
  <a href="convection_tracer.html#rase_traceri4" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code></a>
  <a href="convection_tracer.html#rase_traceri5" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">seedras</code></a>
  <a href="convection_tracer.html#rase_traceri6" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kcbl</code></a>
  <a href="convection_tracer.html#rase_traceri7" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ts</code>, <code class="vardecl">frland</code></a>
  <a href="convection_tracer.html#rase_traceri8" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">co_auto</code></a>
  <a href="convection_tracer.html#rase_traceri9" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code></a>
  <a href="convection_tracer.html#rase_traceri10" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rasparams</code></a>
  <a href="convection_tracer.html#rase_traceri11" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">estblx</code></a>
  <a href="convection_tracer.html#rase_traceri12" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">itrcr</code></a>
  <a href="convection_tracer.html#rase_traceri13" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>itrcr<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">fscav</code></a>
  <a href="convection_tracer.html#rase_traceri14" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">thoin</code>, <code class="vardecl">qhoin</code>, <code class="vardecl">uhoin</code>, <code class="vardecl">vhoin</code></a>
<a href="convection_tracer.html#rase_traceri15" target="origFile"><code class="comment">!PROGNOSTIC</code></a>
  <a href="convection_tracer.html#rase_traceri15" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0, itrcr<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">xho</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0, itrcr), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">xhob</code></a>
<a href="convection_tracer.html#rase_traceri16" target="origFile"><code class="comment">!LOCALS</code></a>
  <a href="convection_tracer.html#rase_traceri16" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">ic</code>, <code class="vardecl">l</code>, <code class="vardecl">kk</code>, <code class="vardecl">k</code></a>
<a href="convection_tracer.html#rase_traceri17" target="origFile"><code class="comment">!Parameters</code></a>
  <a href="convection_tracer.html#rase_traceri17" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">onepkap</code>=<code class="constant">1.</code>+<code class="constant">2.</code>/<code class="constant">7.</code>, <code class="vardecl">daylen</code>=<code class="constant">86400.0</code></a>
  <a href="convection_tracer.html#rase_traceri18" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">rhmax</code>=<code class="constant">0.9999</code></a>
  <a href="convection_tracer.html#rase_traceri19" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_qpert</code>=<code class="constant">0.0</code>, <code class="vardecl">cbl_tpert</code>=<code class="constant">1.0</code></a>
  <a href="convection_tracer.html#rase_traceri20" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_tpert_mxocn</code>=<code class="constant">2.0</code>, <code class="vardecl">cbl_tpert_mxlnd</code>=<code class="constant">4.0</code></a>
<a href="convection_tracer.html#rase_traceri21" target="origFile"><code class="comment">!Constants</code></a>
  <a href="convection_tracer.html#rase_traceri21" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">grav</code>, <code class="vardecl">cp</code>, <code class="vardecl">alhl</code>, <code class="vardecl">cpbg</code>, <code class="vardecl">alhi</code>, <code class="vardecl">cpi</code>, <code class="vardecl">gravi</code>, <code class="vardecl">ddt</code>, <code class="vardecl">lbcp</code></a>
<a href="convection_tracer.html#rase_traceri22" target="origFile"><code class="comment">!Rasparams</code></a>
  <a href="convection_tracer.html#rase_traceri22" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fricfac</code>, <code class="vardecl">cli_crit</code>, <code class="vardecl">rasal1</code>, <code class="vardecl">rasal2</code></a>
  <a href="convection_tracer.html#rase_traceri23" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">friclambda</code></a>
  <a href="convection_tracer.html#rase_traceri24" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sdqv2</code>, <code class="vardecl">sdqv3</code>, <code class="vardecl">sdqvt1</code></a>
  <a href="convection_tracer.html#rase_traceri25" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">acritfac</code>, <code class="vardecl">pblfrac</code>, <code class="vardecl">autorampb</code></a>
  <a href="convection_tracer.html#rase_traceri26" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxdallowed</code>, <code class="vardecl">rhmn</code>, <code class="vardecl">rhmx</code></a>
  <a href="convection_tracer.html#rase_traceri27" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">mxdiam</code></a>
  <a href="convection_tracer.html#rase_traceri28" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2</code>, <code class="vardecl">tx3</code>, <code class="vardecl">akm</code>, <code class="vardecl">acr</code>, <code class="vardecl">alm</code>, <code class="vardecl">tth</code>, <code class="vardecl">qqh</code>, <code class="vardecl">dqx</code></a>
  <a href="convection_tracer.html#rase_traceri29" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfn</code>, <code class="vardecl">tem</code>, <code class="vardecl">trg</code>, <code class="vardecl">trgexp</code>, <code class="vardecl">evp</code>, <code class="vardecl">wlq</code>, <code class="vardecl">qcc</code></a>
  <a href="convection_tracer.html#rase_traceri30" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cli</code>, <code class="vardecl">te_a</code>, <code class="vardecl">c00_x</code>, <code class="vardecl">cli_crit_x</code>, <code class="vardecl">toki</code></a>
  <a href="convection_tracer.html#rase_traceri31" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyr</code>, <code class="vardecl">rate</code>, <code class="vardecl">cvw_x</code>, <code class="vardecl">closs</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>, <code class="vardecl">f4</code></a>
  <a href="convection_tracer.html#rase_traceri32" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wght0</code>, <code class="vardecl">prcbl</code>, <code class="vardecl">rndu</code></a>
  <a href="convection_tracer.html#rase_traceri33" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">lambda_min</code>, <code class="vardecl">lambda_max</code></a>
  <a href="convection_tracer.html#rase_traceri34" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpert</code>, <code class="vardecl">qpert</code></a>
  <a href="convection_tracer.html#rase_traceri35" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uht</code>, <code class="vardecl">vht</code></a>
  <a href="convection_tracer.html#rase_traceri36" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_sv</code>, <code class="vardecl">qoi_sv</code>, <code class="vardecl">uoi_sv</code>, <code class="vardecl">voi_sv</code></a>
  <a href="convection_tracer.html#rase_traceri37" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi</code>, <code class="vardecl">qoi</code>, <code class="vardecl">uoi</code>, <code class="vardecl">voi</code>, <code class="vardecl">dqq</code>, <code class="vardecl">bet</code>, <code class="vardecl">gam</code>, <code class="vardecl">cll</code></a>
  <a href="convection_tracer.html#rase_traceri38" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_c</code>, <code class="vardecl">qoi_c</code></a>
  <a href="convection_tracer.html#rase_traceri39" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">prh</code>, <code class="vardecl">pri</code>, <code class="vardecl">ght</code>, <code class="vardecl">dpt</code>, <code class="vardecl">dpb</code>, <code class="vardecl">pki</code></a>
  <a href="convection_tracer.html#rase_traceri40" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">ucu</code>, <code class="vardecl">vcu</code></a>
  <a href="convection_tracer.html#rase_traceri41" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">cln</code>, <code class="vardecl">rns</code>, <code class="vardecl">pol</code></a>
  <a href="convection_tracer.html#rase_traceri42" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qst</code>, <code class="vardecl">ssl</code>, <code class="vardecl">rmf</code>, <code class="vardecl">rnn</code>, <code class="vardecl">rn1</code>, <code class="vardecl">rmfc</code>, <code class="vardecl">rmfp</code></a>
  <a href="convection_tracer.html#rase_traceri43" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">gms</code>, <code class="vardecl">eta</code>, <code class="vardecl">gmh</code>, <code class="vardecl">eht</code>, <code class="vardecl">gm1</code>, <code class="vardecl">hcc</code>, <code class="vardecl">rmfd</code></a>
  <a href="convection_tracer.html#rase_traceri44" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">hol</code>, <code class="vardecl">hst</code>, <code class="vardecl">qol</code>, <code class="vardecl">zol</code>, <code class="vardecl">hcld</code>, <code class="vardecl">cll0</code>, <code class="vardecl">cllx</code>, <code class="vardecl">clli</code></a>
  <a href="convection_tracer.html#rase_traceri45" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">bke</code>, <code class="vardecl">cvw</code>, <code class="vardecl">updfrc</code></a>
  <a href="convection_tracer.html#rase_traceri46" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">rasal</code>, <code class="vardecl">updfrp</code>, <code class="vardecl">bk2</code>, <code class="vardecl">dll0</code>, <code class="vardecl">dllx</code></a>
  <a href="convection_tracer.html#rase_traceri47" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">wght</code>, <code class="vardecl">massf</code></a>
  <a href="convection_tracer.html#rase_traceri48" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qss</code>, <code class="vardecl">dqs</code>, <code class="vardecl">pf</code>, <code class="vardecl">pk</code>, <code class="vardecl">tempf</code>, <code class="vardecl">zlo</code></a>
  <a href="convection_tracer.html#rase_traceri49" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">prj</code>, <code class="vardecl">prs</code>, <code class="vardecl">qht</code>, <code class="vardecl">sht</code>, <code class="vardecl">zet</code>, <code class="vardecl">zle</code>, <code class="vardecl">pke</code></a>
  <a href="convection_tracer.html#rase_traceri50" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">) </code>:: <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code></a>
<a href="convection_tracer.html#rase_traceri51" target="origFile"><code class="comment">!Tracer scavenging</code></a>
  <a href="convection_tracer.html#rase_traceri51" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">itr</code></a>
<a href="convection_tracer.html#rase_traceri52" target="origFile"><code class="comment">!Layer thickness in km</code></a>
  <a href="convection_tracer.html#rase_traceri52" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">delzkm</code></a>
<a href="convection_tracer.html#rase_traceri53" target="origFile"><code class="comment">!Fraction of tracer *not* scavenged</code></a>
  <a href="convection_tracer.html#rase_traceri53" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fnoscav</code></a>
  <a href="convection_tracer.html#rase_traceri54" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0, itrcr<code class="typename">) </code>:: <code class="vardecl">xoi</code>, <code class="vardecl">xcu</code>, <code class="vardecl">xoi_sv</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0, itrcr) :: <code class="vardecl">xoib</code>, <code class="vardecl">xcub</code>, <code class="vardecl">xoi_svb</code></a>
  <a href="convection_tracer.html#rase_traceri55" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>itrcr<code class="typename">) </code>:: <code class="vardecl">xht</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(itrcr) :: <code class="vardecl">xhtb</code></a>
  <a href="convection_tracer.html#rase_traceri56" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="convection_tracer.html#rase_traceri57" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="convection_tracer.html#rase_traceri58" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="convection_tracer.html#rase_traceri59" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
  <a href="convection_tracer.html#rase_traceri60" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
  <a href="convection_tracer.html#rase_traceri61" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from0</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to0</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb2</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb0</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x5</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x4</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x3</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x2</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">y1</code></a>
<a href="convection_tracer.html#rase_traceri62" target="origFile"><code class="comment">!Pass meteorology to internal arrays so it is not updated</code></a>
  <a href="convection_tracer.html#rase_traceri62" target="origFile">tho = thoin</a>
  <a href="convection_tracer.html#rase_traceri63" target="origFile">qho = qhoin</a>
<a href="convection_tracer.html#rase_traceri64" target="origFile"><code class="comment">!Initialize Local Arrays</code></a>
  <a href="convection_tracer.html#rase_traceri64" target="origFile">poi = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri65" target="origFile">qoi = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri66" target="origFile">dqq = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri67" target="origFile">bet = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri68" target="origFile">gam = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri69" target="origFile">prh = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri70" target="origFile">pri = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri71" target="origFile">ght = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri72" target="origFile">dpt = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri73" target="origFile">dpb = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri74" target="origFile">pki = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri75" target="origFile">pol = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri76" target="origFile">qst = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri77" target="origFile">ssl = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri78" target="origFile">gms = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri79" target="origFile">eta = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri80" target="origFile">gmh = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri81" target="origFile">eht = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri82" target="origFile">gm1 = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri83" target="origFile">hcc = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri84" target="origFile">hst = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri85" target="origFile">qol = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri86" target="origFile">zol = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri87" target="origFile">hcld = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri88" target="origFile">rasal = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri89" target="origFile">bk2 = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri90" target="origFile">qss = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri91" target="origFile">dqs = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri92" target="origFile">prj = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri93" target="origFile">prs = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri94" target="origFile">qht = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri95" target="origFile">sht = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri96" target="origFile">zet = <code class="constant">0.0</code></a>
<a href="convection_tracer.html#rase_traceri97" target="origFile"><code class="comment">!  ---  1</code></a>
<a href="convection_tracer.html#rase_traceri97" target="origFile"><code class="comment">!  ---  4</code></a>
  <a href="convection_tracer.html#rase_traceri97" target="origFile">cli_crit = rasparams(<code class="constant">4</code>)</a>
<a href="convection_tracer.html#rase_traceri98" target="origFile"><code class="comment">!  ---  5</code></a>
  <a href="convection_tracer.html#rase_traceri98" target="origFile">rasal1 = rasparams(<code class="constant">5</code>)</a>
<a href="convection_tracer.html#rase_traceri99" target="origFile"><code class="comment">!  ---  6</code></a>
  <a href="convection_tracer.html#rase_traceri99" target="origFile">rasal2 = rasparams(<code class="constant">6</code>)</a>
<a href="convection_tracer.html#rase_traceri100" target="origFile"><code class="comment">!  --- 11</code></a>
<a href="convection_tracer.html#rase_traceri100" target="origFile"><code class="comment">!  --- 14</code></a>
  <a href="convection_tracer.html#rase_traceri100" target="origFile">sdqv2 = rasparams(<code class="constant">14</code>)</a>
<a href="convection_tracer.html#rase_traceri101" target="origFile"><code class="comment">!  --- 15</code></a>
  <a href="convection_tracer.html#rase_traceri101" target="origFile">sdqv3 = rasparams(<code class="constant">15</code>)</a>
<a href="convection_tracer.html#rase_traceri102" target="origFile"><code class="comment">!  --- 16</code></a>
  <a href="convection_tracer.html#rase_traceri102" target="origFile">sdqvt1 = rasparams(<code class="constant">16</code>)</a>
<a href="convection_tracer.html#rase_traceri103" target="origFile"><code class="comment">!  --- 17</code></a>
  <a href="convection_tracer.html#rase_traceri103" target="origFile">acritfac = rasparams(<code class="constant">17</code>)</a>
<a href="convection_tracer.html#rase_traceri104" target="origFile"><code class="comment">!  --- 20</code></a>
  <a href="convection_tracer.html#rase_traceri104" target="origFile">pblfrac = rasparams(<code class="constant">20</code>)</a>
<a href="convection_tracer.html#rase_traceri105" target="origFile"><code class="comment">!  --- 21</code></a>
  <a href="convection_tracer.html#rase_traceri105" target="origFile">autorampb = rasparams(<code class="constant">21</code>)</a>
<a href="convection_tracer.html#rase_traceri106" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_tracer.html#rase_traceri106" target="origFile">rhmn = rasparams(<code class="constant">24</code>)</a>
<a href="convection_tracer.html#rase_traceri107" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_tracer.html#rase_traceri107" target="origFile">maxdallowed = rasparams(<code class="constant">23</code>)</a>
<a href="convection_tracer.html#rase_traceri108" target="origFile"><code class="comment">!  --- 25</code></a>
  <a href="convection_tracer.html#rase_traceri108" target="origFile">rhmx = rasparams(<code class="constant">25</code>)</a>
  <a href="convection_tracer.html#rase_traceri109" target="origFile">grav = cons_grav</a>
  <a href="convection_tracer.html#rase_traceri110" target="origFile">alhl = cons_alhl</a>
  <a href="convection_tracer.html#rase_traceri111" target="origFile">cp = cons_cp</a>
  <a href="convection_tracer.html#rase_traceri112" target="origFile">cpi = <code class="constant">1.0</code>/cp</a>
  <a href="convection_tracer.html#rase_traceri113" target="origFile">alhi = <code class="constant">1.0</code>/alhl</a>
  <a href="convection_tracer.html#rase_traceri114" target="origFile">gravi = <code class="constant">1.0</code>/grav</a>
  <a href="convection_tracer.html#rase_traceri115" target="origFile">cpbg = cp*gravi</a>
  <a href="convection_tracer.html#rase_traceri116" target="origFile">lbcp = alhl*cpi</a>
  <a href="convection_tracer.html#rase_traceri117" target="origFile">i = <code class="constant">1</code></a>
<a href="convection_tracer.html#rase_traceri118" target="origFile"><code class="comment">!CALL FINDBASE</code></a>
  <a href="convection_tracer.html#rase_traceri118" target="origFile">k = kcbl(i)</a>
  <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (k .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="convection_tracer.html#rase_traceri120" target="origFile"><code class="comment">!Get saturation specific humidity and gradient wrt to T</code></a>
    <a href="convection_tracer.html#rase_traceri120" target="origFile">pke = (ple(i, :)/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection_tracer.html#rase_traceri121" target="origFile">pf = <code class="constant">0.5</code>*(ple(i, <code class="constant">1</code>:k0)+ple(i, <code class="constant">2</code>:k0+<code class="constant">1</code>))</a>
    <a href="convection_tracer.html#rase_traceri122" target="origFile">pk = (pf/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection_tracer.html#rase_traceri123" target="origFile">tempf = tho(i, :)*pk</a>
    <a href="convection_tracer.html#rase_traceri124" target="origFile">zle = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri125" target="origFile">zlo = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri126" target="origFile">zle(k0+<code class="constant">1</code>) = <code class="constant">0.</code></a>
    <a href="convection_tracer.html#rase_traceri130" target="origFile"><code class="keyword">DO </code>l=k0,<code class="constant">1</code>,-<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri127" target="origFile">zle(l) = tho(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l))</a>
      <a href="convection_tracer.html#rase_traceri128" target="origFile">zlo(l) = zle(l+<code class="constant">1</code>) + cons_cp/cons_grav*(pke(l+<code class="constant">1</code>)-pk(l))*zle(l)</a>
      <a href="convection_tracer.html#rase_traceri129" target="origFile">zle(l) = zlo(l) + cons_cp/cons_grav*(pk(l)-pke(l))*zle(l)</a>
    <a href="convection_tracer.html#rase_traceri130" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri131" target="origFile">tpert = cbl_tpert*(ts(i)-(tempf(k0)+cons_grav*zlo(k0)/cons_cp))</a>
<a href="convection_tracer.html#rase_traceri132" target="origFile"><code class="comment">!* ( QSSFC - Q(:,:,K0) ) [CBL_QPERT = 0.0]</code></a>
    <a href="convection_tracer.html#rase_traceri132" target="origFile">qpert = cbl_qpert</a>
    <a href="convection_tracer.html#rase_traceri133" target="origFile"><code class="keyword">IF</code> (tpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri134" target="origFile">tpert = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri133" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri135" target="origFile">tpert = tpert</a>
    <a href="convection_tracer.html#rase_traceri133" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri136" target="origFile"><code class="keyword">IF</code> (qpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri137" target="origFile">qpert = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri136" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri138" target="origFile">qpert = qpert</a>
    <a href="convection_tracer.html#rase_traceri136" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri139" target="origFile"><code class="keyword">IF</code> (frland(i) .LT. <code class="constant">0.1</code>) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri140" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxocn) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri141" target="origFile">tpert = cbl_tpert_mxocn</a>
      <a href="convection_tracer.html#rase_traceri140" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri142" target="origFile">tpert = tpert</a>
      <a href="convection_tracer.html#rase_traceri140" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri139" target="origFile"><code class="keyword">ELSE </code></a><a href="convection_tracer.html#rase_traceri143" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxlnd) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri144" target="origFile">tpert = cbl_tpert_mxlnd</a>
    <a href="convection_tracer.html#rase_traceri143" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri145" target="origFile">tpert = tpert</a>
    <a href="convection_tracer.html#rase_traceri139" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri146" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS</code>(dqs, qss, tempf, pf, k0, estblx, cons_h2omw, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri146" target="origFile"><code class="label">&            </code>cons_airmw)</a>
    <a href="convection_tracer.html#rase_traceri148" target="origFile"><code class="keyword">DO </code>kk=icmin,k+<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri147" target="origFile">prj(kk) = pke(kk)</a>
    <a href="convection_tracer.html#rase_traceri148" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri149" target="origFile">prs(icmin:k0+<code class="constant">1</code>) = ple(i, icmin:k0+<code class="constant">1</code>)</a>
    <a href="convection_tracer.html#rase_traceri150" target="origFile">poi(icmin:k) = tho(i, icmin:k)</a>
    <a href="convection_tracer.html#rase_traceri151" target="origFile">qoi(icmin:k) = qho(i, icmin:k)</a>
    <a href="convection_tracer.html#rase_traceri152" target="origFile">qst(icmin:k) = qss(icmin:k)</a>
    <a href="convection_tracer.html#rase_traceri153" target="origFile">dqq(icmin:k) = dqs(icmin:k)</a>
<a href="convection_tracer.html#rase_traceri156" target="origFile"><code class="comment">!Mass fraction of each layer below cloud base</code></a>
    <a href="convection_tracer.html#rase_traceri156" target="origFile">massf(:) = wgt0(i, :)</a>
<a href="convection_tracer.html#rase_traceri157" target="origFile"><code class="comment">!RESET PRESSURE at bottom edge of CBL </code></a>
    <a href="convection_tracer.html#rase_traceri157" target="origFile">prcbl = prs(k)</a>
    <a href="convection_tracer.html#rase_traceri159" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
      <a href="convection_tracer.html#rase_traceri158" target="origFile">prcbl = prcbl + massf(l)*(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection_tracer.html#rase_traceri159" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri160" target="origFile">prs(k+<code class="constant">1</code>) = prcbl</a>
    <a href="convection_tracer.html#rase_traceri161" target="origFile">prj(k+<code class="constant">1</code>) = (prs(k+<code class="constant">1</code>)/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection_tracer.html#rase_traceri168" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri162" target="origFile">pol(l) = <code class="constant">0.5</code>*(prs(l)+prs(l+<code class="constant">1</code>))</a>
      <a href="convection_tracer.html#rase_traceri163" target="origFile">prh(l) = (prs(l+<code class="constant">1</code>)*prj(l+<code class="constant">1</code>)-prs(l)*prj(l))/(onepkap*(prs(l+<code class="constant">1</code>)-prs(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri163" target="origFile"><code class="label">&       </code>l)))</a>
      <a href="convection_tracer.html#rase_traceri164" target="origFile">pki(l) = <code class="constant">1.0</code>/prh(l)</a>
      <a href="convection_tracer.html#rase_traceri165" target="origFile">dpt(l) = prh(l) - prj(l)</a>
      <a href="convection_tracer.html#rase_traceri166" target="origFile">dpb(l) = prj(l+<code class="constant">1</code>) - prh(l)</a>
      <a href="convection_tracer.html#rase_traceri167" target="origFile">pri(l) = <code class="constant">.01</code>/(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection_tracer.html#rase_traceri168" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="comment">!RECALCULATE PROFILE QUAN. IN LOWEST STRAPPED LAYER</code></a>
    <a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="keyword">IF</code> (k .LE. k0) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri170" target="origFile">poi(k) = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri171" target="origFile">qoi(k) = <code class="constant">0.</code></a>
<a href="convection_tracer.html#rase_traceri172" target="origFile"><code class="comment">!SPECIFY WEIGHTS GIVEN TO EACH LAYER WITHIN SUBCLOUD "SUPERLAYER"</code></a>
      <a href="convection_tracer.html#rase_traceri172" target="origFile">wght = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri174" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_tracer.html#rase_traceri173" target="origFile">wght(l) = massf(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))/(prs(k+<code class="constant">1</code>)-prs(k))</a>
      <a href="convection_tracer.html#rase_traceri174" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri177" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_tracer.html#rase_traceri175" target="origFile">poi(k) = poi(k) + wght(l)*tho(i, l)</a>
        <a href="convection_tracer.html#rase_traceri176" target="origFile">qoi(k) = qoi(k) + wght(l)*qho(i, l)</a>
      <a href="convection_tracer.html#rase_traceri177" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection_tracer.html#rase_traceri182" target="origFile">arg1 = poi(k)*prh(k)</a>
      <a href="convection_tracer.html#rase_traceri183" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS</code>(dqq(k), qst(k), arg1, pol(k), estblx, cons_h2omw, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri183" target="origFile"><code class="label">&               </code>cons_airmw)</a>
    <a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri184" target="origFile"><code class="keyword">IF</code> (seedras(i)/<code class="constant">1000000. </code>.LT. <code class="constant">1e-6</code>) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri185" target="origFile">rndu = <code class="constant">1e-6</code></a>
    <a href="convection_tracer.html#rase_traceri184" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri186" target="origFile">rndu = seedras(i)/<code class="constant">1000000.</code></a>
    <a href="convection_tracer.html#rase_traceri184" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri187" target="origFile">mxdiam = maxdallowed*rndu**(-(<code class="constant">1.</code>/<code class="constant">2.</code>))</a>
    <a href="convection_tracer.html#rase_traceri193" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a href="convection_tracer.html#rase_traceri188" target="origFile"><code class="comment">!*</code></a>
      <a href="convection_tracer.html#rase_traceri188" target="origFile">bet(l) = dqq(l)*pki(l)</a>
<a href="convection_tracer.html#rase_traceri189" target="origFile"><code class="comment">!*</code></a>
      <a href="convection_tracer.html#rase_traceri189" target="origFile">gam(l) = pki(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))</a>
      <a href="convection_tracer.html#rase_traceri190" target="origFile"><code class="keyword">IF</code> (l .LT. k) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri191" target="origFile">ght(l+<code class="constant">1</code>) = gam(l)*dpb(l) + gam(l+<code class="constant">1</code>)*dpt(l+<code class="constant">1</code>)</a>
        <a href="convection_tracer.html#rase_traceri192" target="origFile">gm1(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*(dqq(l)/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))+dqq(l+<code class="constant">1</code>)/(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri192" target="origFile"><code class="label">&         </code>alhl*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))))</a>
      <a href="convection_tracer.html#rase_traceri190" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri193" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri194" target="origFile">rmf = <code class="constant">0.</code></a>
<a href="convection_tracer.html#rase_traceri195" target="origFile"><code class="comment">!DO_TRACERS</code></a>
    <a href="convection_tracer.html#rase_traceri195" target="origFile">cvw = <code class="constant">0.0</code></a>
<a href="convection_tracer.html#rase_traceri196" target="origFile"><code class="comment">! HOL initialized here in order not to confuse Valgrind debugger</code></a>
    <a href="convection_tracer.html#rase_traceri196" target="origFile">hol = <code class="constant">0.</code></a>
    <a href="convection_tracer.html#rase_traceri197" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0</code></a>
    <a href="convection_tracer.html#rase_traceri198" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi(k)*prj(k+<code class="constant">1</code>)</a>
    <a href="convection_tracer.html#rase_traceri212" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri200" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi(l)) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri201" target="origFile">qol(l) = qoi(l)</a>
      <a href="convection_tracer.html#rase_traceri200" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri202" target="origFile">qol(l) = qst(l)*rhmax</a>
      <a href="convection_tracer.html#rase_traceri200" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri203" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri204" target="origFile">qol(l) = qol(l)</a>
      <a href="convection_tracer.html#rase_traceri203" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri205" target="origFile">qol(l) = <code class="constant">0.000</code></a>
      <a href="convection_tracer.html#rase_traceri203" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri206" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi(l) + grav*zet(l+<code class="constant">1</code>)</a>
      <a href="convection_tracer.html#rase_traceri207" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
      <a href="convection_tracer.html#rase_traceri208" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
      <a href="convection_tracer.html#rase_traceri209" target="origFile">tem = poi(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
      <a href="convection_tracer.html#rase_traceri210" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
      <a href="convection_tracer.html#rase_traceri211" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi(l)*cpbg</a>
    <a href="convection_tracer.html#rase_traceri212" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri388" target="origFile"><code class="keyword">DO </code>ic=k,icmin+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a href="convection_tracer.html#rase_traceri213" target="origFile"><code class="comment">!DO_TRACERS</code></a>
      <a href="convection_tracer.html#rase_traceri213" target="origFile"><code class="keyword">IF</code> (<code class="constant">1. </code>.GT. (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri215" target="origFile">trg = (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)</a>
      <a href="convection_tracer.html#rase_traceri213" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri216" target="origFile">trg = <code class="constant">1.</code></a>
      <a href="convection_tracer.html#rase_traceri213" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri217" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.0 </code>.LT. (autorampb-sige(ic))/<code class="constant">0.2</code>) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri218" target="origFile">y1 = (autorampb-sige(ic))/<code class="constant">0.2</code></a>
      <a href="convection_tracer.html#rase_traceri217" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri219" target="origFile">y1 = <code class="constant">0.0</code></a>
      <a href="convection_tracer.html#rase_traceri217" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri220" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.0 </code>.GT. y1) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri221" target="origFile">f4 = y1</a>
      <a href="convection_tracer.html#rase_traceri220" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri222" target="origFile">f4 = <code class="constant">1.0</code></a>
      <a href="convection_tracer.html#rase_traceri220" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">IF</code> (trg .LE. <code class="constant">1.0e-5</code>) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">5</code>)</a>
      <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri224" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection_tracer.html#rase_traceri224" target="origFile"><code class="comment">!RECOMPUTE SOUNDING UP TO DETRAINMENT LEVEL</code></a>
        <a href="convection_tracer.html#rase_traceri224" target="origFile">poi_c = poi</a>
        <a href="convection_tracer.html#rase_traceri225" target="origFile">qoi_c = qoi</a>
        <a href="convection_tracer.html#rase_traceri226" target="origFile">poi_c(k) = poi_c(k) + tpert</a>
        <a href="convection_tracer.html#rase_traceri227" target="origFile">qoi_c(k) = qoi_c(k) + qpert</a>
        <a href="convection_tracer.html#rase_traceri228" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0.</code></a>
        <a href="convection_tracer.html#rase_traceri229" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi_c(k)*prj(k+<code class="constant">1</code>)</a>
        <a href="convection_tracer.html#rase_traceri242" target="origFile"><code class="keyword">DO </code>l=k,ic,-<code class="constant">1</code></a>
          <a href="convection_tracer.html#rase_traceri230" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi_c(l)) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri231" target="origFile">qol(l) = qoi_c(l)</a>
          <a href="convection_tracer.html#rase_traceri230" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri232" target="origFile">qol(l) = qst(l)*rhmax</a>
          <a href="convection_tracer.html#rase_traceri230" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection_tracer.html#rase_traceri233" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri234" target="origFile">qol(l) = qol(l)</a>
          <a href="convection_tracer.html#rase_traceri233" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri235" target="origFile">qol(l) = <code class="constant">0.000</code></a>
          <a href="convection_tracer.html#rase_traceri233" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection_tracer.html#rase_traceri236" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi_c(l) + grav*zet(l+<code class="constant">1</code>)</a>
          <a href="convection_tracer.html#rase_traceri237" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
          <a href="convection_tracer.html#rase_traceri238" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
          <a href="convection_tracer.html#rase_traceri239" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection_tracer.html#rase_traceri239" target="origFile">tem = poi_c(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
          <a href="convection_tracer.html#rase_traceri240" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
          <a href="convection_tracer.html#rase_traceri241" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi_c(l)*cpbg</a>
        <a href="convection_tracer.html#rase_traceri242" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
        <a href="convection_tracer.html#rase_traceri223" target="origFile">ad_from = ic + <code class="constant">1</code></a>
        <a href="convection_tracer.html#rase_traceri246" target="origFile"><code class="keyword">DO </code>l=ad_from,k</a>
          <a href="convection_tracer.html#rase_traceri243" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection_tracer.html#rase_traceri243" target="origFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri244" target="origFile">sht(l) = ssl(l-<code class="constant">1</code>) + tem*(ssl(l)-ssl(l-<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri245" target="origFile">qht(l) = <code class="constant">.5</code>*(qol(l)+qol(l-<code class="constant">1</code>))</a>
        <a href="convection_tracer.html#rase_traceri246" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from)</a>
<a href="convection_tracer.html#rase_traceri247" target="origFile"><code class="comment">!CALCULATE LAMBDA, ETA, AND WORKFUNCTION</code></a>
        <a href="convection_tracer.html#rase_traceri247" target="origFile">lambda_min = <code class="constant">.2</code>/mxdiam</a>
        <a href="convection_tracer.html#rase_traceri248" target="origFile">lambda_max = <code class="constant">.2</code>/<code class="constant">200.</code></a>
        <a href="convection_tracer.html#rase_traceri249" target="origFile"><code class="keyword">IF</code> (hol(k) .LE. hst(ic)) <code class="keyword">THEN</code></a>
          <a href="convection_tracer.html#rase_traceri249" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">4</code>)</a>
        <a href="convection_tracer.html#rase_traceri249" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri250" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection_tracer.html#rase_traceri250" target="origFile"><code class="comment">!LAMBDA CALCULATION: MS-A18</code></a>
          <a href="convection_tracer.html#rase_traceri250" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection_tracer.html#rase_traceri250" target="origFile">tem = (hst(ic)-hol(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri252" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k-<code class="constant">1</code></a>
            <a href="convection_tracer.html#rase_traceri251" target="origFile">tem = tem + (hst(ic)-hol(l))*(zet(l)-zet(l+<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri252" target="origFile"><code class="keyword">END DO</code></a>
          <a href="convection_tracer.html#rase_traceri253" target="origFile"><code class="keyword">IF</code> (tem .LE. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri253" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">3</code>)</a>
          <a href="convection_tracer.html#rase_traceri253" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri254" target="origFile"><code class="comment">!================&gt;></code></a>
            <a href="convection_tracer.html#rase_traceri254" target="origFile">alm = (hol(k)-hst(ic))/tem</a>
            <a href="convection_tracer.html#rase_traceri255" target="origFile"><code class="keyword">IF</code> (alm .GT. lambda_max) <code class="keyword">THEN</code></a>
              <a href="convection_tracer.html#rase_traceri255" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">2</code>)</a>
            <a href="convection_tracer.html#rase_traceri255" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri256" target="origFile"><code class="comment">!================&gt;></code></a>
              <a href="convection_tracer.html#rase_traceri256" target="origFile">toki = <code class="constant">1.0</code></a>
              <a href="convection_tracer.html#rase_traceri257" target="origFile"><code class="keyword">IF</code> (alm .LT. lambda_min) </a><a href="convection_tracer.html#rase_traceri258" target="origFile">toki = (alm/lambda_min)**<code class="constant">2</code></a>
              <a href="convection_tracer.html#rase_traceri255" target="origFile">ad_from0 = ic + <code class="constant">1</code></a>
<a href="convection_tracer.html#rase_traceri260" target="origFile"><code class="comment">!ETA CALCULATION: MS-A2</code></a>
              <a href="convection_tracer.html#rase_traceri260" target="origFile"><code class="keyword">DO </code>l=ad_from0,k</a>
                <a href="convection_tracer.html#rase_traceri259" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(eta(l))</a>
                <a href="convection_tracer.html#rase_traceri259" target="origFile">eta(l) = <code class="constant">1.0 </code>+ alm*(zet(l)-zet(k))</a>
              <a href="convection_tracer.html#rase_traceri260" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection_tracer.html#rase_traceri255" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from0)</a>
              <a href="convection_tracer.html#rase_traceri261" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(eta(ic))</a>
              <a href="convection_tracer.html#rase_traceri261" target="origFile">eta(ic) = <code class="constant">1.0 </code>+ alm*(zol(ic)-zet(k))</a>
<a href="convection_tracer.html#rase_traceri262" target="origFile"><code class="comment">!WORKFUNCTION CALCULATION:  MS-A22</code></a>
              <a href="convection_tracer.html#rase_traceri262" target="origFile">wfn = <code class="constant">0.0</code></a>
              <a href="convection_tracer.html#rase_traceri263" target="origFile">hcc(k) = hol(k)</a>
              <a href="convection_tracer.html#rase_traceri268" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                <a href="convection_tracer.html#rase_traceri264" target="origFile">hcc(l) = hcc(l+<code class="constant">1</code>) + (eta(l)-eta(l+<code class="constant">1</code>))*hol(l)</a>
                <a href="convection_tracer.html#rase_traceri265" target="origFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
                <a href="convection_tracer.html#rase_traceri266" target="origFile">eht(l) = eta(l+<code class="constant">1</code>)*dpb(l) + eta(l)*dpt(l)</a>
                <a href="convection_tracer.html#rase_traceri267" target="origFile">wfn = wfn + (tem-eht(l)*hst(l))*gam(l)</a>
              <a href="convection_tracer.html#rase_traceri268" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection_tracer.html#rase_traceri269" target="origFile">hcc(ic) = hst(ic)*eta(ic)</a>
              <a href="convection_tracer.html#rase_traceri270" target="origFile">wfn = wfn + (hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*gam(ic)*dpb(ic)</a>
<a href="convection_tracer.html#rase_traceri271" target="origFile"><code class="comment">!VERTICAL VELOCITY/KE CALCULATION (ADDED 12/2001 JTB)</code></a>
              <a href="convection_tracer.html#rase_traceri271" target="origFile">bk2(k) = <code class="constant">0.0</code></a>
              <a href="convection_tracer.html#rase_traceri272" target="origFile">hcld(k) = hol(k)</a>
              <a href="convection_tracer.html#rase_traceri283" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                <a href="convection_tracer.html#rase_traceri273" target="origFile">hcld(l) = (eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))/<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri273" target="origFile"><code class="label">&                 </code>eta(l)</a>
                <a href="convection_tracer.html#rase_traceri274" target="origFile">tem = (hcld(l)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))/(<code class="constant">1.0</code>+lbcp*dqq(l<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri274" target="origFile"><code class="label">&                 </code>))</a>
                <a href="convection_tracer.html#rase_traceri275" target="origFile"><code class="keyword">IF</code> (tem .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_tracer.html#rase_traceri276" target="origFile">max1 = <code class="constant">0.0</code></a>
                <a href="convection_tracer.html#rase_traceri275" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_tracer.html#rase_traceri277" target="origFile">max1 = tem</a>
                <a href="convection_tracer.html#rase_traceri275" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection_tracer.html#rase_traceri278" target="origFile">bk2(l) = bk2(l+<code class="constant">1</code>) + grav*max1/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection_tracer.html#rase_traceri279" target="origFile"><code class="keyword">IF</code> (bk2(l) .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_tracer.html#rase_traceri280" target="origFile">max2 = <code class="constant">0.0</code></a>
                <a href="convection_tracer.html#rase_traceri279" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_tracer.html#rase_traceri281" target="origFile">max2 = bk2(l)</a>
                <a href="convection_tracer.html#rase_traceri279" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection_tracer.html#rase_traceri282" target="origFile">cvw(l) = <code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
              <a href="convection_tracer.html#rase_traceri283" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection_tracer.html#rase_traceri284" target="origFile"><code class="comment">!ALPHA CALCULATION </code></a>
              <a href="convection_tracer.html#rase_traceri284" target="origFile"><code class="keyword">IF</code> (zet(ic) .LT. <code class="constant">2000.</code>) </a><a href="convection_tracer.html#rase_traceri285" target="origFile">rasal(ic) = rasal1</a>
              <a href="convection_tracer.html#rase_traceri286" target="origFile"><code class="keyword">IF</code> (zet(ic) .GE. <code class="constant">2000.</code>) </a><a href="convection_tracer.html#rase_traceri287" target="origFile">rasal(ic) = rasal1 + (rasal2-<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri287" target="origFile"><code class="label">&                 </code>rasal1)*(zet(ic)-<code class="constant">2000.</code>)/<code class="constant">8000.</code></a>
              <a href="convection_tracer.html#rase_traceri288" target="origFile"><code class="keyword">IF</code> (rasal(ic) .GT. <code class="constant">1.0e5</code>) <code class="keyword">THEN</code></a>
                <a href="convection_tracer.html#rase_traceri289" target="origFile">rasal(ic) = <code class="constant">1.0e5</code></a>
              <a href="convection_tracer.html#rase_traceri288" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection_tracer.html#rase_traceri290" target="origFile">rasal(ic) = rasal(ic)</a>
              <a href="convection_tracer.html#rase_traceri288" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection_tracer.html#rase_traceri291" target="origFile">rasal(ic) = dt/rasal(ic)</a>
              <a href="convection_tracer.html#rase_traceri295" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
                <a href="convection_tracer.html#rase_traceri292" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_tracer.html#rase_traceri293" target="origFile">cvw(l) = <code class="constant">1.00</code></a>
                <a href="convection_tracer.html#rase_traceri292" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_tracer.html#rase_traceri294" target="origFile">cvw(l) = cvw(l)</a>
                <a href="convection_tracer.html#rase_traceri292" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection_tracer.html#rase_traceri295" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection_tracer.html#rase_traceri296" target="origFile"><code class="keyword">CALL </code><code class="funcname">ACRITN</code>(pol(ic), prs(k), acr, acritfac)</a>
              <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">IF</code> (wfn .LE. acr) <code class="keyword">THEN</code></a>
                <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">1</code>)</a>
              <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri307" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection_tracer.html#rase_traceri307" target="origFile"><code class="comment">!DO_TRACERS</code></a>
                <a href="convection_tracer.html#rase_traceri307" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a href="convection_tracer.html#rase_traceri298" target="origFile"><code class="comment">!Scavenging of the below cloud tracer</code></a>
                  <a href="convection_tracer.html#rase_traceri298" target="origFile">delzkm = (zet(ic)-zet(k))/<code class="constant">1000.</code></a>
                  <a href="convection_tracer.html#rase_traceri299" target="origFile">x4 = <code class="funcname">EXP</code>(-(fscav(itr)*delzkm))</a>
                  <a href="convection_tracer.html#rase_traceri300" target="origFile"><code class="keyword">IF</code> (x4 .GT. <code class="constant">1.</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri301" target="origFile">x1 = <code class="constant">1.</code></a>
                  <a href="convection_tracer.html#rase_traceri300" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri302" target="origFile">x1 = x4</a>
                  <a href="convection_tracer.html#rase_traceri300" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri303" target="origFile"><code class="keyword">IF</code> (x1 .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri304" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(fnoscav)</a>
                    <a href="convection_tracer.html#rase_traceri304" target="origFile">fnoscav = <code class="constant">0.</code></a>
                    <a href="convection_tracer.html#rase_traceri303" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection_tracer.html#rase_traceri303" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri305" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(fnoscav)</a>
                    <a href="convection_tracer.html#rase_traceri305" target="origFile">fnoscav = x1</a>
                    <a href="convection_tracer.html#rase_traceri303" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection_tracer.html#rase_traceri303" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection_tracer.html#rase_traceri307" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection_tracer.html#rase_traceri308" target="origFile">wlq = qol(k)</a>
                <a href="convection_tracer.html#rase_traceri346" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                  <a href="convection_tracer.html#rase_traceri309" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                  <a href="convection_tracer.html#rase_traceri309" target="origFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
                  <a href="convection_tracer.html#rase_traceri310" target="origFile">wlq = wlq + tem*qol(l)</a>
<a href="convection_tracer.html#rase_traceri320" target="origFile"><code class="comment">!DO_TRACERS</code></a>
                  <a href="convection_tracer.html#rase_traceri320" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a href="convection_tracer.html#rase_traceri311" target="origFile"><code class="comment">!Scavenging of the entrained tracer.  Updates transported tracer mass.</code></a>
                    <a href="convection_tracer.html#rase_traceri311" target="origFile">delzkm = (zet(ic)-zet(l+<code class="constant">1</code>))/<code class="constant">1000.</code></a>
                    <a href="convection_tracer.html#rase_traceri312" target="origFile">x5 = <code class="funcname">EXP</code>(-(fscav(itr)*delzkm))</a>
                    <a href="convection_tracer.html#rase_traceri313" target="origFile"><code class="keyword">IF</code> (x5 .GT. <code class="constant">1.</code>) <code class="keyword">THEN</code></a>
                      <a href="convection_tracer.html#rase_traceri314" target="origFile">x2 = <code class="constant">1.</code></a>
                    <a href="convection_tracer.html#rase_traceri313" target="origFile"><code class="keyword">ELSE</code></a>
                      <a href="convection_tracer.html#rase_traceri315" target="origFile">x2 = x5</a>
                    <a href="convection_tracer.html#rase_traceri313" target="origFile"><code class="keyword">END IF</code></a>
                    <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">IF</code> (x2 .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                      <a href="convection_tracer.html#rase_traceri317" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(fnoscav)</a>
                      <a href="convection_tracer.html#rase_traceri317" target="origFile">fnoscav = <code class="constant">0.</code></a>
                      <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                    <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">ELSE</code></a>
                      <a href="convection_tracer.html#rase_traceri318" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(fnoscav)</a>
                      <a href="convection_tracer.html#rase_traceri318" target="origFile">fnoscav = x2</a>
                      <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                    <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri320" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection_tracer.html#rase_traceri321" target="origFile"><code class="keyword">IF</code> (l .GT. ic) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri322" target="origFile">tx2 = <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection_tracer.html#rase_traceri323" target="origFile">tx3 = <code class="constant">0.5</code>*(hst(l)+hst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection_tracer.html#rase_traceri324" target="origFile">qcc = tx2 + gm1(l)*(hcc(l)-tx3)</a>
                    <a href="convection_tracer.html#rase_traceri325" target="origFile">cll0(l) = wlq - qcc</a>
                  <a href="convection_tracer.html#rase_traceri321" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri326" target="origFile">cll0(l) = wlq - qst(ic)*eta(ic)</a>
                  <a href="convection_tracer.html#rase_traceri321" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri327" target="origFile"><code class="keyword">IF</code> (cll0(l) .LT. <code class="constant">0.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri328" target="origFile">cll0(l) = <code class="constant">0.00</code></a>
                  <a href="convection_tracer.html#rase_traceri327" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri329" target="origFile">cll0(l) = cll0(l)</a>
                  <a href="convection_tracer.html#rase_traceri327" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri330" target="origFile">cli = cll0(l)/eta(l)</a>
                  <a href="convection_tracer.html#rase_traceri331" target="origFile">te_a = poi(l)*prh(l)</a>
                  <a href="convection_tracer.html#rase_traceri332" target="origFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE</code>(te_a, sdqv2, sdqv3, sdqvt1, f2, f3)</a>
                  <a href="convection_tracer.html#rase_traceri333" target="origFile">c00_x = co_auto(i)*f2*f3*f4</a>
                  <a href="convection_tracer.html#rase_traceri334" target="origFile">cli_crit_x = cli_crit/(f2*f3)</a>
                  <a href="convection_tracer.html#rase_traceri335" target="origFile">rate = c00_x*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(-(cli**<code class="constant">2</code>/cli_crit_x**<code class="constant">2</code>)))</a>
                  <a href="convection_tracer.html#rase_traceri336" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri337" target="origFile">cvw_x = <code class="constant">1.00</code></a>
                  <a href="convection_tracer.html#rase_traceri336" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri338" target="origFile">cvw_x = cvw(l)</a>
                  <a href="convection_tracer.html#rase_traceri336" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri339" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
                  <a href="convection_tracer.html#rase_traceri340" target="origFile">closs = cll0(l)*rate*dt_lyr</a>
                  <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">IF</code> (closs .GT. cll0(l)) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri342" target="origFile">closs = cll0(l)</a>
                  <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri343" target="origFile">closs = closs</a>
                  <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri344" target="origFile"><code class="keyword">IF</code> (closs .GT. <code class="constant">0.</code>) </a><a href="convection_tracer.html#rase_traceri345" target="origFile">wlq = wlq - closs</a>
                <a href="convection_tracer.html#rase_traceri346" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
                <a href="convection_tracer.html#rase_traceri347" target="origFile">wlq = wlq - qst(ic)*eta(ic)</a>
<a href="convection_tracer.html#rase_traceri348" target="origFile"><code class="comment">!CALCULATE GAMMAS AND KERNEL</code></a>
                <a href="convection_tracer.html#rase_traceri348" target="origFile">gms(k) = (sht(k)-ssl(k))*pri(k)</a>
                <a href="convection_tracer.html#rase_traceri349" target="origFile">gmh(k) = gms(k) + (qht(k)-qol(k))*pri(k)*alhl</a>
                <a href="convection_tracer.html#rase_traceri350" target="origFile">akm = gmh(k)*gam(k-<code class="constant">1</code>)*dpb(k-<code class="constant">1</code>)</a>
                <a href="convection_tracer.html#rase_traceri351" target="origFile">tx2 = gmh(k)</a>
                <a href="convection_tracer.html#rase_traceri356" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                  <a href="convection_tracer.html#rase_traceri352" target="origFile">gms(l) = (eta(l)*(sht(l)-ssl(l))+eta(l+<code class="constant">1</code>)*(ssl(l)-sht(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri352" target="origFile"><code class="label">&                   </code>l+<code class="constant">1</code>)))*pri(l)</a>
                  <a href="convection_tracer.html#rase_traceri353" target="origFile">gmh(l) = gms(l) + (eta(l)*(qht(l)-qol(l))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri353" target="origFile"><code class="label">&                   </code>qol(l)-qht(l+<code class="constant">1</code>)))*alhl*pri(l)</a>
                  <a href="convection_tracer.html#rase_traceri354" target="origFile">tx2 = tx2 + (eta(l)-eta(l+<code class="constant">1</code>))*gmh(l)</a>
                  <a href="convection_tracer.html#rase_traceri355" target="origFile">akm = akm - gms(l)*eht(l)*pki(l) + tx2*ght(l)</a>
                <a href="convection_tracer.html#rase_traceri356" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection_tracer.html#rase_traceri357" target="origFile">gms(ic) = eta(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*pri(ic)</a>
                <a href="convection_tracer.html#rase_traceri358" target="origFile">akm = akm - gms(ic)*eta(ic+<code class="constant">1</code>)*dpb(ic)*pki(ic)</a>
                <a href="convection_tracer.html#rase_traceri359" target="origFile">gmh(ic) = gms(ic) + (eta(ic+<code class="constant">1</code>)*(qol(ic)-qht(ic+<code class="constant">1</code>))*alhl+<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri359" target="origFile"><code class="label">&                 </code>eta(ic)*(hst(ic)-hol(ic)))*pri(ic)</a>
<a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="comment">!CLOUD BASE MASS FLUX</code></a>
                <a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="keyword">IF</code> (akm .GE. <code class="constant">0.0 </code>.OR. wlq .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">0</code>)</a>
                <a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection_tracer.html#rase_traceri361" target="origFile"><code class="comment">!================&gt;></code></a>
                  <a href="convection_tracer.html#rase_traceri361" target="origFile">wfn = -((wfn-acr)/akm)</a>
                  <a href="convection_tracer.html#rase_traceri362" target="origFile">x3 = rasal(ic)*trg*toki*wfn</a>
                  <a href="convection_tracer.html#rase_traceri363" target="origFile"><code class="keyword">IF</code> (x3 .GT. (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri364" target="origFile">wfn = (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)</a>
                  <a href="convection_tracer.html#rase_traceri363" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri365" target="origFile">wfn = x3</a>
                  <a href="convection_tracer.html#rase_traceri363" target="origFile"><code class="keyword">END IF</code></a>
<a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="comment">!CUMULATIVE PRECIP AND CLOUD-BASE MASS FLUX FOR OUTPUT</code></a>
                  <a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                  <a href="convection_tracer.html#rase_traceri366" target="origFile">tem = wfn*gravi</a>
                  <a href="convection_tracer.html#rase_traceri367" target="origFile">rmf(ic) = rmf(ic) + tem</a>
<a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="comment">!THETA AND Q CHANGE DUE TO CLOUD TYPE IC</code></a>
                  <a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
                    <a href="convection_tracer.html#rase_traceri368" target="origFile">gmh(l) = gmh(l)*wfn</a>
                    <a href="convection_tracer.html#rase_traceri369" target="origFile">gms(l) = gms(l)*wfn</a>
                    <a href="convection_tracer.html#rase_traceri370" target="origFile">qoi(l) = qoi(l) + (gmh(l)-gms(l))*alhi</a>
                    <a href="convection_tracer.html#rase_traceri371" target="origFile">poi(l) = poi(l) + gms(l)*pki(l)*cpi</a>
                    <a href="convection_tracer.html#rase_traceri372" target="origFile">qst(l) = qst(l) + gms(l)*bet(l)*cpi</a>
                  <a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection_tracer.html#rase_traceri374" target="origFile"><code class="comment">!*FRICFAC*0.5</code></a>
                  <a href="convection_tracer.html#rase_traceri374" target="origFile">wfn = wfn*<code class="constant">0.5</code>*<code class="constant">1.0</code></a>
<a href="convection_tracer.html#rase_traceri375" target="origFile"><code class="comment">!DO_TRACERS</code></a>
                  <a href="convection_tracer.html#rase_traceri375" target="origFile">tem = wfn*pri(k)</a>
                  <a href="convection_tracer.html#rase_traceri381" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
                    <a href="convection_tracer.html#rase_traceri380" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                      <a href="convection_tracer.html#rase_traceri378" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                      <a href="convection_tracer.html#rase_traceri378" target="origFile">tem = wfn*pri(l)</a>
                    <a href="convection_tracer.html#rase_traceri380" target="origFile"><code class="keyword">END DO</code></a>
                    <a href="convection_tracer.html#rase_traceri381" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
                  <a href="convection_tracer.html#rase_traceri381" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection_tracer.html#rase_traceri382" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                  <a href="convection_tracer.html#rase_traceri382" target="origFile">tem = wfn*pri(ic)</a>
                  <a href="convection_tracer.html#rase_traceri387" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
                    <a href="convection_tracer.html#rase_traceri387" target="origFile">ad_from1 = ic</a>
                    <a href="convection_tracer.html#rase_traceri387" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from1)</a>
                  <a href="convection_tracer.html#rase_traceri387" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">6</code>)</a>
                <a href="convection_tracer.html#rase_traceri360" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">END IF</code></a>
            <a href="convection_tracer.html#rase_traceri255" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection_tracer.html#rase_traceri253" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection_tracer.html#rase_traceri249" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri388" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="comment">!CLOUD LOOP</code></a>
    <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">IF</code> (<code class="funcname">SUM</code>(rmf(icmin:k)) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a href="convection_tracer.html#rase_traceri390" target="origFile"><code class="comment">!De-strap tendencies from RAS</code></a>
      <a href="convection_tracer.html#rase_traceri390" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8ARRAY</code>(wght, k0)</a>
      <a href="convection_tracer.html#rase_traceri390" target="origFile">wght = wgt1(i, :)</a>
<a href="convection_tracer.html#rase_traceri391" target="origFile"><code class="comment">!Scale properly by layer masses</code></a>
      <a href="convection_tracer.html#rase_traceri391" target="origFile">wght0 = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri393" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_tracer.html#rase_traceri392" target="origFile">wght0 = wght0 + wght(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))</a>
      <a href="convection_tracer.html#rase_traceri393" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri394" target="origFile">wght0 = (prs(k+<code class="constant">1</code>)-prs(k))/wght0</a>
      <a href="convection_tracer.html#rase_traceri395" target="origFile">wght = wght0*wght</a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile">xoib = <code class="constant">0.0_8</code></a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile">xoi_svb = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_bi26"></a>      <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
        <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">DO </code>l=k0,k,<code class="constant">-1</code></a>
          <a href="convection_tracer.html#rase_traceri397" target="origFile">xoib(k, itr) = xoib(k, itr) + wght(l)*xhob(i, l, itr)</a>
          <a href="convection_tracer.html#rase_traceri397" target="origFile">xoi_svb(k, itr) = xoi_svb(k, itr) - wght(l)*xhob(i, l, itr)</a>
<a name="rase_tracer_bi25"></a>        <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_bi24"></a>      <a href="convection_tracer.html#rase_traceri396" target="origFile">xoib(icmin:k-<code class="constant">1</code>, :) = xoib(icmin:k-<code class="constant">1</code>, :) + xhob(i, icmin:k-<code class="constant">1</code>, :)</a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile">xhob(i, icmin:k-<code class="constant">1</code>, :) = <code class="constant">0.0_8</code></a>
      <a href="convection_tracer.html#rase_traceri390" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8ARRAY</code>(wght, k0)</a>
    <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile">xoib = <code class="constant">0.0_8</code></a>
      <a href="convection_tracer.html#rase_traceri389" target="origFile">xoi_svb = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri389" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile">xcub = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile">xhtb = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>ic=icmin+<code class="constant">1</code>,k,<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL3B</code>(branch)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">GOTO </code><code class="label">110</code></a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE IF</code> (branch .LT. <code class="constant">5</code>) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">GOTO </code><code class="label">110</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">GOTO </code><code class="label">120</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE IF</code> (branch .EQ. <code class="constant">5</code>) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">GOTO </code><code class="label">130</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
<a name="rase_tracer_bi23"></a>          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from1)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=k,ad_from1,<code class="constant">-1</code></a>
            <a href="convection_tracer.html#rase_traceri385" target="origFile">xcub(l, itr) = xcub(l, itr) + xoib(l, itr)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_bi22"></a>        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
          <a href="convection_tracer.html#rase_traceri383" target="origFile">tempb1 = tem*xcub(ic, itr)</a>
          <a href="convection_tracer.html#rase_traceri383" target="origFile">tempb2 = -(eta(ic+<code class="constant">1</code>)*tempb1)</a>
          <a href="convection_tracer.html#rase_traceri383" target="origFile">xhtb(itr) = xhtb(itr) + <code class="constant">2.</code>*tempb1</a>
          <a href="convection_tracer.html#rase_traceri383" target="origFile">xoib(ic, itr) = xoib(ic, itr) + tempb2 - <code class="constant">2.</code>*(eta(ic)-eta(ic+<code class="constant">1</code>)<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri383" target="origFile"><code class="label">&           </code>)*tempb1</a>
<a name="rase_tracer_bi21"></a>          <a href="convection_tracer.html#rase_traceri383" target="origFile">xoib(ic+<code class="constant">1</code>, itr) = xoib(ic+<code class="constant">1</code>, itr) + tempb2</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri382" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
<a name="rase_tracer_bi19"></a>          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to1)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=ad_to1,k-<code class="constant">1</code>,<code class="constant">1</code></a>
            <a href="convection_tracer.html#rase_traceri379" target="origFile">tempb = tem*xcub(l, itr)</a>
            <a href="convection_tracer.html#rase_traceri379" target="origFile">tempb0 = eta(l+<code class="constant">1</code>)*tempb</a>
            <a href="convection_tracer.html#rase_traceri379" target="origFile">xoib(l-<code class="constant">1</code>, itr) = xoib(l-<code class="constant">1</code>, itr) + eta(l)*tempb</a>
<a name="rase_tracer_bi20"></a>            <a href="convection_tracer.html#rase_traceri379" target="origFile">xoib(l, itr) = xoib(l, itr) + tempb0 - eta(l)*tempb</a>
            <a href="convection_tracer.html#rase_traceri379" target="origFile">xoib(l+<code class="constant">1</code>, itr) = xoib(l+<code class="constant">1</code>, itr) - tempb0</a>
            <a href="convection_tracer.html#rase_traceri378" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_bi18"></a>        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
          <a href="convection_tracer.html#rase_traceri376" target="origFile">xoib(k-<code class="constant">1</code>, itr) = xoib(k-<code class="constant">1</code>, itr) + tem*xcub(k, itr)</a>
<a name="rase_tracer_bi17"></a>          <a href="convection_tracer.html#rase_traceri376" target="origFile">xoib(k, itr) = xoib(k, itr) - tem*xcub(k, itr)</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to0)</a>
<a name="rase_tracer_bi16"></a>      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=ad_to0,k-<code class="constant">1</code>,<code class="constant">1</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
          <a href="convection_tracer.html#rase_traceri319" target="origFile">xoib(l, itr) = xoib(l, itr) + tem*fnoscav*xhtb(itr)</a>
<a name="rase_tracer_bi14"></a>          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_bi15"></a>            <a href="convection_tracer.html#rase_traceri317" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(fnoscav)</a>
          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri318" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(fnoscav)</a>
<a name="rase_tracer_bi13"></a>          <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection_tracer.html#rase_traceri309" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
<a name="rase_tracer_bi12"></a>      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
        <a href="convection_tracer.html#rase_traceri306" target="origFile">xoib(k, itr) = xoib(k, itr) + fnoscav*xhtb(itr)</a>
        <a href="convection_tracer.html#rase_traceri306" target="origFile">xhtb(itr) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_bi10"></a>        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_bi11"></a>          <a href="convection_tracer.html#rase_traceri304" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(fnoscav)</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection_tracer.html#rase_traceri305" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(fnoscav)</a>
<a name="rase_tracer_bi9"></a>        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
 <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="label">100 </code></a> <a href="convection_tracer.html#rase_traceri261" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(eta(ic))</a>
<a name="rase_tracer_bi8"></a>      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from0)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=k,ad_from0,<code class="constant">-1</code></a>
<a name="rase_tracer_bi7"></a>        <a href="convection_tracer.html#rase_traceri259" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(eta(l))</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
 <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="label">110 </code></a> <a href="convection_tracer.html#rase_traceri250" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
<a name="rase_tracer_bi6"></a> <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="label">120  </code><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=k,ad_from,<code class="constant">-1</code></a>
        <a href="convection_tracer.html#rase_traceri243" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_bi5"></a>      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=ad_to,k,<code class="constant">1</code></a>
        <a href="convection_tracer.html#rase_traceri239" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_bi3"></a> <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="label">130  </code>xcub(icmin:k0, :) = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri199" target="origFile">xoib = xoib + xoi_svb</a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_bi2"></a>      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>l=k0,k,<code class="constant">-1</code></a>
          <a href="convection_tracer.html#rase_traceri179" target="origFile">xhob(i, l, itr) = xhob(i, l, itr) + wght(l)*xoib(k, itr)</a>
        <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile">xoib(k, :) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_bi0"></a>    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">DO </code>itr=itrcr,<code class="constant">1</code>,<code class="constant">-1</code></a>
      <a href="convection_tracer.html#rase_traceri154" target="origFile">xhob(i, icmin:k, itr) = xhob(i, icmin:k, itr) + xoib(icmin:k, itr)</a>
      <a href="convection_tracer.html#rase_traceri119" target="origFile">xoib(icmin:k, itr) = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END DO</code></a>
  <a href="convection_tracer.html#rase_traceri119" target="origFile"><code class="keyword">END IF</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RASE_TRACER_B</code></a>

</pre>
</body>
