<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="rase"></a><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code>
<code class="comment">!</code>
<a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RASE</code>(<code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code>, <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code><code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">& </code>, <code class="vardecl">cons_rgas</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code>, <code class="vardecl">seedras</code>, <code class="vardecl">sige</code>, <code class="vardecl">kcbl</code><code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">& </code>, <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code>, <code class="vardecl">frland</code>, <code class="vardecl">ts</code>, <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code>, <code class="vardecl">co_auto</code>, <code class="vardecl">ple</code>, <code class="vardecl">clw</code>, <code class="vardecl">flxd</code><code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">& </code>, <code class="vardecl">cnv_prc3</code>, <code class="vardecl">cnv_updfrc</code>, <code class="vardecl">rasparams</code>, <code class="vardecl">estblx</code>)</a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!INPUTS</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ple</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">sige</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">seedras</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kcbl</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ts</code>, <code class="vardecl">frland</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">co_auto</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rasparams</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">estblx</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!OUTPUTS</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">clw</code>, <code class="vardecl">flxd</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_prc3</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">cnv_updfrc</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!PROGNOSTIC</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!LOCALS</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">ic</code>, <code class="vardecl">l</code>, <code class="vardecl">kk</code>, <code class="vardecl">k</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Parameters</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">onepkap</code>=<code class="constant">1.</code>+<code class="constant">2.</code>/<code class="constant">7.</code>, <code class="vardecl">daylen</code>=<code class="constant">86400.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">rhmax</code>=<code class="constant">0.9999</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_qpert</code>=<code class="constant">0.0</code>, <code class="vardecl">cbl_tpert</code>=<code class="constant">1.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_tpert_mxocn</code>=<code class="constant">2.0</code>, <code class="vardecl">cbl_tpert_mxlnd</code>=<code class="constant">4.0</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Constants</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">grav</code>, <code class="vardecl">cp</code>, <code class="vardecl">alhl</code>, <code class="vardecl">cpbg</code>, <code class="vardecl">alhi</code>, <code class="vardecl">cpi</code>, <code class="vardecl">gravi</code>, <code class="vardecl">ddt</code>, <code class="vardecl">lbcp</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Rasparams</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fricfac</code>, <code class="vardecl">cli_crit</code>, <code class="vardecl">rasal1</code>, <code class="vardecl">rasal2</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">friclambda</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sdqv2</code>, <code class="vardecl">sdqv3</code>, <code class="vardecl">sdqvt1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">acritfac</code>, <code class="vardecl">pblfrac</code>, <code class="vardecl">autorampb</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxdallowed</code>, <code class="vardecl">rhmn</code>, <code class="vardecl">rhmx</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">mxdiam</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2</code>, <code class="vardecl">tx3</code>, <code class="vardecl">akm</code>, <code class="vardecl">acr</code>, <code class="vardecl">alm</code>, <code class="vardecl">tth</code>, <code class="vardecl">qqh</code>, <code class="vardecl">dqx</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfn</code>, <code class="vardecl">tem</code>, <code class="vardecl">trg</code>, <code class="vardecl">trgexp</code>, <code class="vardecl">evp</code>, <code class="vardecl">wlq</code>, <code class="vardecl">qcc</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cli</code>, <code class="vardecl">te_a</code>, <code class="vardecl">c00_x</code>, <code class="vardecl">cli_crit_x</code>, <code class="vardecl">toki</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyr</code>, <code class="vardecl">rate</code>, <code class="vardecl">cvw_x</code>, <code class="vardecl">closs</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>, <code class="vardecl">f4</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wght0</code>, <code class="vardecl">prcbl</code>, <code class="vardecl">rndu</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">lambda_min</code>, <code class="vardecl">lambda_max</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpert</code>, <code class="vardecl">qpert</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uht</code>, <code class="vardecl">vht</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_sv</code>, <code class="vardecl">qoi_sv</code>, <code class="vardecl">uoi_sv</code>, <code class="vardecl">voi_sv</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi</code>, <code class="vardecl">qoi</code>, <code class="vardecl">uoi</code>, <code class="vardecl">voi</code>, <code class="vardecl">dqq</code>, <code class="vardecl">bet</code>, <code class="vardecl">gam</code>, <code class="vardecl">cll</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_c</code>, <code class="vardecl">qoi_c</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">prh</code>, <code class="vardecl">pri</code>, <code class="vardecl">ght</code>, <code class="vardecl">dpt</code>, <code class="vardecl">dpb</code>, <code class="vardecl">pki</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">ucu</code>, <code class="vardecl">vcu</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">cln</code>, <code class="vardecl">rns</code>, <code class="vardecl">pol</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qst</code>, <code class="vardecl">ssl</code>, <code class="vardecl">rmf</code>, <code class="vardecl">rnn</code>, <code class="vardecl">rn1</code>, <code class="vardecl">rmfc</code>, <code class="vardecl">rmfp</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">gms</code>, <code class="vardecl">eta</code>, <code class="vardecl">gmh</code>, <code class="vardecl">eht</code>, <code class="vardecl">gm1</code>, <code class="vardecl">hcc</code>, <code class="vardecl">rmfd</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">hol</code>, <code class="vardecl">hst</code>, <code class="vardecl">qol</code>, <code class="vardecl">zol</code>, <code class="vardecl">hcld</code>, <code class="vardecl">cll0</code>, <code class="vardecl">cllx</code>, <code class="vardecl">clli</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">bke</code>, <code class="vardecl">cvw</code>, <code class="vardecl">updfrc</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">rasal</code>, <code class="vardecl">updfrp</code>, <code class="vardecl">bk2</code>, <code class="vardecl">dll0</code>, <code class="vardecl">dllx</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">wght</code>, <code class="vardecl">massf</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qss</code>, <code class="vardecl">dqs</code>, <code class="vardecl">pf</code>, <code class="vardecl">pk</code>, <code class="vardecl">tempf</code>, <code class="vardecl">zlo</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">prj</code>, <code class="vardecl">prs</code>, <code class="vardecl">qht</code>, <code class="vardecl">sht</code>, <code class="vardecl">zet</code>, <code class="vardecl">zle</code>, <code class="vardecl">pke</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">pwx1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwy1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">pwx10</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwx11</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwr1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">y1</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Initialize Local Arrays</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">poi = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qoi = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">uoi = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">voi = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">dqq = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">bet = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">gam = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">poi_c = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qoi_c = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">prh = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pri = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">ght = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">dpt = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">dpb = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pki = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">ucu = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">vcu = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">cln = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pol = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qst = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">ssl = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rmf = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rnn = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rn1 = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">gms = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">eta = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">gmh = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">eht = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">gm1 = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">hcc = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">hol = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">hst = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qol = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">zol = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">hcld = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">bke = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">cvw = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">updfrc = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rasal = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">updfrp = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">bk2 = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">wght = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">massf = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qss = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">dqs = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pf = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pk = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">tempf = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">zlo = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">prj = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">prs = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">qht = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">sht = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">zet = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">zle = <code class="constant">0.0</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pke = <code class="constant">0.0</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Initialize Outputs</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">cnv_prc3 = <code class="constant">0.</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">cnv_updfrc = <code class="constant">0.</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">flxd = <code class="constant">0.</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">clw = <code class="constant">0.</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  ---  1</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">fricfac = rasparams(<code class="constant">1</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  ---  4</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">cli_crit = rasparams(<code class="constant">4</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  ---  5</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rasal1 = rasparams(<code class="constant">5</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  ---  6</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rasal2 = rasparams(<code class="constant">6</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 11</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">friclambda = rasparams(<code class="constant">11</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 14</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">sdqv2 = rasparams(<code class="constant">14</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 15</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">sdqv3 = rasparams(<code class="constant">15</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 16</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">sdqvt1 = rasparams(<code class="constant">16</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 17</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">acritfac = rasparams(<code class="constant">17</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 20</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">pblfrac = rasparams(<code class="constant">20</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 21</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">autorampb = rasparams(<code class="constant">21</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rhmn = rasparams(<code class="constant">24</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">maxdallowed = rasparams(<code class="constant">23</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!  --- 25</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">rhmx = rasparams(<code class="constant">25</code>)</a>
  <a href="convection_d.html#rase_d" target="diffFile">grav = cons_grav</a>
  <a href="convection_d.html#rase_d" target="diffFile">alhl = cons_alhl</a>
  <a href="convection_d.html#rase_d" target="diffFile">cp = cons_cp</a>
  <a href="convection_d.html#rase_d" target="diffFile">cpi = <code class="constant">1.0</code>/cp</a>
  <a href="convection_d.html#rase_d" target="diffFile">alhi = <code class="constant">1.0</code>/alhl</a>
  <a href="convection_d.html#rase_d" target="diffFile">gravi = <code class="constant">1.0</code>/grav</a>
  <a href="convection_d.html#rase_d" target="diffFile">cpbg = cp*gravi</a>
  <a href="convection_d.html#rase_d" target="diffFile">ddt = daylen/dt</a>
  <a href="convection_d.html#rase_d" target="diffFile">lbcp = alhl*cpi</a>
  <a href="convection_d.html#rase_d" target="diffFile">i = <code class="constant">1</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CALL FINDBASE</code></a>
  <a href="convection_d.html#rase_d" target="diffFile">k = kcbl(i)</a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (k .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Get saturation specific humidity and gradient wrt to T</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">pwx1 = ple(i, :)/<code class="constant">1000.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">pwy1 = cons_rgas/cons_cp</a>
    <a href="convection_d.html#rase_d" target="diffFile">pke = pwx1**pwy1</a>
    <a href="convection_d.html#rase_d" target="diffFile">pf = <code class="constant">0.5</code>*(ple(i, <code class="constant">1</code>:k0)+ple(i, <code class="constant">2</code>:k0+<code class="constant">1</code>))</a>
    <a href="convection_d.html#rase_d" target="diffFile">pwx10 = pf/<code class="constant">1000.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">pwy1 = cons_rgas/cons_cp</a>
    <a href="convection_d.html#rase_d" target="diffFile">pk = pwx10**pwy1</a>
    <a href="convection_d.html#rase_d" target="diffFile">tempf = tho(i, :)*pk</a>
    <a href="convection_d.html#rase_d" target="diffFile">zle = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">zlo = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">zle(k0+<code class="constant">1</code>) = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k0,<code class="constant">1</code>,-<code class="constant">1</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">zle(l) = tho(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l))</a>
      <a href="convection_d.html#rase_d" target="diffFile">zlo(l) = zle(l+<code class="constant">1</code>) + cons_cp/cons_grav*(pke(l+<code class="constant">1</code>)-pk(l))*zle(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile">zle(l) = zlo(l) + cons_cp/cons_grav*(pk(l)-pke(l))*zle(l)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">tpert = cbl_tpert*(ts(i)-(tempf(k0)+cons_grav*zlo(k0)/cons_cp))</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!* ( QSSFC - Q(:,:,K0) ) [CBL_QPERT = 0.0]</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">qpert = cbl_qpert</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (tpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">tpert = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">tpert = tpert</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (qpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">qpert = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">qpert = qpert</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (frland(i) .LT. <code class="constant">0.1</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxocn) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">tpert = cbl_tpert_mxocn</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">tpert = tpert</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE IF</code> (tpert .GT. cbl_tpert_mxlnd) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">tpert = cbl_tpert_mxlnd</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">tpert = tpert</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS</code>(dqs, qss, tempf, pf, k0, estblx, cons_h2omw, <code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&            </code>cons_airmw)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>kk=icmin,k+<code class="constant">1</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">prj(kk) = pke(kk)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">prs(icmin:k0+<code class="constant">1</code>) = ple(i, icmin:k0+<code class="constant">1</code>)</a>
    <a href="convection_d.html#rase_d" target="diffFile">poi(icmin:k) = tho(i, icmin:k)</a>
    <a href="convection_d.html#rase_d" target="diffFile">qoi(icmin:k) = qho(i, icmin:k)</a>
    <a href="convection_d.html#rase_d" target="diffFile">uoi(icmin:k) = uho(i, icmin:k)</a>
    <a href="convection_d.html#rase_d" target="diffFile">voi(icmin:k) = vho(i, icmin:k)</a>
    <a href="convection_d.html#rase_d" target="diffFile">qst(icmin:k) = qss(icmin:k)</a>
    <a href="convection_d.html#rase_d" target="diffFile">dqq(icmin:k) = dqs(icmin:k)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Mass fraction of each layer below cloud base</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">massf(:) = wgt0(i, :)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!RESET PRESSURE at bottom edge of CBL </code></a>
    <a href="convection_d.html#rase_d" target="diffFile">prcbl = prs(k)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,k0</a>
      <a href="convection_d.html#rase_d" target="diffFile">prcbl = prcbl + massf(l)*(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">prs(k+<code class="constant">1</code>) = prcbl</a>
    <a href="convection_d.html#rase_d" target="diffFile">pwx11 = prs(k+<code class="constant">1</code>)/<code class="constant">1000.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">pwy1 = cons_rgas/cons_cp</a>
    <a href="convection_d.html#rase_d" target="diffFile">prj(k+<code class="constant">1</code>) = pwx11**pwy1</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">pol(l) = <code class="constant">0.5</code>*(prs(l)+prs(l+<code class="constant">1</code>))</a>
      <a href="convection_d.html#rase_d" target="diffFile">prh(l) = (prs(l+<code class="constant">1</code>)*prj(l+<code class="constant">1</code>)-prs(l)*prj(l))/(onepkap*(prs(l+<code class="constant">1</code>)-prs(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&       </code>l)))</a>
      <a href="convection_d.html#rase_d" target="diffFile">pki(l) = <code class="constant">1.0</code>/prh(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile">dpt(l) = prh(l) - prj(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile">dpb(l) = prj(l+<code class="constant">1</code>) - prh(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile">pri(l) = <code class="constant">.01</code>/(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!RECALCULATE PROFILE QUAN. IN LOWEST STRAPPED LAYER</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (k .LE. k0) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">poi(k) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">qoi(k) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">uoi(k) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">voi(k) = <code class="constant">0.</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!SPECIFY WEIGHTS GIVEN TO EACH LAYER WITHIN SUBCLOUD "SUPERLAYER"</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">wght = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_d.html#rase_d" target="diffFile">wght(l) = massf(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))/(prs(k+<code class="constant">1</code>)-prs(k))</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_d.html#rase_d" target="diffFile">poi(k) = poi(k) + wght(l)*tho(i, l)</a>
        <a href="convection_d.html#rase_d" target="diffFile">qoi(k) = qoi(k) + wght(l)*qho(i, l)</a>
        <a href="convection_d.html#rase_d" target="diffFile">uoi(k) = uoi(k) + wght(l)*uho(i, l)</a>
        <a href="convection_d.html#rase_d" target="diffFile">voi(k) = voi(k) + wght(l)*vho(i, l)</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS</code>(dqq(k), qst(k), poi(k)*prh(k), pol(k), estblx, <code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&               </code>cons_h2omw, cons_airmw)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (seedras(i)/<code class="constant">1000000. </code>.LT. <code class="constant">1e-6</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">rndu = <code class="constant">1e-6</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">rndu = seedras(i)/<code class="constant">1000000.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">pwr1 = rndu**(-(<code class="constant">1.</code>/<code class="constant">2.</code>))</a>
    <a href="convection_d.html#rase_d" target="diffFile">mxdiam = maxdallowed*pwr1</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!*</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">bet(l) = dqq(l)*pki(l)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!*</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">gam(l) = pki(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (l .LT. k) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">ght(l+<code class="constant">1</code>) = gam(l)*dpb(l) + gam(l+<code class="constant">1</code>)*dpt(l+<code class="constant">1</code>)</a>
        <a href="convection_d.html#rase_d" target="diffFile">gm1(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*(dqq(l)/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))+dqq(l+<code class="constant">1</code>)/(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&         </code>alhl*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))))</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">rns = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">cll = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">rmf = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">rmfd = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">rmfc = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">rmfp = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">cll0 = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">dll0 = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">cllx = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">dllx = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">clli = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">poi_sv = poi</a>
    <a href="convection_d.html#rase_d" target="diffFile">qoi_sv = qoi</a>
    <a href="convection_d.html#rase_d" target="diffFile">uoi_sv = uoi</a>
    <a href="convection_d.html#rase_d" target="diffFile">voi_sv = voi</a>
    <a href="convection_d.html#rase_d" target="diffFile">cvw = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">updfrc = <code class="constant">0.0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">updfrp = <code class="constant">0.0</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">! HOL initialized here in order not to confuse Valgrind debugger</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">hol = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">zet(k+<code class="constant">1</code>) = <code class="constant">0</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">sht(k+<code class="constant">1</code>) = cp*poi(k)*prj(k+<code class="constant">1</code>)</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi(l)) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qoi(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qst(l)*rhmax</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qol(l)</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">qol(l) = <code class="constant">0.000</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi(l) + grav*zet(l+<code class="constant">1</code>)</a>
      <a href="convection_d.html#rase_d" target="diffFile">hol(l) = ssl(l) + qol(l)*alhl</a>
      <a href="convection_d.html#rase_d" target="diffFile">hst(l) = ssl(l) + qst(l)*alhl</a>
      <a href="convection_d.html#rase_d" target="diffFile">tem = poi(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
      <a href="convection_d.html#rase_d" target="diffFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
      <a href="convection_d.html#rase_d" target="diffFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi(l)*cpbg</a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>ic=k,icmin+<code class="constant">1</code>,-<code class="constant">1</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">ucu(icmin:) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">vcu(icmin:) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">alm = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1. </code>.GT. (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">trg = (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">trg = <code class="constant">1.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">0.0 </code>.LT. (autorampb-sige(ic))/<code class="constant">0.2</code>) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">y1 = (autorampb-sige(ic))/<code class="constant">0.2</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">y1 = <code class="constant">0.0</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.0 </code>.GT. y1) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">f4 = y1</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">f4 = <code class="constant">1.0</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (trg .GT. <code class="constant">1.0e-5</code>) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!RECOMPUTE SOUNDING UP TO DETRAINMENT LEVEL</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">poi_c = poi</a>
        <a href="convection_d.html#rase_d" target="diffFile">qoi_c = qoi</a>
        <a href="convection_d.html#rase_d" target="diffFile">poi_c(k) = poi_c(k) + tpert</a>
        <a href="convection_d.html#rase_d" target="diffFile">qoi_c(k) = qoi_c(k) + qpert</a>
        <a href="convection_d.html#rase_d" target="diffFile">zet(k+<code class="constant">1</code>) = <code class="constant">0.</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">sht(k+<code class="constant">1</code>) = cp*poi_c(k)*prj(k+<code class="constant">1</code>)</a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,ic,-<code class="constant">1</code></a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi_c(l)) <code class="keyword">THEN</code></a>
            <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qoi_c(l)</a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qst(l)*rhmax</a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
            <a href="convection_d.html#rase_d" target="diffFile">qol(l) = qol(l)</a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="convection_d.html#rase_d" target="diffFile">qol(l) = <code class="constant">0.000</code></a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="convection_d.html#rase_d" target="diffFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi_c(l) + grav*zet(l+<code class="constant">1</code>)</a>
          <a href="convection_d.html#rase_d" target="diffFile">hol(l) = ssl(l) + qol(l)*alhl</a>
          <a href="convection_d.html#rase_d" target="diffFile">hst(l) = ssl(l) + qst(l)*alhl</a>
          <a href="convection_d.html#rase_d" target="diffFile">tem = poi_c(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
          <a href="convection_d.html#rase_d" target="diffFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
          <a href="convection_d.html#rase_d" target="diffFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi_c(l)*cpbg</a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
          <a href="convection_d.html#rase_d" target="diffFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
          <a href="convection_d.html#rase_d" target="diffFile">sht(l) = ssl(l-<code class="constant">1</code>) + tem*(ssl(l)-ssl(l-<code class="constant">1</code>))</a>
          <a href="convection_d.html#rase_d" target="diffFile">qht(l) = <code class="constant">.5</code>*(qol(l)+qol(l-<code class="constant">1</code>))</a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CALCULATE LAMBDA, ETA, AND WORKFUNCTION</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">lambda_min = <code class="constant">.2</code>/mxdiam</a>
        <a href="convection_d.html#rase_d" target="diffFile">lambda_max = <code class="constant">.2</code>/<code class="constant">200.</code></a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (hol(k) .GT. hst(ic)) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!LAMBDA CALCULATION: MS-A18</code></a>
          <a href="convection_d.html#rase_d" target="diffFile">tem = (hst(ic)-hol(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>))</a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k-<code class="constant">1</code></a>
            <a href="convection_d.html#rase_d" target="diffFile">tem = tem + (hst(ic)-hol(l))*(zet(l)-zet(l+<code class="constant">1</code>))</a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (tem .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
            <a href="convection_d.html#rase_d" target="diffFile">alm = (hol(k)-hst(ic))/tem</a>
            <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (alm .LE. lambda_max) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
              <a href="convection_d.html#rase_d" target="diffFile">toki = <code class="constant">1.0</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (alm .LT. lambda_min) toki = (alm/lambda_min)**<code class="constant">2</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!ETA CALCULATION: MS-A2</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
                <a href="convection_d.html#rase_d" target="diffFile">eta(l) = <code class="constant">1.0 </code>+ alm*(zet(l)-zet(k))</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">eta(ic) = <code class="constant">1.0 </code>+ alm*(zol(ic)-zet(k))</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!WORKFUNCTION CALCULATION:  MS-A22</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">wfn = <code class="constant">0.0</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">hcc(k) = hol(k)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">hcc(l) = hcc(l+<code class="constant">1</code>) + (eta(l)-eta(l+<code class="constant">1</code>))*hol(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile">eht(l) = eta(l+<code class="constant">1</code>)*dpb(l) + eta(l)*dpt(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile">wfn = wfn + (tem-eht(l)*hst(l))*gam(l)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">hcc(ic) = hst(ic)*eta(ic)</a>
              <a href="convection_d.html#rase_d" target="diffFile">wfn = wfn + (hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*gam(ic)*dpb(ic)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!VERTICAL VELOCITY/KE CALCULATION (ADDED 12/2001 JTB)</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">bk2(k) = <code class="constant">0.0</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">bke(k) = <code class="constant">0.0</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">hcld(k) = hol(k)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">hcld(l) = (eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))/<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                 </code>eta(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile">tem = (hcld(l)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))/(<code class="constant">1.0</code>+lbcp*dqq(l<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                 </code>))</a>
                <a href="convection_d.html#rase_d" target="diffFile">bke(l) = bke(l+<code class="constant">1</code>) + grav*tem/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (tem .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">max1 = <code class="constant">0.0</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">max1 = tem</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">bk2(l) = bk2(l+<code class="constant">1</code>) + grav*max1/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (bk2(l) .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">max2 = <code class="constant">0.0</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">max2 = bk2(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">cvw(l) = <code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!ALPHA CALCULATION </code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (zet(ic) .LT. <code class="constant">2000.</code>) rasal(ic) = rasal1</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (zet(ic) .GE. <code class="constant">2000.</code>) rasal(ic) = rasal1 + (rasal2-<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                 </code>rasal1)*(zet(ic)-<code class="constant">2000.</code>)/<code class="constant">8000.</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (rasal(ic) .GT. <code class="constant">1.0e5</code>) <code class="keyword">THEN</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">rasal(ic) = <code class="constant">1.0e5</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">rasal(ic) = rasal(ic)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
              <a href="convection_d.html#rase_d" target="diffFile">rasal(ic) = dt/rasal(ic)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic,k</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">cvw(l) = <code class="constant">1.00</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">cvw(l) = cvw(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ACRITN</code>(pol(ic), prs(k), acr, acritfac)</a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (wfn .GT. acr) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
                <a href="convection_d.html#rase_d" target="diffFile">wlq = qol(k)</a>
                <a href="convection_d.html#rase_d" target="diffFile">uht = uoi(k)</a>
                <a href="convection_d.html#rase_d" target="diffFile">vht = voi(k)</a>
                <a href="convection_d.html#rase_d" target="diffFile">rnn(k) = <code class="constant">0.</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">cll0(k) = <code class="constant">0.</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">wlq = wlq + tem*qol(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">uht = uht + tem*uoi(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">vht = vht + tem*voi(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (l .GT. ic) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">tx2 = <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">tx3 = <code class="constant">0.5</code>*(hst(l)+hst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">qcc = tx2 + gm1(l)*(hcc(l)-tx3)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">cll0(l) = wlq - qcc</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">cll0(l) = wlq - qst(ic)*eta(ic)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (cll0(l) .LT. <code class="constant">0.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">cll0(l) = <code class="constant">0.00</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">cll0(l) = cll0(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">cli = cll0(l)/eta(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">te_a = poi(l)*prh(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE</code>(te_a, sdqv2, sdqv3, sdqvt1, f2, f3)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">c00_x = co_auto(i)*f2*f3*f4</a>
                  <a href="convection_d.html#rase_d" target="diffFile">cli_crit_x = cli_crit/(f2*f3)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">arg1 = -(cli**<code class="constant">2</code>/cli_crit_x**<code class="constant">2</code>)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">rate = c00_x*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(arg1))</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">cvw_x = <code class="constant">1.00</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">cvw_x = cvw(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
                  <a href="convection_d.html#rase_d" target="diffFile">closs = cll0(l)*rate*dt_lyr</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (closs .GT. cll0(l)) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">closs = cll0(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">closs = closs</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">cll0(l) = cll0(l) - closs</a>
                  <a href="convection_d.html#rase_d" target="diffFile">dll0(l) = closs</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (closs .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">wlq = wlq - closs</a>
                    <a href="convection_d.html#rase_d" target="diffFile">rnn(l) = closs</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">rnn(l) = <code class="constant">0.</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">wlq = wlq - qst(ic)*eta(ic)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CALCULATE GAMMAS AND KERNEL</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">gms(k) = (sht(k)-ssl(k))*pri(k)</a>
                <a href="convection_d.html#rase_d" target="diffFile">gmh(k) = gms(k) + (qht(k)-qol(k))*pri(k)*alhl</a>
                <a href="convection_d.html#rase_d" target="diffFile">akm = gmh(k)*gam(k-<code class="constant">1</code>)*dpb(k-<code class="constant">1</code>)</a>
                <a href="convection_d.html#rase_d" target="diffFile">tx2 = gmh(k)</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">gms(l) = (eta(l)*(sht(l)-ssl(l))+eta(l+<code class="constant">1</code>)*(ssl(l)-sht(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                   </code>l+<code class="constant">1</code>)))*pri(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">gmh(l) = gms(l) + (eta(l)*(qht(l)-qol(l))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                   </code>qol(l)-qht(l+<code class="constant">1</code>)))*alhl*pri(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">tx2 = tx2 + (eta(l)-eta(l+<code class="constant">1</code>))*gmh(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">akm = akm - gms(l)*eht(l)*pki(l) + tx2*ght(l)</a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
                <a href="convection_d.html#rase_d" target="diffFile">gms(ic) = eta(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*pri(ic)</a>
                <a href="convection_d.html#rase_d" target="diffFile">akm = akm - gms(ic)*eta(ic+<code class="constant">1</code>)*dpb(ic)*pki(ic)</a>
                <a href="convection_d.html#rase_d" target="diffFile">gmh(ic) = gms(ic) + (eta(ic+<code class="constant">1</code>)*(qol(ic)-qht(ic+<code class="constant">1</code>))*alhl+<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                 </code>eta(ic)*(hst(ic)-hol(ic)))*pri(ic)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CLOUD BASE MASS FLUX</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (.NOT.(akm .GE. <code class="constant">0.0 </code>.OR. wlq .LT. <code class="constant">0.0</code>)) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">wfn = -((wfn-acr)/akm)</a>
                  <a href="convection_d.html#rase_d" target="diffFile">x1 = rasal(ic)*trg*toki*wfn</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (x1 .GT. (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)) <code class="keyword">THEN</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">wfn = (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">wfn = x1</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CUMULATIVE PRECIP AND CLOUD-BASE MASS FLUX FOR OUTPUT</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">tem = wfn*gravi</a>
                  <a href="convection_d.html#rase_d" target="diffFile">cll(ic) = cll(ic) + wlq*tem</a>
                  <a href="convection_d.html#rase_d" target="diffFile">rmf(ic) = rmf(ic) + tem</a>
                  <a href="convection_d.html#rase_d" target="diffFile">rmfd(ic) = rmfd(ic) + tem*eta(ic)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
                    <a href="convection_d.html#rase_d" target="diffFile">rmfp(l) = tem*eta(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">rmfc(l) = rmfc(l) + rmfp(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">dllx(l) = dllx(l) + tem*dll0(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (cvw(l) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                      <a href="convection_d.html#rase_d" target="diffFile">updfrp(l) = rmfp(l)*(ddt/daylen)*<code class="constant">1000.</code>/(cvw(l)*prs<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                       </code>(l))</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
                      <a href="convection_d.html#rase_d" target="diffFile">updfrp(l) = <code class="constant">0.0</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">clli(l) = cll0(l)/eta(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">updfrc(l) = updfrc(l) + updfrp(l)</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!THETA AND Q CHANGE DUE TO CLOUD TYPE IC</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic,k</a>
                    <a href="convection_d.html#rase_d" target="diffFile">rns(l) = rns(l) + rnn(l)*tem</a>
                    <a href="convection_d.html#rase_d" target="diffFile">gmh(l) = gmh(l)*wfn</a>
                    <a href="convection_d.html#rase_d" target="diffFile">gms(l) = gms(l)*wfn</a>
                    <a href="convection_d.html#rase_d" target="diffFile">qoi(l) = qoi(l) + (gmh(l)-gms(l))*alhi</a>
                    <a href="convection_d.html#rase_d" target="diffFile">poi(l) = poi(l) + gms(l)*pki(l)*cpi</a>
                    <a href="convection_d.html#rase_d" target="diffFile">qst(l) = qst(l) + gms(l)*bet(l)*cpi</a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!*FRICFAC*0.5</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile">wfn = wfn*<code class="constant">0.5</code>*<code class="constant">1.0</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CUMULUS FRICTION</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (fricfac .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!================&gt;></code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">wfn = wfn*fricfac*<code class="funcname">EXP</code>(-(alm/friclambda))</a>
                    <a href="convection_d.html#rase_d" target="diffFile">tem = wfn*pri(k)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">ucu(k) = ucu(k) + tem*(uoi(k-<code class="constant">1</code>)-uoi(k))</a>
                    <a href="convection_d.html#rase_d" target="diffFile">vcu(k) = vcu(k) + tem*(voi(k-<code class="constant">1</code>)-voi(k))</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                      <a href="convection_d.html#rase_d" target="diffFile">tem = wfn*pri(l)</a>
                      <a href="convection_d.html#rase_d" target="diffFile">ucu(l) = ucu(l) + tem*((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                       </code>uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                      <a href="convection_d.html#rase_d" target="diffFile">vcu(l) = vcu(l) + tem*((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                       </code>voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
                    <a href="convection_d.html#rase_d" target="diffFile">tem = wfn*pri(ic)</a>
                    <a href="convection_d.html#rase_d" target="diffFile">ucu(ic) = ucu(ic) + (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
                    <a href="convection_d.html#rase_d" target="diffFile">vcu(ic) = vcu(ic) + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=ic,k</a>
                      <a href="convection_d.html#rase_d" target="diffFile">uoi(l) = uoi(l) + ucu(l)</a>
                      <a href="convection_d.html#rase_d" target="diffFile">voi(l) = voi(l) + vcu(l)</a>
                    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
                  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
                <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
              <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
            <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!CLOUD LOOP</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">SUM</code>(rmf(icmin:k)) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=icmin,k</a>
        <a href="convection_d.html#rase_d" target="diffFile">tem = pri(l)*grav</a>
        <a href="convection_d.html#rase_d" target="diffFile">cnv_prc3(i, l) = rns(l)*tem</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">tho(i, icmin:k-<code class="constant">1</code>) = poi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection_d.html#rase_d" target="diffFile">qho(i, icmin:k-<code class="constant">1</code>) = qoi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection_d.html#rase_d" target="diffFile">uho(i, icmin:k-<code class="constant">1</code>) = uoi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection_d.html#rase_d" target="diffFile">vho(i, icmin:k-<code class="constant">1</code>) = voi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection_d.html#rase_d" target="diffFile">cnv_updfrc(i, icmin:k-<code class="constant">1</code>) = updfrc(icmin:k-<code class="constant">1</code>)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!De-strap tendencies from RAS</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">wght = wgt1(i, :)</a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="comment">!Scale properly by layer masses</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">wght0 = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_d.html#rase_d" target="diffFile">wght0 = wght0 + wght(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">wght0 = (prs(k+<code class="constant">1</code>)-prs(k))/wght0</a>
      <a href="convection_d.html#rase_d" target="diffFile">wght = wght0*wght</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_d.html#rase_d" target="diffFile">tho(i, l) = tho(i, l) + wght(l)*(poi(k)-poi_sv(k))</a>
        <a href="convection_d.html#rase_d" target="diffFile">qho(i, l) = qho(i, l) + wght(l)*(qoi(k)-qoi_sv(k))</a>
        <a href="convection_d.html#rase_d" target="diffFile">uho(i, l) = uho(i, l) + wght(l)*(uoi(k)-uoi_sv(k))</a>
        <a href="convection_d.html#rase_d" target="diffFile">vho(i, l) = vho(i, l) + wght(l)*(voi(k)-voi_sv(k))</a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">flxd(i, icmin:k) = rmfd(icmin:k)*ddt/daylen</a>
      <a href="convection_d.html#rase_d" target="diffFile">clw(i, icmin:k) = cll(icmin:k)*ddt/daylen</a>
      <a href="convection_d.html#rase_d" target="diffFile">flxd(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">clw(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">IF</code> (k .LT. k0) <code class="keyword">THEN</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">flxd(i, k:k0) = <code class="constant">0.</code></a>
        <a href="convection_d.html#rase_d" target="diffFile">clw(i, k:k0) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">flxd(i, :) = <code class="constant">0.</code></a>
      <a href="convection_d.html#rase_d" target="diffFile">clw(i, :) = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">ELSE</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">flxd(i, :) = <code class="constant">0.</code></a>
    <a href="convection_d.html#rase_d" target="diffFile">clw(i, :) = <code class="constant">0.</code></a>
  <a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END IF</code></a>
<a href="convection_d.html#rase_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RASE</code></a>

<code class="keyword">SUBROUTINE </code><code class="funcname">ACRITN</code>(<code class="vardecl">pl</code>, <code class="vardecl">plb</code>, <code class="vardecl">acr</code>, <code class="vardecl">acritfac</code>)
  <code class="keyword">IMPLICIT NONE</code>
  <code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">pl</code>, <code class="vardecl">plb</code>, <code class="vardecl">acritfac</code>
  <code class="typename">REAL*8</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">acr</code>
  <code class="typename">INTEGER </code>:: <code class="vardecl">iwk</code>
  <code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">ph</code>(<code class="constant">15</code>)=(/<code class="constant">150.0</code>, <code class="constant">200.0</code>, <code class="constant">250.0</code>, <code class="constant">300.0</code>, <code class="constant">350.0</code>, <code class="constant">400.0</code><code class="label">&</code>
<code class="label">&   </code>, <code class="constant">450.0</code>, <code class="constant">500.0</code>, <code class="constant">550.0</code>, <code class="constant">600.0</code>, <code class="constant">650.0</code>, <code class="constant">700.0</code>, <code class="constant">750.0</code>, <code class="constant">800.0</code>, <code class="constant">850.0</code>/)
  <code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">a</code>(<code class="constant">15</code>)=(/<code class="constant">1.6851</code>, <code class="constant">1.1686</code>, <code class="constant">0.7663</code>, <code class="constant">0.5255</code>, <code class="constant">0.4100</code>, <code class="label">&</code>
<code class="label">&   </code><code class="constant">0.3677</code>, <code class="constant">0.3151</code>, <code class="constant">0.2216</code>, <code class="constant">0.1521</code>, <code class="constant">0.1082</code>, <code class="constant">0.0750</code>, <code class="constant">0.0664</code>, <code class="constant">0.0553</code>, <code class="label">&</code>
<code class="label">&   </code><code class="constant">0.0445</code>, <code class="constant">0.0633</code>/)
  <code class="keyword">INTRINSIC </code><code class="funcname">INT</code>
  iwk = <code class="funcname">INT</code>(pl*<code class="constant">0.02 </code>- <code class="constant">0.999999999</code>)
  <code class="keyword">IF</code> (iwk .GT. <code class="constant">1 </code>.AND. iwk .LE. <code class="constant">15</code>) <code class="keyword">THEN</code>
    acr = a(iwk-<code class="constant">1</code>) + (pl-ph(iwk-<code class="constant">1</code>))*<code class="constant">.02</code>*(a(iwk)-a(iwk-<code class="constant">1</code>))
  <code class="keyword">ELSE IF</code> (iwk .GT. <code class="constant">15</code>) <code class="keyword">THEN</code>
    acr = a(<code class="constant">15</code>)
  <code class="keyword">ELSE</code>
    acr = a(<code class="constant">1</code>)
  <code class="keyword">END IF</code>
  acr = acritfac*acr*(plb-pl)
<a name="sundq3_ice"></a><code class="keyword">END SUBROUTINE </code><code class="funcname">ACRITN</code>

<a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SUNDQ3_ICE</code>(<code class="vardecl">temp</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>)</a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">f2</code>, <code class="vardecl">f3</code></a>
<a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="comment">!,RATE2,RATE3,TE1</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">xx</code>, <code class="vardecl">yy</code>, <code class="vardecl">te0</code>, <code class="vardecl">te2</code>, <code class="vardecl">jump1</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile">te0 = <code class="constant">273.</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile">te2 = <code class="constant">200.</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile">jump1 = (rate2-<code class="constant">1.0</code>)/(te0-te1)**<code class="constant">0.333</code></a>
<a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="comment">! Ice - phase treatment</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">IF</code> (temp .GE. te0) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f2 = <code class="constant">1.0</code></a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f3 = <code class="constant">1.0</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">IF</code> (temp .GE. te1 .AND. temp .LT. te0) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f2 = <code class="constant">1.0 </code>+ jump1*(te0-temp)**<code class="constant">0.3333</code></a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f3 = <code class="constant">1.0</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">IF</code> (temp .LT. te1) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f2 = rate2 + (rate3-rate2)*(te1-temp)/(te1-te2)</a>
    <a href="convection_d.html#sundq3_ice_d" target="diffFile">f3 = <code class="constant">1.0</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">IF</code> (f2 .GT. <code class="constant">27.0</code>) f2 = <code class="constant">27.0</code></a>
<a name="dqsat_ras"></a><a href="convection_d.html#sundq3_ice_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SUNDQ3_ICE</code></a>

<a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSAT_RAS</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code>, <code class="vardecl">temp</code>, <code class="vardecl">plo</code>, <code class="vardecl">lm</code>, <code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="label">&</code></a>
<a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="label">& </code><code class="vardecl">cons_airmw</code>)</a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="comment">!Inputs</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">lm</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="comment">!Outputs</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
<a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="comment">!Locals</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">k</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile">esfac = cons_h2omw/cons_airmw</a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,lm</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">tl = temp(k)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">pl = plo(k)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">pp = pl*<code class="constant">100.0</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">ti = tmintbl</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">ELSE IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">ti = tmaxtbl - <code class="constant">.001</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">ti = tl</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">it = <code class="funcname">INT</code>(tt)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">qq = (tt-it)*dqq + estblx(it)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">qsat = max_mixing_ratio</a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">dqsat = <code class="constant">0.0</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">qsat = esfac*qq*dd</a>
      <a href="convection_d.html#dqsat_ras_d" target="diffFile">dqsat = esfac*degsubs*dqq*pp*(dd*dd)</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">dqsi(k) = dqsat</a>
    <a href="convection_d.html#dqsat_ras_d" target="diffFile">qssi(k) = qsat</a>
  <a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="dqsats_ras"></a><a href="convection_d.html#dqsat_ras_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSAT_RAS</code></a>

<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSATS_RAS</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code>, <code class="vardecl">temp</code>, <code class="vardecl">plo</code>, <code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="label">&</code></a>
<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="label">& </code><code class="vardecl">cons_airmw</code>)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="comment">!Inputs</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="comment">!Outputs</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="comment">!Locals</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">esfac = cons_h2omw/cons_airmw</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">tl = temp</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">pl = plo</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">pp = pl*<code class="constant">100.0</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">ti = tmintbl</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">ELSE IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">ti = tmaxtbl - <code class="constant">.001</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">ELSE</code></a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">ti = tl</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">it = <code class="funcname">INT</code>(tt)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">qq = (tt-it)*dqq + estblx(it)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">qsat = max_mixing_ratio</a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">dqsat = <code class="constant">0.0</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">ELSE</code></a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">qsat = esfac*qq*dd</a>
    <a href="convection_d.html#dqsats_ras_d" target="diffFile">dqsat = esfac*degsubs*dqq*pp*(dd*dd)</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">dqsi = dqsat</a>
  <a href="convection_d.html#dqsats_ras_d" target="diffFile">qssi = qsat</a>
<a href="convection_d.html#dqsats_ras_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSATS_RAS</code></a>

</pre>
</body>
