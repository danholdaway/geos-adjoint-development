<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="rase_b"></a><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code>
<code class="comment">!</code>
<a href="convection.html#rase" target="origFile"><code class="comment">!  Differentiation of rase in reverse (adjoint) mode:</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   gradient     of useful results: clw cnv_prc3 tho qho vho cnv_updfrc</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                uho flxd</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   with respect to varying inputs: clw cnv_prc3 tho qho vho cnv_updfrc</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                uho flxd</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!   RW status of diff variables: clw:in-zero cnv_prc3:in-zero tho:in-out</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                qho:in-out vho:in-out cnv_updfrc:in-zero uho:in-out</code></a>
<a href="convection.html#rase" target="origFile"><code class="comment">!                flxd:in-zero</code></a>
<a href="convection.html#rase" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RASE_B</code>(<code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code>, <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code>, <code class="vardecl">seedras</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">sige</code>, <code class="vardecl">kcbl</code>, <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code>, <code class="vardecl">frland</code>, <code class="vardecl">ts</code>, <code class="vardecl">tho</code>, <code class="vardecl">thob</code>, <code class="vardecl">qho</code>, <code class="vardecl">qhob</code>, <code class="vardecl">uho</code>, <code class="vardecl">uhob</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">vho</code>, <code class="vardecl">vhob</code>, <code class="vardecl">co_auto</code>, <code class="vardecl">ple</code>, <code class="vardecl">clw</code>, <code class="vardecl">clwb</code>, <code class="vardecl">flxd</code>, <code class="vardecl">flxdb</code>, <code class="vardecl">cnv_prc3</code>, <code class="vardecl">cnv_prc3b</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">cnv_updfrc</code>, <code class="vardecl">cnv_updfrcb</code>, <code class="vardecl">rasparams</code>, <code class="vardecl">estblx</code>)</a>
  <a href="convection.html#rase" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection.html#rasei80" target="origFile"><code class="comment">!INPUTS</code></a>
  <a href="convection.html#rasei80" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code></a>
  <a href="convection.html#rasei81" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ple</code></a>
  <a href="convection.html#rasei82" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">sige</code></a>
  <a href="convection.html#rasei83" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code></a>
  <a href="convection.html#rasei84" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code></a>
  <a href="convection.html#rasei85" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">seedras</code></a>
  <a href="convection.html#rasei86" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kcbl</code></a>
  <a href="convection.html#rasei87" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ts</code>, <code class="vardecl">frland</code></a>
  <a href="convection.html#rasei88" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">co_auto</code></a>
  <a href="convection.html#rasei89" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code></a>
  <a href="convection.html#rasei90" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rasparams</code></a>
  <a href="convection.html#rasei91" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">estblx</code></a>
<a href="convection.html#rasei92" target="origFile"><code class="comment">!OUTPUTS</code></a>
  <a href="convection.html#rasei92" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">) </code>:: <code class="vardecl">clw</code>, <code class="vardecl">flxd</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0) :: <code class="vardecl">clwb</code>, <code class="vardecl">flxdb</code></a>
  <a href="convection.html#rasei93" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">) </code>:: <code class="vardecl">cnv_prc3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0) :: <code class="vardecl">cnv_prc3b</code></a>
  <a href="convection.html#rasei94" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">) </code>:: <code class="vardecl">cnv_updfrc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0) :: <code class="vardecl">cnv_updfrcb</code></a>
<a href="convection.html#rasei95" target="origFile"><code class="comment">!PROGNOSTIC</code></a>
  <a href="convection.html#rasei95" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">thob</code></a>
<a href="convection.html#rasei96" target="origFile"><code class="comment">!LOCALS</code></a>
  <a href="convection.html#rasei96" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">ic</code>, <code class="vardecl">l</code>, <code class="vardecl">kk</code>, <code class="vardecl">k</code></a>
<a href="convection.html#rasei97" target="origFile"><code class="comment">!Parameters</code></a>
  <a href="convection.html#rasei97" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">onepkap</code>=<code class="constant">1.</code>+<code class="constant">2.</code>/<code class="constant">7.</code>, <code class="vardecl">daylen</code>=<code class="constant">86400.0</code></a>
  <a href="convection.html#rasei98" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">rhmax</code>=<code class="constant">0.9999</code></a>
  <a href="convection.html#rasei99" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_qpert</code>=<code class="constant">0.0</code>, <code class="vardecl">cbl_tpert</code>=<code class="constant">1.0</code></a>
  <a href="convection.html#rasei100" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_tpert_mxocn</code>=<code class="constant">2.0</code>, <code class="vardecl">cbl_tpert_mxlnd</code>=<code class="constant">4.0</code></a>
<a href="convection.html#rasei101" target="origFile"><code class="comment">!Constants</code></a>
  <a href="convection.html#rasei101" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">grav</code>, <code class="vardecl">cp</code>, <code class="vardecl">alhl</code>, <code class="vardecl">cpbg</code>, <code class="vardecl">alhi</code>, <code class="vardecl">cpi</code>, <code class="vardecl">gravi</code>, <code class="vardecl">ddt</code>, <code class="vardecl">lbcp</code></a>
<a href="convection.html#rasei102" target="origFile"><code class="comment">!Rasparams</code></a>
  <a href="convection.html#rasei102" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fricfac</code>, <code class="vardecl">cli_crit</code>, <code class="vardecl">rasal1</code>, <code class="vardecl">rasal2</code></a>
  <a href="convection.html#rasei103" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">friclambda</code></a>
  <a href="convection.html#rasei104" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sdqv2</code>, <code class="vardecl">sdqv3</code>, <code class="vardecl">sdqvt1</code></a>
  <a href="convection.html#rasei105" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">acritfac</code>, <code class="vardecl">pblfrac</code>, <code class="vardecl">autorampb</code></a>
  <a href="convection.html#rasei106" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxdallowed</code>, <code class="vardecl">rhmn</code>, <code class="vardecl">rhmx</code></a>
  <a href="convection.html#rasei107" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">mxdiam</code></a>
  <a href="convection.html#rasei108" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2</code>, <code class="vardecl">tx3</code>, <code class="vardecl">akm</code>, <code class="vardecl">acr</code>, <code class="vardecl">alm</code>, <code class="vardecl">tth</code>, <code class="vardecl">qqh</code>, <code class="vardecl">dqx</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2b</code>, <code class="vardecl">tx3b</code>, <code class="vardecl">akmb</code>, <code class="vardecl">almb</code></a>
  <a href="convection.html#rasei109" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfn</code>, <code class="vardecl">tem</code>, <code class="vardecl">trg</code>, <code class="vardecl">trgexp</code>, <code class="vardecl">evp</code>, <code class="vardecl">wlq</code>, <code class="vardecl">qcc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfnb</code>, <code class="vardecl">temb</code>, <code class="vardecl">trgb</code>, <code class="vardecl">wlqb</code>, <code class="vardecl">qccb</code></a>
  <a href="convection.html#rasei110" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cli</code>, <code class="vardecl">te_a</code>, <code class="vardecl">c00_x</code>, <code class="vardecl">cli_crit_x</code>, <code class="vardecl">toki</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">clib</code>, <code class="vardecl">te_ab</code>, <code class="vardecl">c00_xb</code>, <code class="vardecl">cli_crit_xb</code>, <code class="vardecl">tokib</code></a>
  <a href="convection.html#rasei111" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyr</code>, <code class="vardecl">rate</code>, <code class="vardecl">cvw_x</code>, <code class="vardecl">closs</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>, <code class="vardecl">f4</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyrb</code>, <code class="vardecl">rateb</code>, <code class="vardecl">cvw_xb</code>, <code class="vardecl">clossb</code>, <code class="vardecl">f2b</code></a>
  <a href="convection.html#rasei112" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wght0</code>, <code class="vardecl">prcbl</code>, <code class="vardecl">rndu</code></a>
  <a href="convection.html#rasei113" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">lambda_min</code>, <code class="vardecl">lambda_max</code></a>
  <a href="convection.html#rasei114" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpert</code>, <code class="vardecl">qpert</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpertb</code></a>
  <a href="convection.html#rasei115" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uht</code>, <code class="vardecl">vht</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uhtb</code>, <code class="vardecl">vhtb</code></a>
  <a href="convection.html#rasei116" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_sv</code>, <code class="vardecl">qoi_sv</code>, <code class="vardecl">uoi_sv</code>, <code class="vardecl">voi_sv</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poi_svb</code>, <code class="vardecl">qoi_svb</code>, <code class="vardecl">uoi_svb</code>, <code class="vardecl">voi_svb</code></a>
  <a href="convection.html#rasei117" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi</code>, <code class="vardecl">qoi</code>, <code class="vardecl">uoi</code>, <code class="vardecl">voi</code>, <code class="vardecl">dqq</code>, <code class="vardecl">bet</code>, <code class="vardecl">gam</code>, <code class="vardecl">cll</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poib</code>, <code class="vardecl">qoib</code>, <code class="vardecl">uoib</code>, <code class="vardecl">voib</code>, <code class="vardecl">dqqb</code>, <code class="vardecl">betb</code>, <code class="vardecl">gamb</code>, <code class="label">&</code></a>
<a href="convection.html#rase" target="origFile"><code class="label">& </code><code class="vardecl">cllb</code></a>
  <a href="convection.html#rasei118" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_c</code>, <code class="vardecl">qoi_c</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poi_cb</code>, <code class="vardecl">qoi_cb</code></a>
  <a href="convection.html#rasei119" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">prh</code>, <code class="vardecl">pri</code>, <code class="vardecl">ght</code>, <code class="vardecl">dpt</code>, <code class="vardecl">dpb</code>, <code class="vardecl">pki</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">ghtb</code></a>
  <a href="convection.html#rasei120" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">ucu</code>, <code class="vardecl">vcu</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">ucub</code>, <code class="vardecl">vcub</code></a>
  <a href="convection.html#rasei121" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">cln</code>, <code class="vardecl">rns</code>, <code class="vardecl">pol</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">rnsb</code></a>
  <a href="convection.html#rasei122" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qst</code>, <code class="vardecl">ssl</code>, <code class="vardecl">rmf</code>, <code class="vardecl">rnn</code>, <code class="vardecl">rn1</code>, <code class="vardecl">rmfc</code>, <code class="vardecl">rmfp</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">qstb</code>, <code class="vardecl">sslb</code>, <code class="vardecl">rnnb</code>, <code class="vardecl">rmfpb</code></a>
  <a href="convection.html#rasei123" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">gms</code>, <code class="vardecl">eta</code>, <code class="vardecl">gmh</code>, <code class="vardecl">eht</code>, <code class="vardecl">gm1</code>, <code class="vardecl">hcc</code>, <code class="vardecl">rmfd</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">gmsb</code>, <code class="vardecl">etab</code>, <code class="vardecl">gmhb</code>, <code class="vardecl">ehtb</code>, <code class="vardecl">gm1b</code>, <code class="vardecl">hccb</code>, <code class="vardecl">rmfdb</code></a>
  <a href="convection.html#rasei124" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">hol</code>, <code class="vardecl">hst</code>, <code class="vardecl">qol</code>, <code class="vardecl">zol</code>, <code class="vardecl">hcld</code>, <code class="vardecl">cll0</code>, <code class="vardecl">cllx</code>, <code class="vardecl">clli</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">holb</code>, <code class="vardecl">hstb</code>, <code class="vardecl">qolb</code>, <code class="vardecl">zolb</code>, <code class="vardecl">hcldb</code>, <code class="vardecl">cll0b</code></a>
  <a href="convection.html#rasei125" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">bke</code>, <code class="vardecl">cvw</code>, <code class="vardecl">updfrc</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">cvwb</code>, <code class="vardecl">updfrcb</code></a>
  <a href="convection.html#rasei126" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">rasal</code>, <code class="vardecl">updfrp</code>, <code class="vardecl">bk2</code>, <code class="vardecl">dll0</code>, <code class="vardecl">dllx</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">rasalb</code>, <code class="vardecl">updfrpb</code>, <code class="vardecl">bk2b</code></a>
  <a href="convection.html#rasei127" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">wght</code>, <code class="vardecl">massf</code></a>
  <a href="convection.html#rasei128" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qss</code>, <code class="vardecl">dqs</code>, <code class="vardecl">pf</code>, <code class="vardecl">pk</code>, <code class="vardecl">tempf</code>, <code class="vardecl">zlo</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">qssb</code>, <code class="vardecl">dqsb</code>, <code class="vardecl">tempfb</code>, <code class="vardecl">zlob</code></a>
  <a href="convection.html#rasei129" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">prj</code>, <code class="vardecl">prs</code>, <code class="vardecl">qht</code>, <code class="vardecl">sht</code>, <code class="vardecl">zet</code>, <code class="vardecl">zle</code>, <code class="vardecl">pke</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">qhtb</code>, <code class="vardecl">shtb</code>, <code class="vardecl">zetb</code>, <code class="vardecl">zleb</code></a>
  <a href="convection.html#rasei130" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="convection.html#rasei131" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="convection.html#rasei132" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="convection.html#rasei133" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
  <a href="convection.html#rasei134" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
  <a href="convection.html#rasei135" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1b</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from0</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to0</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from2</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to2</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from4</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to4</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from5</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">vhob</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">uhob</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">qhob</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp2</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp0</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb9</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb8</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb7</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb6</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2b</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb5</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb4</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb19</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb3</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb18</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb2</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb17</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb16</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb0</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb15</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb14</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb13</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb12</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb11</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb10</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb40</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1b</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb39</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb38</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb37</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb36</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb35</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb34</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb33</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1b</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb32</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb31</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb30</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb29</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb28</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb27</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb26</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb25</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb24</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb23</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb22</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb21</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp9</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp8</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb20</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp7</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp6</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp5</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">y1</code></a>
  <a href="convection.html#rase" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp4</code></a>
<a href="convection.html#rasei136" target="origFile"><code class="comment">!Initialize Local Arrays</code></a>
  <a href="convection.html#rasei136" target="origFile">poi = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei137" target="origFile">qoi = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei138" target="origFile">uoi = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei139" target="origFile">voi = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei140" target="origFile">dqq = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei141" target="origFile">bet = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei142" target="origFile">gam = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei143" target="origFile">prh = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei144" target="origFile">pri = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei145" target="origFile">ght = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei146" target="origFile">dpt = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei147" target="origFile">dpb = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei148" target="origFile">pki = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei149" target="origFile">ucu = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei150" target="origFile">vcu = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei151" target="origFile">pol = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei152" target="origFile">qst = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei153" target="origFile">ssl = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei154" target="origFile">rnn = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei155" target="origFile">gms = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei156" target="origFile">eta = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei157" target="origFile">gmh = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei158" target="origFile">eht = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei159" target="origFile">gm1 = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei160" target="origFile">hcc = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei161" target="origFile">hst = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei162" target="origFile">qol = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei163" target="origFile">zol = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei164" target="origFile">hcld = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei165" target="origFile">rasal = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei166" target="origFile">bk2 = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei167" target="origFile">qss = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei168" target="origFile">dqs = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei169" target="origFile">prj = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei170" target="origFile">prs = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei171" target="origFile">qht = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei172" target="origFile">sht = <code class="constant">0.0</code></a>
  <a href="convection.html#rasei173" target="origFile">zet = <code class="constant">0.0</code></a>
<a href="convection.html#rasei174" target="origFile"><code class="comment">!Initialize Outputs</code></a>
<a href="convection.html#rasei174" target="origFile"><code class="comment">!  ---  1</code></a>
  <a href="convection.html#rasei174" target="origFile">fricfac = rasparams(<code class="constant">1</code>)</a>
<a href="convection.html#rasei175" target="origFile"><code class="comment">!  ---  4</code></a>
  <a href="convection.html#rasei175" target="origFile">cli_crit = rasparams(<code class="constant">4</code>)</a>
<a href="convection.html#rasei176" target="origFile"><code class="comment">!  ---  5</code></a>
  <a href="convection.html#rasei176" target="origFile">rasal1 = rasparams(<code class="constant">5</code>)</a>
<a href="convection.html#rasei177" target="origFile"><code class="comment">!  ---  6</code></a>
  <a href="convection.html#rasei177" target="origFile">rasal2 = rasparams(<code class="constant">6</code>)</a>
<a href="convection.html#rasei178" target="origFile"><code class="comment">!  --- 11</code></a>
  <a href="convection.html#rasei178" target="origFile">friclambda = rasparams(<code class="constant">11</code>)</a>
<a href="convection.html#rasei179" target="origFile"><code class="comment">!  --- 14</code></a>
  <a href="convection.html#rasei179" target="origFile">sdqv2 = rasparams(<code class="constant">14</code>)</a>
<a href="convection.html#rasei180" target="origFile"><code class="comment">!  --- 15</code></a>
  <a href="convection.html#rasei180" target="origFile">sdqv3 = rasparams(<code class="constant">15</code>)</a>
<a href="convection.html#rasei181" target="origFile"><code class="comment">!  --- 16</code></a>
  <a href="convection.html#rasei181" target="origFile">sdqvt1 = rasparams(<code class="constant">16</code>)</a>
<a href="convection.html#rasei182" target="origFile"><code class="comment">!  --- 17</code></a>
  <a href="convection.html#rasei182" target="origFile">acritfac = rasparams(<code class="constant">17</code>)</a>
<a href="convection.html#rasei183" target="origFile"><code class="comment">!  --- 20</code></a>
  <a href="convection.html#rasei183" target="origFile">pblfrac = rasparams(<code class="constant">20</code>)</a>
<a href="convection.html#rasei184" target="origFile"><code class="comment">!  --- 21</code></a>
  <a href="convection.html#rasei184" target="origFile">autorampb = rasparams(<code class="constant">21</code>)</a>
<a href="convection.html#rasei185" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection.html#rasei185" target="origFile">rhmn = rasparams(<code class="constant">24</code>)</a>
<a href="convection.html#rasei186" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection.html#rasei186" target="origFile">maxdallowed = rasparams(<code class="constant">23</code>)</a>
<a href="convection.html#rasei187" target="origFile"><code class="comment">!  --- 25</code></a>
  <a href="convection.html#rasei187" target="origFile">rhmx = rasparams(<code class="constant">25</code>)</a>
  <a href="convection.html#rasei188" target="origFile">grav = cons_grav</a>
  <a href="convection.html#rasei189" target="origFile">alhl = cons_alhl</a>
  <a href="convection.html#rasei190" target="origFile">cp = cons_cp</a>
  <a href="convection.html#rasei191" target="origFile">cpi = <code class="constant">1.0</code>/cp</a>
  <a href="convection.html#rasei192" target="origFile">alhi = <code class="constant">1.0</code>/alhl</a>
  <a href="convection.html#rasei193" target="origFile">gravi = <code class="constant">1.0</code>/grav</a>
  <a href="convection.html#rasei194" target="origFile">cpbg = cp*gravi</a>
  <a href="convection.html#rasei195" target="origFile">ddt = daylen/dt</a>
  <a href="convection.html#rasei196" target="origFile">lbcp = alhl*cpi</a>
  <a href="convection.html#rasei197" target="origFile">i = <code class="constant">1</code></a>
<a href="convection.html#rasei198" target="origFile"><code class="comment">!CALL FINDBASE</code></a>
  <a href="convection.html#rasei198" target="origFile">k = kcbl(i)</a>
  <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (k .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="convection.html#rasei200" target="origFile"><code class="comment">!Get saturation specific humidity and gradient wrt to T</code></a>
    <a href="convection.html#rasei200" target="origFile">pke = (ple(i, :)/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection.html#rasei201" target="origFile">pf = <code class="constant">0.5</code>*(ple(i, <code class="constant">1</code>:k0)+ple(i, <code class="constant">2</code>:k0+<code class="constant">1</code>))</a>
    <a href="convection.html#rasei202" target="origFile">pk = (pf/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection.html#rasei203" target="origFile">tempf = tho(i, :)*pk</a>
    <a href="convection.html#rasei204" target="origFile">zle = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei205" target="origFile">zlo = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei206" target="origFile">zle(k0+<code class="constant">1</code>) = <code class="constant">0.</code></a>
    <a href="convection.html#rasei210" target="origFile"><code class="keyword">DO </code>l=k0,<code class="constant">1</code>,-<code class="constant">1</code></a>
      <a href="convection.html#rasei207" target="origFile">zle(l) = tho(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l))</a>
      <a href="convection.html#rasei208" target="origFile">zlo(l) = zle(l+<code class="constant">1</code>) + cons_cp/cons_grav*(pke(l+<code class="constant">1</code>)-pk(l))*zle(l)</a>
      <a href="convection.html#rasei209" target="origFile">zle(l) = zlo(l) + cons_cp/cons_grav*(pk(l)-pke(l))*zle(l)</a>
    <a href="convection.html#rasei210" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei211" target="origFile">tpert = cbl_tpert*(ts(i)-(tempf(k0)+cons_grav*zlo(k0)/cons_cp))</a>
<a href="convection.html#rasei212" target="origFile"><code class="comment">!* ( QSSFC - Q(:,:,K0) ) [CBL_QPERT = 0.0]</code></a>
    <a href="convection.html#rasei212" target="origFile">qpert = cbl_qpert</a>
    <a href="convection.html#rasei213" target="origFile"><code class="keyword">IF</code> (tpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei214" target="origFile">tpert = <code class="constant">0.0</code></a>
      <a href="convection.html#rasei213" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="convection.html#rasei213" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei213" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei215" target="origFile">tpert = tpert</a>
    <a href="convection.html#rasei213" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei216" target="origFile"><code class="keyword">IF</code> (qpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei217" target="origFile">qpert = <code class="constant">0.0</code></a>
    <a href="convection.html#rasei216" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei218" target="origFile">qpert = qpert</a>
    <a href="convection.html#rasei216" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei219" target="origFile"><code class="keyword">IF</code> (frland(i) .LT. <code class="constant">0.1</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei220" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxocn) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei221" target="origFile">tpert = cbl_tpert_mxocn</a>
        <a href="convection.html#rasei220" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei220" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei220" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
        <a href="convection.html#rasei222" target="origFile">tpert = tpert</a>
      <a href="convection.html#rasei220" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei219" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#rasei223" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxlnd) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei224" target="origFile">tpert = cbl_tpert_mxlnd</a>
      <a href="convection.html#rasei223" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">3</code>)</a>
    <a href="convection.html#rasei223" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei223" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
      <a href="convection.html#rasei225" target="origFile">tpert = tpert</a>
    <a href="convection.html#rasei219" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei226" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS</code>(dqs, qss, tempf, pf, k0, estblx, cons_h2omw, <code class="label">&</code></a>
<a href="convection.html#rasei226" target="origFile"><code class="label">&            </code>cons_airmw)</a>
    <a href="convection.html#rasei228" target="origFile"><code class="keyword">DO </code>kk=icmin,k+<code class="constant">1</code></a>
      <a href="convection.html#rasei227" target="origFile">prj(kk) = pke(kk)</a>
    <a href="convection.html#rasei228" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei229" target="origFile">prs(icmin:k0+<code class="constant">1</code>) = ple(i, icmin:k0+<code class="constant">1</code>)</a>
    <a href="convection.html#rasei230" target="origFile">poi(icmin:k) = tho(i, icmin:k)</a>
    <a href="convection.html#rasei231" target="origFile">qoi(icmin:k) = qho(i, icmin:k)</a>
    <a href="convection.html#rasei232" target="origFile">uoi(icmin:k) = uho(i, icmin:k)</a>
    <a href="convection.html#rasei233" target="origFile">voi(icmin:k) = vho(i, icmin:k)</a>
    <a href="convection.html#rasei234" target="origFile">qst(icmin:k) = qss(icmin:k)</a>
    <a href="convection.html#rasei235" target="origFile">dqq(icmin:k) = dqs(icmin:k)</a>
<a href="convection.html#rasei236" target="origFile"><code class="comment">!Mass fraction of each layer below cloud base</code></a>
    <a href="convection.html#rasei236" target="origFile">massf(:) = wgt0(i, :)</a>
<a href="convection.html#rasei237" target="origFile"><code class="comment">!RESET PRESSURE at bottom edge of CBL </code></a>
    <a href="convection.html#rasei237" target="origFile">prcbl = prs(k)</a>
    <a href="convection.html#rasei239" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
      <a href="convection.html#rasei238" target="origFile">prcbl = prcbl + massf(l)*(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection.html#rasei239" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei240" target="origFile">prs(k+<code class="constant">1</code>) = prcbl</a>
    <a href="convection.html#rasei241" target="origFile">prj(k+<code class="constant">1</code>) = (prs(k+<code class="constant">1</code>)/<code class="constant">1000.</code>)**(cons_rgas/cons_cp)</a>
    <a href="convection.html#rasei248" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection.html#rasei242" target="origFile">pol(l) = <code class="constant">0.5</code>*(prs(l)+prs(l+<code class="constant">1</code>))</a>
      <a href="convection.html#rasei243" target="origFile">prh(l) = (prs(l+<code class="constant">1</code>)*prj(l+<code class="constant">1</code>)-prs(l)*prj(l))/(onepkap*(prs(l+<code class="constant">1</code>)-prs(<code class="label">&</code></a>
<a href="convection.html#rasei243" target="origFile"><code class="label">&       </code>l)))</a>
      <a href="convection.html#rasei244" target="origFile">pki(l) = <code class="constant">1.0</code>/prh(l)</a>
      <a href="convection.html#rasei245" target="origFile">dpt(l) = prh(l) - prj(l)</a>
      <a href="convection.html#rasei246" target="origFile">dpb(l) = prj(l+<code class="constant">1</code>) - prh(l)</a>
      <a href="convection.html#rasei247" target="origFile">pri(l) = <code class="constant">.01</code>/(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection.html#rasei248" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection.html#rasei249" target="origFile"><code class="comment">!RECALCULATE PROFILE QUAN. IN LOWEST STRAPPED LAYER</code></a>
    <a href="convection.html#rasei249" target="origFile"><code class="keyword">IF</code> (k .LE. k0) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei250" target="origFile">poi(k) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei251" target="origFile">qoi(k) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei252" target="origFile">uoi(k) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei253" target="origFile">voi(k) = <code class="constant">0.</code></a>
<a href="convection.html#rasei254" target="origFile"><code class="comment">!SPECIFY WEIGHTS GIVEN TO EACH LAYER WITHIN SUBCLOUD "SUPERLAYER"</code></a>
      <a href="convection.html#rasei254" target="origFile">wght = <code class="constant">0.</code></a>
      <a href="convection.html#rasei256" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection.html#rasei255" target="origFile">wght(l) = massf(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))/(prs(k+<code class="constant">1</code>)-prs(k))</a>
      <a href="convection.html#rasei256" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei261" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection.html#rasei257" target="origFile">poi(k) = poi(k) + wght(l)*tho(i, l)</a>
        <a href="convection.html#rasei258" target="origFile">qoi(k) = qoi(k) + wght(l)*qho(i, l)</a>
        <a href="convection.html#rasei259" target="origFile">uoi(k) = uoi(k) + wght(l)*uho(i, l)</a>
        <a href="convection.html#rasei260" target="origFile">voi(k) = voi(k) + wght(l)*vho(i, l)</a>
<a name="rase_bi263"></a>      <a href="convection.html#rasei261" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei262" target="origFile">arg1 = poi(k)*prh(k)</a>
      <a href="convection.html#rasei264" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS</code>(dqq(k), qst(k), arg1, pol(k), estblx, cons_h2omw, <code class="label">&</code></a>
<a href="convection.html#rasei264" target="origFile"><code class="label">&               </code>cons_airmw)</a>
      <a href="convection.html#rasei249" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="convection.html#rasei249" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei249" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="convection.html#rasei249" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei265" target="origFile"><code class="keyword">IF</code> (seedras(i)/<code class="constant">1000000. </code>.LT. <code class="constant">1e-6</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei266" target="origFile">rndu = <code class="constant">1e-6</code></a>
    <a href="convection.html#rasei265" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei267" target="origFile">rndu = seedras(i)/<code class="constant">1000000.</code></a>
    <a href="convection.html#rasei265" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei268" target="origFile">mxdiam = maxdallowed*rndu**(-(<code class="constant">1.</code>/<code class="constant">2.</code>))</a>
    <a href="convection.html#rasei274" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a href="convection.html#rasei269" target="origFile"><code class="comment">!*</code></a>
      <a href="convection.html#rasei269" target="origFile">bet(l) = dqq(l)*pki(l)</a>
<a href="convection.html#rasei270" target="origFile"><code class="comment">!*</code></a>
      <a href="convection.html#rasei270" target="origFile">gam(l) = pki(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))</a>
      <a href="convection.html#rasei271" target="origFile"><code class="keyword">IF</code> (l .LT. k) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei272" target="origFile">ght(l+<code class="constant">1</code>) = gam(l)*dpb(l) + gam(l+<code class="constant">1</code>)*dpt(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei273" target="origFile">gm1(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*(dqq(l)/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))+dqq(l+<code class="constant">1</code>)/(<code class="label">&</code></a>
<a href="convection.html#rasei273" target="origFile"><code class="label">&         </code>alhl*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))))</a>
        <a href="convection.html#rasei271" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei271" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei271" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="convection.html#rasei271" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei274" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei275" target="origFile">rmf = <code class="constant">0.</code></a>
    <a href="convection.html#rasei276" target="origFile">cvw = <code class="constant">0.0</code></a>
<a href="convection.html#rasei277" target="origFile"><code class="comment">! HOL initialized here in order not to confuse Valgrind debugger</code></a>
    <a href="convection.html#rasei277" target="origFile">hol = <code class="constant">0.</code></a>
    <a href="convection.html#rasei278" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0</code></a>
    <a href="convection.html#rasei279" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi(k)*prj(k+<code class="constant">1</code>)</a>
    <a href="convection.html#rasei296" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
      <a href="convection.html#rasei284" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi(l)) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei285" target="origFile">qol(l) = qoi(l)</a>
        <a href="convection.html#rasei284" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="convection.html#rasei284" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei286" target="origFile">qol(l) = qst(l)*rhmax</a>
        <a href="convection.html#rasei284" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei284" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei287" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei287" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="convection.html#rasei288" target="origFile">qol(l) = qol(l)</a>
      <a href="convection.html#rasei287" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei289" target="origFile">qol(l) = <code class="constant">0.000</code></a>
        <a href="convection.html#rasei287" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei287" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei290" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi(l) + grav*zet(l+<code class="constant">1</code>)</a>
      <a href="convection.html#rasei291" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
      <a href="convection.html#rasei292" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
      <a href="convection.html#rasei293" target="origFile">tem = poi(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
      <a href="convection.html#rasei294" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
      <a href="convection.html#rasei295" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi(l)*cpbg</a>
    <a href="convection.html#rasei296" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei473" target="origFile"><code class="keyword">DO </code>ic=k,icmin+<code class="constant">1</code>,-<code class="constant">1</code></a>
      <a href="convection.html#rasei297" target="origFile">ucu(icmin:) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei298" target="origFile">vcu(icmin:) = <code class="constant">0.</code></a>
      <a href="convection.html#rasei299" target="origFile"><code class="keyword">IF</code> (<code class="constant">1. </code>.GT. (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei300" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(trg)</a>
        <a href="convection.html#rasei300" target="origFile">trg = (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)</a>
        <a href="convection.html#rasei299" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="convection.html#rasei299" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei301" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(trg)</a>
        <a href="convection.html#rasei301" target="origFile">trg = <code class="constant">1.</code></a>
        <a href="convection.html#rasei299" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei299" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei302" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.0 </code>.LT. (autorampb-sige(ic))/<code class="constant">0.2</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei303" target="origFile">y1 = (autorampb-sige(ic))/<code class="constant">0.2</code></a>
      <a href="convection.html#rasei302" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei304" target="origFile">y1 = <code class="constant">0.0</code></a>
      <a href="convection.html#rasei302" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei305" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.0 </code>.GT. y1) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei306" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f4)</a>
        <a href="convection.html#rasei306" target="origFile">f4 = y1</a>
        <a href="convection.html#rasei305" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="convection.html#rasei305" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei307" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f4)</a>
        <a href="convection.html#rasei307" target="origFile">f4 = <code class="constant">1.0</code></a>
        <a href="convection.html#rasei305" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="convection.html#rasei305" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei308" target="origFile"><code class="keyword">IF</code> (trg .LE. <code class="constant">1.0e-5</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei308" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">6</code>)</a>
      <a href="convection.html#rasei308" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei309" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection.html#rasei309" target="origFile"><code class="comment">!RECOMPUTE SOUNDING UP TO DETRAINMENT LEVEL</code></a>
        <a href="convection.html#rasei309" target="origFile">poi_c = poi</a>
        <a href="convection.html#rasei310" target="origFile">qoi_c = qoi</a>
        <a href="convection.html#rasei311" target="origFile">poi_c(k) = poi_c(k) + tpert</a>
        <a href="convection.html#rasei312" target="origFile">qoi_c(k) = qoi_c(k) + qpert</a>
        <a href="convection.html#rasei313" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(zet(k+<code class="constant">1</code>))</a>
        <a href="convection.html#rasei313" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0.</code></a>
        <a href="convection.html#rasei314" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(sht(k+<code class="constant">1</code>))</a>
        <a href="convection.html#rasei314" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi_c(k)*prj(k+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei327" target="origFile"><code class="keyword">DO </code>l=k,ic,-<code class="constant">1</code></a>
          <a href="convection.html#rasei315" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi_c(l)) <code class="keyword">THEN</code></a>
            <a href="convection.html#rasei316" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qol(l))</a>
            <a href="convection.html#rasei316" target="origFile">qol(l) = qoi_c(l)</a>
            <a href="convection.html#rasei315" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="convection.html#rasei315" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection.html#rasei317" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qol(l))</a>
            <a href="convection.html#rasei317" target="origFile">qol(l) = qst(l)*rhmax</a>
            <a href="convection.html#rasei315" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="convection.html#rasei315" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection.html#rasei318" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
            <a href="convection.html#rasei318" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
            <a href="convection.html#rasei319" target="origFile">qol(l) = qol(l)</a>
          <a href="convection.html#rasei318" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection.html#rasei320" target="origFile">qol(l) = <code class="constant">0.000</code></a>
            <a href="convection.html#rasei318" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="convection.html#rasei318" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection.html#rasei321" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(ssl(l))</a>
          <a href="convection.html#rasei321" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi_c(l) + grav*zet(l+<code class="constant">1</code>)</a>
          <a href="convection.html#rasei322" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hol(l))</a>
          <a href="convection.html#rasei322" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
          <a href="convection.html#rasei323" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hst(l))</a>
          <a href="convection.html#rasei323" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
          <a href="convection.html#rasei324" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection.html#rasei324" target="origFile">tem = poi_c(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
          <a href="convection.html#rasei325" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(zet(l))</a>
          <a href="convection.html#rasei325" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
          <a href="convection.html#rasei326" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(zol(l))</a>
          <a href="convection.html#rasei326" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi_c(l)*cpbg</a>
        <a href="convection.html#rasei327" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection.html#rasei308" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
        <a href="convection.html#rasei308" target="origFile">ad_from = ic + <code class="constant">1</code></a>
        <a href="convection.html#rasei331" target="origFile"><code class="keyword">DO </code>l=ad_from,k</a>
          <a href="convection.html#rasei328" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection.html#rasei328" target="origFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
          <a href="convection.html#rasei329" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(sht(l))</a>
          <a href="convection.html#rasei329" target="origFile">sht(l) = ssl(l-<code class="constant">1</code>) + tem*(ssl(l)-ssl(l-<code class="constant">1</code>))</a>
          <a href="convection.html#rasei330" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qht(l))</a>
          <a href="convection.html#rasei330" target="origFile">qht(l) = <code class="constant">.5</code>*(qol(l)+qol(l-<code class="constant">1</code>))</a>
        <a href="convection.html#rasei331" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection.html#rasei308" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from)</a>
<a href="convection.html#rasei332" target="origFile"><code class="comment">!CALCULATE LAMBDA, ETA, AND WORKFUNCTION</code></a>
        <a href="convection.html#rasei332" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(lambda_min)</a>
        <a href="convection.html#rasei332" target="origFile">lambda_min = <code class="constant">.2</code>/mxdiam</a>
        <a href="convection.html#rasei333" target="origFile">lambda_max = <code class="constant">.2</code>/<code class="constant">200.</code></a>
        <a href="convection.html#rasei334" target="origFile"><code class="keyword">IF</code> (hol(k) .LE. hst(ic)) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei334" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">5</code>)</a>
        <a href="convection.html#rasei334" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei335" target="origFile"><code class="comment">!================&gt;></code></a>
<a href="convection.html#rasei335" target="origFile"><code class="comment">!LAMBDA CALCULATION: MS-A18</code></a>
          <a href="convection.html#rasei335" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
          <a href="convection.html#rasei335" target="origFile">tem = (hst(ic)-hol(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>))</a>
          <a href="convection.html#rasei334" target="origFile">ad_from0 = ic + <code class="constant">1</code></a>
          <a href="convection.html#rasei337" target="origFile"><code class="keyword">DO </code>l=ad_from0,k-<code class="constant">1</code></a>
            <a href="convection.html#rasei336" target="origFile">tem = tem + (hst(ic)-hol(l))*(zet(l)-zet(l+<code class="constant">1</code>))</a>
          <a href="convection.html#rasei337" target="origFile"><code class="keyword">END DO</code></a>
          <a href="convection.html#rasei334" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from0)</a>
          <a href="convection.html#rasei338" target="origFile"><code class="keyword">IF</code> (tem .LE. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="convection.html#rasei338" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">4</code>)</a>
          <a href="convection.html#rasei338" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei339" target="origFile"><code class="comment">!================&gt;></code></a>
            <a href="convection.html#rasei339" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(alm)</a>
            <a href="convection.html#rasei339" target="origFile">alm = (hol(k)-hst(ic))/tem</a>
            <a href="convection.html#rasei340" target="origFile"><code class="keyword">IF</code> (alm .GT. lambda_max) <code class="keyword">THEN</code></a>
              <a href="convection.html#rasei340" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">3</code>)</a>
            <a href="convection.html#rasei340" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei341" target="origFile"><code class="comment">!================&gt;></code></a>
              <a href="convection.html#rasei341" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(toki)</a>
              <a href="convection.html#rasei341" target="origFile">toki = <code class="constant">1.0</code></a>
              <a href="convection.html#rasei342" target="origFile"><code class="keyword">IF</code> (alm .LT. lambda_min) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei343" target="origFile">toki = (alm/lambda_min)**<code class="constant">2</code></a>
                <a href="convection.html#rasei342" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
              <a href="convection.html#rasei342" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection.html#rasei342" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
              <a href="convection.html#rasei342" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei340" target="origFile">ad_from1 = ic + <code class="constant">1</code></a>
<a href="convection.html#rasei345" target="origFile"><code class="comment">!ETA CALCULATION: MS-A2</code></a>
              <a href="convection.html#rasei345" target="origFile"><code class="keyword">DO </code>l=ad_from1,k</a>
                <a href="convection.html#rasei344" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(eta(l))</a>
                <a href="convection.html#rasei344" target="origFile">eta(l) = <code class="constant">1.0 </code>+ alm*(zet(l)-zet(k))</a>
              <a href="convection.html#rasei345" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection.html#rasei340" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from1)</a>
              <a href="convection.html#rasei346" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(eta(ic))</a>
              <a href="convection.html#rasei346" target="origFile">eta(ic) = <code class="constant">1.0 </code>+ alm*(zol(ic)-zet(k))</a>
<a href="convection.html#rasei347" target="origFile"><code class="comment">!WORKFUNCTION CALCULATION:  MS-A22</code></a>
              <a href="convection.html#rasei347" target="origFile">wfn = <code class="constant">0.0</code></a>
              <a href="convection.html#rasei348" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hcc(k))</a>
              <a href="convection.html#rasei348" target="origFile">hcc(k) = hol(k)</a>
              <a href="convection.html#rasei353" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                <a href="convection.html#rasei349" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hcc(l))</a>
                <a href="convection.html#rasei349" target="origFile">hcc(l) = hcc(l+<code class="constant">1</code>) + (eta(l)-eta(l+<code class="constant">1</code>))*hol(l)</a>
                <a href="convection.html#rasei350" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                <a href="convection.html#rasei350" target="origFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
                <a href="convection.html#rasei351" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(eht(l))</a>
                <a href="convection.html#rasei351" target="origFile">eht(l) = eta(l+<code class="constant">1</code>)*dpb(l) + eta(l)*dpt(l)</a>
                <a href="convection.html#rasei352" target="origFile">wfn = wfn + (tem-eht(l)*hst(l))*gam(l)</a>
              <a href="convection.html#rasei353" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection.html#rasei340" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
              <a href="convection.html#rasei354" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hcc(ic))</a>
              <a href="convection.html#rasei354" target="origFile">hcc(ic) = hst(ic)*eta(ic)</a>
              <a href="convection.html#rasei355" target="origFile">wfn = wfn + (hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*gam(ic)*dpb(ic)</a>
<a href="convection.html#rasei356" target="origFile"><code class="comment">!VERTICAL VELOCITY/KE CALCULATION (ADDED 12/2001 JTB)</code></a>
              <a href="convection.html#rasei356" target="origFile">bk2(k) = <code class="constant">0.0</code></a>
              <a href="convection.html#rasei357" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hcld(k))</a>
              <a href="convection.html#rasei357" target="origFile">hcld(k) = hol(k)</a>
              <a href="convection.html#rasei368" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                <a href="convection.html#rasei358" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(hcld(l))</a>
                <a href="convection.html#rasei358" target="origFile">hcld(l) = (eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))/<code class="label">&</code></a>
<a href="convection.html#rasei358" target="origFile"><code class="label">&                 </code>eta(l)</a>
                <a href="convection.html#rasei359" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                <a href="convection.html#rasei359" target="origFile">tem = (hcld(l)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))/(<code class="constant">1.0</code>+lbcp*dqq(l<code class="label">&</code></a>
<a href="convection.html#rasei359" target="origFile"><code class="label">&                 </code>))</a>
                <a href="convection.html#rasei360" target="origFile"><code class="keyword">IF</code> (tem .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei361" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(max1)</a>
                  <a href="convection.html#rasei361" target="origFile">max1 = <code class="constant">0.0</code></a>
                  <a href="convection.html#rasei360" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                <a href="convection.html#rasei360" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei362" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(max1)</a>
                  <a href="convection.html#rasei362" target="origFile">max1 = tem</a>
                  <a href="convection.html#rasei360" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                <a href="convection.html#rasei360" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei363" target="origFile">bk2(l) = bk2(l+<code class="constant">1</code>) + grav*max1/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection.html#rasei364" target="origFile"><code class="keyword">IF</code> (bk2(l) .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei365" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(max2)</a>
                  <a href="convection.html#rasei365" target="origFile">max2 = <code class="constant">0.0</code></a>
                  <a href="convection.html#rasei364" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                <a href="convection.html#rasei364" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei366" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(max2)</a>
                  <a href="convection.html#rasei366" target="origFile">max2 = bk2(l)</a>
                  <a href="convection.html#rasei364" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                <a href="convection.html#rasei364" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei367" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cvw(l))</a>
                <a href="convection.html#rasei367" target="origFile">cvw(l) = <code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
              <a href="convection.html#rasei368" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection.html#rasei340" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
<a href="convection.html#rasei369" target="origFile"><code class="comment">!ALPHA CALCULATION </code></a>
              <a href="convection.html#rasei369" target="origFile"><code class="keyword">IF</code> (zet(ic) .LT. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei370" target="origFile">rasal(ic) = rasal1</a>
                <a href="convection.html#rasei369" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
              <a href="convection.html#rasei369" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection.html#rasei369" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
              <a href="convection.html#rasei369" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei371" target="origFile"><code class="keyword">IF</code> (zet(ic) .GE. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei372" target="origFile">rasal(ic) = rasal1 + (rasal2-rasal1)*(zet(ic)-<code class="constant">2000.</code>)/<code class="label">&</code></a>
<a href="convection.html#rasei372" target="origFile"><code class="label">&                 </code><code class="constant">8000.</code></a>
                <a href="convection.html#rasei371" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
              <a href="convection.html#rasei371" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection.html#rasei371" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
              <a href="convection.html#rasei371" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei373" target="origFile"><code class="keyword">IF</code> (rasal(ic) .GT. <code class="constant">1.0e5</code>) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei374" target="origFile">rasal(ic) = <code class="constant">1.0e5</code></a>
                <a href="convection.html#rasei373" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
              <a href="convection.html#rasei373" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection.html#rasei373" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                <a href="convection.html#rasei375" target="origFile">rasal(ic) = rasal(ic)</a>
              <a href="convection.html#rasei373" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei376" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rasal(ic))</a>
              <a href="convection.html#rasei376" target="origFile">rasal(ic) = dt/rasal(ic)</a>
              <a href="convection.html#rasei340" target="origFile">ad_from2 = ic</a>
              <a href="convection.html#rasei380" target="origFile"><code class="keyword">DO </code>l=ad_from2,k</a>
                <a href="convection.html#rasei377" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei378" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cvw(l))</a>
                  <a href="convection.html#rasei378" target="origFile">cvw(l) = <code class="constant">1.00</code></a>
                  <a href="convection.html#rasei377" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                <a href="convection.html#rasei377" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection.html#rasei379" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cvw(l))</a>
                  <a href="convection.html#rasei379" target="origFile">cvw(l) = cvw(l)</a>
                  <a href="convection.html#rasei377" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                <a href="convection.html#rasei377" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei380" target="origFile"><code class="keyword">END DO</code></a>
              <a href="convection.html#rasei340" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from2)</a>
              <a href="convection.html#rasei381" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(acr)</a>
              <a href="convection.html#rasei381" target="origFile"><code class="keyword">CALL </code><code class="funcname">ACRITN</code>(pol(ic), prs(k), acr, acritfac)</a>
              <a href="convection.html#rasei382" target="origFile"><code class="keyword">IF</code> (wfn .LE. acr) <code class="keyword">THEN</code></a>
                <a href="convection.html#rasei382" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">2</code>)</a>
              <a href="convection.html#rasei382" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei383" target="origFile"><code class="comment">!================&gt;></code></a>
                <a href="convection.html#rasei383" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wlq)</a>
                <a href="convection.html#rasei383" target="origFile">wlq = qol(k)</a>
                <a href="convection.html#rasei384" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(uht)</a>
                <a href="convection.html#rasei384" target="origFile">uht = uoi(k)</a>
                <a href="convection.html#rasei385" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(vht)</a>
                <a href="convection.html#rasei385" target="origFile">vht = voi(k)</a>
                <a href="convection.html#rasei386" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rnn(k))</a>
                <a href="convection.html#rasei386" target="origFile">rnn(k) = <code class="constant">0.</code></a>
                <a href="convection.html#rasei420" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
                  <a href="convection.html#rasei388" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                  <a href="convection.html#rasei388" target="origFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei389" target="origFile">wlq = wlq + tem*qol(l)</a>
                  <a href="convection.html#rasei390" target="origFile">uht = uht + tem*uoi(l)</a>
                  <a href="convection.html#rasei391" target="origFile">vht = vht + tem*voi(l)</a>
                  <a href="convection.html#rasei392" target="origFile"><code class="keyword">IF</code> (l .GT. ic) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei393" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tx2)</a>
                    <a href="convection.html#rasei393" target="origFile">tx2 = <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection.html#rasei394" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tx3)</a>
                    <a href="convection.html#rasei394" target="origFile">tx3 = <code class="constant">0.5</code>*(hst(l)+hst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection.html#rasei395" target="origFile">qcc = tx2 + gm1(l)*(hcc(l)-tx3)</a>
                    <a href="convection.html#rasei396" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cll0(l))</a>
                    <a href="convection.html#rasei396" target="origFile">cll0(l) = wlq - qcc</a>
                    <a href="convection.html#rasei392" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei392" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei397" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cll0(l))</a>
                    <a href="convection.html#rasei397" target="origFile">cll0(l) = wlq - qst(ic)*eta(ic)</a>
                    <a href="convection.html#rasei392" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei392" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection.html#rasei398" target="origFile"><code class="keyword">IF</code> (cll0(l) .LT. <code class="constant">0.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei399" target="origFile">cll0(l) = <code class="constant">0.00</code></a>
                    <a href="convection.html#rasei398" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei398" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei398" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                    <a href="convection.html#rasei400" target="origFile">cll0(l) = cll0(l)</a>
                  <a href="convection.html#rasei398" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection.html#rasei401" target="origFile">cli = cll0(l)/eta(l)</a>
                  <a href="convection.html#rasei402" target="origFile">te_a = poi(l)*prh(l)</a>
                  <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f3)</a>
                  <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f2)</a>
                  <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE</code>(te_a, sdqv2, sdqv3, sdqvt1, f2, f3)</a>
                  <a href="convection.html#rasei404" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(c00_x)</a>
                  <a href="convection.html#rasei404" target="origFile">c00_x = co_auto(i)*f2*f3*f4</a>
                  <a href="convection.html#rasei405" target="origFile">cli_crit_x = cli_crit/(f2*f3)</a>
                  <a href="convection.html#rasei406" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rate)</a>
                  <a href="convection.html#rasei406" target="origFile">rate = c00_x*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(-(cli**<code class="constant">2</code>/cli_crit_x**<code class="constant">2</code>)))</a>
                  <a href="convection.html#rasei407" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei408" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cvw_x)</a>
                    <a href="convection.html#rasei408" target="origFile">cvw_x = <code class="constant">1.00</code></a>
                    <a href="convection.html#rasei407" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei407" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei409" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(cvw_x)</a>
                    <a href="convection.html#rasei409" target="origFile">cvw_x = cvw(l)</a>
                    <a href="convection.html#rasei407" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei407" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection.html#rasei410" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
                  <a href="convection.html#rasei411" target="origFile">closs = cll0(l)*rate*dt_lyr</a>
                  <a href="convection.html#rasei412" target="origFile"><code class="keyword">IF</code> (closs .GT. cll0(l)) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei413" target="origFile">closs = cll0(l)</a>
                    <a href="convection.html#rasei412" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei412" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei414" target="origFile">closs = closs</a>
                    <a href="convection.html#rasei412" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei412" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection.html#rasei415" target="origFile"><code class="keyword">IF</code> (closs .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei417" target="origFile">wlq = wlq - closs</a>
                    <a href="convection.html#rasei418" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rnn(l))</a>
                    <a href="convection.html#rasei418" target="origFile">rnn(l) = closs</a>
                    <a href="convection.html#rasei415" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei415" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei419" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rnn(l))</a>
                    <a href="convection.html#rasei419" target="origFile">rnn(l) = <code class="constant">0.</code></a>
                    <a href="convection.html#rasei415" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei415" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei420" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection.html#rasei382" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
                <a href="convection.html#rasei421" target="origFile">wlq = wlq - qst(ic)*eta(ic)</a>
<a href="convection.html#rasei422" target="origFile"><code class="comment">!CALCULATE GAMMAS AND KERNEL</code></a>
                <a href="convection.html#rasei422" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gms(k))</a>
                <a href="convection.html#rasei422" target="origFile">gms(k) = (sht(k)-ssl(k))*pri(k)</a>
                <a href="convection.html#rasei423" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gmh(k))</a>
                <a href="convection.html#rasei423" target="origFile">gmh(k) = gms(k) + (qht(k)-qol(k))*pri(k)*alhl</a>
                <a href="convection.html#rasei424" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(akm)</a>
                <a href="convection.html#rasei424" target="origFile">akm = gmh(k)*gam(k-<code class="constant">1</code>)*dpb(k-<code class="constant">1</code>)</a>
                <a href="convection.html#rasei425" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tx2)</a>
                <a href="convection.html#rasei425" target="origFile">tx2 = gmh(k)</a>
                <a href="convection.html#rasei430" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                  <a href="convection.html#rasei426" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gms(l))</a>
                  <a href="convection.html#rasei426" target="origFile">gms(l) = (eta(l)*(sht(l)-ssl(l))+eta(l+<code class="constant">1</code>)*(ssl(l)-sht(<code class="label">&</code></a>
<a href="convection.html#rasei426" target="origFile"><code class="label">&                   </code>l+<code class="constant">1</code>)))*pri(l)</a>
                  <a href="convection.html#rasei427" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gmh(l))</a>
                  <a href="convection.html#rasei427" target="origFile">gmh(l) = gms(l) + (eta(l)*(qht(l)-qol(l))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a href="convection.html#rasei427" target="origFile"><code class="label">&                   </code>qol(l)-qht(l+<code class="constant">1</code>)))*alhl*pri(l)</a>
                  <a href="convection.html#rasei428" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tx2)</a>
                  <a href="convection.html#rasei428" target="origFile">tx2 = tx2 + (eta(l)-eta(l+<code class="constant">1</code>))*gmh(l)</a>
                  <a href="convection.html#rasei429" target="origFile">akm = akm - gms(l)*eht(l)*pki(l) + tx2*ght(l)</a>
                <a href="convection.html#rasei430" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection.html#rasei382" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
                <a href="convection.html#rasei431" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gms(ic))</a>
                <a href="convection.html#rasei431" target="origFile">gms(ic) = eta(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*pri(ic)</a>
                <a href="convection.html#rasei432" target="origFile">akm = akm - gms(ic)*eta(ic+<code class="constant">1</code>)*dpb(ic)*pki(ic)</a>
                <a href="convection.html#rasei433" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gmh(ic))</a>
                <a href="convection.html#rasei433" target="origFile">gmh(ic) = gms(ic) + (eta(ic+<code class="constant">1</code>)*(qol(ic)-qht(ic+<code class="constant">1</code>))*alhl+<code class="label">&</code></a>
<a href="convection.html#rasei433" target="origFile"><code class="label">&                 </code>eta(ic)*(hst(ic)-hol(ic)))*pri(ic)</a>
<a href="convection.html#rasei434" target="origFile"><code class="comment">!CLOUD BASE MASS FLUX</code></a>
                <a href="convection.html#rasei434" target="origFile"><code class="keyword">IF</code> (akm .GE. <code class="constant">0.0 </code>.OR. wlq .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                  <a href="convection.html#rasei434" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">1</code>)</a>
                <a href="convection.html#rasei434" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei435" target="origFile"><code class="comment">!================&gt;></code></a>
                  <a href="convection.html#rasei435" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wfn)</a>
                  <a href="convection.html#rasei435" target="origFile">wfn = -((wfn-acr)/akm)</a>
                  <a href="convection.html#rasei436" target="origFile">x1 = rasal(ic)*trg*toki*wfn</a>
                  <a href="convection.html#rasei437" target="origFile"><code class="keyword">IF</code> (x1 .GT. (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei438" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wfn)</a>
                    <a href="convection.html#rasei438" target="origFile">wfn = (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)</a>
                    <a href="convection.html#rasei437" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei437" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection.html#rasei439" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wfn)</a>
                    <a href="convection.html#rasei439" target="origFile">wfn = x1</a>
                    <a href="convection.html#rasei437" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                  <a href="convection.html#rasei437" target="origFile"><code class="keyword">END IF</code></a>
<a href="convection.html#rasei440" target="origFile"><code class="comment">!CUMULATIVE PRECIP AND CLOUD-BASE MASS FLUX FOR OUTPUT</code></a>
                  <a href="convection.html#rasei440" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                  <a href="convection.html#rasei440" target="origFile">tem = wfn*gravi</a>
                  <a href="convection.html#rasei441" target="origFile">rmf(ic) = rmf(ic) + tem</a>
                  <a href="convection.html#rasei434" target="origFile">ad_from3 = ic + <code class="constant">1</code></a>
                  <a href="convection.html#rasei449" target="origFile"><code class="keyword">DO </code>l=ad_from3,k</a>
                    <a href="convection.html#rasei444" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(rmfp(l))</a>
                    <a href="convection.html#rasei444" target="origFile">rmfp(l) = tem*eta(l)</a>
                    <a href="convection.html#rasei445" target="origFile"><code class="keyword">IF</code> (cvw(l) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                      <a href="convection.html#rasei445" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
                    <a href="convection.html#rasei445" target="origFile"><code class="keyword">ELSE</code></a>
                      <a href="convection.html#rasei445" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
                    <a href="convection.html#rasei445" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection.html#rasei449" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection.html#rasei434" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from3)</a>
                  <a href="convection.html#rasei434" target="origFile">ad_from4 = ic</a>
<a href="convection.html#rasei456" target="origFile"><code class="comment">!THETA AND Q CHANGE DUE TO CLOUD TYPE IC</code></a>
                  <a href="convection.html#rasei456" target="origFile"><code class="keyword">DO </code>l=ad_from4,k</a>
                    <a href="convection.html#rasei450" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gmh(l))</a>
                    <a href="convection.html#rasei450" target="origFile">gmh(l) = gmh(l)*wfn</a>
                    <a href="convection.html#rasei451" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(gms(l))</a>
                    <a href="convection.html#rasei451" target="origFile">gms(l) = gms(l)*wfn</a>
                    <a href="convection.html#rasei452" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qoi(l))</a>
                    <a href="convection.html#rasei452" target="origFile">qoi(l) = qoi(l) + (gmh(l)-gms(l))*alhi</a>
                    <a href="convection.html#rasei453" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(poi(l))</a>
                    <a href="convection.html#rasei453" target="origFile">poi(l) = poi(l) + gms(l)*pki(l)*cpi</a>
                    <a href="convection.html#rasei454" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qst(l))</a>
                    <a href="convection.html#rasei454" target="origFile">qst(l) = qst(l) + gms(l)*bet(l)*cpi</a>
                  <a href="convection.html#rasei456" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection.html#rasei434" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from4)</a>
<a href="convection.html#rasei457" target="origFile"><code class="comment">!*FRICFAC*0.5</code></a>
                  <a href="convection.html#rasei457" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wfn)</a>
                  <a href="convection.html#rasei457" target="origFile">wfn = wfn*<code class="constant">0.5</code>*<code class="constant">1.0</code></a>
<a href="convection.html#rasei458" target="origFile"><code class="comment">!CUMULUS FRICTION</code></a>
                  <a href="convection.html#rasei458" target="origFile"><code class="keyword">IF</code> (fricfac .LE. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                    <a href="convection.html#rasei458" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">0</code>)</a>
                  <a href="convection.html#rasei458" target="origFile"><code class="keyword">ELSE</code></a>
<a href="convection.html#rasei459" target="origFile"><code class="comment">!================&gt;></code></a>
                    <a href="convection.html#rasei459" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(wfn)</a>
                    <a href="convection.html#rasei459" target="origFile">wfn = wfn*fricfac*<code class="funcname">EXP</code>(-(alm/friclambda))</a>
                    <a href="convection.html#rasei460" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                    <a href="convection.html#rasei460" target="origFile">tem = wfn*pri(k)</a>
                    <a href="convection.html#rasei461" target="origFile">ucu(k) = ucu(k) + tem*(uoi(k-<code class="constant">1</code>)-uoi(k))</a>
                    <a href="convection.html#rasei462" target="origFile">vcu(k) = vcu(k) + tem*(voi(k-<code class="constant">1</code>)-voi(k))</a>
                    <a href="convection.html#rasei466" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                      <a href="convection.html#rasei463" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                      <a href="convection.html#rasei463" target="origFile">tem = wfn*pri(l)</a>
                      <a href="convection.html#rasei464" target="origFile">ucu(l) = ucu(l) + tem*((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection.html#rasei464" target="origFile"><code class="label">&                       </code>uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                      <a href="convection.html#rasei465" target="origFile">vcu(l) = vcu(l) + tem*((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection.html#rasei465" target="origFile"><code class="label">&                       </code>voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                    <a href="convection.html#rasei466" target="origFile"><code class="keyword">END DO</code></a>
                    <a href="convection.html#rasei458" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(l + <code class="constant">1</code>)</a>
                    <a href="convection.html#rasei467" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
                    <a href="convection.html#rasei467" target="origFile">tem = wfn*pri(ic)</a>
                    <a href="convection.html#rasei468" target="origFile">ucu(ic) = ucu(ic) + (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection.html#rasei468" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
                    <a href="convection.html#rasei469" target="origFile">vcu(ic) = vcu(ic) + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection.html#rasei469" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
                    <a href="convection.html#rasei458" target="origFile">ad_from5 = ic</a>
                    <a href="convection.html#rasei472" target="origFile"><code class="keyword">DO </code>l=ad_from5,k</a>
                      <a href="convection.html#rasei470" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(uoi(l))</a>
                      <a href="convection.html#rasei470" target="origFile">uoi(l) = uoi(l) + ucu(l)</a>
                      <a href="convection.html#rasei471" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(voi(l))</a>
                      <a href="convection.html#rasei471" target="origFile">voi(l) = voi(l) + vcu(l)</a>
                    <a href="convection.html#rasei472" target="origFile"><code class="keyword">END DO</code></a>
                    <a href="convection.html#rasei458" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from5)</a>
                    <a href="convection.html#rasei458" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL3B</code>(<code class="constant">7</code>)</a>
                  <a href="convection.html#rasei458" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection.html#rasei434" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection.html#rasei382" target="origFile"><code class="keyword">END IF</code></a>
            <a href="convection.html#rasei340" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection.html#rasei338" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei334" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei308" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei473" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection.html#rasei474" target="origFile"><code class="comment">!CLOUD LOOP</code></a>
    <a href="convection.html#rasei474" target="origFile"><code class="keyword">IF</code> (<code class="funcname">SUM</code>(rmf(icmin:k)) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei477" target="origFile"><code class="keyword">DO </code>l=icmin,k</a>
        <a href="convection.html#rasei475" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(tem)</a>
      <a href="convection.html#rasei477" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection.html#rasei479" target="origFile"><code class="comment">!De-strap tendencies from RAS</code></a>
      <a href="convection.html#rasei479" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8ARRAY</code>(wght, k0)</a>
      <a href="convection.html#rasei479" target="origFile">wght = wgt1(i, :)</a>
<a href="convection.html#rasei480" target="origFile"><code class="comment">!Scale properly by layer masses</code></a>
      <a href="convection.html#rasei480" target="origFile">wght0 = <code class="constant">0.</code></a>
      <a href="convection.html#rasei486" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection.html#rasei485" target="origFile">wght0 = wght0 + wght(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))</a>
      <a href="convection.html#rasei486" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei487" target="origFile">wght0 = (prs(k+<code class="constant">1</code>)-prs(k))/wght0</a>
      <a href="convection.html#rasei488" target="origFile">wght = wght0*wght</a>
      <a href="convection.html#rasei496" target="origFile"><code class="keyword">IF</code> (k .LT. k0) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei496" target="origFile">clwb(i, k:k0) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei496" target="origFile">flxdb(i, k:k0) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei496" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi194"></a>      <a href="convection.html#rasei474" target="origFile">clwb(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">flxdb(i, <code class="constant">1</code>:icmin-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi195"></a>      <a href="convection.html#rasei495" target="origFile">cllb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei495" target="origFile">cllb(icmin:k) = cllb(icmin:k) + ddt*clwb(i, icmin:k)/daylen</a>
      <a href="convection.html#rasei494" target="origFile">rmfdb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei494" target="origFile">rmfdb(icmin:k) = rmfdb(icmin:k) + ddt*flxdb(i, icmin:k)/daylen</a>
      <a href="convection.html#rasei474" target="origFile">qoi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">uoi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">qoib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">voib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">poib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">poi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">uoib = <code class="constant">0.0_8</code></a>
<a name="rase_bi188"></a>      <a href="convection.html#rasei474" target="origFile">voi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile"><code class="keyword">DO </code>l=k0,k,<code class="constant">-1</code></a>
<a name="rase_bi189"></a>        <a href="convection.html#rasei489" target="origFile">voib(k) = voib(k) + wght(l)*vhob(i, l)</a>
        <a href="convection.html#rasei489" target="origFile">voi_svb(k) = voi_svb(k) - wght(l)*vhob(i, l)</a>
<a name="rase_bi190"></a>        <a href="convection.html#rasei490" target="origFile">uoib(k) = uoib(k) + wght(l)*uhob(i, l)</a>
        <a href="convection.html#rasei490" target="origFile">uoi_svb(k) = uoi_svb(k) - wght(l)*uhob(i, l)</a>
<a name="rase_bi191"></a>        <a href="convection.html#rasei491" target="origFile">qoib(k) = qoib(k) + wght(l)*qhob(i, l)</a>
        <a href="convection.html#rasei491" target="origFile">qoi_svb(k) = qoi_svb(k) - wght(l)*qhob(i, l)</a>
        <a href="convection.html#rasei492" target="origFile">poib(k) = poib(k) + wght(l)*thob(i, l)</a>
<a name="rase_bi182"></a>        <a href="convection.html#rasei492" target="origFile">poi_svb(k) = poi_svb(k) - wght(l)*thob(i, l)</a>
<a name="rase_bi183"></a>      <a href="convection.html#rasei474" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei479" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8ARRAY</code>(wght, k0)</a>
      <a href="convection.html#rasei478" target="origFile">updfrcb = <code class="constant">0.0_8</code></a>
<a name="rase_bi184"></a>      <a href="convection.html#rasei478" target="origFile">updfrcb(icmin:k-<code class="constant">1</code>) = updfrcb(icmin:k-<code class="constant">1</code>) + cnv_updfrcb(i, icmin:k-<code class="constant">1</code><code class="label">&</code></a>
<a href="convection.html#rasei478" target="origFile"><code class="label">&       </code>)</a>
<a name="rase_bi185"></a>      <a href="convection.html#rasei481" target="origFile">voib(icmin:k-<code class="constant">1</code>) = voib(icmin:k-<code class="constant">1</code>) + vhob(i, icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei474" target="origFile">vhob(i, icmin:k-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi186"></a>      <a href="convection.html#rasei482" target="origFile">uoib(icmin:k-<code class="constant">1</code>) = uoib(icmin:k-<code class="constant">1</code>) + uhob(i, icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei474" target="origFile">uhob(i, icmin:k-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi187"></a>      <a href="convection.html#rasei483" target="origFile">qoib(icmin:k-<code class="constant">1</code>) = qoib(icmin:k-<code class="constant">1</code>) + qhob(i, icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei474" target="origFile">qhob(i, icmin:k-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei484" target="origFile">poib(icmin:k-<code class="constant">1</code>) = poib(icmin:k-<code class="constant">1</code>) + thob(i, icmin:k-<code class="constant">1</code>)</a>
      <a href="convection.html#rasei474" target="origFile">thob(i, icmin:k-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi475"></a>      <a href="convection.html#rasei474" target="origFile">rnsb = <code class="constant">0.0_8</code></a>
<a name="rase_bi181"></a>      <a href="convection.html#rasei474" target="origFile"><code class="keyword">DO </code>l=k,icmin,<code class="constant">-1</code></a>
        <a href="convection.html#rasei475" target="origFile">tem = pri(l)*grav</a>
        <a href="convection.html#rasei476" target="origFile">rnsb(l) = rnsb(l) + tem*cnv_prc3b(i, l)</a>
        <a href="convection.html#rasei476" target="origFile">cnv_prc3b(i, l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei475" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection.html#rasei474" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei474" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#rasei474" target="origFile">qoi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">uoi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">qoib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">voib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">updfrcb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">poib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">rnsb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">poi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">uoib = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">rmfdb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">voi_svb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei474" target="origFile">cllb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei474" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#rasei199" target="origFile">ehtb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">gm1b = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">hccb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">f2b = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">cvwb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">dqqb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">ucub = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">ghtb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">hstb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">betb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">qhtb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">tpertb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">qolb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">bk2b = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">rasalb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">hcldb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">etab = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">shtb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">gmhb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">rnnb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">qstb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">gmsb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">vcub = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">sslb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">zetb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">updfrpb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">zolb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">cll0b = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">holb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">rmfpb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile">gamb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>ic=icmin+<code class="constant">1</code>,k,<code class="constant">1</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL3B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .LT. <code class="constant">4</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .LT. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="convection.html#rasei199" target="origFile">wfnb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">vhtb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">almb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">uhtb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">wlqb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">wfnb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">vhtb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">akmb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">tokib = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">almb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile">uhtb = <code class="constant">0.0_8</code></a>
            <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE IF</code> (branch .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile">wfnb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile">tokib = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile">almb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">110</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile">almb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">120</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE IF</code> (branch .LT. <code class="constant">6</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">4</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile">temb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">130</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">140</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE IF</code> (branch .EQ. <code class="constant">6</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei199" target="origFile">trgb = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">GOTO </code><code class="label">150</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_bi179"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from5)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from5,<code class="constant">-1</code></a>
<a name="rase_bi180"></a>          <a href="convection.html#rasei471" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(voi(l))</a>
          <a href="convection.html#rasei471" target="origFile">vcub(l) = vcub(l) + voib(l)</a>
          <a href="convection.html#rasei470" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(uoi(l))</a>
<a name="rase_bi176"></a>          <a href="convection.html#rasei470" target="origFile">ucub(l) = ucub(l) + uoib(l)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection.html#rasei469" target="origFile">tempb35 = tem*vcub(ic)</a>
        <a href="convection.html#rasei469" target="origFile">tempb36 = <code class="constant">2.</code>*tempb35</a>
        <a href="convection.html#rasei469" target="origFile">tempb37 = -(eta(ic+<code class="constant">1</code>)*tempb35)</a>
        <a href="convection.html#rasei469" target="origFile">vhtb = tempb36</a>
        <a href="convection.html#rasei469" target="origFile">voib(ic) = voib(ic) + tempb37 - (eta(ic)-eta(ic+<code class="constant">1</code>))*tempb36</a>
        <a href="convection.html#rasei469" target="origFile">etab(ic) = etab(ic) - voi(ic)*tempb36</a>
        <a href="convection.html#rasei469" target="origFile">etab(ic+<code class="constant">1</code>) = etab(ic+<code class="constant">1</code>) + voi(ic)*tempb36 - (voi(ic)+voi(ic+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="convection.html#rasei469" target="origFile"><code class="label">&         </code>tempb35</a>
        <a href="convection.html#rasei469" target="origFile">voib(ic+<code class="constant">1</code>) = voib(ic+<code class="constant">1</code>) + tempb37</a>
        <a href="convection.html#rasei469" target="origFile">temb = (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic+<code class="constant">1</code>)))-(uoi(ic)+uoi(ic+<code class="constant">1</code>))<code class="label">&</code></a>
<a name="rase_bi177"></a><a href="convection.html#rasei469" target="origFile"><code class="label">&         </code>*eta(ic+<code class="constant">1</code>))*ucub(ic) + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic+<code class="constant">1</code>)))-(<code class="label">&</code></a>
<a href="convection.html#rasei469" target="origFile"><code class="label">&         </code>voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*vcub(ic)</a>
        <a href="convection.html#rasei468" target="origFile">tempb38 = tem*ucub(ic)</a>
        <a href="convection.html#rasei468" target="origFile">tempb39 = <code class="constant">2.</code>*tempb38</a>
        <a href="convection.html#rasei468" target="origFile">tempb40 = -(eta(ic+<code class="constant">1</code>)*tempb38)</a>
        <a href="convection.html#rasei468" target="origFile">uhtb = tempb39</a>
        <a href="convection.html#rasei468" target="origFile">uoib(ic) = uoib(ic) + tempb40 - (eta(ic)-eta(ic+<code class="constant">1</code>))*tempb39</a>
        <a href="convection.html#rasei468" target="origFile">etab(ic) = etab(ic) - uoi(ic)*tempb39</a>
        <a href="convection.html#rasei468" target="origFile">etab(ic+<code class="constant">1</code>) = etab(ic+<code class="constant">1</code>) + uoi(ic)*tempb39 - (uoi(ic)+uoi(ic+<code class="constant">1</code>))*<code class="label">&</code></a>
<a name="rase_bi178"></a><a href="convection.html#rasei468" target="origFile"><code class="label">&         </code>tempb38</a>
        <a href="convection.html#rasei468" target="origFile">uoib(ic+<code class="constant">1</code>) = uoib(ic+<code class="constant">1</code>) + tempb40</a>
        <a href="convection.html#rasei467" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection.html#rasei467" target="origFile">wfnb = pri(ic)*temb</a>
<a name="rase_bi173"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to4)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to4,k-<code class="constant">1</code>,<code class="constant">1</code></a>
          <a href="convection.html#rasei465" target="origFile">tempb31 = tem*vcub(l)</a>
          <a href="convection.html#rasei465" target="origFile">tempb32 = eta(l+<code class="constant">1</code>)*tempb31</a>
          <a href="convection.html#rasei465" target="origFile">temb = ((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)+(uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="convection.html#rasei465" target="origFile"><code class="label">&           </code>ucub(l) + ((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)+(voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="label">&</code></a>
<a href="convection.html#rasei465" target="origFile"><code class="label">&           </code><code class="constant">1</code>))*vcub(l)</a>
          <a href="convection.html#rasei465" target="origFile">voib(l-<code class="constant">1</code>) = voib(l-<code class="constant">1</code>) + eta(l)*tempb31</a>
          <a href="convection.html#rasei465" target="origFile">voib(l) = voib(l) + tempb32 - eta(l)*tempb31</a>
          <a href="convection.html#rasei465" target="origFile">etab(l) = etab(l) + (voi(l-<code class="constant">1</code>)-voi(l))*tempb31</a>
<a name="rase_bi174"></a>          <a href="convection.html#rasei465" target="origFile">voib(l+<code class="constant">1</code>) = voib(l+<code class="constant">1</code>) - tempb32</a>
          <a href="convection.html#rasei465" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + (voi(l)-voi(l+<code class="constant">1</code>))*tempb31</a>
          <a href="convection.html#rasei464" target="origFile">tempb33 = tem*ucub(l)</a>
          <a href="convection.html#rasei464" target="origFile">tempb34 = eta(l+<code class="constant">1</code>)*tempb33</a>
          <a href="convection.html#rasei464" target="origFile">uoib(l-<code class="constant">1</code>) = uoib(l-<code class="constant">1</code>) + eta(l)*tempb33</a>
          <a href="convection.html#rasei464" target="origFile">uoib(l) = uoib(l) + tempb34 - eta(l)*tempb33</a>
          <a href="convection.html#rasei464" target="origFile">etab(l) = etab(l) + (uoi(l-<code class="constant">1</code>)-uoi(l))*tempb33</a>
<a name="rase_bi175"></a>          <a href="convection.html#rasei464" target="origFile">uoib(l+<code class="constant">1</code>) = uoib(l+<code class="constant">1</code>) - tempb34</a>
          <a href="convection.html#rasei464" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + (uoi(l)-uoi(l+<code class="constant">1</code>))*tempb33</a>
          <a href="convection.html#rasei463" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
<a name="rase_bi169"></a>          <a href="convection.html#rasei463" target="origFile">wfnb = wfnb + pri(l)*temb</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
        <a href="convection.html#rasei462" target="origFile">temb = (uoi(k-<code class="constant">1</code>)-uoi(k))*ucub(k) + (voi(k-<code class="constant">1</code>)-voi(k))*vcub(k)</a>
<a name="rase_bi170"></a>        <a href="convection.html#rasei462" target="origFile">voib(k-<code class="constant">1</code>) = voib(k-<code class="constant">1</code>) + tem*vcub(k)</a>
        <a href="convection.html#rasei462" target="origFile">voib(k) = voib(k) - tem*vcub(k)</a>
<a name="rase_bi171"></a>        <a href="convection.html#rasei461" target="origFile">uoib(k-<code class="constant">1</code>) = uoib(k-<code class="constant">1</code>) + tem*ucub(k)</a>
        <a href="convection.html#rasei461" target="origFile">uoib(k) = uoib(k) - tem*ucub(k)</a>
<a name="rase_bi172"></a>        <a href="convection.html#rasei460" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection.html#rasei460" target="origFile">wfnb = wfnb + pri(k)*temb</a>
        <a href="convection.html#rasei459" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wfn)</a>
        <a href="convection.html#rasei459" target="origFile">almb = -(<code class="funcname">EXP</code>(-(alm/friclambda))*wfn*fricfac*wfnb/friclambda)</a>
<a name="rase_bi168"></a>        <a href="convection.html#rasei459" target="origFile">wfnb = fricfac*<code class="funcname">EXP</code>(-(alm/friclambda))*wfnb</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei457" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wfn)</a>
      <a href="convection.html#rasei457" target="origFile">wfnb = <code class="constant">0.5</code>*wfnb</a>
      <a href="convection.html#rasei199" target="origFile">temb = <code class="constant">0.0_8</code></a>
<a name="rase_bi162"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from4)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from4,<code class="constant">-1</code></a>
        <a href="convection.html#rasei454" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qst(l))</a>
        <a href="convection.html#rasei454" target="origFile">gmsb(l) = gmsb(l) + pki(l)*cpi*poib(l) - alhi*qoib(l) + cpi*bet(<code class="label">&</code></a>
<a name="rase_bi163"></a><a href="convection.html#rasei454" target="origFile"><code class="label">&         </code>l)*qstb(l)</a>
<a name="rase_bi164"></a>        <a href="convection.html#rasei454" target="origFile">betb(l) = betb(l) + cpi*gms(l)*qstb(l)</a>
        <a href="convection.html#rasei453" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(poi(l))</a>
<a name="rase_bi165"></a>        <a href="convection.html#rasei452" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qoi(l))</a>
<a name="rase_bi166"></a>        <a href="convection.html#rasei452" target="origFile">gmhb(l) = gmhb(l) + alhi*qoib(l)</a>
        <a href="convection.html#rasei451" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gms(l))</a>
        <a href="convection.html#rasei450" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gmh(l))</a>
        <a href="convection.html#rasei451" target="origFile">wfnb = wfnb + gmh(l)*gmhb(l) + gms(l)*gmsb(l)</a>
<a name="rase_bi167"></a>        <a href="convection.html#rasei451" target="origFile">gmsb(l) = wfn*gmsb(l)</a>
        <a href="convection.html#rasei450" target="origFile">gmhb(l) = wfn*gmhb(l)</a>
        <a href="convection.html#rasei455" target="origFile">rnnb(l) = rnnb(l) + tem*rnsb(l)</a>
        <a href="convection.html#rasei455" target="origFile">temb = temb + rnn(l)*rnsb(l)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi161"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from3)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from3,<code class="constant">-1</code></a>
        <a href="convection.html#rasei448" target="origFile">updfrpb(l) = updfrpb(l) + updfrcb(l)</a>
<a name="rase_bi159"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei446" target="origFile">temp9 = daylen*prs(l)*cvw(l)</a>
          <a href="convection.html#rasei446" target="origFile">tempb30 = ddt*<code class="constant">1000.</code>*updfrpb(l)/temp9</a>
          <a href="convection.html#rasei446" target="origFile">rmfpb(l) = rmfpb(l) + tempb30</a>
          <a href="convection.html#rasei446" target="origFile">cvwb(l) = cvwb(l) - rmfp(l)*daylen*prs(l)*tempb30/temp9</a>
<a name="rase_bi160"></a>          <a href="convection.html#rasei446" target="origFile">updfrpb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_bi158"></a>          <a href="convection.html#rasei447" target="origFile">updfrpb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei444" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rmfp(l))</a>
        <a href="convection.html#rasei444" target="origFile">temb = temb + eta(l)*rmfpb(l)</a>
        <a href="convection.html#rasei444" target="origFile">etab(l) = etab(l) + tem*rmfpb(l)</a>
<a name="rase_bi155"></a>        <a href="convection.html#rasei444" target="origFile">rmfpb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi156"></a>      <a href="convection.html#rasei442" target="origFile">temb = temb + wlq*cllb(ic) + eta(ic)*rmfdb(ic)</a>
<a name="rase_bi157"></a>      <a href="convection.html#rasei442" target="origFile">etab(ic) = etab(ic) + tem*rmfdb(ic)</a>
      <a href="convection.html#rasei443" target="origFile">wlqb = tem*cllb(ic)</a>
      <a href="convection.html#rasei440" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection.html#rasei440" target="origFile">wfnb = wfnb + gravi*temb</a>
<a name="rase_bi153"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei438" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wfn)</a>
<a name="rase_bi154"></a>        <a href="convection.html#rasei199" target="origFile">x1b = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei439" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wfn)</a>
<a name="rase_bi151"></a>        <a href="convection.html#rasei439" target="origFile">x1b = wfnb</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei436" target="origFile">tempb28 = trg*toki*x1b</a>
      <a href="convection.html#rasei436" target="origFile">tempb29 = rasal(ic)*wfn*x1b</a>
      <a href="convection.html#rasei436" target="origFile">rasalb(ic) = rasalb(ic) + wfn*tempb28</a>
      <a href="convection.html#rasei436" target="origFile">wfnb = rasal(ic)*tempb28</a>
<a name="rase_bi152"></a>      <a href="convection.html#rasei436" target="origFile">trgb = toki*tempb29</a>
      <a href="convection.html#rasei436" target="origFile">tokib = trg*tempb29</a>
      <a href="convection.html#rasei435" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wfn)</a>
<a name="rase_bi149"></a>      <a href="convection.html#rasei435" target="origFile">akmb = (wfn-acr)*wfnb/akm**<code class="constant">2</code></a>
<a name="rase_bi148"></a>      <a href="convection.html#rasei435" target="origFile">wfnb = -(wfnb/akm)</a>
 <a href="convection.html#rasei199" target="origFile"><code class="label">100 </code></a> <a href="convection.html#rasei432" target="origFile">tempb26 = -(dpb(ic)*pki(ic)*akmb)</a>
      <a href="convection.html#rasei433" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gmh(ic))</a>
      <a href="convection.html#rasei433" target="origFile">tempb24 = pri(ic)*gmhb(ic)</a>
      <a href="convection.html#rasei433" target="origFile">tempb25 = alhl*eta(ic+<code class="constant">1</code>)*tempb24</a>
      <a href="convection.html#rasei433" target="origFile">gmsb(ic) = gmsb(ic) + eta(ic+<code class="constant">1</code>)*tempb26 + gmhb(ic)</a>
      <a href="convection.html#rasei433" target="origFile">etab(ic+<code class="constant">1</code>) = etab(ic+<code class="constant">1</code>) + alhl*(qol(ic)-qht(ic+<code class="constant">1</code>))*tempb24</a>
      <a href="convection.html#rasei433" target="origFile">qolb(ic) = qolb(ic) + tempb25</a>
      <a href="convection.html#rasei433" target="origFile">qhtb(ic+<code class="constant">1</code>) = qhtb(ic+<code class="constant">1</code>) - tempb25</a>
      <a href="convection.html#rasei433" target="origFile">etab(ic) = etab(ic) + (hst(ic)-hol(ic))*tempb24</a>
      <a href="convection.html#rasei433" target="origFile">hstb(ic) = hstb(ic) + eta(ic)*tempb24</a>
      <a href="convection.html#rasei433" target="origFile">holb(ic) = holb(ic) - eta(ic)*tempb24</a>
      <a href="convection.html#rasei433" target="origFile">gmhb(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi150"></a>      <a href="convection.html#rasei432" target="origFile">etab(ic+<code class="constant">1</code>) = etab(ic+<code class="constant">1</code>) + pri(ic)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*gmsb(ic) + <code class="label">&</code></a>
<a href="convection.html#rasei432" target="origFile"><code class="label">&       </code>gms(ic)*tempb26</a>
      <a href="convection.html#rasei431" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gms(ic))</a>
      <a href="convection.html#rasei431" target="origFile">tempb27 = pri(ic)*eta(ic+<code class="constant">1</code>)*gmsb(ic)</a>
      <a href="convection.html#rasei431" target="origFile">sslb(ic) = sslb(ic) + tempb27</a>
      <a href="convection.html#rasei431" target="origFile">shtb(ic+<code class="constant">1</code>) = shtb(ic+<code class="constant">1</code>) - tempb27</a>
      <a href="convection.html#rasei431" target="origFile">gmsb(ic) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile">tx2b = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to3)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to3,k-<code class="constant">1</code>,<code class="constant">1</code></a>
<a name="rase_bi144"></a>        <a href="convection.html#rasei429" target="origFile">tx2b = tx2b + ght(l)*akmb</a>
        <a href="convection.html#rasei428" target="origFile">gmhb(l) = gmhb(l) + (eta(l)-eta(l+<code class="constant">1</code>))*tx2b</a>
        <a href="convection.html#rasei429" target="origFile">gmsb(l) = gmsb(l) + gmhb(l) - pki(l)*eht(l)*akmb</a>
<a name="rase_bi145"></a>        <a href="convection.html#rasei429" target="origFile">ehtb(l) = ehtb(l) - pki(l)*gms(l)*akmb</a>
        <a href="convection.html#rasei429" target="origFile">ghtb(l) = ghtb(l) + tx2*akmb</a>
        <a href="convection.html#rasei428" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tx2)</a>
<a name="rase_bi146"></a>        <a href="convection.html#rasei428" target="origFile">etab(l) = etab(l) + gmh(l)*tx2b</a>
        <a href="convection.html#rasei428" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) - gmh(l)*tx2b</a>
        <a href="convection.html#rasei427" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gmh(l))</a>
        <a href="convection.html#rasei427" target="origFile">tempb20 = alhl*pri(l)*gmhb(l)</a>
        <a href="convection.html#rasei427" target="origFile">tempb21 = eta(l+<code class="constant">1</code>)*tempb20</a>
        <a href="convection.html#rasei427" target="origFile">etab(l) = etab(l) + (qht(l)-qol(l))*tempb20</a>
        <a href="convection.html#rasei427" target="origFile">qhtb(l) = qhtb(l) + eta(l)*tempb20</a>
        <a href="convection.html#rasei427" target="origFile">qolb(l) = qolb(l) + tempb21 - eta(l)*tempb20</a>
        <a href="convection.html#rasei427" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + (qol(l)-qht(l+<code class="constant">1</code>))*tempb20</a>
<a name="rase_bi147"></a>        <a href="convection.html#rasei427" target="origFile">qhtb(l+<code class="constant">1</code>) = qhtb(l+<code class="constant">1</code>) - tempb21</a>
        <a href="convection.html#rasei427" target="origFile">gmhb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei426" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gms(l))</a>
        <a href="convection.html#rasei426" target="origFile">tempb22 = pri(l)*gmsb(l)</a>
        <a href="convection.html#rasei426" target="origFile">tempb23 = eta(l+<code class="constant">1</code>)*tempb22</a>
        <a href="convection.html#rasei426" target="origFile">etab(l) = etab(l) + (sht(l)-ssl(l))*tempb22</a>
        <a href="convection.html#rasei426" target="origFile">shtb(l) = shtb(l) + eta(l)*tempb22</a>
        <a href="convection.html#rasei426" target="origFile">sslb(l) = sslb(l) + tempb23 - eta(l)*tempb22</a>
        <a href="convection.html#rasei426" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + (ssl(l)-sht(l+<code class="constant">1</code>))*tempb22</a>
        <a href="convection.html#rasei426" target="origFile">shtb(l+<code class="constant">1</code>) = shtb(l+<code class="constant">1</code>) - tempb23</a>
        <a href="convection.html#rasei426" target="origFile">gmsb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi139"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei424" target="origFile">tempb18 = dpb(k-<code class="constant">1</code>)*akmb</a>
<a name="rase_bi140"></a>      <a href="convection.html#rasei425" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tx2)</a>
      <a href="convection.html#rasei425" target="origFile">gmhb(k) = gmhb(k) + gam(k-<code class="constant">1</code>)*tempb18 + tx2b</a>
<a name="rase_bi141"></a>      <a href="convection.html#rasei424" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(akm)</a>
      <a href="convection.html#rasei424" target="origFile">gamb(k-<code class="constant">1</code>) = gamb(k-<code class="constant">1</code>) + gmh(k)*tempb18</a>
      <a href="convection.html#rasei423" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gmh(k))</a>
      <a href="convection.html#rasei423" target="origFile">tempb19 = pri(k)*alhl*gmhb(k)</a>
      <a href="convection.html#rasei423" target="origFile">gmsb(k) = gmsb(k) + gmhb(k)</a>
      <a href="convection.html#rasei423" target="origFile">qhtb(k) = qhtb(k) + tempb19</a>
<a name="rase_bi142"></a>      <a href="convection.html#rasei423" target="origFile">qolb(k) = qolb(k) - tempb19</a>
      <a href="convection.html#rasei423" target="origFile">gmhb(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei422" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(gms(k))</a>
      <a href="convection.html#rasei422" target="origFile">shtb(k) = shtb(k) + pri(k)*gmsb(k)</a>
<a name="rase_bi143"></a>      <a href="convection.html#rasei422" target="origFile">sslb(k) = sslb(k) - pri(k)*gmsb(k)</a>
      <a href="convection.html#rasei422" target="origFile">gmsb(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei421" target="origFile">qstb(ic) = qstb(ic) - eta(ic)*wlqb</a>
      <a href="convection.html#rasei421" target="origFile">etab(ic) = etab(ic) - qst(ic)*wlqb</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to2)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to2,k-<code class="constant">1</code>,<code class="constant">1</code></a>
<a name="rase_bi138"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei419" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rnn(l))</a>
          <a href="convection.html#rasei419" target="origFile">rnnb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi137"></a>          <a href="convection.html#rasei199" target="origFile">clossb = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei418" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rnn(l))</a>
          <a href="convection.html#rasei418" target="origFile">clossb = rnnb(l) - wlqb</a>
<a name="rase_bi136"></a>          <a href="convection.html#rasei418" target="origFile">rnnb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei416" target="origFile">clossb = clossb - cll0b(l)</a>
<a name="rase_bi410"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="rase_bi135"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei134" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
          <a href="convection.html#rasei413" target="origFile">cll0b(l) = cll0b(l) + clossb</a>
<a name="rase_bi410"></a>          <a href="convection.html#rasei199" target="origFile">clossb = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_bi133"></a>          <a href="convection.html#rasei134" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei411" target="origFile">cll0b(l) = cll0b(l) + rate*dt_lyr*clossb</a>
<a name="rase_bi134"></a>        <a href="convection.html#rasei411" target="origFile">rateb = cll0(l)*dt_lyr*clossb</a>
        <a href="convection.html#rasei411" target="origFile">dt_lyrb = cll0(l)*rate*clossb</a>
        <a href="convection.html#rasei410" target="origFile">tempb17 = dt_lyrb/cvw_x</a>
        <a href="convection.html#rasei410" target="origFile">zetb(l) = zetb(l) + tempb17</a>
        <a href="convection.html#rasei410" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) - tempb17</a>
        <a href="convection.html#rasei410" target="origFile">cvw_xb = -((zet(l)-zet(l+<code class="constant">1</code>))*tempb17/cvw_x)</a>
<a name="rase_bi131"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_bi132"></a>          <a href="convection.html#rasei408" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cvw_x)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei409" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cvw_x)</a>
<a name="rase_bi405"></a>          <a href="convection.html#rasei409" target="origFile">cvwb(l) = cvwb(l) + cvw_xb</a>
<a name="rase_bi401"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi128"></a>        <a href="convection.html#rasei405" target="origFile">cli_crit_x = cli_crit/(f2*f3)</a>
        <a href="convection.html#rasei401" target="origFile">cli = cll0(l)/eta(l)</a>
        <a href="convection.html#rasei406" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rate)</a>
        <a href="convection.html#rasei406" target="origFile">temp8 = cli_crit_x**<code class="constant">2</code></a>
        <a href="convection.html#rasei406" target="origFile">temp7 = cli**<code class="constant">2</code>/temp8</a>
        <a href="convection.html#rasei406" target="origFile">tempb15 = <code class="funcname">EXP</code>(-temp7)*c00_x*rateb/temp8</a>
        <a href="convection.html#rasei406" target="origFile">c00_xb = (<code class="constant">1.0</code>-<code class="funcname">EXP</code>(-temp7))*rateb</a>
        <a href="convection.html#rasei406" target="origFile">clib = <code class="constant">2</code>*cli*tempb15</a>
        <a href="convection.html#rasei406" target="origFile">cli_crit_xb = -(temp7*<code class="constant">2</code>*cli_crit_x*tempb15)</a>
<a name="rase_bi129"></a>        <a href="convection.html#rasei405" target="origFile">f2b = f2b + f3*f4*co_auto(i)*c00_xb - cli_crit*cli_crit_xb/(f3*<code class="label">&</code></a>
<a name="rase_bi402"></a><a href="convection.html#rasei405" target="origFile"><code class="label">&         </code>f2**<code class="constant">2</code>)</a>
<a name="rase_bi130"></a>        <a href="convection.html#rasei404" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(c00_x)</a>
        <a href="convection.html#rasei402" target="origFile">te_a = poi(l)*prh(l)</a>
        <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f2)</a>
        <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f3)</a>
        <a href="convection.html#rasei403" target="origFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE_B</code>(te_a, te_ab, sdqv2, sdqv3, sdqvt1, f2, f2b, f3<code class="label">&</code></a>
<a href="convection.html#rasei403" target="origFile"><code class="label">&                  </code>)</a>
        <a href="convection.html#rasei402" target="origFile">poib(l) = poib(l) + prh(l)*te_ab</a>
        <a href="convection.html#rasei401" target="origFile">tempb16 = clib/eta(l)</a>
        <a href="convection.html#rasei401" target="origFile">cll0b(l) = cll0b(l) + tempb16</a>
<a name="rase_bi127"></a>        <a href="convection.html#rasei401" target="origFile">etab(l) = etab(l) - cll0(l)*tempb16/eta(l)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) </a><a href="convection.html#rasei399" target="origFile">cll0b(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi126"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei397" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cll0(l))</a>
          <a href="convection.html#rasei397" target="origFile">wlqb = wlqb + cll0b(l)</a>
          <a href="convection.html#rasei397" target="origFile">qstb(ic) = qstb(ic) - eta(ic)*cll0b(l)</a>
          <a href="convection.html#rasei397" target="origFile">etab(ic) = etab(ic) - qst(ic)*cll0b(l)</a>
<a name="rase_bi122"></a>          <a href="convection.html#rasei397" target="origFile">cll0b(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei396" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cll0(l))</a>
          <a href="convection.html#rasei396" target="origFile">wlqb = wlqb + cll0b(l)</a>
<a name="rase_bi123"></a>          <a href="convection.html#rasei396" target="origFile">qccb = -cll0b(l)</a>
          <a href="convection.html#rasei396" target="origFile">cll0b(l) = <code class="constant">0.0_8</code></a>
          <a href="convection.html#rasei395" target="origFile">tx2b = qccb</a>
          <a href="convection.html#rasei395" target="origFile">gm1b(l) = gm1b(l) + (hcc(l)-tx3)*qccb</a>
<a name="rase_bi124"></a>          <a href="convection.html#rasei395" target="origFile">hccb(l) = hccb(l) + gm1(l)*qccb</a>
          <a href="convection.html#rasei395" target="origFile">tx3b = -(gm1(l)*qccb)</a>
          <a href="convection.html#rasei394" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tx3)</a>
          <a href="convection.html#rasei394" target="origFile">tempb13 = <code class="constant">0.5</code>*eta(l)*tx3b</a>
          <a href="convection.html#rasei394" target="origFile">hstb(l) = hstb(l) + tempb13</a>
          <a href="convection.html#rasei394" target="origFile">hstb(l-<code class="constant">1</code>) = hstb(l-<code class="constant">1</code>) + tempb13</a>
<a name="rase_bi125"></a>          <a href="convection.html#rasei394" target="origFile">etab(l) = etab(l) + <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*tx2b + <code class="constant">0.5</code>*(hst(l)+<code class="label">&</code></a>
<a href="convection.html#rasei394" target="origFile"><code class="label">&           </code>hst(l-<code class="constant">1</code>))*tx3b</a>
          <a href="convection.html#rasei393" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tx2)</a>
          <a href="convection.html#rasei393" target="origFile">tempb14 = <code class="constant">0.5</code>*eta(l)*tx2b</a>
          <a href="convection.html#rasei393" target="origFile">qstb(l) = qstb(l) + tempb14</a>
<a name="rase_bi388"></a>          <a href="convection.html#rasei393" target="origFile">qstb(l-<code class="constant">1</code>) = qstb(l-<code class="constant">1</code>) + tempb14</a>
<a name="rase_bi119"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei388" target="origFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
<a name="rase_bi120"></a>        <a href="convection.html#rasei391" target="origFile">temb = uoi(l)*uhtb + qol(l)*wlqb + voi(l)*vhtb</a>
<a name="rase_bi121"></a>        <a href="convection.html#rasei391" target="origFile">voib(l) = voib(l) + tem*vhtb</a>
        <a href="convection.html#rasei390" target="origFile">uoib(l) = uoib(l) + tem*uhtb</a>
        <a href="convection.html#rasei389" target="origFile">qolb(l) = qolb(l) + tem*wlqb</a>
        <a href="convection.html#rasei388" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection.html#rasei388" target="origFile">etab(l) = etab(l) + temb</a>
<a name="rase_bi114"></a>        <a href="convection.html#rasei388" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) - temb</a>
<a name="rase_bi115"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei387" target="origFile">cll0b(k) = <code class="constant">0.0_8</code></a>
<a name="rase_bi116"></a>      <a href="convection.html#rasei386" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rnn(k))</a>
      <a href="convection.html#rasei386" target="origFile">rnnb(k) = <code class="constant">0.0_8</code></a>
<a name="rase_bi117"></a>      <a href="convection.html#rasei385" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(vht)</a>
      <a href="convection.html#rasei385" target="origFile">voib(k) = voib(k) + vhtb</a>
<a name="rase_bi118"></a>      <a href="convection.html#rasei384" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(uht)</a>
      <a href="convection.html#rasei384" target="origFile">uoib(k) = uoib(k) + uhtb</a>
<a name="rase_bi113"></a>      <a href="convection.html#rasei383" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(wlq)</a>
      <a href="convection.html#rasei383" target="origFile">qolb(k) = qolb(k) + wlqb</a>
 <a href="convection.html#rasei199" target="origFile"><code class="label">110 </code></a> <a href="convection.html#rasei381" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(acr)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from2)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from2,<code class="constant">-1</code></a>
<a name="rase_bi111"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei378" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cvw(l))</a>
<a name="rase_bi112"></a>          <a href="convection.html#rasei378" target="origFile">cvwb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei379" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cvw(l))</a>
<a name="rase_bi110"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei376" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(rasal(ic))</a>
<a name="rase_bi109"></a>      <a href="convection.html#rasei376" target="origFile">rasalb(ic) = -(dt*rasalb(ic)/rasal(ic)**<code class="constant">2</code>)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) </a><a href="convection.html#rasei374" target="origFile">rasalb(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi108"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei372" target="origFile">zetb(ic) = zetb(ic) + (rasal2-rasal1)*rasalb(ic)/<code class="constant">8000.</code></a>
        <a href="convection.html#rasei372" target="origFile">rasalb(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi107"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) </a><a href="convection.html#rasei370" target="origFile">rasalb(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi106"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to1)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to1,k-<code class="constant">1</code>,<code class="constant">1</code></a>
        <a href="convection.html#rasei367" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(cvw(l))</a>
        <a href="convection.html#rasei367" target="origFile"><code class="keyword">IF</code> (<code class="constant">2.0</code>*max2 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei367" target="origFile">max2b = <code class="constant">0.0</code></a>
        <a href="convection.html#rasei367" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei367" target="origFile">max2b = cvwb(l)/<code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
        <a href="convection.html#rasei367" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei367" target="origFile">cvwb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi104"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_bi105"></a>          <a href="convection.html#rasei365" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(max2)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei366" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(max2)</a>
<a name="rase_bi103"></a>          <a href="convection.html#rasei366" target="origFile">bk2b(l) = bk2b(l) + max2b</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei363" target="origFile">temp6 = cp*prj(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei363" target="origFile">temp5 = temp6*poi(l)</a>
        <a href="convection.html#rasei363" target="origFile">tempb12 = grav*bk2b(l)/temp5</a>
        <a href="convection.html#rasei363" target="origFile">bk2b(l+<code class="constant">1</code>) = bk2b(l+<code class="constant">1</code>) + bk2b(l)</a>
        <a href="convection.html#rasei363" target="origFile">max1b = tempb12</a>
        <a href="convection.html#rasei363" target="origFile">poib(l) = poib(l) - max1*temp6*tempb12/temp5</a>
        <a href="convection.html#rasei363" target="origFile">bk2b(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi101"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei361" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(max1)</a>
<a name="rase_bi102"></a>          <a href="convection.html#rasei199" target="origFile">temb = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei362" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(max1)</a>
<a name="rase_bi99"></a>          <a href="convection.html#rasei362" target="origFile">temb = max1b</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection.html#rasei359" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection.html#rasei359" target="origFile">temp4 = lbcp*dqq(l) + <code class="constant">1.0</code></a>
        <a href="convection.html#rasei359" target="origFile">tempb10 = temb/temp4</a>
        <a href="convection.html#rasei359" target="origFile">temp3 = zet(l) - zet(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei359" target="origFile">temp2 = hcld(l) - hst(l)</a>
        <a href="convection.html#rasei359" target="origFile">hcldb(l) = hcldb(l) + temp3*tempb10</a>
        <a href="convection.html#rasei359" target="origFile">hstb(l) = hstb(l) - temp3*tempb10</a>
        <a href="convection.html#rasei359" target="origFile">zetb(l) = zetb(l) + temp2*tempb10</a>
<a name="rase_bi100"></a>        <a href="convection.html#rasei359" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) - temp2*tempb10</a>
        <a href="convection.html#rasei359" target="origFile">dqqb(l) = dqqb(l) - temp2*temp3*lbcp*tempb10/temp4</a>
        <a href="convection.html#rasei358" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hcld(l))</a>
        <a href="convection.html#rasei358" target="origFile">tempb11 = hcldb(l)/eta(l)</a>
        <a href="convection.html#rasei358" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + (hcld(l+<code class="constant">1</code>)-hol(l))*tempb11</a>
        <a href="convection.html#rasei358" target="origFile">hcldb(l+<code class="constant">1</code>) = hcldb(l+<code class="constant">1</code>) + eta(l+<code class="constant">1</code>)*tempb11</a>
        <a href="convection.html#rasei358" target="origFile">etab(l) = etab(l) + (hol(l)-(eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>)<code class="label">&</code></a>
<a href="convection.html#rasei358" target="origFile"><code class="label">&         </code>)*hol(l))/eta(l))*tempb11</a>
        <a href="convection.html#rasei358" target="origFile">holb(l) = holb(l) + (eta(l)-eta(l+<code class="constant">1</code>))*tempb11</a>
<a name="rase_bi95"></a>        <a href="convection.html#rasei358" target="origFile">hcldb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei357" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hcld(k))</a>
<a name="rase_bi96"></a>      <a href="convection.html#rasei357" target="origFile">holb(k) = holb(k) + hcldb(k)</a>
<a name="rase_bi97"></a>      <a href="convection.html#rasei357" target="origFile">hcldb(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei356" target="origFile">bk2b(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei355" target="origFile">tempb9 = dpb(ic)*gam(ic)*wfnb</a>
      <a href="convection.html#rasei355" target="origFile">hccb(ic+<code class="constant">1</code>) = hccb(ic+<code class="constant">1</code>) + tempb9</a>
      <a href="convection.html#rasei355" target="origFile">hstb(ic) = hstb(ic) + eta(ic)*hccb(ic) - eta(ic+<code class="constant">1</code>)*tempb9</a>
<a name="rase_bi98"></a>      <a href="convection.html#rasei355" target="origFile">etab(ic+<code class="constant">1</code>) = etab(ic+<code class="constant">1</code>) - hst(ic)*tempb9</a>
      <a href="convection.html#rasei355" target="origFile">gamb(ic) = gamb(ic) + dpb(ic)*(hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*wfnb</a>
      <a href="convection.html#rasei354" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hcc(ic))</a>
      <a href="convection.html#rasei354" target="origFile">etab(ic) = etab(ic) + hst(ic)*hccb(ic)</a>
      <a href="convection.html#rasei354" target="origFile">hccb(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi350"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to0)</a>
<a name="rase_bi92"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to0,k-<code class="constant">1</code>,<code class="constant">1</code></a>
        <a href="convection.html#rasei350" target="origFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
        <a href="convection.html#rasei352" target="origFile">tempb8 = gam(l)*wfnb</a>
        <a href="convection.html#rasei352" target="origFile">temb = tempb8</a>
        <a href="convection.html#rasei352" target="origFile">ehtb(l) = ehtb(l) - hst(l)*tempb8</a>
<a name="rase_bi93"></a>        <a href="convection.html#rasei352" target="origFile">hstb(l) = hstb(l) - eht(l)*tempb8</a>
        <a href="convection.html#rasei352" target="origFile">gamb(l) = gamb(l) + (tem-eht(l)*hst(l))*wfnb</a>
        <a href="convection.html#rasei351" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(eht(l))</a>
        <a href="convection.html#rasei351" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) + dpb(l)*ehtb(l)</a>
        <a href="convection.html#rasei350" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
<a name="rase_bi94"></a>        <a href="convection.html#rasei350" target="origFile">hccb(l+<code class="constant">1</code>) = hccb(l+<code class="constant">1</code>) + dpb(l)*temb</a>
        <a href="convection.html#rasei350" target="origFile">hccb(l) = hccb(l) + dpt(l)*temb</a>
        <a href="convection.html#rasei349" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hcc(l))</a>
        <a href="convection.html#rasei349" target="origFile">hccb(l+<code class="constant">1</code>) = hccb(l+<code class="constant">1</code>) + hccb(l)</a>
        <a href="convection.html#rasei351" target="origFile">etab(l) = etab(l) + hol(l)*hccb(l) + dpt(l)*ehtb(l)</a>
        <a href="convection.html#rasei351" target="origFile">ehtb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei349" target="origFile">etab(l+<code class="constant">1</code>) = etab(l+<code class="constant">1</code>) - hol(l)*hccb(l)</a>
        <a href="convection.html#rasei349" target="origFile">holb(l) = holb(l) + (eta(l)-eta(l+<code class="constant">1</code>))*hccb(l)</a>
<a name="rase_bi90"></a>        <a href="convection.html#rasei349" target="origFile">hccb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei348" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hcc(k))</a>
<a name="rase_bi91"></a>      <a href="convection.html#rasei348" target="origFile">holb(k) = holb(k) + hccb(k)</a>
      <a href="convection.html#rasei348" target="origFile">hccb(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei346" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(eta(ic))</a>
      <a href="convection.html#rasei346" target="origFile">almb = almb + (zol(ic)-zet(k))*etab(ic)</a>
      <a href="convection.html#rasei346" target="origFile">zolb(ic) = zolb(ic) + alm*etab(ic)</a>
      <a href="convection.html#rasei346" target="origFile">zetb(k) = zetb(k) - alm*etab(ic)</a>
      <a href="convection.html#rasei346" target="origFile">etab(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_bi89"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from1)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from1,<code class="constant">-1</code></a>
        <a href="convection.html#rasei344" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(eta(l))</a>
        <a href="convection.html#rasei344" target="origFile">almb = almb + (zet(l)-zet(k))*etab(l)</a>
        <a href="convection.html#rasei344" target="origFile">zetb(l) = zetb(l) + alm*etab(l)</a>
        <a href="convection.html#rasei344" target="origFile">zetb(k) = zetb(k) - alm*etab(l)</a>
        <a href="convection.html#rasei344" target="origFile">etab(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi88"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi87"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="rase_bi86"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) </a><a href="convection.html#rasei343" target="origFile">almb = almb + <code class="constant">2</code>*alm*tokib/lambda_min**<code class="constant">2</code></a>
      <a href="convection.html#rasei341" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(toki)</a>
 <a href="convection.html#rasei199" target="origFile"><code class="label">120 </code></a> <a href="convection.html#rasei339" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(alm)</a>
      <a href="convection.html#rasei339" target="origFile">tempb7 = almb/tem</a>
      <a href="convection.html#rasei339" target="origFile">holb(k) = holb(k) + tempb7</a>
      <a href="convection.html#rasei339" target="origFile">hstb(ic) = hstb(ic) - tempb7</a>
      <a href="convection.html#rasei339" target="origFile">temb = -((hol(k)-hst(ic))*tempb7/tem)</a>
<a name="rase_bi85"></a> <a href="convection.html#rasei199" target="origFile"><code class="label">130  </code><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from0)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ad_from0,<code class="constant">-1</code></a>
        <a href="convection.html#rasei336" target="origFile">tempb5 = (zet(l)-zet(l+<code class="constant">1</code>))*temb</a>
        <a href="convection.html#rasei336" target="origFile">tempb6 = (hst(ic)-hol(l))*temb</a>
        <a href="convection.html#rasei336" target="origFile">hstb(ic) = hstb(ic) + tempb5</a>
        <a href="convection.html#rasei336" target="origFile">holb(l) = holb(l) - tempb5</a>
        <a href="convection.html#rasei336" target="origFile">zetb(l) = zetb(l) + tempb6</a>
<a name="rase_bi84"></a>        <a href="convection.html#rasei336" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) - tempb6</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei335" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection.html#rasei335" target="origFile">tempb3 = (zol(ic)-zet(ic+<code class="constant">1</code>))*temb</a>
      <a href="convection.html#rasei335" target="origFile">tempb4 = (hst(ic)-hol(ic))*temb</a>
      <a href="convection.html#rasei335" target="origFile">hstb(ic) = hstb(ic) + tempb3</a>
      <a href="convection.html#rasei335" target="origFile">holb(ic) = holb(ic) - tempb3</a>
<a name="rase_bi83"></a>      <a href="convection.html#rasei335" target="origFile">zolb(ic) = zolb(ic) + tempb4</a>
      <a href="convection.html#rasei335" target="origFile">zetb(ic+<code class="constant">1</code>) = zetb(ic+<code class="constant">1</code>) - tempb4</a>
 <a href="convection.html#rasei199" target="origFile"><code class="label">140 </code></a> <a href="convection.html#rasei332" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(lambda_min)</a>
<a name="rase_bi81"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k,ad_from,<code class="constant">-1</code></a>
        <a href="convection.html#rasei330" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qht(l))</a>
        <a href="convection.html#rasei330" target="origFile">qolb(l) = qolb(l) + <code class="constant">.5</code>*qhtb(l)</a>
<a name="rase_bi328"></a>        <a href="convection.html#rasei330" target="origFile">qolb(l-<code class="constant">1</code>) = qolb(l-<code class="constant">1</code>) + <code class="constant">.5</code>*qhtb(l)</a>
<a name="rase_bi82"></a>        <a href="convection.html#rasei330" target="origFile">qhtb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei328" target="origFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
        <a href="convection.html#rasei329" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(sht(l))</a>
        <a href="convection.html#rasei329" target="origFile">sslb(l-<code class="constant">1</code>) = sslb(l-<code class="constant">1</code>) + (<code class="constant">1.0_8</code>-tem)*shtb(l)</a>
        <a href="convection.html#rasei329" target="origFile">sslb(l) = sslb(l) + tem*shtb(l)</a>
        <a href="convection.html#rasei329" target="origFile">shtb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei328" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei199" target="origFile">poi_cb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile">qoi_cb = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to)</a>
<a name="rase_bi75"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=ad_to,k,<code class="constant">1</code></a>
        <a href="convection.html#rasei323" target="origFile">sslb(l) = sslb(l) + holb(l) + hstb(l)</a>
<a name="rase_bi76"></a>        <a href="convection.html#rasei326" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(zol(l))</a>
        <a href="convection.html#rasei326" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) + zetb(l) + zolb(l)</a>
        <a href="convection.html#rasei325" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(zet(l))</a>
        <a href="convection.html#rasei325" target="origFile">temb = zetb(l)</a>
        <a href="convection.html#rasei326" target="origFile">poi_cb(l) = poi_cb(l) + (prj(l+<code class="constant">1</code>)-prj(l))*cpbg*temb + prj(l+<code class="constant">1</code>)*<code class="label">&</code></a>
<a href="convection.html#rasei326" target="origFile"><code class="label">&         </code>cp*sslb(l) + (prj(l+<code class="constant">1</code>)-prh(l))*cpbg*zolb(l)</a>
<a name="rase_bi77"></a>        <a href="convection.html#rasei326" target="origFile">zolb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi78"></a>        <a href="convection.html#rasei325" target="origFile">zetb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei324" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(tem)</a>
        <a href="convection.html#rasei323" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hst(l))</a>
<a name="rase_bi79"></a>        <a href="convection.html#rasei323" target="origFile">qstb(l) = qstb(l) + alhl*hstb(l)</a>
        <a href="convection.html#rasei323" target="origFile">hstb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei322" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(hol(l))</a>
<a name="rase_bi80"></a>        <a href="convection.html#rasei322" target="origFile">qolb(l) = qolb(l) + alhl*holb(l)</a>
        <a href="convection.html#rasei322" target="origFile">holb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei321" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(ssl(l))</a>
        <a href="convection.html#rasei321" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) + grav*sslb(l)</a>
<a name="rase_bi74"></a>        <a href="convection.html#rasei321" target="origFile">sslb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) </a><a href="convection.html#rasei320" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi72"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="convection.html#rasei316" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qol(l))</a>
          <a href="convection.html#rasei316" target="origFile">qoi_cb(l) = qoi_cb(l) + qolb(l)</a>
<a name="rase_bi73"></a>          <a href="convection.html#rasei316" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="convection.html#rasei317" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qol(l))</a>
          <a href="convection.html#rasei317" target="origFile">qstb(l) = qstb(l) + rhmax*qolb(l)</a>
          <a href="convection.html#rasei317" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi67"></a>        <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection.html#rasei314" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(sht(k+<code class="constant">1</code>))</a>
<a name="rase_bi68"></a>      <a href="convection.html#rasei314" target="origFile">poi_cb(k) = poi_cb(k) + prj(k+<code class="constant">1</code>)*cp*shtb(k+<code class="constant">1</code>)</a>
      <a href="convection.html#rasei314" target="origFile">shtb(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi69"></a>      <a href="convection.html#rasei313" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(zet(k+<code class="constant">1</code>))</a>
<a name="rase_bi70"></a>      <a href="convection.html#rasei313" target="origFile">zetb(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_bi71"></a>      <a href="convection.html#rasei311" target="origFile">tpertb = tpertb + poi_cb(k)</a>
      <a href="convection.html#rasei310" target="origFile">qoib = qoib + qoi_cb</a>
      <a href="convection.html#rasei309" target="origFile">poib = poib + poi_cb</a>
<a name="rase_bi65"></a> <a href="convection.html#rasei199" target="origFile"><code class="label">150  </code><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_bi66"></a>        <a href="convection.html#rasei306" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f4)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei307" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f4)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi63"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei300" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(trg)</a>
        <a href="convection.html#rasei300" target="origFile">tempb2 = trgb/((rhmx-rhmn)*qst(k))</a>
        <a href="convection.html#rasei300" target="origFile">qoib(k) = qoib(k) + tempb2</a>
<a name="rase_bi64"></a>        <a href="convection.html#rasei300" target="origFile">qstb(k) = qstb(k) - qoi(k)*tempb2/qst(k)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei301" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(trg)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei199" target="origFile">vcub(icmin:k0) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile">ucub(icmin:k0) = <code class="constant">0.0_8</code></a>
<a name="rase_bi58"></a>    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi56"></a>    <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=icmin,k,<code class="constant">1</code></a>
<a name="rase_bi57"></a>      <a href="convection.html#rasei292" target="origFile">sslb(l) = sslb(l) + holb(l) + hstb(l)</a>
      <a href="convection.html#rasei295" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) + zetb(l) + zolb(l)</a>
      <a href="convection.html#rasei294" target="origFile">temb = zetb(l)</a>
      <a href="convection.html#rasei295" target="origFile">poib(l) = poib(l) + (prj(l+<code class="constant">1</code>)-prj(l))*cpbg*temb + prj(l+<code class="constant">1</code>)*cp*sslb<code class="label">&</code></a>
<a href="convection.html#rasei295" target="origFile"><code class="label">&       </code>(l) + (prj(l+<code class="constant">1</code>)-prh(l))*cpbg*zolb(l)</a>
      <a href="convection.html#rasei295" target="origFile">zolb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei294" target="origFile">zetb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi59"></a>      <a href="convection.html#rasei292" target="origFile">qstb(l) = qstb(l) + alhl*hstb(l)</a>
      <a href="convection.html#rasei292" target="origFile">hstb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi60"></a>      <a href="convection.html#rasei291" target="origFile">qolb(l) = qolb(l) + alhl*holb(l)</a>
      <a href="convection.html#rasei291" target="origFile">holb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei290" target="origFile">zetb(l+<code class="constant">1</code>) = zetb(l+<code class="constant">1</code>) + grav*sslb(l)</a>
<a name="rase_bi55"></a>      <a href="convection.html#rasei290" target="origFile">sslb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) </a><a href="convection.html#rasei289" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi53"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei285" target="origFile">qoib(l) = qoib(l) + qolb(l)</a>
<a name="rase_bi54"></a>        <a href="convection.html#rasei285" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection.html#rasei286" target="origFile">qstb(l) = qstb(l) + rhmax*qolb(l)</a>
        <a href="convection.html#rasei286" target="origFile">qolb(l) = <code class="constant">0.0_8</code></a>
<a name="rase_bi48"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi49"></a>    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi50"></a>    <a href="convection.html#rasei279" target="origFile">poib(k) = poib(k) + prj(k+<code class="constant">1</code>)*cp*shtb(k+<code class="constant">1</code>)</a>
<a name="rase_bi51"></a>    <a href="convection.html#rasei280" target="origFile">voib = voib + voi_svb</a>
<a name="rase_bi52"></a>    <a href="convection.html#rasei281" target="origFile">uoib = uoib + uoi_svb</a>
    <a href="convection.html#rasei282" target="origFile">qoib = qoib + qoi_svb</a>
    <a href="convection.html#rasei283" target="origFile">poib = poib + poi_svb</a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=icmin,k,<code class="constant">1</code></a>
<a name="rase_bi46"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="convection.html#rasei273" target="origFile">temp1 = alhl*(lbcp*dqq(l+<code class="constant">1</code>)+<code class="constant">1.0</code>)</a>
        <a href="convection.html#rasei273" target="origFile">temp0 = alhl*(lbcp*dqq(l)+<code class="constant">1.0</code>)</a>
        <a href="convection.html#rasei273" target="origFile">tempb = lbcp*<code class="constant">0.5</code>*gm1b(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei273" target="origFile">tempb0 = tempb/temp0</a>
        <a href="convection.html#rasei273" target="origFile">tempb1 = tempb/temp1</a>
        <a href="convection.html#rasei273" target="origFile">dqqb(l) = dqqb(l) + (<code class="constant">1.0_8</code>-alhl*dqq(l)*lbcp/temp0)*tempb0</a>
<a name="rase_bi47"></a>        <a href="convection.html#rasei273" target="origFile">dqqb(l+<code class="constant">1</code>) = dqqb(l+<code class="constant">1</code>) + (<code class="constant">1.0_8</code>-alhl*dqq(l+<code class="constant">1</code>)*lbcp/temp1)*tempb1</a>
        <a href="convection.html#rasei273" target="origFile">gm1b(l+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
        <a href="convection.html#rasei272" target="origFile">gamb(l) = gamb(l) + dpb(l)*ghtb(l+<code class="constant">1</code>)</a>
        <a href="convection.html#rasei272" target="origFile">gamb(l+<code class="constant">1</code>) = gamb(l+<code class="constant">1</code>) + dpt(l+<code class="constant">1</code>)*ghtb(l+<code class="constant">1</code>)</a>
<a name="rase_bi44"></a>        <a href="convection.html#rasei272" target="origFile">ghtb(l+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection.html#rasei270" target="origFile">temp = lbcp*dqq(l) + <code class="constant">1.0</code></a>
<a name="rase_bi45"></a>      <a href="convection.html#rasei270" target="origFile">dqqb(l) = dqqb(l) + pki(l)*betb(l) - pki(l)*lbcp*gamb(l)/temp**<code class="constant">2</code></a>
      <a href="convection.html#rasei270" target="origFile">gamb(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei269" target="origFile">betb(l) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi42"></a>    <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei264" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS_B</code>(dqq(k), dqqb(k), qst(k), qstb(k), arg1, arg1b, <code class="label">&</code></a>
<a href="convection.html#rasei264" target="origFile"><code class="label">&                 </code>pol(k), estblx, cons_h2omw, cons_airmw)</a>
<a name="rase_bi43"></a>      <a href="convection.html#rasei263" target="origFile">dqqb(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei263" target="origFile">qstb(k) = <code class="constant">0.0_8</code></a>
<a name="rase_bi38"></a>      <a href="convection.html#rasei262" target="origFile">poib(k) = poib(k) + prh(k)*arg1b</a>
<a name="rase_bi39"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=k0,k,<code class="constant">-1</code></a>
<a name="rase_bi40"></a>        <a href="convection.html#rasei260" target="origFile">vhob(i, l) = vhob(i, l) + wght(l)*voib(k)</a>
<a name="rase_bi41"></a>        <a href="convection.html#rasei259" target="origFile">uhob(i, l) = uhob(i, l) + wght(l)*uoib(k)</a>
        <a href="convection.html#rasei258" target="origFile">qhob(i, l) = qhob(i, l) + wght(l)*qoib(k)</a>
<a name="rase_bi34"></a>        <a href="convection.html#rasei257" target="origFile">thob(i, l) = thob(i, l) + wght(l)*poib(k)</a>
<a name="rase_bi35"></a>      <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_bi36"></a>      <a href="convection.html#rasei253" target="origFile">voib(k) = <code class="constant">0.0_8</code></a>
<a name="rase_bi37"></a>      <a href="convection.html#rasei252" target="origFile">uoib(k) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei251" target="origFile">qoib(k) = <code class="constant">0.0_8</code></a>
<a name="rase_bi28"></a>      <a href="convection.html#rasei250" target="origFile">poib(k) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi29"></a>    <a href="convection.html#rasei235" target="origFile">dqsb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei235" target="origFile">dqsb(icmin:k) = dqsb(icmin:k) + dqqb(icmin:k)</a>
<a name="rase_bi30"></a>    <a href="convection.html#rasei234" target="origFile">qssb = <code class="constant">0.0_8</code></a>
<a name="rase_bi31"></a>    <a href="convection.html#rasei234" target="origFile">qssb(icmin:k) = qssb(icmin:k) + qstb(icmin:k)</a>
<a name="rase_bi32"></a>    <a href="convection.html#rasei233" target="origFile">vhob(i, icmin:k) = vhob(i, icmin:k) + voib(icmin:k)</a>
<a name="rase_bi33"></a>    <a href="convection.html#rasei232" target="origFile">uhob(i, icmin:k) = uhob(i, icmin:k) + uoib(icmin:k)</a>
<a name="rase_bi27"></a>    <a href="convection.html#rasei231" target="origFile">qhob(i, icmin:k) = qhob(i, icmin:k) + qoib(icmin:k)</a>
    <a href="convection.html#rasei230" target="origFile">thob(i, icmin:k) = thob(i, icmin:k) + poib(icmin:k)</a>
    <a href="convection.html#rasei226" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS_B</code>(dqs, dqsb, qss, qssb, tempf, tempfb, pf, k0, estblx<code class="label">&</code></a>
<a href="convection.html#rasei226" target="origFile"><code class="label">&              </code>, cons_h2omw, cons_airmw)</a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .LT. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) tpertb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">ELSE IF</code> (branch .NE. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#rasei199" target="origFile">tpertb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_bi26"></a>    <a href="convection.html#rasei199" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) tpertb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei211" target="origFile">zlob = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei211" target="origFile">tempfb(k0) = tempfb(k0) - cbl_tpert*tpertb</a>
    <a href="convection.html#rasei211" target="origFile">zlob(k0) = zlob(k0) - cons_grav*cbl_tpert*tpertb/cons_cp</a>
<a name="rase_bi23"></a>    <a href="convection.html#rasei199" target="origFile">zleb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,k0,<code class="constant">1</code></a>
<a name="rase_bi24"></a>      <a href="convection.html#rasei209" target="origFile">zlob(l) = zlob(l) + zleb(l)</a>
      <a href="convection.html#rasei209" target="origFile">zleb(l) = cons_cp*(pk(l)-pke(l))*zleb(l)/cons_grav</a>
      <a href="convection.html#rasei208" target="origFile">zleb(l+<code class="constant">1</code>) = zleb(l+<code class="constant">1</code>) + zlob(l)</a>
<a name="rase_bi25"></a>      <a href="convection.html#rasei208" target="origFile">zleb(l) = zleb(l) + cons_cp*(pke(l+<code class="constant">1</code>)-pk(l))*zlob(l)/cons_grav</a>
      <a href="convection.html#rasei208" target="origFile">zlob(l) = <code class="constant">0.0_8</code></a>
      <a href="convection.html#rasei207" target="origFile">thob(i, l) = thob(i, l) + (cons_vireps*qho(i, l)+<code class="constant">1.</code>)*zleb(l)</a>
      <a href="convection.html#rasei207" target="origFile">qhob(i, l) = qhob(i, l) + tho(i, l)*cons_vireps*zleb(l)</a>
<a name="rase_bi22"></a>      <a href="convection.html#rasei207" target="origFile">zleb(l) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#rasei199" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection.html#rasei203" target="origFile">thob(i, :) = thob(i, :) + pk*tempfb</a>
  <a href="convection.html#rasei199" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#rase" target="origFile">clwb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#rase" target="origFile">cnv_prc3b = <code class="constant">0.0_8</code></a>
  <a href="convection.html#rase" target="origFile">cnv_updfrcb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#rase" target="origFile">flxdb = <code class="constant">0.0_8</code></a>
<a name="sundq3_ice_b"></a><a href="convection.html#rase" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RASE_B</code></a>

<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!  Differentiation of sundq3_ice in reverse (adjoint) mode:</code></a>
<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!   gradient     of useful results: f2</code></a>
<a href="convection.html#sundq3_ice" target="origFile"><code class="comment">!   with respect to varying inputs: temp f2</code></a>
<a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SUNDQ3_ICE_B</code>(<code class="vardecl">temp</code>, <code class="vardecl">tempb</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code>, <code class="vardecl">f2</code>, <code class="vardecl">f2b</code>, <code class="vardecl">f3</code>)</a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
  <a href="convection.html#sundq3_icei67" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">rate2</code>, <code class="vardecl">rate3</code>, <code class="vardecl">te1</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb</code></a>
  <a href="convection.html#sundq3_icei68" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">f2</code>, <code class="vardecl">f3</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">f2b</code></a>
<a href="convection.html#sundq3_icei69" target="origFile"><code class="comment">!,RATE2,RATE3,TE1</code></a>
  <a href="convection.html#sundq3_icei69" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">xx</code>, <code class="vardecl">yy</code>, <code class="vardecl">te0</code>, <code class="vardecl">te2</code>, <code class="vardecl">jump1</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
  <a href="convection.html#sundq3_icei70" target="origFile">te0 = <code class="constant">273.</code></a>
  <a href="convection.html#sundq3_icei71" target="origFile">te2 = <code class="constant">200.</code></a>
  <a href="convection.html#sundq3_icei72" target="origFile">jump1 = (rate2-<code class="constant">1.0</code>)/(te0-te1)**<code class="constant">0.333</code></a>
<a href="convection.html#sundq3_icei73" target="origFile"><code class="comment">! Ice - phase treatment</code></a>
  <a href="convection.html#sundq3_icei73" target="origFile"><code class="keyword">IF</code> (temp .GE. te0) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei74" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_icei74" target="origFile">f2 = <code class="constant">1.0</code></a>
    <a href="convection.html#sundq3_icei73" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
  <a href="convection.html#sundq3_icei73" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#sundq3_icei73" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
  <a href="convection.html#sundq3_icei73" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#sundq3_icei75" target="origFile"><code class="keyword">IF</code> (temp .GE. te1 .AND. temp .LT. te0) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei76" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_icei76" target="origFile">f2 = <code class="constant">1.0 </code>+ jump1*(te0-temp)**<code class="constant">0.3333</code></a>
    <a href="convection.html#sundq3_icei75" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
  <a href="convection.html#sundq3_icei75" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#sundq3_icei75" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
  <a href="convection.html#sundq3_icei75" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">IF</code> (temp .LT. te1) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei78" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_icei78" target="origFile">f2 = rate2 + (rate3-rate2)*(te1-temp)/(te1-te2)</a>
    <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
  <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
  <a href="convection.html#sundq3_icei77" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#sundq3_icei79" target="origFile"><code class="keyword">IF</code> (f2 .GT. <code class="constant">27.0</code>) f2b = <code class="constant">0.0_8</code></a>
<a name="sundq3_ice_bi21"></a>  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei78" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_icei78" target="origFile">tempb = -((rate3-rate2)*f2b/(te1-te2))</a>
    <a href="convection.html#sundq3_ice" target="origFile">f2b = <code class="constant">0.0_8</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#sundq3_ice" target="origFile">tempb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">END IF</code></a>
<a name="sundq3_ice_bi20"></a>  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei76" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_icei76" target="origFile">tempb = tempb - <code class="constant">0.3333</code>*(te0-temp)**(<code class="constant">-0.6667</code>)*jump1*f2b</a>
    <a href="convection.html#sundq3_ice" target="origFile">f2b = <code class="constant">0.0_8</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">END IF</code></a>
<a name="sundq3_ice_bi19"></a>  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#sundq3_icei74" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(f2)</a>
    <a href="convection.html#sundq3_ice" target="origFile">f2b = <code class="constant">0.0_8</code></a>
  <a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsat_ras_b"></a><a href="convection.html#sundq3_ice" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SUNDQ3_ICE_B</code></a>

<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!  Differentiation of dqsat_ras in reverse (adjoint) mode:</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!   gradient     of useful results: dqsi qssi</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="comment">!   with respect to varying inputs: temp</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSAT_RAS_B</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">dqsib</code>, <code class="vardecl">qssi</code>, <code class="vardecl">qssib</code>, <code class="vardecl">temp</code>, <code class="vardecl">tempb</code>, <code class="vardecl">plo</code>, <code class="vardecl">lm</code>, <code class="label">&</code></a>
<a href="convection.html#dqsat_ras" target="origFile"><code class="label">& </code><code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>)</a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection.html#dqsat_rasi32" target="origFile"><code class="comment">!Inputs</code></a>
  <a href="convection.html#dqsat_rasi32" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">lm</code></a>
  <a href="convection.html#dqsat_rasi33" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(lm) :: <code class="vardecl">tempb</code></a>
  <a href="convection.html#dqsat_rasi34" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection.html#dqsat_rasi35" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection.html#dqsat_rasi36" target="origFile"><code class="comment">!Outputs</code></a>
  <a href="convection.html#dqsat_rasi36" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>lm<code class="typename">) </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(lm) :: <code class="vardecl">dqsib</code>, <code class="vardecl">qssib</code></a>
<a href="convection.html#dqsat_rasi37" target="origFile"><code class="comment">!Locals</code></a>
  <a href="convection.html#dqsat_rasi37" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
  <a href="convection.html#dqsat_rasi38" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
  <a href="convection.html#dqsat_rasi39" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">k</code></a>
  <a href="convection.html#dqsat_rasi40" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tlb</code>, <code class="vardecl">ttb</code>, <code class="vardecl">tib</code>, <code class="vardecl">dqsatb</code>, <code class="vardecl">qsatb</code>, <code class="vardecl">qqb</code>, <code class="vardecl">ddb</code></a>
  <a href="convection.html#dqsat_rasi41" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
  <a href="convection.html#dqsat_rasi42" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
  <a href="convection.html#dqsat_rasi43" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
  <a href="convection.html#dqsat_rasi44" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
  <a href="convection.html#dqsat_rasi45" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
  <a href="convection.html#dqsat_rasi46" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp0</code></a>
  <a href="convection.html#dqsat_rasi47" target="origFile">esfac = cons_h2omw/cons_airmw</a>
  <a href="convection.html#dqsat_rasi66" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,lm</a>
    <a href="convection.html#dqsat_rasi48" target="origFile">tl = temp(k)</a>
    <a href="convection.html#dqsat_rasi49" target="origFile">pl = plo(k)</a>
    <a href="convection.html#dqsat_rasi50" target="origFile">pp = pl*<code class="constant">100.0</code></a>
    <a href="convection.html#dqsat_rasi51" target="origFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_rasi52" target="origFile">ti = tmintbl</a>
      <a href="convection.html#dqsat_rasi51" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
    <a href="convection.html#dqsat_rasi51" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_rasi54" target="origFile">ti = tmaxtbl - <code class="constant">.001</code></a>
      <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
    <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#dqsat_rasi55" target="origFile">ti = tl</a>
      <a href="convection.html#dqsat_rasi53" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
    <a href="convection.html#dqsat_rasi51" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#dqsat_rasi56" target="origFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
    <a href="convection.html#dqsat_rasi57" target="origFile">it = <code class="funcname">INT</code>(tt)</a>
    <a href="convection.html#dqsat_rasi58" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(dqq)</a>
    <a href="convection.html#dqsat_rasi58" target="origFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
    <a href="convection.html#dqsat_rasi59" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHREAL8</code>(qq)</a>
    <a href="convection.html#dqsat_rasi59" target="origFile">qq = (tt-it)*dqq + estblx(it)</a>
    <a href="convection.html#dqsat_rasi60" target="origFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_rasi60" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="convection.html#dqsat_rasi60" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="convection.html#dqsat_rasi60" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="convection.html#dqsat_rasi60" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#dqsat_rasi66" target="origFile"><code class="keyword">END DO</code></a>
<a name="dqsat_ras_bi17"></a>  <a href="convection.html#dqsat_ras" target="origFile">tempb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">DO </code>k=lm,<code class="constant">1</code>,<code class="constant">-1</code></a>
<a name="dqsat_ras_bi18"></a>    <a href="convection.html#dqsat_rasi64" target="origFile">qsatb = qssib(k)</a>
    <a href="convection.html#dqsat_rasi64" target="origFile">qssib(k) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#dqsat_rasi65" target="origFile">dqsatb = dqsib(k)</a>
    <a href="convection.html#dqsat_rasi65" target="origFile">dqsib(k) = <code class="constant">0.0_8</code></a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="dqsat_ras_bi49"></a>      <a href="convection.html#dqsat_ras" target="origFile">qqb = <code class="constant">0.0_8</code></a>
<a name="dqsat_ras_bi50"></a>    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsat_ras_bi14"></a>      <a href="convection.html#dqsat_rasi49" target="origFile">pl = plo(k)</a>
<a name="dqsat_ras_bi15"></a>      <a href="convection.html#dqsat_rasi50" target="origFile">pp = pl*<code class="constant">100.0</code></a>
      <a href="convection.html#dqsat_rasi61" target="origFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
<a name="dqsat_ras_bi16"></a>      <a href="convection.html#dqsat_rasi62" target="origFile">ddb = esfac*qq*qsatb + esfac*degsubs*dqq*pp*<code class="constant">2</code>*dd*dqsatb</a>
      <a href="convection.html#dqsat_rasi61" target="origFile">temp0 = pp - (-esfac+<code class="constant">1.0</code>)*qq</a>
<a name="dqsat_ras_bi11"></a>      <a href="convection.html#dqsat_rasi63" target="origFile">qqb = (<code class="constant">1.0</code>-esfac)*ddb/temp0**<code class="constant">2 </code>+ esfac*dd*qsatb</a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">END IF</code></a>
<a name="dqsat_ras_bi12"></a>    <a href="convection.html#dqsat_rasi59" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(qq)</a>
<a name="dqsat_ras_bi13"></a>    <a href="convection.html#dqsat_rasi59" target="origFile">ttb = dqq*qqb</a>
    <a href="convection.html#dqsat_rasi58" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPREAL8</code>(dqq)</a>
    <a href="convection.html#dqsat_rasi56" target="origFile">tib = degsubs*ttb</a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="convection.html#dqsat_ras" target="origFile">tlb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">ELSE IF</code> (branch .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="dqsat_ras_bi10"></a>      <a href="convection.html#dqsat_ras" target="origFile">tlb = <code class="constant">0.0_8</code></a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsat_ras_bi9"></a>      <a href="convection.html#dqsat_rasi55" target="origFile">tlb = tib</a>
    <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection.html#dqsat_rasi48" target="origFile">tempb(k) = tempb(k) + tlb</a>
  <a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">END DO</code></a>
<a name="dqsats_ras_b"></a><a href="convection.html#dqsat_ras" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSAT_RAS_B</code></a>

<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!  Differentiation of dqsats_ras in reverse (adjoint) mode:</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!   gradient     of useful results: dqsi qssi</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="comment">!   with respect to varying inputs: temp</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DQSATS_RAS_B</code>(<code class="vardecl">dqsi</code>, <code class="vardecl">dqsib</code>, <code class="vardecl">qssi</code>, <code class="vardecl">qssib</code>, <code class="vardecl">temp</code>, <code class="vardecl">tempb</code>, <code class="vardecl">plo</code>, <code class="label">&</code></a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="label">& </code><code class="vardecl">estblx</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>)</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="convection.html#dqsats_rasi0" target="origFile"><code class="comment">!Inputs</code></a>
  <a href="convection.html#dqsats_rasi0" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp</code>, <code class="vardecl">plo</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tempb</code></a>
  <a href="convection.html#dqsats_rasi1" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">estblx</code>(:)</a>
  <a href="convection.html#dqsats_rasi2" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code></a>
<a href="convection.html#dqsats_rasi3" target="origFile"><code class="comment">!Outputs</code></a>
  <a href="convection.html#dqsats_rasi3" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dqsi</code>, <code class="vardecl">qssi</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dqsib</code>, <code class="vardecl">qssib</code></a>
<a href="convection.html#dqsats_rasi4" target="origFile"><code class="comment">!Locals</code></a>
  <a href="convection.html#dqsats_rasi4" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">max_mixing_ratio</code>=<code class="constant">1.0</code></a>
  <a href="convection.html#dqsats_rasi5" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">esfac</code></a>
  <a href="convection.html#dqsats_rasi6" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tl</code>, <code class="vardecl">tt</code>, <code class="vardecl">ti</code>, <code class="vardecl">dqsat</code>, <code class="vardecl">qsat</code>, <code class="vardecl">dqq</code>, <code class="vardecl">qq</code>, <code class="vardecl">pl</code>, <code class="vardecl">pp</code>, <code class="vardecl">dd</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tlb</code>, <code class="vardecl">ttb</code>, <code class="vardecl">tib</code>, <code class="vardecl">dqsatb</code>, <code class="vardecl">qsatb</code>, <code class="vardecl">qqb</code>, <code class="vardecl">ddb</code></a>
  <a href="convection.html#dqsats_rasi7" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">it</code></a>
  <a href="convection.html#dqsats_rasi8" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">degsubs</code>=<code class="constant">100</code></a>
  <a href="convection.html#dqsats_rasi9" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tmintbl</code>=<code class="constant">150.0</code>, <code class="vardecl">tmaxtbl</code>=<code class="constant">333.0</code></a>
  <a href="convection.html#dqsats_rasi10" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">tablesize</code>=<code class="funcname">NINT</code>(<code class="vardecl">tmaxtbl</code>-<code class="vardecl">tmintbl</code>)*<code class="vardecl">degsubs</code>+<code class="constant">1</code></a>
  <a href="convection.html#dqsats_rasi11" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">NINT</code></a>
  <a href="convection.html#dqsats_rasi12" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">INT</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp0</code></a>
  <a href="convection.html#dqsats_rasi13" target="origFile">esfac = cons_h2omw/cons_airmw</a>
  <a href="convection.html#dqsats_rasi14" target="origFile">tl = temp</a>
  <a href="convection.html#dqsats_rasi15" target="origFile">pl = plo</a>
  <a href="convection.html#dqsats_rasi16" target="origFile">pp = pl*<code class="constant">100.0</code></a>
  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">IF</code> (tl .LE. tmintbl) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_rasi18" target="origFile">ti = tmintbl</a>
    <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">ELSE </code></a><a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">IF</code> (tl .GE. tmaxtbl - <code class="constant">.001</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_rasi20" target="origFile">ti = tmaxtbl - <code class="constant">.001</code></a>
    <a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
  <a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#dqsats_rasi21" target="origFile">ti = tl</a>
    <a href="convection.html#dqsats_rasi19" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
  <a href="convection.html#dqsats_rasi17" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#dqsats_rasi22" target="origFile">tt = (ti-tmintbl)*degsubs + <code class="constant">1</code></a>
  <a href="convection.html#dqsats_rasi23" target="origFile">it = <code class="funcname">INT</code>(tt)</a>
  <a href="convection.html#dqsats_rasi24" target="origFile">dqq = estblx(it+<code class="constant">1</code>) - estblx(it)</a>
  <a href="convection.html#dqsats_rasi25" target="origFile">qq = (tt-it)*dqq + estblx(it)</a>
  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">IF</code> (pp .LE. qq) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">ELSE</code></a>
    <a href="convection.html#dqsats_rasi27" target="origFile">dd = <code class="constant">1.0</code>/(pp-(<code class="constant">1.0</code>-esfac)*qq)</a>
<a name="dqsats_ras_bi7"></a>    <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
<a name="dqsats_ras_bi8"></a>  <a href="convection.html#dqsats_rasi26" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#dqsats_rasi30" target="origFile">qsatb = qssib</a>
  <a href="convection.html#dqsats_rasi31" target="origFile">dqsatb = dqsib</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="dqsats_ras_bi6"></a>    <a href="convection.html#dqsats_ras" target="origFile">qqb = <code class="constant">0.0_8</code></a>
<a name="dqsats_ras_bi4"></a>  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsats_ras_bi5"></a>    <a href="convection.html#dqsats_rasi27" target="origFile">temp0 = pp - (-esfac+<code class="constant">1.0</code>)*qq</a>
    <a href="convection.html#dqsats_rasi28" target="origFile">ddb = esfac*qq*qsatb + esfac*degsubs*dqq*pp*<code class="constant">2</code>*dd*dqsatb</a>
<a name="dqsats_ras_bi2"></a>    <a href="convection.html#dqsats_rasi29" target="origFile">qqb = (<code class="constant">1.0</code>-esfac)*ddb/temp0**<code class="constant">2 </code>+ esfac*dd*qsatb</a>
<a name="dqsats_ras_bi3"></a>  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#dqsats_rasi25" target="origFile">ttb = dqq*qqb</a>
  <a href="convection.html#dqsats_rasi22" target="origFile">tib = degsubs*ttb</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
    <a href="convection.html#dqsats_ras" target="origFile">tlb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">ELSE IF</code> (branch .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="dqsats_ras_bi1"></a>    <a href="convection.html#dqsats_ras" target="origFile">tlb = <code class="constant">0.0_8</code></a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">ELSE</code></a>
<a name="dqsats_ras_bi0"></a>    <a href="convection.html#dqsats_rasi21" target="origFile">tlb = tib</a>
  <a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection.html#dqsats_rasi14" target="origFile">tempb = tlb</a>
<a href="convection.html#dqsats_ras" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DQSATS_RAS_B</code></a>

</pre>
</body>
