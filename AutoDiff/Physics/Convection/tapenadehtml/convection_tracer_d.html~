<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="rase_tracer_d"></a><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code>
<code class="comment">!</code>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!  Differentiation of rase_tracer in forward (tangent) mode:</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   variations   of useful results: xho</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   with respect to varying inputs: xho</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="comment">!   RW status of diff variables: xho:in-out</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RASE_TRACER_D</code>(<code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code>, <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code>, <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code>, <code class="vardecl">seedras</code>, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">sige</code>, <code class="vardecl">kcbl</code>, <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code>, <code class="vardecl">frland</code>, <code class="vardecl">ts</code>, <code class="vardecl">thoin</code>, <code class="vardecl">qhoin</code>, <code class="vardecl">uhoin</code>, <code class="vardecl">vhoin</code>, <code class="label">&</code></a>
<a name="rase_tracer_di0"></a><a href="convection_tracer.html#rase_tracer" target="origFile"><code class="label">& </code><code class="vardecl">co_auto</code>, <code class="vardecl">ple</code>, <code class="vardecl">rasparams</code>, <code class="vardecl">estblx</code>, <code class="vardecl">itrcr</code>, <code class="vardecl">xho</code>, <code class="vardecl">xhod</code>, <code class="vardecl">fscav</code>)</a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="rase_tracer_di1"></a><a href="convection_tracer.html#rase_traceri0" target="origFile"><code class="comment">!INPUTS</code></a>
<a name="rase_tracer_di2"></a>  <a href="convection_tracer.html#rase_traceri0" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">idim</code>, <code class="vardecl">irun</code>, <code class="vardecl">k0</code>, <code class="vardecl">icmin</code></a>
<a name="rase_tracer_di3"></a>  <a href="convection_tracer.html#rase_traceri1" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ple</code></a>
<a name="rase_tracer_di4"></a>  <a href="convection_tracer.html#rase_traceri2" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">sige</code></a>
<a name="rase_tracer_di5"></a>  <a href="convection_tracer.html#rase_traceri3" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dt</code>, <code class="vardecl">cons_cp</code>, <code class="vardecl">cons_alhl</code>, <code class="vardecl">cons_grav</code>, <code class="vardecl">cons_rgas</code></a>
<a name="rase_tracer_di6"></a>  <a href="convection_tracer.html#rase_traceri4" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cons_h2omw</code>, <code class="vardecl">cons_airmw</code>, <code class="vardecl">cons_vireps</code></a>
<a name="rase_tracer_di7"></a>  <a href="convection_tracer.html#rase_traceri5" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">seedras</code></a>
<a name="rase_tracer_di8"></a>  <a href="convection_tracer.html#rase_traceri6" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kcbl</code></a>
<a name="rase_tracer_di9"></a>  <a href="convection_tracer.html#rase_traceri7" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ts</code>, <code class="vardecl">frland</code></a>
<a name="rase_tracer_di10"></a>  <a href="convection_tracer.html#rase_traceri8" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">co_auto</code></a>
<a name="rase_tracer_di11"></a>  <a href="convection_tracer.html#rase_traceri9" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">wgt0</code>, <code class="vardecl">wgt1</code></a>
<a name="rase_tracer_di12"></a>  <a href="convection_tracer.html#rase_traceri10" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rasparams</code></a>
<a name="rase_tracer_di13"></a>  <a href="convection_tracer.html#rase_traceri11" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">estblx</code></a>
<a name="rase_tracer_di14"></a>  <a href="convection_tracer.html#rase_traceri12" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">itrcr</code></a>
<a name="rase_tracer_di15"></a>  <a href="convection_tracer.html#rase_traceri13" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>itrcr<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">fscav</code></a>
  <a href="convection_tracer.html#rase_traceri14" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">thoin</code>, <code class="vardecl">qhoin</code>, <code class="vardecl">uhoin</code>, <code class="vardecl">vhoin</code></a>
<a href="convection_tracer.html#rase_traceri15" target="origFile"><code class="comment">!PROGNOSTIC</code></a>
<a name="rase_tracer_di16"></a>  <a href="convection_tracer.html#rase_traceri15" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0, itrcr<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">xho</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(idim, k0, itrcr), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">xhod</code></a>
<a name="rase_tracer_di17"></a><a href="convection_tracer.html#rase_traceri16" target="origFile"><code class="comment">!LOCALS</code></a>
  <a href="convection_tracer.html#rase_traceri16" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">ic</code>, <code class="vardecl">l</code>, <code class="vardecl">kk</code>, <code class="vardecl">k</code></a>
<a name="rase_tracer_di18"></a><a href="convection_tracer.html#rase_traceri17" target="origFile"><code class="comment">!Parameters</code></a>
<a name="rase_tracer_di19"></a>  <a href="convection_tracer.html#rase_traceri17" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">onepkap</code>=<code class="constant">1.</code>+<code class="constant">2.</code>/<code class="constant">7.</code>, <code class="vardecl">daylen</code>=<code class="constant">86400.0</code></a>
<a name="rase_tracer_di20"></a>  <a href="convection_tracer.html#rase_traceri18" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">rhmax</code>=<code class="constant">0.9999</code></a>
<a name="rase_tracer_di21"></a>  <a href="convection_tracer.html#rase_traceri19" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_qpert</code>=<code class="constant">0.0</code>, <code class="vardecl">cbl_tpert</code>=<code class="constant">1.0</code></a>
  <a href="convection_tracer.html#rase_traceri20" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">cbl_tpert_mxocn</code>=<code class="constant">2.0</code>, <code class="vardecl">cbl_tpert_mxlnd</code>=<code class="constant">4.0</code></a>
<a name="rase_tracer_di22"></a><a href="convection_tracer.html#rase_traceri21" target="origFile"><code class="comment">!Constants</code></a>
  <a href="convection_tracer.html#rase_traceri21" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">grav</code>, <code class="vardecl">cp</code>, <code class="vardecl">alhl</code>, <code class="vardecl">cpbg</code>, <code class="vardecl">alhi</code>, <code class="vardecl">cpi</code>, <code class="vardecl">gravi</code>, <code class="vardecl">ddt</code>, <code class="vardecl">lbcp</code></a>
<a name="rase_tracer_di23"></a><a href="convection_tracer.html#rase_traceri22" target="origFile"><code class="comment">!Rasparams</code></a>
<a name="rase_tracer_di24"></a>  <a href="convection_tracer.html#rase_traceri22" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fricfac</code>, <code class="vardecl">cli_crit</code>, <code class="vardecl">rasal1</code>, <code class="vardecl">rasal2</code></a>
<a name="rase_tracer_di25"></a>  <a href="convection_tracer.html#rase_traceri23" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">friclambda</code></a>
<a name="rase_tracer_di26"></a>  <a href="convection_tracer.html#rase_traceri24" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sdqv2</code>, <code class="vardecl">sdqv3</code>, <code class="vardecl">sdqvt1</code></a>
<a name="rase_tracer_di27"></a>  <a href="convection_tracer.html#rase_traceri25" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">acritfac</code>, <code class="vardecl">pblfrac</code>, <code class="vardecl">autorampb</code></a>
<a name="rase_tracer_di28"></a>  <a href="convection_tracer.html#rase_traceri26" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxdallowed</code>, <code class="vardecl">rhmn</code>, <code class="vardecl">rhmx</code></a>
<a name="rase_tracer_di29"></a>  <a href="convection_tracer.html#rase_traceri27" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">mxdiam</code></a>
<a name="rase_tracer_di30"></a>  <a href="convection_tracer.html#rase_traceri28" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tx2</code>, <code class="vardecl">tx3</code>, <code class="vardecl">akm</code>, <code class="vardecl">acr</code>, <code class="vardecl">alm</code>, <code class="vardecl">tth</code>, <code class="vardecl">qqh</code>, <code class="vardecl">dqx</code></a>
<a name="rase_tracer_di31"></a>  <a href="convection_tracer.html#rase_traceri29" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wfn</code>, <code class="vardecl">tem</code>, <code class="vardecl">trg</code>, <code class="vardecl">trgexp</code>, <code class="vardecl">evp</code>, <code class="vardecl">wlq</code>, <code class="vardecl">qcc</code></a>
<a name="rase_tracer_di32"></a>  <a href="convection_tracer.html#rase_traceri30" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cli</code>, <code class="vardecl">te_a</code>, <code class="vardecl">c00_x</code>, <code class="vardecl">cli_crit_x</code>, <code class="vardecl">toki</code></a>
<a name="rase_tracer_di33"></a>  <a href="convection_tracer.html#rase_traceri31" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dt_lyr</code>, <code class="vardecl">rate</code>, <code class="vardecl">cvw_x</code>, <code class="vardecl">closs</code>, <code class="vardecl">f2</code>, <code class="vardecl">f3</code>, <code class="vardecl">f4</code></a>
<a name="rase_tracer_di34"></a>  <a href="convection_tracer.html#rase_traceri32" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">wght0</code>, <code class="vardecl">prcbl</code>, <code class="vardecl">rndu</code></a>
<a name="rase_tracer_di35"></a>  <a href="convection_tracer.html#rase_traceri33" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">lambda_min</code>, <code class="vardecl">lambda_max</code></a>
<a name="rase_tracer_di36"></a>  <a href="convection_tracer.html#rase_traceri34" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">tpert</code>, <code class="vardecl">qpert</code></a>
<a name="rase_tracer_di37"></a>  <a href="convection_tracer.html#rase_traceri35" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">uht</code>, <code class="vardecl">vht</code></a>
  <a href="convection_tracer.html#rase_traceri36" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_sv</code>, <code class="vardecl">qoi_sv</code>, <code class="vardecl">uoi_sv</code>, <code class="vardecl">voi_sv</code></a>
<a name="rase_tracer_di38"></a>  <a href="convection_tracer.html#rase_traceri37" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi</code>, <code class="vardecl">qoi</code>, <code class="vardecl">uoi</code>, <code class="vardecl">voi</code>, <code class="vardecl">dqq</code>, <code class="vardecl">bet</code>, <code class="vardecl">gam</code>, <code class="vardecl">cll</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poid</code>, <code class="vardecl">qoid</code>, <code class="vardecl">dqqd</code>, <code class="vardecl">betd</code>, <code class="vardecl">gamd</code></a>
<a name="rase_tracer_di39"></a>  <a href="convection_tracer.html#rase_traceri38" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">poi_c</code>, <code class="vardecl">qoi_c</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">poi_cd</code>, <code class="vardecl">qoi_cd</code></a>
<a name="rase_tracer_di40"></a>  <a href="convection_tracer.html#rase_traceri39" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">prh</code>, <code class="vardecl">pri</code>, <code class="vardecl">ght</code>, <code class="vardecl">dpt</code>, <code class="vardecl">dpb</code>, <code class="vardecl">pki</code></a>
<a name="rase_tracer_di41"></a>  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">prhd</code>, <code class="vardecl">prid</code>, <code class="vardecl">ghtd</code>, <code class="vardecl">dptd</code>, <code class="vardecl">dpbd</code>, <code class="vardecl">pkid</code></a>
  <a href="convection_tracer.html#rase_traceri40" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">ucu</code>, <code class="vardecl">vcu</code></a>
<a name="rase_tracer_di42"></a>  <a href="convection_tracer.html#rase_traceri41" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">cln</code>, <code class="vardecl">rns</code>, <code class="vardecl">pol</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">pold</code></a>
<a name="rase_tracer_di43"></a>  <a href="convection_tracer.html#rase_traceri42" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qst</code>, <code class="vardecl">ssl</code>, <code class="vardecl">rmf</code>, <code class="vardecl">rnn</code>, <code class="vardecl">rn1</code>, <code class="vardecl">rmfc</code>, <code class="vardecl">rmfp</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">qstd</code>, <code class="vardecl">ssld</code></a>
<a name="rase_tracer_di44"></a>  <a href="convection_tracer.html#rase_traceri43" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">gms</code>, <code class="vardecl">eta</code>, <code class="vardecl">gmh</code>, <code class="vardecl">eht</code>, <code class="vardecl">gm1</code>, <code class="vardecl">hcc</code>, <code class="vardecl">rmfd</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">gmsd</code>, <code class="vardecl">etad</code>, <code class="vardecl">gmhd</code>, <code class="vardecl">ehtd</code>, <code class="vardecl">hccd</code></a>
<a name="rase_tracer_di45"></a>  <a href="convection_tracer.html#rase_traceri44" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">hol</code>, <code class="vardecl">hst</code>, <code class="vardecl">qol</code>, <code class="vardecl">zol</code>, <code class="vardecl">hcld</code>, <code class="vardecl">cll0</code>, <code class="vardecl">cllx</code>, <code class="vardecl">clli</code></a>
<a name="rase_tracer_di46"></a>  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">hold</code>, <code class="vardecl">hstd</code>, <code class="vardecl">qold</code>, <code class="vardecl">zold</code></a>
  <a href="convection_tracer.html#rase_traceri45" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">bke</code>, <code class="vardecl">cvw</code>, <code class="vardecl">updfrc</code></a>
<a name="rase_tracer_di47"></a>  <a href="convection_tracer.html#rase_traceri46" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">rasal</code>, <code class="vardecl">updfrp</code>, <code class="vardecl">bk2</code>, <code class="vardecl">dll0</code>, <code class="vardecl">dllx</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">rasald</code></a>
<a name="rase_tracer_di48"></a>  <a href="convection_tracer.html#rase_traceri47" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">wght</code>, <code class="vardecl">massf</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">wghtd</code></a>
<a name="rase_tracer_di49"></a>  <a href="convection_tracer.html#rase_traceri48" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0<code class="typename">) </code>:: <code class="vardecl">qss</code>, <code class="vardecl">dqs</code>, <code class="vardecl">pf</code>, <code class="vardecl">pk</code>, <code class="vardecl">tempf</code>, <code class="vardecl">zlo</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">zlod</code></a>
<a name="rase_tracer_di50"></a>  <a href="convection_tracer.html#rase_traceri49" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0 + <code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">prj</code>, <code class="vardecl">prs</code>, <code class="vardecl">qht</code>, <code class="vardecl">sht</code>, <code class="vardecl">zet</code>, <code class="vardecl">zle</code>, <code class="vardecl">pke</code></a>
<a name="rase_tracer_di51"></a>  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">prjd</code>, <code class="vardecl">prsd</code>, <code class="vardecl">qhtd</code>, <code class="vardecl">shtd</code>, <code class="vardecl">zetd</code>, <code class="vardecl">zled</code></a>
  <a href="convection_tracer.html#rase_traceri50" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>idim, k0<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">tho</code>, <code class="vardecl">qho</code>, <code class="vardecl">uho</code>, <code class="vardecl">vho</code></a>
<a name="rase_tracer_di52"></a><a href="convection_tracer.html#rase_traceri51" target="origFile"><code class="comment">!Tracer scavenging</code></a>
  <a href="convection_tracer.html#rase_traceri51" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">itr</code></a>
<a name="rase_tracer_di53"></a><a href="convection_tracer.html#rase_traceri52" target="origFile"><code class="comment">!Layer thickness in km</code></a>
  <a href="convection_tracer.html#rase_traceri52" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">delzkm</code></a>
<a name="rase_tracer_di54"></a><a href="convection_tracer.html#rase_traceri53" target="origFile"><code class="comment">!Fraction of tracer *not* scavenged</code></a>
  <a href="convection_tracer.html#rase_traceri53" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fnoscav</code></a>
<a name="rase_tracer_di55"></a>  <a href="convection_tracer.html#rase_traceri54" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>k0, itrcr<code class="typename">) </code>:: <code class="vardecl">xoi</code>, <code class="vardecl">xcu</code>, <code class="vardecl">xoi_sv</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0, itrcr) :: <code class="vardecl">xoid</code>, <code class="vardecl">xcud</code>, <code class="vardecl">xoi_svd</code></a>
<a name="rase_tracer_di56"></a>  <a href="convection_tracer.html#rase_traceri55" target="origFile"><code class="typename">REAL*8</code>, <code class="typename">DIMENSION(</code>itrcr<code class="typename">) </code>:: <code class="vardecl">xht</code></a>
<a name="rase_tracer_di57"></a>  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(itrcr) :: <code class="vardecl">xhtd</code></a>
<a name="rase_tracer_di58"></a>  <a href="convection_tracer.html#rase_traceri56" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="rase_tracer_di59"></a>  <a href="convection_tracer.html#rase_traceri57" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="rase_tracer_di60"></a>  <a href="convection_tracer.html#rase_traceri58" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
<a name="rase_tracer_di61"></a>  <a href="convection_tracer.html#rase_traceri59" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
<a name="rase_tracer_di62"></a>  <a href="convection_tracer.html#rase_traceri60" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
<a name="rase_tracer_di63"></a>  <a href="convection_tracer.html#rase_traceri61" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0+<code class="constant">1</code>) :: <code class="vardecl">pwx1</code></a>
<a name="rase_tracer_di64"></a>  <a href="convection_tracer.html#rase_traceri62" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwy1</code></a>
<a name="rase_tracer_di65"></a>  <a href="convection_tracer.html#rase_traceri63" target="origFile"><code class="typename">REAL*8</code>, DIMENSION(k0) :: <code class="vardecl">pwx10</code></a>
<a name="rase_tracer_di66"></a>  <a href="convection_tracer.html#rase_traceri64" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwx11</code></a>
  <a href="convection_tracer.html#rase_traceri65" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">pwr1</code></a>
  <a href="convection_tracer.html#rase_traceri66" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x5</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x4</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x3</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x2</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">x1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max2</code></a>
<a name="rase_tracer_di67"></a>  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">max1</code></a>
  <a href="convection_tracer.html#rase_tracer" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">y1</code></a>
<a name="rase_tracer_di68"></a><a href="convection_tracer.html#rase_traceri67" target="origFile"><code class="comment">!Pass meteorology to internal arrays so it is not updated</code></a>
<a name="rase_tracer_di69"></a>  <a href="convection_tracer.html#rase_traceri67" target="origFile">tho = thoin</a>
<a name="rase_tracer_di70"></a>  <a href="convection_tracer.html#rase_traceri68" target="origFile">qho = qhoin</a>
<a name="rase_tracer_di71"></a>  <a href="convection_tracer.html#rase_traceri69" target="origFile">uho = uhoin</a>
  <a href="convection_tracer.html#rase_traceri70" target="origFile">vho = vhoin</a>
<a name="rase_tracer_di72"></a><a href="convection_tracer.html#rase_traceri71" target="origFile"><code class="comment">!Initialize Local Arrays</code></a>
<a name="rase_tracer_di73"></a>  <a href="convection_tracer.html#rase_traceri71" target="origFile">poi = <code class="constant">0.0</code></a>
<a name="rase_tracer_di74"></a>  <a href="convection_tracer.html#rase_traceri72" target="origFile">qoi = <code class="constant">0.0</code></a>
<a name="rase_tracer_di75"></a>  <a href="convection_tracer.html#rase_traceri73" target="origFile">uoi = <code class="constant">0.0</code></a>
<a name="rase_tracer_di76"></a>  <a href="convection_tracer.html#rase_traceri74" target="origFile">voi = <code class="constant">0.0</code></a>
<a name="rase_tracer_di77"></a>  <a href="convection_tracer.html#rase_traceri75" target="origFile">dqq = <code class="constant">0.0</code></a>
<a name="rase_tracer_di78"></a>  <a href="convection_tracer.html#rase_traceri76" target="origFile">bet = <code class="constant">0.0</code></a>
<a name="rase_tracer_di79"></a>  <a href="convection_tracer.html#rase_traceri77" target="origFile">gam = <code class="constant">0.0</code></a>
<a name="rase_tracer_di80"></a>  <a href="convection_tracer.html#rase_traceri78" target="origFile">poi_c = <code class="constant">0.0</code></a>
<a name="rase_tracer_di81"></a>  <a href="convection_tracer.html#rase_traceri79" target="origFile">qoi_c = <code class="constant">0.0</code></a>
<a name="rase_tracer_di82"></a>  <a href="convection_tracer.html#rase_traceri80" target="origFile">prh = <code class="constant">0.0</code></a>
<a name="rase_tracer_di83"></a>  <a href="convection_tracer.html#rase_traceri81" target="origFile">pri = <code class="constant">0.0</code></a>
<a name="rase_tracer_di84"></a>  <a href="convection_tracer.html#rase_traceri82" target="origFile">ght = <code class="constant">0.0</code></a>
<a name="rase_tracer_di85"></a>  <a href="convection_tracer.html#rase_traceri83" target="origFile">dpt = <code class="constant">0.0</code></a>
<a name="rase_tracer_di86"></a>  <a href="convection_tracer.html#rase_traceri84" target="origFile">dpb = <code class="constant">0.0</code></a>
<a name="rase_tracer_di87"></a>  <a href="convection_tracer.html#rase_traceri85" target="origFile">pki = <code class="constant">0.0</code></a>
<a name="rase_tracer_di88"></a>  <a href="convection_tracer.html#rase_traceri86" target="origFile">ucu = <code class="constant">0.0</code></a>
<a name="rase_tracer_di89"></a>  <a href="convection_tracer.html#rase_traceri87" target="origFile">vcu = <code class="constant">0.0</code></a>
<a name="rase_tracer_di90"></a>  <a href="convection_tracer.html#rase_traceri88" target="origFile">cln = <code class="constant">0.0</code></a>
<a name="rase_tracer_di91"></a>  <a href="convection_tracer.html#rase_traceri89" target="origFile">pol = <code class="constant">0.0</code></a>
<a name="rase_tracer_di92"></a>  <a href="convection_tracer.html#rase_traceri90" target="origFile">qst = <code class="constant">0.0</code></a>
<a name="rase_tracer_di93"></a>  <a href="convection_tracer.html#rase_traceri91" target="origFile">ssl = <code class="constant">0.0</code></a>
<a name="rase_tracer_di94"></a>  <a href="convection_tracer.html#rase_traceri92" target="origFile">rmf = <code class="constant">0.0</code></a>
<a name="rase_tracer_di95"></a>  <a href="convection_tracer.html#rase_traceri93" target="origFile">rnn = <code class="constant">0.0</code></a>
<a name="rase_tracer_di96"></a>  <a href="convection_tracer.html#rase_traceri94" target="origFile">rn1 = <code class="constant">0.0</code></a>
<a name="rase_tracer_di97"></a>  <a href="convection_tracer.html#rase_traceri95" target="origFile">gms = <code class="constant">0.0</code></a>
<a name="rase_tracer_di98"></a>  <a href="convection_tracer.html#rase_traceri96" target="origFile">eta = <code class="constant">0.0</code></a>
<a name="rase_tracer_di99"></a>  <a href="convection_tracer.html#rase_traceri97" target="origFile">gmh = <code class="constant">0.0</code></a>
<a name="rase_tracer_di100"></a>  <a href="convection_tracer.html#rase_traceri98" target="origFile">eht = <code class="constant">0.0</code></a>
<a name="rase_tracer_di101"></a>  <a href="convection_tracer.html#rase_traceri99" target="origFile">gm1 = <code class="constant">0.0</code></a>
<a name="rase_tracer_di102"></a>  <a href="convection_tracer.html#rase_traceri100" target="origFile">hcc = <code class="constant">0.0</code></a>
<a name="rase_tracer_di103"></a>  <a href="convection_tracer.html#rase_traceri101" target="origFile">hol = <code class="constant">0.0</code></a>
<a name="rase_tracer_di104"></a>  <a href="convection_tracer.html#rase_traceri102" target="origFile">hst = <code class="constant">0.0</code></a>
<a name="rase_tracer_di105"></a>  <a href="convection_tracer.html#rase_traceri103" target="origFile">qol = <code class="constant">0.0</code></a>
<a name="rase_tracer_di106"></a>  <a href="convection_tracer.html#rase_traceri104" target="origFile">zol = <code class="constant">0.0</code></a>
<a name="rase_tracer_di107"></a>  <a href="convection_tracer.html#rase_traceri105" target="origFile">hcld = <code class="constant">0.0</code></a>
<a name="rase_tracer_di108"></a>  <a href="convection_tracer.html#rase_traceri106" target="origFile">bke = <code class="constant">0.0</code></a>
<a name="rase_tracer_di109"></a>  <a href="convection_tracer.html#rase_traceri107" target="origFile">cvw = <code class="constant">0.0</code></a>
<a name="rase_tracer_di110"></a>  <a href="convection_tracer.html#rase_traceri108" target="origFile">updfrc = <code class="constant">0.0</code></a>
<a name="rase_tracer_di111"></a>  <a href="convection_tracer.html#rase_traceri109" target="origFile">rasal = <code class="constant">0.0</code></a>
<a name="rase_tracer_di112"></a>  <a href="convection_tracer.html#rase_traceri110" target="origFile">updfrp = <code class="constant">0.0</code></a>
<a name="rase_tracer_di113"></a>  <a href="convection_tracer.html#rase_traceri111" target="origFile">bk2 = <code class="constant">0.0</code></a>
<a name="rase_tracer_di114"></a>  <a href="convection_tracer.html#rase_traceri112" target="origFile">wght = <code class="constant">0.0</code></a>
<a name="rase_tracer_di115"></a>  <a href="convection_tracer.html#rase_traceri113" target="origFile">massf = <code class="constant">0.0</code></a>
<a name="rase_tracer_di116"></a>  <a href="convection_tracer.html#rase_traceri114" target="origFile">qss = <code class="constant">0.0</code></a>
<a name="rase_tracer_di117"></a>  <a href="convection_tracer.html#rase_traceri115" target="origFile">dqs = <code class="constant">0.0</code></a>
<a name="rase_tracer_di118"></a>  <a href="convection_tracer.html#rase_traceri116" target="origFile">pf = <code class="constant">0.0</code></a>
<a name="rase_tracer_di119"></a>  <a href="convection_tracer.html#rase_traceri117" target="origFile">pk = <code class="constant">0.0</code></a>
<a name="rase_tracer_di120"></a>  <a href="convection_tracer.html#rase_traceri118" target="origFile">tempf = <code class="constant">0.0</code></a>
<a name="rase_tracer_di121"></a>  <a href="convection_tracer.html#rase_traceri119" target="origFile">zlo = <code class="constant">0.0</code></a>
<a name="rase_tracer_di122"></a>  <a href="convection_tracer.html#rase_traceri120" target="origFile">prj = <code class="constant">0.0</code></a>
<a name="rase_tracer_di123"></a>  <a href="convection_tracer.html#rase_traceri121" target="origFile">prs = <code class="constant">0.0</code></a>
<a name="rase_tracer_di124"></a>  <a href="convection_tracer.html#rase_traceri122" target="origFile">qht = <code class="constant">0.0</code></a>
<a name="rase_tracer_di125"></a>  <a href="convection_tracer.html#rase_traceri123" target="origFile">sht = <code class="constant">0.0</code></a>
<a name="rase_tracer_di126"></a>  <a href="convection_tracer.html#rase_traceri124" target="origFile">zet = <code class="constant">0.0</code></a>
<a name="rase_tracer_di127"></a>  <a href="convection_tracer.html#rase_traceri125" target="origFile">zle = <code class="constant">0.0</code></a>
  <a href="convection_tracer.html#rase_traceri126" target="origFile">pke = <code class="constant">0.0</code></a>
<a name="rase_tracer_di128"></a><a href="convection_tracer.html#rase_traceri127" target="origFile"><code class="comment">!  ---  1</code></a>
  <a href="convection_tracer.html#rase_traceri127" target="origFile">fricfac = rasparams(<code class="constant">1</code>)</a>
<a name="rase_tracer_di129"></a><a href="convection_tracer.html#rase_traceri128" target="origFile"><code class="comment">!  ---  4</code></a>
  <a href="convection_tracer.html#rase_traceri128" target="origFile">cli_crit = rasparams(<code class="constant">4</code>)</a>
<a name="rase_tracer_di130"></a><a href="convection_tracer.html#rase_traceri129" target="origFile"><code class="comment">!  ---  5</code></a>
  <a href="convection_tracer.html#rase_traceri129" target="origFile">rasal1 = rasparams(<code class="constant">5</code>)</a>
<a name="rase_tracer_di131"></a><a href="convection_tracer.html#rase_traceri130" target="origFile"><code class="comment">!  ---  6</code></a>
  <a href="convection_tracer.html#rase_traceri130" target="origFile">rasal2 = rasparams(<code class="constant">6</code>)</a>
<a name="rase_tracer_di132"></a><a href="convection_tracer.html#rase_traceri131" target="origFile"><code class="comment">!  --- 11</code></a>
  <a href="convection_tracer.html#rase_traceri131" target="origFile">friclambda = rasparams(<code class="constant">11</code>)</a>
<a name="rase_tracer_di133"></a><a href="convection_tracer.html#rase_traceri132" target="origFile"><code class="comment">!  --- 14</code></a>
  <a href="convection_tracer.html#rase_traceri132" target="origFile">sdqv2 = rasparams(<code class="constant">14</code>)</a>
<a name="rase_tracer_di134"></a><a href="convection_tracer.html#rase_traceri133" target="origFile"><code class="comment">!  --- 15</code></a>
  <a href="convection_tracer.html#rase_traceri133" target="origFile">sdqv3 = rasparams(<code class="constant">15</code>)</a>
<a name="rase_tracer_di135"></a><a href="convection_tracer.html#rase_traceri134" target="origFile"><code class="comment">!  --- 16</code></a>
  <a href="convection_tracer.html#rase_traceri134" target="origFile">sdqvt1 = rasparams(<code class="constant">16</code>)</a>
<a name="rase_tracer_di136"></a><a href="convection_tracer.html#rase_traceri135" target="origFile"><code class="comment">!  --- 17</code></a>
  <a href="convection_tracer.html#rase_traceri135" target="origFile">acritfac = rasparams(<code class="constant">17</code>)</a>
<a name="rase_tracer_di137"></a><a href="convection_tracer.html#rase_traceri136" target="origFile"><code class="comment">!  --- 20</code></a>
  <a href="convection_tracer.html#rase_traceri136" target="origFile">pblfrac = rasparams(<code class="constant">20</code>)</a>
<a name="rase_tracer_di138"></a><a href="convection_tracer.html#rase_traceri137" target="origFile"><code class="comment">!  --- 21</code></a>
  <a href="convection_tracer.html#rase_traceri137" target="origFile">autorampb = rasparams(<code class="constant">21</code>)</a>
<a name="rase_tracer_di139"></a><a href="convection_tracer.html#rase_traceri138" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_tracer.html#rase_traceri138" target="origFile">rhmn = rasparams(<code class="constant">24</code>)</a>
<a name="rase_tracer_di140"></a><a href="convection_tracer.html#rase_traceri139" target="origFile"><code class="comment">!  --- 24</code></a>
  <a href="convection_tracer.html#rase_traceri139" target="origFile">maxdallowed = rasparams(<code class="constant">23</code>)</a>
<a name="rase_tracer_di141"></a><a href="convection_tracer.html#rase_traceri140" target="origFile"><code class="comment">!  --- 25</code></a>
<a name="rase_tracer_di142"></a>  <a href="convection_tracer.html#rase_traceri140" target="origFile">rhmx = rasparams(<code class="constant">25</code>)</a>
<a name="rase_tracer_di143"></a>  <a href="convection_tracer.html#rase_traceri141" target="origFile">grav = cons_grav</a>
<a name="rase_tracer_di144"></a>  <a href="convection_tracer.html#rase_traceri142" target="origFile">alhl = cons_alhl</a>
<a name="rase_tracer_di145"></a>  <a href="convection_tracer.html#rase_traceri143" target="origFile">cp = cons_cp</a>
<a name="rase_tracer_di146"></a>  <a href="convection_tracer.html#rase_traceri144" target="origFile">cpi = <code class="constant">1.0</code>/cp</a>
<a name="rase_tracer_di147"></a>  <a href="convection_tracer.html#rase_traceri145" target="origFile">alhi = <code class="constant">1.0</code>/alhl</a>
<a name="rase_tracer_di148"></a>  <a href="convection_tracer.html#rase_traceri146" target="origFile">gravi = <code class="constant">1.0</code>/grav</a>
<a name="rase_tracer_di149"></a>  <a href="convection_tracer.html#rase_traceri147" target="origFile">cpbg = cp*gravi</a>
<a name="rase_tracer_di150"></a>  <a href="convection_tracer.html#rase_traceri148" target="origFile">ddt = daylen/dt</a>
<a name="rase_tracer_di151"></a>  <a href="convection_tracer.html#rase_traceri149" target="origFile">lbcp = alhl*cpi</a>
  <a href="convection_tracer.html#rase_traceri150" target="origFile">i = <code class="constant">1</code></a>
<a name="rase_tracer_di152"></a><a href="convection_tracer.html#rase_traceri151" target="origFile"><code class="comment">!CALL FINDBASE</code></a>
<a name="rase_tracer_di153"></a>  <a href="convection_tracer.html#rase_traceri151" target="origFile">k = kcbl(i)</a>
  <a href="convection_tracer.html#rase_traceri152" target="origFile"><code class="keyword">IF</code> (k .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di154"></a><a href="convection_tracer.html#rase_traceri153" target="origFile"><code class="comment">!Get saturation specific humidity and gradient wrt to T</code></a>
<a name="rase_tracer_di155"></a>    <a href="convection_tracer.html#rase_traceri153" target="origFile">pwx1 = ple(i, :)/<code class="constant">1000.</code></a>
<a name="rase_tracer_di156"></a>    <a href="convection_tracer.html#rase_traceri154" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_tracer_di157"></a>    <a href="convection_tracer.html#rase_traceri155" target="origFile">pke = pwx1**pwy1</a>
<a name="rase_tracer_di158"></a>    <a href="convection_tracer.html#rase_traceri156" target="origFile">pf = <code class="constant">0.5</code>*(ple(i, <code class="constant">1</code>:k0)+ple(i, <code class="constant">2</code>:k0+<code class="constant">1</code>))</a>
<a name="rase_tracer_di159"></a>    <a href="convection_tracer.html#rase_traceri157" target="origFile">pwx10 = pf/<code class="constant">1000.</code></a>
<a name="rase_tracer_di160"></a>    <a href="convection_tracer.html#rase_traceri158" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_tracer_di161"></a>    <a href="convection_tracer.html#rase_traceri159" target="origFile">pk = pwx10**pwy1</a>
<a name="rase_tracer_di162"></a>    <a href="convection_tracer.html#rase_traceri160" target="origFile">tempf = tho(i, :)*pk</a>
<a name="rase_tracer_di163"></a>    <a href="convection_tracer.html#rase_traceri161" target="origFile">zle = <code class="constant">0.0</code></a>
<a name="rase_tracer_di163"></a>    <a href="convection_tracer.html#rase_traceri162" target="origFile">zlo = <code class="constant">0.0</code></a>
<a name="rase_tracer_di167"></a>    <a href="convection_tracer.html#rase_traceri163" target="origFile">zled(k0+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di164"></a>    <a href="convection_tracer.html#rase_traceri163" target="origFile">zle(k0+<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_tracer_di164"></a>    <a href="convection_tracer.html#rase_traceri167" target="origFile"><code class="keyword">DO </code>l=k0,<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_tracer_di165"></a>      <a href="convection_tracer.html#rase_traceri164" target="origFile">zled(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di165"></a>      <a href="convection_tracer.html#rase_traceri164" target="origFile">zle(l) = tho(i, l)*(<code class="constant">1.</code>+cons_vireps*qho(i, l))</a>
<a name="rase_tracer_di166"></a>      <a href="convection_tracer.html#rase_traceri165" target="origFile">zlod(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di166"></a>      <a href="convection_tracer.html#rase_traceri165" target="origFile">zlo(l) = zle(l+<code class="constant">1</code>) + cons_cp/cons_grav*(pke(l+<code class="constant">1</code>)-pk(l))*zle(l)</a>
      <a href="convection_tracer.html#rase_traceri166" target="origFile">zled(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di168"></a>      <a href="convection_tracer.html#rase_traceri166" target="origFile">zle(l) = zlo(l) + cons_cp/cons_grav*(pk(l)-pke(l))*zle(l)</a>
<a name="rase_tracer_di169"></a>    <a href="convection_tracer.html#rase_traceri167" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri168" target="origFile">tpert = cbl_tpert*(ts(i)-(tempf(k0)+cons_grav*zlo(k0)/cons_cp))</a>
<a name="rase_tracer_di170"></a><a href="convection_tracer.html#rase_traceri169" target="origFile"><code class="comment">!* ( QSSFC - Q(:,:,K0) ) [CBL_QPERT = 0.0]</code></a>
<a name="rase_tracer_di171"></a>    <a href="convection_tracer.html#rase_traceri169" target="origFile">qpert = cbl_qpert</a>
    <a href="convection_tracer.html#rase_traceri170" target="origFile"><code class="keyword">IF</code> (tpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di172"></a>      <a href="convection_tracer.html#rase_traceri171" target="origFile">tpert = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri170" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di173"></a>      <a href="convection_tracer.html#rase_traceri172" target="origFile">tpert = tpert</a>
<a name="rase_tracer_di174"></a>    <a href="convection_tracer.html#rase_traceri170" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri173" target="origFile"><code class="keyword">IF</code> (qpert .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di175"></a>      <a href="convection_tracer.html#rase_traceri174" target="origFile">qpert = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri173" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di176"></a>      <a href="convection_tracer.html#rase_traceri175" target="origFile">qpert = qpert</a>
<a name="rase_tracer_di177"></a>    <a href="convection_tracer.html#rase_traceri173" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di178"></a>    <a href="convection_tracer.html#rase_traceri176" target="origFile"><code class="keyword">IF</code> (frland(i) .LT. <code class="constant">0.1</code>) <code class="keyword">THEN</code></a>
      <a href="convection_tracer.html#rase_traceri177" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxocn) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di179"></a>        <a href="convection_tracer.html#rase_traceri178" target="origFile">tpert = cbl_tpert_mxocn</a>
      <a href="convection_tracer.html#rase_traceri177" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di180"></a>        <a href="convection_tracer.html#rase_traceri179" target="origFile">tpert = tpert</a>
<a name="rase_tracer_di181"></a>      <a href="convection_tracer.html#rase_traceri177" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri176" target="origFile"><code class="keyword">ELSE </code></a><a href="convection_tracer.html#rase_traceri180" target="origFile"><code class="keyword">IF</code> (tpert .GT. cbl_tpert_mxlnd) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di182"></a>      <a href="convection_tracer.html#rase_traceri181" target="origFile">tpert = cbl_tpert_mxlnd</a>
    <a href="convection_tracer.html#rase_traceri180" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di183"></a>      <a href="convection_tracer.html#rase_traceri182" target="origFile">tpert = tpert</a>
    <a href="convection_tracer.html#rase_traceri176" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di185"></a>    <a href="convection_tracer.html#rase_traceri183" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSAT_RAS</code>(dqs, qss, tempf, pf, k0, estblx, cons_h2omw, <code class="label">&</code></a>
<a name="rase_tracer_di184"></a><a href="convection_tracer.html#rase_traceri183" target="origFile"><code class="label">&            </code>cons_airmw)</a>
<a name="rase_tracer_di184"></a>    <a href="convection_tracer.html#rase_traceri185" target="origFile"><code class="keyword">DO </code>kk=icmin,k+<code class="constant">1</code></a>
      <a href="convection_tracer.html#rase_traceri184" target="origFile">prjd(kk) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di186"></a>      <a href="convection_tracer.html#rase_traceri184" target="origFile">prj(kk) = pke(kk)</a>
<a name="rase_tracer_di186"></a>    <a href="convection_tracer.html#rase_traceri185" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di187"></a>    <a href="convection_tracer.html#rase_traceri186" target="origFile">prsd(icmin:k0+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di187"></a>    <a href="convection_tracer.html#rase_traceri186" target="origFile">prs(icmin:k0+<code class="constant">1</code>) = ple(i, icmin:k0+<code class="constant">1</code>)</a>
<a name="rase_tracer_di188"></a>    <a href="convection_tracer.html#rase_traceri187" target="origFile">poid(icmin:k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di188"></a>    <a href="convection_tracer.html#rase_traceri187" target="origFile">poi(icmin:k) = tho(i, icmin:k)</a>
<a name="rase_tracer_di189"></a>    <a href="convection_tracer.html#rase_traceri188" target="origFile">qoid(icmin:k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di190"></a>    <a href="convection_tracer.html#rase_traceri188" target="origFile">qoi(icmin:k) = qho(i, icmin:k)</a>
<a name="rase_tracer_di191"></a>    <a href="convection_tracer.html#rase_traceri189" target="origFile">uoi(icmin:k) = uho(i, icmin:k)</a>
<a name="rase_tracer_di191"></a>    <a href="convection_tracer.html#rase_traceri190" target="origFile">voi(icmin:k) = vho(i, icmin:k)</a>
<a name="rase_tracer_di192"></a>    <a href="convection_tracer.html#rase_traceri191" target="origFile">qstd(icmin:k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di192"></a>    <a href="convection_tracer.html#rase_traceri191" target="origFile">qst(icmin:k) = qss(icmin:k)</a>
    <a href="convection_tracer.html#rase_traceri192" target="origFile">dqqd(icmin:k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di194"></a>    <a href="convection_tracer.html#rase_traceri192" target="origFile">dqq(icmin:k) = dqs(icmin:k)</a>
    <a href="convection_tracer.html#rase_traceri152" target="origFile">xoid = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di193"></a><a href="convection_tracer.html#rase_traceri194" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di193"></a>    <a href="convection_tracer.html#rase_traceri194" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
      <a href="convection_tracer.html#rase_traceri193" target="origFile">xoid(icmin:k, itr) = xhod(i, icmin:k, itr)</a>
<a name="rase_tracer_di195"></a>      <a href="convection_tracer.html#rase_traceri193" target="origFile">xoi(icmin:k, itr) = xho(i, icmin:k, itr)</a>
    <a href="convection_tracer.html#rase_traceri194" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di196"></a><a href="convection_tracer.html#rase_traceri195" target="origFile"><code class="comment">!Mass fraction of each layer below cloud base</code></a>
    <a href="convection_tracer.html#rase_traceri195" target="origFile">massf(:) = wgt0(i, :)</a>
<a name="rase_tracer_di198"></a><a href="convection_tracer.html#rase_traceri196" target="origFile"><code class="comment">!RESET PRESSURE at bottom edge of CBL </code></a>
<a name="rase_tracer_di197"></a>    <a href="convection_tracer.html#rase_traceri196" target="origFile">prcbl = prs(k)</a>
    <a href="convection_tracer.html#rase_traceri198" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_tracer_di199"></a>      <a href="convection_tracer.html#rase_traceri197" target="origFile">prcbl = prcbl + massf(l)*(prs(l+<code class="constant">1</code>)-prs(l))</a>
<a name="rase_tracer_di199"></a>    <a href="convection_tracer.html#rase_traceri198" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di200"></a>    <a href="convection_tracer.html#rase_traceri199" target="origFile">prsd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di201"></a>    <a href="convection_tracer.html#rase_traceri199" target="origFile">prs(k+<code class="constant">1</code>) = prcbl</a>
<a name="rase_tracer_di202"></a>    <a href="convection_tracer.html#rase_traceri200" target="origFile">pwx11 = prs(k+<code class="constant">1</code>)/<code class="constant">1000.</code></a>
<a name="rase_tracer_di202"></a>    <a href="convection_tracer.html#rase_traceri201" target="origFile">pwy1 = cons_rgas/cons_cp</a>
<a name="rase_tracer_di209"></a>    <a href="convection_tracer.html#rase_traceri202" target="origFile">prjd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di203"></a>    <a href="convection_tracer.html#rase_traceri202" target="origFile">prj(k+<code class="constant">1</code>) = pwx11**pwy1</a>
<a name="rase_tracer_di203"></a>    <a href="convection_tracer.html#rase_traceri209" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_tracer_di204"></a>      <a href="convection_tracer.html#rase_traceri203" target="origFile">pold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di204"></a>      <a href="convection_tracer.html#rase_traceri203" target="origFile">pol(l) = <code class="constant">0.5</code>*(prs(l)+prs(l+<code class="constant">1</code>))</a>
      <a href="convection_tracer.html#rase_traceri204" target="origFile">prhd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di205"></a>      <a href="convection_tracer.html#rase_traceri204" target="origFile">prh(l) = (prs(l+<code class="constant">1</code>)*prj(l+<code class="constant">1</code>)-prs(l)*prj(l))/(onepkap*(prs(l+<code class="constant">1</code>)-prs(<code class="label">&</code></a>
<a name="rase_tracer_di205"></a><a href="convection_tracer.html#rase_traceri204" target="origFile"><code class="label">&       </code>l)))</a>
<a name="rase_tracer_di206"></a>      <a href="convection_tracer.html#rase_traceri205" target="origFile">pkid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di206"></a>      <a href="convection_tracer.html#rase_traceri205" target="origFile">pki(l) = <code class="constant">1.0</code>/prh(l)</a>
<a name="rase_tracer_di207"></a>      <a href="convection_tracer.html#rase_traceri206" target="origFile">dptd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di207"></a>      <a href="convection_tracer.html#rase_traceri206" target="origFile">dpt(l) = prh(l) - prj(l)</a>
<a name="rase_tracer_di208"></a>      <a href="convection_tracer.html#rase_traceri207" target="origFile">dpbd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di208"></a>      <a href="convection_tracer.html#rase_traceri207" target="origFile">dpb(l) = prj(l+<code class="constant">1</code>) - prh(l)</a>
      <a href="convection_tracer.html#rase_traceri208" target="origFile">prid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di210"></a>      <a href="convection_tracer.html#rase_traceri208" target="origFile">pri(l) = <code class="constant">.01</code>/(prs(l+<code class="constant">1</code>)-prs(l))</a>
    <a href="convection_tracer.html#rase_traceri209" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di211"></a><a href="convection_tracer.html#rase_traceri210" target="origFile"><code class="comment">!RECALCULATE PROFILE QUAN. IN LOWEST STRAPPED LAYER</code></a>
<a name="rase_tracer_di211"></a>    <a href="convection_tracer.html#rase_traceri210" target="origFile"><code class="keyword">IF</code> (k .LE. k0) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di212"></a>      <a href="convection_tracer.html#rase_traceri211" target="origFile">poid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di212"></a>      <a href="convection_tracer.html#rase_traceri211" target="origFile">poi(k) = <code class="constant">0.</code></a>
<a name="rase_tracer_di213"></a>      <a href="convection_tracer.html#rase_traceri212" target="origFile">qoid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di214"></a>      <a href="convection_tracer.html#rase_traceri212" target="origFile">qoi(k) = <code class="constant">0.</code></a>
<a name="rase_tracer_di215"></a>      <a href="convection_tracer.html#rase_traceri213" target="origFile">uoi(k) = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri214" target="origFile">voi(k) = <code class="constant">0.</code></a>
<a name="rase_tracer_di217"></a><a href="convection_tracer.html#rase_traceri215" target="origFile"><code class="comment">!SPECIFY WEIGHTS GIVEN TO EACH LAYER WITHIN SUBCLOUD "SUPERLAYER"</code></a>
<a name="rase_tracer_di216"></a>      <a href="convection_tracer.html#rase_traceri215" target="origFile">wght = <code class="constant">0.</code></a>
<a name="rase_tracer_di216"></a>      <a href="convection_tracer.html#rase_traceri217" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
        <a href="convection_tracer.html#rase_traceri216" target="origFile">wghtd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di222"></a>        <a href="convection_tracer.html#rase_traceri216" target="origFile">wght(l) = massf(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))/(prs(k+<code class="constant">1</code>)-prs(k))</a>
<a name="rase_tracer_di218"></a>      <a href="convection_tracer.html#rase_traceri217" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di218"></a>      <a href="convection_tracer.html#rase_traceri222" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_tracer_di219"></a>        <a href="convection_tracer.html#rase_traceri218" target="origFile">poid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di219"></a>        <a href="convection_tracer.html#rase_traceri218" target="origFile">poi(k) = poi(k) + wght(l)*tho(i, l)</a>
<a name="rase_tracer_di220"></a>        <a href="convection_tracer.html#rase_traceri219" target="origFile">qoid(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di221"></a>        <a href="convection_tracer.html#rase_traceri219" target="origFile">qoi(k) = qoi(k) + wght(l)*qho(i, l)</a>
        <a href="convection_tracer.html#rase_traceri220" target="origFile">uoi(k) = uoi(k) + wght(l)*uho(i, l)</a>
<a name="rase_tracer_di223"></a>        <a href="convection_tracer.html#rase_traceri221" target="origFile">voi(k) = voi(k) + wght(l)*vho(i, l)</a>
      <a href="convection_tracer.html#rase_traceri222" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di223"></a><a href="convection_tracer.html#rase_traceri223" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di226"></a>      <a href="convection_tracer.html#rase_traceri223" target="origFile">xoid(k, :) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di225"></a>      <a href="convection_tracer.html#rase_traceri223" target="origFile">xoi(k, :) = <code class="constant">0.</code></a>
<a name="rase_tracer_di224"></a>      <a href="convection_tracer.html#rase_traceri226" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di224"></a>        <a href="convection_tracer.html#rase_traceri225" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
          <a href="convection_tracer.html#rase_traceri224" target="origFile">xoid(k, itr) = xoid(k, itr) + wght(l)*xhod(i, l, itr)</a>
          <a href="convection_tracer.html#rase_traceri224" target="origFile">xoi(k, itr) = xoi(k, itr) + wght(l)*xho(i, l, itr)</a>
<a name="rase_tracer_di227"></a>        <a href="convection_tracer.html#rase_traceri225" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri226" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri227" target="origFile"><code class="keyword">CALL </code><code class="funcname">DQSATS_RAS</code>(dqq(k), qst(k), poi(k)*prh(k), pol(k), estblx, <code class="label">&</code></a>
<a name="rase_tracer_di228"></a><a href="convection_tracer.html#rase_traceri227" target="origFile"><code class="label">&               </code>cons_h2omw, cons_airmw)</a>
<a name="rase_tracer_di229"></a>    <a href="convection_tracer.html#rase_traceri210" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri228" target="origFile"><code class="keyword">IF</code> (seedras(i)/<code class="constant">1000000. </code>.LT. <code class="constant">1e-6</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di230"></a>      <a href="convection_tracer.html#rase_traceri229" target="origFile">rndu = <code class="constant">1e-6</code></a>
    <a href="convection_tracer.html#rase_traceri228" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di231"></a>      <a href="convection_tracer.html#rase_traceri230" target="origFile">rndu = seedras(i)/<code class="constant">1000000.</code></a>
<a name="rase_tracer_di232"></a>    <a href="convection_tracer.html#rase_traceri228" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di238"></a>    <a href="convection_tracer.html#rase_traceri231" target="origFile">pwr1 = rndu**(-(<code class="constant">1.</code>/<code class="constant">2.</code>))</a>
<a name="rase_tracer_di233"></a>    <a href="convection_tracer.html#rase_traceri232" target="origFile">mxdiam = maxdallowed*pwr1</a>
    <a href="convection_tracer.html#rase_traceri238" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_tracer_di233"></a><a href="convection_tracer.html#rase_traceri233" target="origFile"><code class="comment">!*</code></a>
<a name="rase_tracer_di234"></a>      <a href="convection_tracer.html#rase_traceri233" target="origFile">betd(l) = <code class="constant">0.0_8</code></a>
      <a href="convection_tracer.html#rase_traceri233" target="origFile">bet(l) = dqq(l)*pki(l)</a>
<a name="rase_tracer_di234"></a><a href="convection_tracer.html#rase_traceri234" target="origFile"><code class="comment">!*</code></a>
<a name="rase_tracer_di235"></a>      <a href="convection_tracer.html#rase_traceri234" target="origFile">gamd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di236"></a>      <a href="convection_tracer.html#rase_traceri234" target="origFile">gam(l) = pki(l)/(<code class="constant">1.0</code>+lbcp*dqq(l))</a>
<a name="rase_tracer_di236"></a>      <a href="convection_tracer.html#rase_traceri235" target="origFile"><code class="keyword">IF</code> (l .LT. k) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di237"></a>        <a href="convection_tracer.html#rase_traceri236" target="origFile">ghtd(l+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
        <a href="convection_tracer.html#rase_traceri236" target="origFile">ght(l+<code class="constant">1</code>) = gam(l)*dpb(l) + gam(l+<code class="constant">1</code>)*dpt(l+<code class="constant">1</code>)</a>
        <a href="convection_tracer.html#rase_traceri237" target="origFile">gm1(l+<code class="constant">1</code>) = <code class="constant">0.5</code>*lbcp*(dqq(l)/(alhl*(<code class="constant">1.0</code>+lbcp*dqq(l)))+dqq(l+<code class="constant">1</code>)/(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri237" target="origFile"><code class="label">&         </code>alhl*(<code class="constant">1.0</code>+lbcp*dqq(l+<code class="constant">1</code>))))</a>
<a name="rase_tracer_di239"></a>      <a href="convection_tracer.html#rase_traceri235" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di240"></a>    <a href="convection_tracer.html#rase_traceri238" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di241"></a>    <a href="convection_tracer.html#rase_traceri239" target="origFile">rns = <code class="constant">0.</code></a>
<a name="rase_tracer_di242"></a>    <a href="convection_tracer.html#rase_traceri240" target="origFile">cll = <code class="constant">0.</code></a>
<a name="rase_tracer_di243"></a>    <a href="convection_tracer.html#rase_traceri241" target="origFile">rmf = <code class="constant">0.</code></a>
<a name="rase_tracer_di244"></a>    <a href="convection_tracer.html#rase_traceri242" target="origFile">rmfd = <code class="constant">0.</code></a>
<a name="rase_tracer_di245"></a>    <a href="convection_tracer.html#rase_traceri243" target="origFile">rmfc = <code class="constant">0.</code></a>
<a name="rase_tracer_di246"></a>    <a href="convection_tracer.html#rase_traceri244" target="origFile">rmfp = <code class="constant">0.</code></a>
<a name="rase_tracer_di247"></a>    <a href="convection_tracer.html#rase_traceri245" target="origFile">cll0 = <code class="constant">0.</code></a>
<a name="rase_tracer_di248"></a>    <a href="convection_tracer.html#rase_traceri246" target="origFile">dll0 = <code class="constant">0.</code></a>
<a name="rase_tracer_di249"></a>    <a href="convection_tracer.html#rase_traceri247" target="origFile">cllx = <code class="constant">0.</code></a>
<a name="rase_tracer_di250"></a>    <a href="convection_tracer.html#rase_traceri248" target="origFile">dllx = <code class="constant">0.</code></a>
<a name="rase_tracer_di251"></a>    <a href="convection_tracer.html#rase_traceri249" target="origFile">clli = <code class="constant">0.</code></a>
<a name="rase_tracer_di252"></a>    <a href="convection_tracer.html#rase_traceri250" target="origFile">poi_sv = poi</a>
<a name="rase_tracer_di253"></a>    <a href="convection_tracer.html#rase_traceri251" target="origFile">qoi_sv = qoi</a>
<a name="rase_tracer_di254"></a>    <a href="convection_tracer.html#rase_traceri252" target="origFile">uoi_sv = uoi</a>
    <a href="convection_tracer.html#rase_traceri253" target="origFile">voi_sv = voi</a>
<a name="rase_tracer_di254"></a><a href="convection_tracer.html#rase_traceri254" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di255"></a>    <a href="convection_tracer.html#rase_traceri254" target="origFile">xoi_svd = xoid</a>
<a name="rase_tracer_di256"></a>    <a href="convection_tracer.html#rase_traceri254" target="origFile">xoi_sv = xoi</a>
<a name="rase_tracer_di257"></a>    <a href="convection_tracer.html#rase_traceri255" target="origFile">cvw = <code class="constant">0.0</code></a>
<a name="rase_tracer_di258"></a>    <a href="convection_tracer.html#rase_traceri256" target="origFile">updfrc = <code class="constant">0.0</code></a>
    <a href="convection_tracer.html#rase_traceri257" target="origFile">updfrp = <code class="constant">0.0</code></a>
<a name="rase_tracer_di259"></a><a href="convection_tracer.html#rase_traceri258" target="origFile"><code class="comment">! HOL initialized here in order not to confuse Valgrind debugger</code></a>
<a name="rase_tracer_di259"></a>    <a href="convection_tracer.html#rase_traceri258" target="origFile">hol = <code class="constant">0.</code></a>
<a name="rase_tracer_di260"></a>    <a href="convection_tracer.html#rase_traceri259" target="origFile">zetd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di260"></a>    <a href="convection_tracer.html#rase_traceri259" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0</code></a>
<a name="rase_tracer_di273"></a>    <a href="convection_tracer.html#rase_traceri260" target="origFile">shtd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di261"></a>    <a href="convection_tracer.html#rase_traceri260" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi(k)*prj(k+<code class="constant">1</code>)</a>
<a name="rase_tracer_di262"></a>    <a href="convection_tracer.html#rase_traceri273" target="origFile"><code class="keyword">DO </code>l=k,icmin,-<code class="constant">1</code></a>
<a name="rase_tracer_di262"></a>      <a href="convection_tracer.html#rase_traceri261" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi(l)) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri262" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di263"></a>        <a href="convection_tracer.html#rase_traceri262" target="origFile">qol(l) = qoi(l)</a>
<a name="rase_tracer_di263"></a>      <a href="convection_tracer.html#rase_traceri261" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri263" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di264"></a>        <a href="convection_tracer.html#rase_traceri263" target="origFile">qol(l) = qst(l)*rhmax</a>
<a name="rase_tracer_di265"></a>      <a href="convection_tracer.html#rase_traceri261" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di265"></a>      <a href="convection_tracer.html#rase_traceri264" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
        <a href="convection_tracer.html#rase_traceri265" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di266"></a>        <a href="convection_tracer.html#rase_traceri265" target="origFile">qol(l) = qol(l)</a>
<a name="rase_tracer_di266"></a>      <a href="convection_tracer.html#rase_traceri264" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="convection_tracer.html#rase_traceri266" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di267"></a>        <a href="convection_tracer.html#rase_traceri266" target="origFile">qol(l) = <code class="constant">0.000</code></a>
<a name="rase_tracer_di267"></a>      <a href="convection_tracer.html#rase_traceri264" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di268"></a>      <a href="convection_tracer.html#rase_traceri267" target="origFile">ssld(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di268"></a>      <a href="convection_tracer.html#rase_traceri267" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi(l) + grav*zet(l+<code class="constant">1</code>)</a>
<a name="rase_tracer_di269"></a>      <a href="convection_tracer.html#rase_traceri268" target="origFile">hold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di269"></a>      <a href="convection_tracer.html#rase_traceri268" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
<a name="rase_tracer_di270"></a>      <a href="convection_tracer.html#rase_traceri269" target="origFile">hstd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di271"></a>      <a href="convection_tracer.html#rase_traceri269" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
<a name="rase_tracer_di271"></a>      <a href="convection_tracer.html#rase_traceri270" target="origFile">tem = poi(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
<a name="rase_tracer_di272"></a>      <a href="convection_tracer.html#rase_traceri271" target="origFile">zetd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di272"></a>      <a href="convection_tracer.html#rase_traceri271" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
      <a href="convection_tracer.html#rase_traceri272" target="origFile">zold(l) = <code class="constant">0.0_8</code></a>
      <a href="convection_tracer.html#rase_traceri272" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi(l)*cpbg</a>
    <a href="convection_tracer.html#rase_traceri273" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di492"></a>    <a href="convection_tracer.html#rase_traceri152" target="origFile">xcud = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di274"></a>    <a href="convection_tracer.html#rase_traceri152" target="origFile">xhtd = <code class="constant">0.0_8</code></a>
    <a href="convection_tracer.html#rase_traceri492" target="origFile"><code class="keyword">DO </code>ic=k,icmin+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_tracer_di274"></a><a href="convection_tracer.html#rase_traceri274" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di275"></a>      <a href="convection_tracer.html#rase_traceri274" target="origFile">xcud(icmin:, :) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di276"></a>      <a href="convection_tracer.html#rase_traceri274" target="origFile">xcu(icmin:, :) = <code class="constant">0.</code></a>
<a name="rase_tracer_di277"></a>      <a href="convection_tracer.html#rase_traceri275" target="origFile">ucu(icmin:) = <code class="constant">0.</code></a>
<a name="rase_tracer_di278"></a>      <a href="convection_tracer.html#rase_traceri276" target="origFile">vcu(icmin:) = <code class="constant">0.</code></a>
<a name="rase_tracer_di279"></a>      <a href="convection_tracer.html#rase_traceri277" target="origFile">alm = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri278" target="origFile"><code class="keyword">IF</code> (<code class="constant">1. </code>.GT. (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di280"></a>        <a href="convection_tracer.html#rase_traceri279" target="origFile">trg = (qoi(k)/qst(k)-rhmn)/(rhmx-rhmn)</a>
      <a href="convection_tracer.html#rase_traceri278" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di281"></a>        <a href="convection_tracer.html#rase_traceri280" target="origFile">trg = <code class="constant">1.</code></a>
<a name="rase_tracer_di282"></a>      <a href="convection_tracer.html#rase_traceri278" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri281" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.0 </code>.LT. (autorampb-sige(ic))/<code class="constant">0.2</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di283"></a>        <a href="convection_tracer.html#rase_traceri282" target="origFile">y1 = (autorampb-sige(ic))/<code class="constant">0.2</code></a>
      <a href="convection_tracer.html#rase_traceri281" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di284"></a>        <a href="convection_tracer.html#rase_traceri283" target="origFile">y1 = <code class="constant">0.0</code></a>
<a name="rase_tracer_di285"></a>      <a href="convection_tracer.html#rase_traceri281" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri284" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.0 </code>.GT. y1) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di286"></a>        <a href="convection_tracer.html#rase_traceri285" target="origFile">f4 = y1</a>
      <a href="convection_tracer.html#rase_traceri284" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di287"></a>        <a href="convection_tracer.html#rase_traceri286" target="origFile">f4 = <code class="constant">1.0</code></a>
<a name="rase_tracer_di288"></a>      <a href="convection_tracer.html#rase_traceri284" target="origFile"><code class="keyword">END IF</code></a>
      <a href="convection_tracer.html#rase_traceri287" target="origFile"><code class="keyword">IF</code> (trg .GT. <code class="constant">1.0e-5</code>) <code class="keyword">THEN</code></a>
<a href="convection_tracer.html#rase_traceri288" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di289"></a><a href="convection_tracer.html#rase_traceri288" target="origFile"><code class="comment">!RECOMPUTE SOUNDING UP TO DETRAINMENT LEVEL</code></a>
<a name="rase_tracer_di290"></a>        <a href="convection_tracer.html#rase_traceri288" target="origFile">poi_c = poi</a>
<a name="rase_tracer_di290"></a>        <a href="convection_tracer.html#rase_traceri289" target="origFile">qoi_c = qoi</a>
<a name="rase_tracer_di291"></a>        <a href="convection_tracer.html#rase_traceri290" target="origFile">poi_cd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di291"></a>        <a href="convection_tracer.html#rase_traceri290" target="origFile">poi_c(k) = poi_c(k) + tpert</a>
<a name="rase_tracer_di292"></a>        <a href="convection_tracer.html#rase_traceri291" target="origFile">qoi_cd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di292"></a>        <a href="convection_tracer.html#rase_traceri291" target="origFile">qoi_c(k) = qoi_c(k) + qpert</a>
<a name="rase_tracer_di293"></a>        <a href="convection_tracer.html#rase_traceri292" target="origFile">zetd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di293"></a>        <a href="convection_tracer.html#rase_traceri292" target="origFile">zet(k+<code class="constant">1</code>) = <code class="constant">0.</code></a>
<a name="rase_tracer_di306"></a>        <a href="convection_tracer.html#rase_traceri293" target="origFile">shtd(k+<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di294"></a>        <a href="convection_tracer.html#rase_traceri293" target="origFile">sht(k+<code class="constant">1</code>) = cp*poi_c(k)*prj(k+<code class="constant">1</code>)</a>
<a name="rase_tracer_di295"></a>        <a href="convection_tracer.html#rase_traceri306" target="origFile"><code class="keyword">DO </code>l=k,ic,-<code class="constant">1</code></a>
<a name="rase_tracer_di295"></a>          <a href="convection_tracer.html#rase_traceri294" target="origFile"><code class="keyword">IF</code> (qst(l)*rhmax .GT. qoi_c(l)) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri295" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di296"></a>            <a href="convection_tracer.html#rase_traceri295" target="origFile">qol(l) = qoi_c(l)</a>
<a name="rase_tracer_di296"></a>          <a href="convection_tracer.html#rase_traceri294" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri296" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di297"></a>            <a href="convection_tracer.html#rase_traceri296" target="origFile">qol(l) = qst(l)*rhmax</a>
<a name="rase_tracer_di298"></a>          <a href="convection_tracer.html#rase_traceri294" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di298"></a>          <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">IF</code> (<code class="constant">0.000 </code>.LT. qol(l)) <code class="keyword">THEN</code></a>
            <a href="convection_tracer.html#rase_traceri298" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di299"></a>            <a href="convection_tracer.html#rase_traceri298" target="origFile">qol(l) = qol(l)</a>
<a name="rase_tracer_di299"></a>          <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="convection_tracer.html#rase_traceri299" target="origFile">qold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di300"></a>            <a href="convection_tracer.html#rase_traceri299" target="origFile">qol(l) = <code class="constant">0.000</code></a>
<a name="rase_tracer_di300"></a>          <a href="convection_tracer.html#rase_traceri297" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di301"></a>          <a href="convection_tracer.html#rase_traceri300" target="origFile">ssld(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di301"></a>          <a href="convection_tracer.html#rase_traceri300" target="origFile">ssl(l) = cp*prj(l+<code class="constant">1</code>)*poi_c(l) + grav*zet(l+<code class="constant">1</code>)</a>
<a name="rase_tracer_di302"></a>          <a href="convection_tracer.html#rase_traceri301" target="origFile">hold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di302"></a>          <a href="convection_tracer.html#rase_traceri301" target="origFile">hol(l) = ssl(l) + qol(l)*alhl</a>
<a name="rase_tracer_di303"></a>          <a href="convection_tracer.html#rase_traceri302" target="origFile">hstd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di304"></a>          <a href="convection_tracer.html#rase_traceri302" target="origFile">hst(l) = ssl(l) + qst(l)*alhl</a>
<a name="rase_tracer_di304"></a>          <a href="convection_tracer.html#rase_traceri303" target="origFile">tem = poi_c(l)*(prj(l+<code class="constant">1</code>)-prj(l))*cpbg</a>
<a name="rase_tracer_di305"></a>          <a href="convection_tracer.html#rase_traceri304" target="origFile">zetd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di305"></a>          <a href="convection_tracer.html#rase_traceri304" target="origFile">zet(l) = zet(l+<code class="constant">1</code>) + tem</a>
          <a href="convection_tracer.html#rase_traceri305" target="origFile">zold(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di310"></a>          <a href="convection_tracer.html#rase_traceri305" target="origFile">zol(l) = zet(l+<code class="constant">1</code>) + (prj(l+<code class="constant">1</code>)-prh(l))*poi_c(l)*cpbg</a>
<a name="rase_tracer_di307"></a>        <a href="convection_tracer.html#rase_traceri306" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di308"></a>        <a href="convection_tracer.html#rase_traceri310" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
<a name="rase_tracer_di308"></a>          <a href="convection_tracer.html#rase_traceri307" target="origFile">tem = (prj(l)-prh(l-<code class="constant">1</code>))/(prh(l)-prh(l-<code class="constant">1</code>))</a>
<a name="rase_tracer_di309"></a>          <a href="convection_tracer.html#rase_traceri308" target="origFile">shtd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di309"></a>          <a href="convection_tracer.html#rase_traceri308" target="origFile">sht(l) = ssl(l-<code class="constant">1</code>) + tem*(ssl(l)-ssl(l-<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri309" target="origFile">qhtd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di311"></a>          <a href="convection_tracer.html#rase_traceri309" target="origFile">qht(l) = <code class="constant">.5</code>*(qol(l)+qol(l-<code class="constant">1</code>))</a>
        <a href="convection_tracer.html#rase_traceri310" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di312"></a><a href="convection_tracer.html#rase_traceri311" target="origFile"><code class="comment">!CALCULATE LAMBDA, ETA, AND WORKFUNCTION</code></a>
<a name="rase_tracer_di313"></a>        <a href="convection_tracer.html#rase_traceri311" target="origFile">lambda_min = <code class="constant">.2</code>/mxdiam</a>
<a name="rase_tracer_di314"></a>        <a href="convection_tracer.html#rase_traceri312" target="origFile">lambda_max = <code class="constant">.2</code>/<code class="constant">200.</code></a>
        <a href="convection_tracer.html#rase_traceri313" target="origFile"><code class="keyword">IF</code> (hol(k) .GT. hst(ic)) <code class="keyword">THEN</code></a>
<a href="convection_tracer.html#rase_traceri314" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di316"></a><a href="convection_tracer.html#rase_traceri314" target="origFile"><code class="comment">!LAMBDA CALCULATION: MS-A18</code></a>
<a name="rase_tracer_di315"></a>          <a href="convection_tracer.html#rase_traceri314" target="origFile">tem = (hst(ic)-hol(ic))*(zol(ic)-zet(ic+<code class="constant">1</code>))</a>
          <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k-<code class="constant">1</code></a>
<a name="rase_tracer_di317"></a>            <a href="convection_tracer.html#rase_traceri315" target="origFile">tem = tem + (hst(ic)-hol(l))*(zet(l)-zet(l+<code class="constant">1</code>))</a>
<a name="rase_tracer_di318"></a>          <a href="convection_tracer.html#rase_traceri316" target="origFile"><code class="keyword">END DO</code></a>
          <a href="convection_tracer.html#rase_traceri317" target="origFile"><code class="keyword">IF</code> (tem .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di319"></a><a href="convection_tracer.html#rase_traceri318" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di320"></a>            <a href="convection_tracer.html#rase_traceri318" target="origFile">alm = (hol(k)-hst(ic))/tem</a>
            <a href="convection_tracer.html#rase_traceri319" target="origFile"><code class="keyword">IF</code> (alm .LE. lambda_max) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di322"></a><a name="rase_tracer_di321"></a><a href="convection_tracer.html#rase_traceri320" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di324"></a>              <a href="convection_tracer.html#rase_traceri320" target="origFile">toki = <code class="constant">1.0</code></a>
              <a href="convection_tracer.html#rase_traceri321" target="origFile"><code class="keyword">IF</code> (alm .LT. lambda_min) </a><a href="convection_tracer.html#rase_traceri322" target="origFile">toki = (alm/lambda_min)**<code class="constant">2</code></a>
<a name="rase_tracer_di323"></a><a href="convection_tracer.html#rase_traceri324" target="origFile"><code class="comment">!ETA CALCULATION: MS-A2</code></a>
<a name="rase_tracer_di323"></a>              <a href="convection_tracer.html#rase_traceri324" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
                <a href="convection_tracer.html#rase_traceri323" target="origFile">etad(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di325"></a>                <a href="convection_tracer.html#rase_traceri323" target="origFile">eta(l) = <code class="constant">1.0 </code>+ alm*(zet(l)-zet(k))</a>
<a name="rase_tracer_di325"></a>              <a href="convection_tracer.html#rase_traceri324" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di326"></a>              <a href="convection_tracer.html#rase_traceri325" target="origFile">etad(ic) = <code class="constant">0.0_8</code></a>
              <a href="convection_tracer.html#rase_traceri325" target="origFile">eta(ic) = <code class="constant">1.0 </code>+ alm*(zol(ic)-zet(k))</a>
<a name="rase_tracer_di327"></a><a href="convection_tracer.html#rase_traceri326" target="origFile"><code class="comment">!WORKFUNCTION CALCULATION:  MS-A22</code></a>
<a name="rase_tracer_di327"></a>              <a href="convection_tracer.html#rase_traceri326" target="origFile">wfn = <code class="constant">0.0</code></a>
<a name="rase_tracer_di332"></a>              <a href="convection_tracer.html#rase_traceri327" target="origFile">hccd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di328"></a>              <a href="convection_tracer.html#rase_traceri327" target="origFile">hcc(k) = hol(k)</a>
<a name="rase_tracer_di328"></a>              <a href="convection_tracer.html#rase_traceri332" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
<a name="rase_tracer_di329"></a>                <a href="convection_tracer.html#rase_traceri328" target="origFile">hccd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di330"></a>                <a href="convection_tracer.html#rase_traceri328" target="origFile">hcc(l) = hcc(l+<code class="constant">1</code>) + (eta(l)-eta(l+<code class="constant">1</code>))*hol(l)</a>
<a name="rase_tracer_di330"></a>                <a href="convection_tracer.html#rase_traceri329" target="origFile">tem = hcc(l+<code class="constant">1</code>)*dpb(l) + hcc(l)*dpt(l)</a>
<a name="rase_tracer_di331"></a>                <a href="convection_tracer.html#rase_traceri330" target="origFile">ehtd(l) = <code class="constant">0.0_8</code></a>
                <a href="convection_tracer.html#rase_traceri330" target="origFile">eht(l) = eta(l+<code class="constant">1</code>)*dpb(l) + eta(l)*dpt(l)</a>
<a name="rase_tracer_di333"></a>                <a href="convection_tracer.html#rase_traceri331" target="origFile">wfn = wfn + (tem-eht(l)*hst(l))*gam(l)</a>
<a name="rase_tracer_di333"></a>              <a href="convection_tracer.html#rase_traceri332" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di334"></a>              <a href="convection_tracer.html#rase_traceri333" target="origFile">hccd(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di335"></a>              <a href="convection_tracer.html#rase_traceri333" target="origFile">hcc(ic) = hst(ic)*eta(ic)</a>
              <a href="convection_tracer.html#rase_traceri334" target="origFile">wfn = wfn + (hcc(ic+<code class="constant">1</code>)-hst(ic)*eta(ic+<code class="constant">1</code>))*gam(ic)*dpb(ic)</a>
<a name="rase_tracer_di336"></a><a href="convection_tracer.html#rase_traceri335" target="origFile"><code class="comment">!VERTICAL VELOCITY/KE CALCULATION (ADDED 12/2001 JTB)</code></a>
<a name="rase_tracer_di337"></a>              <a href="convection_tracer.html#rase_traceri335" target="origFile">bk2(k) = <code class="constant">0.0</code></a>
<a name="rase_tracer_di349"></a>              <a href="convection_tracer.html#rase_traceri336" target="origFile">bke(k) = <code class="constant">0.0</code></a>
<a name="rase_tracer_di338"></a>              <a href="convection_tracer.html#rase_traceri337" target="origFile">hcld(k) = hol(k)</a>
              <a href="convection_tracer.html#rase_traceri349" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
<a name="rase_tracer_di339"></a>                <a href="convection_tracer.html#rase_traceri338" target="origFile">hcld(l) = (eta(l+<code class="constant">1</code>)*hcld(l+<code class="constant">1</code>)+(eta(l)-eta(l+<code class="constant">1</code>))*hol(l))/<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri338" target="origFile"><code class="label">&                 </code>eta(l)</a>
<a name="rase_tracer_di340"></a>                <a href="convection_tracer.html#rase_traceri339" target="origFile">tem = (hcld(l)-hst(l))*(zet(l)-zet(l+<code class="constant">1</code>))/(<code class="constant">1.0</code>+lbcp*dqq(l<code class="label">&</code></a>
<a name="rase_tracer_di341"></a><a href="convection_tracer.html#rase_traceri339" target="origFile"><code class="label">&                 </code>))</a>
<a name="rase_tracer_di342"></a>                <a href="convection_tracer.html#rase_traceri340" target="origFile">bke(l) = bke(l+<code class="constant">1</code>) + grav*tem/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">IF</code> (tem .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di343"></a>                  <a href="convection_tracer.html#rase_traceri342" target="origFile">max1 = <code class="constant">0.0</code></a>
                <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di344"></a>                  <a href="convection_tracer.html#rase_traceri343" target="origFile">max1 = tem</a>
<a name="rase_tracer_di345"></a>                <a href="convection_tracer.html#rase_traceri341" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di346"></a>                <a href="convection_tracer.html#rase_traceri344" target="origFile">bk2(l) = bk2(l+<code class="constant">1</code>) + grav*max1/(cp*prj(l+<code class="constant">1</code>)*poi(l))</a>
                <a href="convection_tracer.html#rase_traceri345" target="origFile"><code class="keyword">IF</code> (bk2(l) .LT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di347"></a>                  <a href="convection_tracer.html#rase_traceri346" target="origFile">max2 = <code class="constant">0.0</code></a>
                <a href="convection_tracer.html#rase_traceri345" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di348"></a>                  <a href="convection_tracer.html#rase_traceri347" target="origFile">max2 = bk2(l)</a>
                <a href="convection_tracer.html#rase_traceri345" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di350"></a>                <a href="convection_tracer.html#rase_traceri348" target="origFile">cvw(l) = <code class="funcname">SQRT</code>(<code class="constant">2.0</code>*max2)</a>
              <a href="convection_tracer.html#rase_traceri349" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di351"></a><a href="convection_tracer.html#rase_traceri350" target="origFile"><code class="comment">!ALPHA CALCULATION </code></a>
<a name="rase_tracer_di351"></a>              <a href="convection_tracer.html#rase_traceri350" target="origFile"><code class="keyword">IF</code> (zet(ic) .LT. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection_tracer.html#rase_traceri351" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di352"></a>                <a href="convection_tracer.html#rase_traceri351" target="origFile">rasal(ic) = rasal1</a>
<a name="rase_tracer_di353"></a>              <a href="convection_tracer.html#rase_traceri350" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di353"></a>              <a href="convection_tracer.html#rase_traceri352" target="origFile"><code class="keyword">IF</code> (zet(ic) .GE. <code class="constant">2000.</code>) <code class="keyword">THEN</code></a>
                <a href="convection_tracer.html#rase_traceri353" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
                <a href="convection_tracer.html#rase_traceri353" target="origFile">rasal(ic) = rasal1 + (rasal2-rasal1)*(zet(ic)-<code class="constant">2000.</code>)/<code class="label">&</code></a>
<a name="rase_tracer_di354"></a><a href="convection_tracer.html#rase_traceri353" target="origFile"><code class="label">&                 </code><code class="constant">8000.</code></a>
<a name="rase_tracer_di355"></a>              <a href="convection_tracer.html#rase_traceri352" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di355"></a>              <a href="convection_tracer.html#rase_traceri354" target="origFile"><code class="keyword">IF</code> (rasal(ic) .GT. <code class="constant">1.0e5</code>) <code class="keyword">THEN</code></a>
                <a href="convection_tracer.html#rase_traceri355" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di356"></a>                <a href="convection_tracer.html#rase_traceri355" target="origFile">rasal(ic) = <code class="constant">1.0e5</code></a>
<a name="rase_tracer_di356"></a>              <a href="convection_tracer.html#rase_traceri354" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="convection_tracer.html#rase_traceri356" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di357"></a>                <a href="convection_tracer.html#rase_traceri356" target="origFile">rasal(ic) = rasal(ic)</a>
<a name="rase_tracer_di357"></a>              <a href="convection_tracer.html#rase_traceri354" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di361"></a>              <a href="convection_tracer.html#rase_traceri357" target="origFile">rasald(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di358"></a>              <a href="convection_tracer.html#rase_traceri357" target="origFile">rasal(ic) = dt/rasal(ic)</a>
<a name="rase_tracer_di359"></a>              <a href="convection_tracer.html#rase_traceri361" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
                <a href="convection_tracer.html#rase_traceri358" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di360"></a>                  <a href="convection_tracer.html#rase_traceri359" target="origFile">cvw(l) = <code class="constant">1.00</code></a>
                <a href="convection_tracer.html#rase_traceri358" target="origFile"><code class="keyword">ELSE</code></a>
                  <a href="convection_tracer.html#rase_traceri360" target="origFile">cvw(l) = cvw(l)</a>
<a name="rase_tracer_di362"></a>                <a href="convection_tracer.html#rase_traceri358" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di363"></a>              <a href="convection_tracer.html#rase_traceri361" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di373"></a>              <a href="convection_tracer.html#rase_traceri362" target="origFile"><code class="keyword">CALL </code><code class="funcname">ACRITN</code>(pol(ic), prs(k), acr, acritfac)</a>
              <a href="convection_tracer.html#rase_traceri363" target="origFile"><code class="keyword">IF</code> (wfn .GT. acr) <code class="keyword">THEN</code></a>
<a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di364"></a><a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="comment">!DO_TRACERS</code></a>
                <a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di365"></a><a href="convection_tracer.html#rase_traceri364" target="origFile"><code class="comment">!Scavenging of the below cloud tracer</code></a>
<a name="rase_tracer_di366"></a>                  <a href="convection_tracer.html#rase_traceri364" target="origFile">delzkm = (zet(ic)-zet(k))/<code class="constant">1000.</code></a>
<a name="rase_tracer_di367"></a>                  <a href="convection_tracer.html#rase_traceri365" target="origFile">x4 = <code class="funcname">EXP</code>(-(fscav(itr)*delzkm))</a>
                  <a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="keyword">IF</code> (x4 .GT. <code class="constant">1.</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di368"></a>                    <a href="convection_tracer.html#rase_traceri367" target="origFile">x1 = <code class="constant">1.</code></a>
                  <a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di369"></a>                    <a href="convection_tracer.html#rase_traceri368" target="origFile">x1 = x4</a>
<a name="rase_tracer_di370"></a>                  <a href="convection_tracer.html#rase_traceri366" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri369" target="origFile"><code class="keyword">IF</code> (x1 .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di371"></a>                    <a href="convection_tracer.html#rase_traceri370" target="origFile">fnoscav = <code class="constant">0.</code></a>
                  <a href="convection_tracer.html#rase_traceri369" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di372"></a>                    <a href="convection_tracer.html#rase_traceri371" target="origFile">fnoscav = x1</a>
<a name="rase_tracer_di372"></a>                  <a href="convection_tracer.html#rase_traceri369" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri372" target="origFile">xhtd(itr) = fnoscav*xoid(k, itr)</a>
<a name="rase_tracer_di374"></a>                  <a href="convection_tracer.html#rase_traceri372" target="origFile">xht(itr) = xoi(k, itr)*fnoscav</a>
<a name="rase_tracer_di375"></a>                <a href="convection_tracer.html#rase_traceri373" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di376"></a>                <a href="convection_tracer.html#rase_traceri374" target="origFile">wlq = qol(k)</a>
<a name="rase_tracer_di377"></a>                <a href="convection_tracer.html#rase_traceri375" target="origFile">uht = uoi(k)</a>
<a name="rase_tracer_di378"></a>                <a href="convection_tracer.html#rase_traceri376" target="origFile">vht = voi(k)</a>
<a name="rase_tracer_di423"></a>                <a href="convection_tracer.html#rase_traceri377" target="origFile">rnn(k) = <code class="constant">0.</code></a>
<a name="rase_tracer_di379"></a>                <a href="convection_tracer.html#rase_traceri378" target="origFile">cll0(k) = <code class="constant">0.</code></a>
<a name="rase_tracer_di380"></a>                <a href="convection_tracer.html#rase_traceri423" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic,-<code class="constant">1</code></a>
<a name="rase_tracer_di381"></a>                  <a href="convection_tracer.html#rase_traceri379" target="origFile">tem = eta(l) - eta(l+<code class="constant">1</code>)</a>
<a name="rase_tracer_di382"></a>                  <a href="convection_tracer.html#rase_traceri380" target="origFile">wlq = wlq + tem*qol(l)</a>
<a name="rase_tracer_di392"></a>                  <a href="convection_tracer.html#rase_traceri381" target="origFile">uht = uht + tem*uoi(l)</a>
                  <a href="convection_tracer.html#rase_traceri382" target="origFile">vht = vht + tem*voi(l)</a>
<a name="rase_tracer_di383"></a><a href="convection_tracer.html#rase_traceri392" target="origFile"><code class="comment">!DO_TRACERS</code></a>
                  <a href="convection_tracer.html#rase_traceri392" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di384"></a><a href="convection_tracer.html#rase_traceri383" target="origFile"><code class="comment">!Scavenging of the entrained tracer.  Updates transported tracer mass.</code></a>
<a name="rase_tracer_di385"></a>                    <a href="convection_tracer.html#rase_traceri383" target="origFile">delzkm = (zet(ic)-zet(l+<code class="constant">1</code>))/<code class="constant">1000.</code></a>
<a name="rase_tracer_di386"></a>                    <a href="convection_tracer.html#rase_traceri384" target="origFile">x5 = <code class="funcname">EXP</code>(-(fscav(itr)*delzkm))</a>
                    <a href="convection_tracer.html#rase_traceri385" target="origFile"><code class="keyword">IF</code> (x5 .GT. <code class="constant">1.</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di387"></a>                      <a href="convection_tracer.html#rase_traceri386" target="origFile">x2 = <code class="constant">1.</code></a>
                    <a href="convection_tracer.html#rase_traceri385" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di388"></a>                      <a href="convection_tracer.html#rase_traceri387" target="origFile">x2 = x5</a>
<a name="rase_tracer_di389"></a>                    <a href="convection_tracer.html#rase_traceri385" target="origFile"><code class="keyword">END IF</code></a>
                    <a href="convection_tracer.html#rase_traceri388" target="origFile"><code class="keyword">IF</code> (x2 .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di390"></a>                      <a href="convection_tracer.html#rase_traceri389" target="origFile">fnoscav = <code class="constant">0.</code></a>
                    <a href="convection_tracer.html#rase_traceri388" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di391"></a>                      <a href="convection_tracer.html#rase_traceri390" target="origFile">fnoscav = x2</a>
<a name="rase_tracer_di391"></a>                    <a href="convection_tracer.html#rase_traceri388" target="origFile"><code class="keyword">END IF</code></a>
                    <a href="convection_tracer.html#rase_traceri391" target="origFile">xhtd(itr) = xhtd(itr) + tem*fnoscav*xoid(l, itr)</a>
<a name="rase_tracer_di393"></a>                    <a href="convection_tracer.html#rase_traceri391" target="origFile">xht(itr) = xht(itr) + tem*xoi(l, itr)*fnoscav</a>
<a name="rase_tracer_di394"></a>                  <a href="convection_tracer.html#rase_traceri392" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di395"></a>                  <a href="convection_tracer.html#rase_traceri393" target="origFile"><code class="keyword">IF</code> (l .GT. ic) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di396"></a>                    <a href="convection_tracer.html#rase_traceri394" target="origFile">tx2 = <code class="constant">0.5</code>*(qst(l)+qst(l-<code class="constant">1</code>))*eta(l)</a>
<a name="rase_tracer_di397"></a>                    <a href="convection_tracer.html#rase_traceri395" target="origFile">tx3 = <code class="constant">0.5</code>*(hst(l)+hst(l-<code class="constant">1</code>))*eta(l)</a>
                    <a href="convection_tracer.html#rase_traceri396" target="origFile">qcc = tx2 + gm1(l)*(hcc(l)-tx3)</a>
<a name="rase_tracer_di398"></a>                    <a href="convection_tracer.html#rase_traceri397" target="origFile">cll0(l) = wlq - qcc</a>
                  <a href="convection_tracer.html#rase_traceri393" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di399"></a>                    <a href="convection_tracer.html#rase_traceri398" target="origFile">cll0(l) = wlq - qst(ic)*eta(ic)</a>
<a name="rase_tracer_di400"></a>                  <a href="convection_tracer.html#rase_traceri393" target="origFile"><code class="keyword">END IF</code></a>
                  <a href="convection_tracer.html#rase_traceri399" target="origFile"><code class="keyword">IF</code> (cll0(l) .LT. <code class="constant">0.00</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di401"></a>                    <a href="convection_tracer.html#rase_traceri400" target="origFile">cll0(l) = <code class="constant">0.00</code></a>
                  <a href="convection_tracer.html#rase_traceri399" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di402"></a>                    <a href="convection_tracer.html#rase_traceri401" target="origFile">cll0(l) = cll0(l)</a>
<a name="rase_tracer_di403"></a>                  <a href="convection_tracer.html#rase_traceri399" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di404"></a>                  <a href="convection_tracer.html#rase_traceri402" target="origFile">cli = cll0(l)/eta(l)</a>
<a name="rase_tracer_di405"></a>                  <a href="convection_tracer.html#rase_traceri403" target="origFile">te_a = poi(l)*prh(l)</a>
<a name="rase_tracer_di406"></a>                  <a href="convection_tracer.html#rase_traceri404" target="origFile"><code class="keyword">CALL </code><code class="funcname">SUNDQ3_ICE</code>(te_a, sdqv2, sdqv3, sdqvt1, f2, f3)</a>
<a name="rase_tracer_di407"></a>                  <a href="convection_tracer.html#rase_traceri405" target="origFile">c00_x = co_auto(i)*f2*f3*f4</a>
<a name="rase_tracer_di408"></a>                  <a href="convection_tracer.html#rase_traceri406" target="origFile">cli_crit_x = cli_crit/(f2*f3)</a>
<a name="rase_tracer_di409"></a>                  <a href="convection_tracer.html#rase_traceri407" target="origFile">arg1 = -(cli**<code class="constant">2</code>/cli_crit_x**<code class="constant">2</code>)</a>
<a name="rase_tracer_di410"></a>                  <a href="convection_tracer.html#rase_traceri408" target="origFile">rate = c00_x*(<code class="constant">1.0</code>-<code class="funcname">EXP</code>(arg1))</a>
                  <a href="convection_tracer.html#rase_traceri409" target="origFile"><code class="keyword">IF</code> (cvw(l) .LT. <code class="constant">1.00</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di411"></a>                    <a href="convection_tracer.html#rase_traceri410" target="origFile">cvw_x = <code class="constant">1.00</code></a>
                  <a href="convection_tracer.html#rase_traceri409" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di412"></a>                    <a href="convection_tracer.html#rase_traceri411" target="origFile">cvw_x = cvw(l)</a>
<a name="rase_tracer_di413"></a>                  <a href="convection_tracer.html#rase_traceri409" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di414"></a>                  <a href="convection_tracer.html#rase_traceri412" target="origFile">dt_lyr = (zet(l)-zet(l+<code class="constant">1</code>))/cvw_x</a>
<a name="rase_tracer_di415"></a>                  <a href="convection_tracer.html#rase_traceri413" target="origFile">closs = cll0(l)*rate*dt_lyr</a>
                  <a href="convection_tracer.html#rase_traceri414" target="origFile"><code class="keyword">IF</code> (closs .GT. cll0(l)) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di416"></a>                    <a href="convection_tracer.html#rase_traceri415" target="origFile">closs = cll0(l)</a>
                  <a href="convection_tracer.html#rase_traceri414" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di417"></a>                    <a href="convection_tracer.html#rase_traceri416" target="origFile">closs = closs</a>
<a name="rase_tracer_di418"></a>                  <a href="convection_tracer.html#rase_traceri414" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di419"></a>                  <a href="convection_tracer.html#rase_traceri417" target="origFile">cll0(l) = cll0(l) - closs</a>
<a name="rase_tracer_di420"></a>                  <a href="convection_tracer.html#rase_traceri418" target="origFile">dll0(l) = closs</a>
<a name="rase_tracer_di421"></a>                  <a href="convection_tracer.html#rase_traceri419" target="origFile"><code class="keyword">IF</code> (closs .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                    <a href="convection_tracer.html#rase_traceri420" target="origFile">wlq = wlq - closs</a>
<a name="rase_tracer_di422"></a>                    <a href="convection_tracer.html#rase_traceri421" target="origFile">rnn(l) = closs</a>
                  <a href="convection_tracer.html#rase_traceri419" target="origFile"><code class="keyword">ELSE</code></a>
                    <a href="convection_tracer.html#rase_traceri422" target="origFile">rnn(l) = <code class="constant">0.</code></a>
<a name="rase_tracer_di424"></a>                  <a href="convection_tracer.html#rase_traceri419" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di425"></a>                <a href="convection_tracer.html#rase_traceri423" target="origFile"><code class="keyword">END DO</code></a>
                <a href="convection_tracer.html#rase_traceri424" target="origFile">wlq = wlq - qst(ic)*eta(ic)</a>
<a name="rase_tracer_di425"></a><a href="convection_tracer.html#rase_traceri425" target="origFile"><code class="comment">!CALCULATE GAMMAS AND KERNEL</code></a>
<a name="rase_tracer_di426"></a>                <a href="convection_tracer.html#rase_traceri425" target="origFile">gmsd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di426"></a>                <a href="convection_tracer.html#rase_traceri425" target="origFile">gms(k) = (sht(k)-ssl(k))*pri(k)</a>
<a name="rase_tracer_di427"></a>                <a href="convection_tracer.html#rase_traceri426" target="origFile">gmhd(k) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di428"></a>                <a href="convection_tracer.html#rase_traceri426" target="origFile">gmh(k) = gms(k) + (qht(k)-qol(k))*pri(k)*alhl</a>
<a name="rase_tracer_di433"></a>                <a href="convection_tracer.html#rase_traceri427" target="origFile">akm = gmh(k)*gam(k-<code class="constant">1</code>)*dpb(k-<code class="constant">1</code>)</a>
<a name="rase_tracer_di429"></a>                <a href="convection_tracer.html#rase_traceri428" target="origFile">tx2 = gmh(k)</a>
<a name="rase_tracer_di429"></a>                <a href="convection_tracer.html#rase_traceri433" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                  <a href="convection_tracer.html#rase_traceri429" target="origFile">gmsd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di430"></a>                  <a href="convection_tracer.html#rase_traceri429" target="origFile">gms(l) = (eta(l)*(sht(l)-ssl(l))+eta(l+<code class="constant">1</code>)*(ssl(l)-sht(<code class="label">&</code></a>
<a name="rase_tracer_di430"></a><a href="convection_tracer.html#rase_traceri429" target="origFile"><code class="label">&                   </code>l+<code class="constant">1</code>)))*pri(l)</a>
                  <a href="convection_tracer.html#rase_traceri430" target="origFile">gmhd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di431"></a>                  <a href="convection_tracer.html#rase_traceri430" target="origFile">gmh(l) = gms(l) + (eta(l)*(qht(l)-qol(l))+eta(l+<code class="constant">1</code>)*(<code class="label">&</code></a>
<a name="rase_tracer_di432"></a><a href="convection_tracer.html#rase_traceri430" target="origFile"><code class="label">&                   </code>qol(l)-qht(l+<code class="constant">1</code>)))*alhl*pri(l)</a>
                  <a href="convection_tracer.html#rase_traceri431" target="origFile">tx2 = tx2 + (eta(l)-eta(l+<code class="constant">1</code>))*gmh(l)</a>
<a name="rase_tracer_di434"></a>                  <a href="convection_tracer.html#rase_traceri432" target="origFile">akm = akm - gms(l)*eht(l)*pki(l) + tx2*ght(l)</a>
<a name="rase_tracer_di434"></a>                <a href="convection_tracer.html#rase_traceri433" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di435"></a>                <a href="convection_tracer.html#rase_traceri434" target="origFile">gmsd(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di436"></a>                <a href="convection_tracer.html#rase_traceri434" target="origFile">gms(ic) = eta(ic+<code class="constant">1</code>)*(ssl(ic)-sht(ic+<code class="constant">1</code>))*pri(ic)</a>
<a name="rase_tracer_di436"></a>                <a href="convection_tracer.html#rase_traceri435" target="origFile">akm = akm - gms(ic)*eta(ic+<code class="constant">1</code>)*dpb(ic)*pki(ic)</a>
                <a href="convection_tracer.html#rase_traceri436" target="origFile">gmhd(ic) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di437"></a>                <a href="convection_tracer.html#rase_traceri436" target="origFile">gmh(ic) = gms(ic) + (eta(ic+<code class="constant">1</code>)*(qol(ic)-qht(ic+<code class="constant">1</code>))*alhl+<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri436" target="origFile"><code class="label">&                 </code>eta(ic)*(hst(ic)-hol(ic)))*pri(ic)</a>
<a name="rase_tracer_di438"></a><a href="convection_tracer.html#rase_traceri437" target="origFile"><code class="comment">!CLOUD BASE MASS FLUX</code></a>
                <a href="convection_tracer.html#rase_traceri437" target="origFile"><code class="keyword">IF</code> (.NOT.(akm .GE. <code class="constant">0.0 </code>.OR. wlq .LT. <code class="constant">0.0</code>)) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di439"></a><a href="convection_tracer.html#rase_traceri438" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di440"></a>                  <a href="convection_tracer.html#rase_traceri438" target="origFile">wfn = -((wfn-acr)/akm)</a>
<a name="rase_tracer_di441"></a>                  <a href="convection_tracer.html#rase_traceri439" target="origFile">x3 = rasal(ic)*trg*toki*wfn</a>
                  <a href="convection_tracer.html#rase_traceri440" target="origFile"><code class="keyword">IF</code> (x3 .GT. (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di442"></a>                    <a href="convection_tracer.html#rase_traceri441" target="origFile">wfn = (prs(k+<code class="constant">1</code>)-prs(k))*(<code class="constant">100.</code>*pblfrac)</a>
                  <a href="convection_tracer.html#rase_traceri440" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di443"></a>                    <a href="convection_tracer.html#rase_traceri442" target="origFile">wfn = x3</a>
                  <a href="convection_tracer.html#rase_traceri440" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di444"></a><a href="convection_tracer.html#rase_traceri443" target="origFile"><code class="comment">!CUMULATIVE PRECIP AND CLOUD-BASE MASS FLUX FOR OUTPUT</code></a>
<a name="rase_tracer_di445"></a>                  <a href="convection_tracer.html#rase_traceri443" target="origFile">tem = wfn*gravi</a>
<a name="rase_tracer_di446"></a>                  <a href="convection_tracer.html#rase_traceri444" target="origFile">cll(ic) = cll(ic) + wlq*tem</a>
<a name="rase_tracer_di455"></a>                  <a href="convection_tracer.html#rase_traceri445" target="origFile">rmf(ic) = rmf(ic) + tem</a>
<a name="rase_tracer_di447"></a>                  <a href="convection_tracer.html#rase_traceri446" target="origFile">rmfd(ic) = rmfd(ic) + tem*eta(ic)</a>
<a name="rase_tracer_di448"></a>                  <a href="convection_tracer.html#rase_traceri455" target="origFile"><code class="keyword">DO </code>l=ic+<code class="constant">1</code>,k</a>
<a name="rase_tracer_di449"></a>                    <a href="convection_tracer.html#rase_traceri447" target="origFile">rmfp(l) = tem*eta(l)</a>
<a name="rase_tracer_di450"></a>                    <a href="convection_tracer.html#rase_traceri448" target="origFile">rmfc(l) = rmfc(l) + rmfp(l)</a>
<a name="rase_tracer_di451"></a>                    <a href="convection_tracer.html#rase_traceri449" target="origFile">dllx(l) = dllx(l) + tem*dll0(l)</a>
                    <a href="convection_tracer.html#rase_traceri450" target="origFile"><code class="keyword">IF</code> (cvw(l) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
                      <a href="convection_tracer.html#rase_traceri451" target="origFile">updfrp(l) = rmfp(l)*(ddt/daylen)*<code class="constant">1000.</code>/(cvw(l)*prs<code class="label">&</code></a>
<a name="rase_tracer_di452"></a><a href="convection_tracer.html#rase_traceri451" target="origFile"><code class="label">&                       </code>(l))</a>
                    <a href="convection_tracer.html#rase_traceri450" target="origFile"><code class="keyword">ELSE</code></a>
<a name="rase_tracer_di453"></a>                      <a href="convection_tracer.html#rase_traceri452" target="origFile">updfrp(l) = <code class="constant">0.0</code></a>
<a name="rase_tracer_di454"></a>                    <a href="convection_tracer.html#rase_traceri450" target="origFile"><code class="keyword">END IF</code></a>
                    <a href="convection_tracer.html#rase_traceri453" target="origFile">clli(l) = cll0(l)/eta(l)</a>
<a name="rase_tracer_di462"></a>                    <a href="convection_tracer.html#rase_traceri454" target="origFile">updfrc(l) = updfrc(l) + updfrp(l)</a>
                  <a href="convection_tracer.html#rase_traceri455" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di456"></a><a href="convection_tracer.html#rase_traceri462" target="origFile"><code class="comment">!THETA AND Q CHANGE DUE TO CLOUD TYPE IC</code></a>
<a name="rase_tracer_di457"></a>                  <a href="convection_tracer.html#rase_traceri462" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
<a name="rase_tracer_di457"></a>                    <a href="convection_tracer.html#rase_traceri456" target="origFile">rns(l) = rns(l) + rnn(l)*tem</a>
<a name="rase_tracer_di458"></a>                    <a href="convection_tracer.html#rase_traceri457" target="origFile">gmhd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di458"></a>                    <a href="convection_tracer.html#rase_traceri457" target="origFile">gmh(l) = gmh(l)*wfn</a>
<a name="rase_tracer_di459"></a>                    <a href="convection_tracer.html#rase_traceri458" target="origFile">gmsd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di459"></a>                    <a href="convection_tracer.html#rase_traceri458" target="origFile">gms(l) = gms(l)*wfn</a>
<a name="rase_tracer_di460"></a>                    <a href="convection_tracer.html#rase_traceri459" target="origFile">qoid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di460"></a>                    <a href="convection_tracer.html#rase_traceri459" target="origFile">qoi(l) = qoi(l) + (gmh(l)-gms(l))*alhi</a>
<a name="rase_tracer_di461"></a>                    <a href="convection_tracer.html#rase_traceri460" target="origFile">poid(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di461"></a>                    <a href="convection_tracer.html#rase_traceri460" target="origFile">poi(l) = poi(l) + gms(l)*pki(l)*cpi</a>
                    <a href="convection_tracer.html#rase_traceri461" target="origFile">qstd(l) = <code class="constant">0.0_8</code></a>
<a name="rase_tracer_di463"></a>                    <a href="convection_tracer.html#rase_traceri461" target="origFile">qst(l) = qst(l) + gms(l)*bet(l)*cpi</a>
                  <a href="convection_tracer.html#rase_traceri462" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di464"></a><a href="convection_tracer.html#rase_traceri463" target="origFile"><code class="comment">!*FRICFAC*0.5</code></a>
                  <a href="convection_tracer.html#rase_traceri463" target="origFile">wfn = wfn*<code class="constant">0.5</code>*<code class="constant">1.0</code></a>
<a name="rase_tracer_di466"></a><a href="convection_tracer.html#rase_traceri464" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di465"></a>                  <a href="convection_tracer.html#rase_traceri464" target="origFile">tem = wfn*pri(k)</a>
                  <a href="convection_tracer.html#rase_traceri466" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di465"></a>                    <a href="convection_tracer.html#rase_traceri465" target="origFile">xcud(k, itr) = xcud(k, itr) + tem*(xoid(k-<code class="constant">1</code>, itr)-<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri465" target="origFile"><code class="label">&                     </code>xoid(k, itr))</a>
                    <a href="convection_tracer.html#rase_traceri465" target="origFile">xcu(k, itr) = xcu(k, itr) + tem*(xoi(k-<code class="constant">1</code>, itr)-xoi(k<code class="label">&</code></a>
<a name="rase_tracer_di470"></a><a href="convection_tracer.html#rase_traceri465" target="origFile"><code class="label">&                     </code>, itr))</a>
<a name="rase_tracer_di469"></a>                  <a href="convection_tracer.html#rase_traceri466" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di467"></a>                  <a href="convection_tracer.html#rase_traceri470" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di468"></a>                    <a href="convection_tracer.html#rase_traceri469" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                      <a href="convection_tracer.html#rase_traceri467" target="origFile">tem = wfn*pri(l)</a>
                      <a href="convection_tracer.html#rase_traceri468" target="origFile">xcud(l, itr) = xcud(l, itr) + tem*(eta(l)*(xoid(l-<code class="label">&</code></a>
<a name="rase_tracer_di468"></a><a href="convection_tracer.html#rase_traceri468" target="origFile"><code class="label">&                       </code><code class="constant">1</code>, itr)-xoid(l, itr))+eta(l+<code class="constant">1</code>)*(xoid(l, itr)-<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri468" target="origFile"><code class="label">&                       </code>xoid(l+<code class="constant">1</code>, itr)))</a>
                      <a href="convection_tracer.html#rase_traceri468" target="origFile">xcu(l, itr) = xcu(l, itr) + tem*((xoi(l-<code class="constant">1</code>, itr)-<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri468" target="origFile"><code class="label">&                       </code>xoi(l, itr))*eta(l)+(xoi(l, itr)-xoi(l+<code class="constant">1</code>, itr))*<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri468" target="origFile"><code class="label">&                       </code>eta(l+<code class="constant">1</code>))</a>
<a name="rase_tracer_di471"></a>                    <a href="convection_tracer.html#rase_traceri469" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di473"></a>                  <a href="convection_tracer.html#rase_traceri470" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di472"></a>                  <a href="convection_tracer.html#rase_traceri471" target="origFile">tem = wfn*pri(ic)</a>
                  <a href="convection_tracer.html#rase_traceri473" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
                    <a href="convection_tracer.html#rase_traceri472" target="origFile">xcud(ic, itr) = xcud(ic, itr) + tem*(<code class="constant">2.</code>*(xhtd(itr)-(<code class="label">&</code></a>
<a name="rase_tracer_di472"></a><a href="convection_tracer.html#rase_traceri472" target="origFile"><code class="label">&                     </code>eta(ic)-eta(ic+<code class="constant">1</code>))*xoid(ic, itr))-eta(ic+<code class="constant">1</code>)*(xoid(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri472" target="origFile"><code class="label">&                     </code>ic, itr)+xoid(ic+<code class="constant">1</code>, itr)))</a>
                    <a href="convection_tracer.html#rase_traceri472" target="origFile">xcu(ic, itr) = xcu(ic, itr) + (<code class="constant">2.</code>*(xht(itr)-xoi(ic, <code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri472" target="origFile"><code class="label">&                     </code>itr)*(eta(ic)-eta(ic+<code class="constant">1</code>)))-(xoi(ic, itr)+xoi(ic+<code class="constant">1</code>, <code class="label">&</code></a>
<a name="rase_tracer_di476"></a><a href="convection_tracer.html#rase_traceri472" target="origFile"><code class="label">&                     </code>itr))*eta(ic+<code class="constant">1</code>))*tem</a>
<a name="rase_tracer_di475"></a>                  <a href="convection_tracer.html#rase_traceri473" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di474"></a>                  <a href="convection_tracer.html#rase_traceri476" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
<a name="rase_tracer_di474"></a>                    <a href="convection_tracer.html#rase_traceri475" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
                      <a href="convection_tracer.html#rase_traceri474" target="origFile">xoid(l, itr) = xoid(l, itr) + xcud(l, itr)</a>
                      <a href="convection_tracer.html#rase_traceri474" target="origFile">xoi(l, itr) = xoi(l, itr) + xcu(l, itr)</a>
<a name="rase_tracer_di477"></a>                    <a href="convection_tracer.html#rase_traceri475" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection_tracer.html#rase_traceri476" target="origFile"><code class="keyword">END DO</code></a>
<a href="convection_tracer.html#rase_traceri477" target="origFile"><code class="comment">!End DO_TRACERS</code></a>
<a name="rase_tracer_di478"></a><a href="convection_tracer.html#rase_traceri477" target="origFile"><code class="comment">!CUMULUS FRICTION</code></a>
                  <a href="convection_tracer.html#rase_traceri477" target="origFile"><code class="keyword">IF</code> (fricfac .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di479"></a><a href="convection_tracer.html#rase_traceri478" target="origFile"><code class="comment">!================&gt;></code></a>
<a name="rase_tracer_di480"></a>                    <a href="convection_tracer.html#rase_traceri478" target="origFile">wfn = wfn*fricfac*<code class="funcname">EXP</code>(-(alm/friclambda))</a>
<a name="rase_tracer_di481"></a>                    <a href="convection_tracer.html#rase_traceri479" target="origFile">tem = wfn*pri(k)</a>
<a name="rase_tracer_di485"></a>                    <a href="convection_tracer.html#rase_traceri480" target="origFile">ucu(k) = ucu(k) + tem*(uoi(k-<code class="constant">1</code>)-uoi(k))</a>
<a name="rase_tracer_di482"></a>                    <a href="convection_tracer.html#rase_traceri481" target="origFile">vcu(k) = vcu(k) + tem*(voi(k-<code class="constant">1</code>)-voi(k))</a>
<a name="rase_tracer_di483"></a>                    <a href="convection_tracer.html#rase_traceri485" target="origFile"><code class="keyword">DO </code>l=k-<code class="constant">1</code>,ic+<code class="constant">1</code>,-<code class="constant">1</code></a>
                      <a href="convection_tracer.html#rase_traceri482" target="origFile">tem = wfn*pri(l)</a>
<a name="rase_tracer_di484"></a>                      <a href="convection_tracer.html#rase_traceri483" target="origFile">ucu(l) = ucu(l) + tem*((uoi(l-<code class="constant">1</code>)-uoi(l))*eta(l)+(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri483" target="origFile"><code class="label">&                       </code>uoi(l)-uoi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
                      <a href="convection_tracer.html#rase_traceri484" target="origFile">vcu(l) = vcu(l) + tem*((voi(l-<code class="constant">1</code>)-voi(l))*eta(l)+(<code class="label">&</code></a>
<a name="rase_tracer_di486"></a><a href="convection_tracer.html#rase_traceri484" target="origFile"><code class="label">&                       </code>voi(l)-voi(l+<code class="constant">1</code>))*eta(l+<code class="constant">1</code>))</a>
<a name="rase_tracer_di487"></a>                    <a href="convection_tracer.html#rase_traceri485" target="origFile"><code class="keyword">END DO</code></a>
                    <a href="convection_tracer.html#rase_traceri486" target="origFile">tem = wfn*pri(ic)</a>
<a name="rase_tracer_di488"></a>                    <a href="convection_tracer.html#rase_traceri487" target="origFile">ucu(ic) = ucu(ic) + (<code class="constant">2.</code>*(uht-uoi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri487" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(uoi(ic)+uoi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
<a name="rase_tracer_di491"></a>                    <a href="convection_tracer.html#rase_traceri488" target="origFile">vcu(ic) = vcu(ic) + (<code class="constant">2.</code>*(vht-voi(ic)*(eta(ic)-eta(ic<code class="label">&</code></a>
<a name="rase_tracer_di489"></a><a href="convection_tracer.html#rase_traceri488" target="origFile"><code class="label">&                     </code>+<code class="constant">1</code>)))-(voi(ic)+voi(ic+<code class="constant">1</code>))*eta(ic+<code class="constant">1</code>))*tem</a>
<a name="rase_tracer_di490"></a>                    <a href="convection_tracer.html#rase_traceri491" target="origFile"><code class="keyword">DO </code>l=ic,k</a>
                      <a href="convection_tracer.html#rase_traceri489" target="origFile">uoi(l) = uoi(l) + ucu(l)</a>
                      <a href="convection_tracer.html#rase_traceri490" target="origFile">voi(l) = voi(l) + vcu(l)</a>
                    <a href="convection_tracer.html#rase_traceri491" target="origFile"><code class="keyword">END DO</code></a>
                  <a href="convection_tracer.html#rase_traceri477" target="origFile"><code class="keyword">END IF</code></a>
                <a href="convection_tracer.html#rase_traceri437" target="origFile"><code class="keyword">END IF</code></a>
              <a href="convection_tracer.html#rase_traceri363" target="origFile"><code class="keyword">END IF</code></a>
            <a href="convection_tracer.html#rase_traceri319" target="origFile"><code class="keyword">END IF</code></a>
          <a href="convection_tracer.html#rase_traceri317" target="origFile"><code class="keyword">END IF</code></a>
        <a href="convection_tracer.html#rase_traceri313" target="origFile"><code class="keyword">END IF</code></a>
<a name="rase_tracer_di493"></a>      <a href="convection_tracer.html#rase_traceri287" target="origFile"><code class="keyword">END IF</code></a>
    <a href="convection_tracer.html#rase_traceri492" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di494"></a><a href="convection_tracer.html#rase_traceri493" target="origFile"><code class="comment">!CLOUD LOOP</code></a>
<a name="rase_tracer_di495"></a>    <a href="convection_tracer.html#rase_traceri493" target="origFile"><code class="keyword">IF</code> (<code class="funcname">SUM</code>(rmf(icmin:k)) .GT. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
<a name="rase_tracer_di496"></a>      <a href="convection_tracer.html#rase_traceri494" target="origFile">tho(i, icmin:k-<code class="constant">1</code>) = poi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_tracer_di497"></a>      <a href="convection_tracer.html#rase_traceri495" target="origFile">qho(i, icmin:k-<code class="constant">1</code>) = qoi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_tracer_di498"></a>      <a href="convection_tracer.html#rase_traceri496" target="origFile">uho(i, icmin:k-<code class="constant">1</code>) = uoi(icmin:k-<code class="constant">1</code>)</a>
      <a href="convection_tracer.html#rase_traceri497" target="origFile">vho(i, icmin:k-<code class="constant">1</code>) = voi(icmin:k-<code class="constant">1</code>)</a>
<a name="rase_tracer_di499"></a><a href="convection_tracer.html#rase_traceri498" target="origFile"><code class="comment">!De-strap tendencies from RAS</code></a>
      <a href="convection_tracer.html#rase_traceri498" target="origFile">wght = wgt1(i, :)</a>
<a name="rase_tracer_di501"></a><a href="convection_tracer.html#rase_traceri499" target="origFile"><code class="comment">!Scale properly by layer masses</code></a>
<a name="rase_tracer_di500"></a>      <a href="convection_tracer.html#rase_traceri499" target="origFile">wght0 = <code class="constant">0.</code></a>
      <a href="convection_tracer.html#rase_traceri501" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_tracer_di502"></a>        <a href="convection_tracer.html#rase_traceri500" target="origFile">wght0 = wght0 + wght(l)*(ple(i, l+<code class="constant">1</code>)-ple(i, l))</a>
<a name="rase_tracer_di503"></a>      <a href="convection_tracer.html#rase_traceri501" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di508"></a>      <a href="convection_tracer.html#rase_traceri502" target="origFile">wght0 = (prs(k+<code class="constant">1</code>)-prs(k))/wght0</a>
<a name="rase_tracer_di504"></a>      <a href="convection_tracer.html#rase_traceri503" target="origFile">wght = wght0*wght</a>
<a name="rase_tracer_di505"></a>      <a href="convection_tracer.html#rase_traceri508" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_tracer_di506"></a>        <a href="convection_tracer.html#rase_traceri504" target="origFile">tho(i, l) = tho(i, l) + wght(l)*(poi(k)-poi_sv(k))</a>
<a name="rase_tracer_di507"></a>        <a href="convection_tracer.html#rase_traceri505" target="origFile">qho(i, l) = qho(i, l) + wght(l)*(qoi(k)-qoi_sv(k))</a>
        <a href="convection_tracer.html#rase_traceri506" target="origFile">uho(i, l) = uho(i, l) + wght(l)*(uoi(k)-uoi_sv(k))</a>
<a name="rase_tracer_di509"></a>        <a href="convection_tracer.html#rase_traceri507" target="origFile">vho(i, l) = vho(i, l) + wght(l)*(voi(k)-voi_sv(k))</a>
      <a href="convection_tracer.html#rase_traceri508" target="origFile"><code class="keyword">END DO</code></a>
<a name="rase_tracer_di509"></a><a href="convection_tracer.html#rase_traceri509" target="origFile"><code class="comment">!DO_TRACERS</code></a>
<a name="rase_tracer_di512"></a>      <a href="convection_tracer.html#rase_traceri509" target="origFile">xhod(i, icmin:k-<code class="constant">1</code>, :) = xoid(icmin:k-<code class="constant">1</code>, :)</a>
<a name="rase_tracer_di511"></a>      <a href="convection_tracer.html#rase_traceri509" target="origFile">xho(i, icmin:k-<code class="constant">1</code>, :) = xoi(icmin:k-<code class="constant">1</code>, :)</a>
<a name="rase_tracer_di510"></a>      <a href="convection_tracer.html#rase_traceri512" target="origFile"><code class="keyword">DO </code>itr=<code class="constant">1</code>,itrcr</a>
        <a href="convection_tracer.html#rase_traceri511" target="origFile"><code class="keyword">DO </code>l=k,k0</a>
<a name="rase_tracer_di510"></a>          <a href="convection_tracer.html#rase_traceri510" target="origFile">xhod(i, l, itr) = xhod(i, l, itr) + wght(l)*(xoid(k, itr)-<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri510" target="origFile"><code class="label">&           </code>xoi_svd(k, itr))</a>
          <a href="convection_tracer.html#rase_traceri510" target="origFile">xho(i, l, itr) = xho(i, l, itr) + wght(l)*(xoi(k, itr)-xoi_sv(<code class="label">&</code></a>
<a href="convection_tracer.html#rase_traceri510" target="origFile"><code class="label">&           </code>k, itr))</a>
        <a href="convection_tracer.html#rase_traceri511" target="origFile"><code class="keyword">END DO</code></a>
      <a href="convection_tracer.html#rase_traceri512" target="origFile"><code class="keyword">END DO</code></a>
    <a href="convection_tracer.html#rase_traceri493" target="origFile"><code class="keyword">END IF</code></a>
  <a href="convection_tracer.html#rase_traceri152" target="origFile"><code class="keyword">END IF</code></a>
<a href="convection_tracer.html#rase_tracer" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RASE_TRACER_D</code></a>

</pre>
</body>
