<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Ecuador team)</code>
<code class="comment">!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30</code>
<code class="comment">!</code>
<code class="comment">!-------------------------------------------------------------------------</code>
<code class="comment">!         NASA/GSFC, Software Systems Support Office, Code 610.3         !</code>
<code class="comment">!-------------------------------------------------------------------------</code>
<code class="comment">!BOP</code>
<code class="comment">!</code>
<code class="comment">! !MODULE: convectiveTransport_mod </code>
<code class="comment">!</code>
<code class="comment">! !INTERFACE:</code>
<code class="comment">!</code>
<code class="keyword">MODULE </code><code class="funcname">CONVECTIVETRANSPORT_MOD</code>
  <code class="keyword">IMPLICIT NONE</code>
<code class="comment">!EOC</code>
<code class="comment">!------------------------------------------------------------------------------</code>
  PRIVATE 
  PUBLIC convectivetransport
<a name="convectivetransport"></a>
<code class="keyword">CONTAINS</code>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Module for the convective transport.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!-----------------------------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!-----------------------------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!BOP</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !IROUTINE: convectiveTransport</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !INTERFACE:</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
  <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">CONVECTIVETRANSPORT</code>(<code class="vardecl">il2g</code>, <code class="vardecl">delt</code>, <code class="vardecl">xmbsth</code>, <code class="vardecl">ideep</code>, <code class="vardecl">pbli</code>, <code class="vardecl">dui</code>, <code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">eui</code>, <code class="vardecl">mui</code>, <code class="vardecl">mdi</code>, <code class="vardecl">dpi</code>, <code class="vardecl">fracis</code>, <code class="vardecl">qq</code>, <code class="vardecl">isfixedconcentration</code>, <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">k1</code>, <code class="vardecl">k2</code><code class="label">&</code></a>
<a name="convectivetransporti0"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">&   </code>, <code class="vardecl">ilong</code>, <code class="vardecl">numspecies</code>)</a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a name="convectivetransporti1"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !INPUT PARAMETERS</code></a>
<a name="convectivetransporti2"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">isfixedconcentration</code>(:)</a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">k1</code>, <code class="vardecl">k2</code>, <code class="vardecl">ilong</code>, <code class="vardecl">numspecies</code></a>
<a name="convectivetransporti3"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathered max lon indices over which to operate</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">il2g</code></a>
<a name="convectivetransporti4"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! convection time step (s)</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">delt</code></a>
<a name="convectivetransporti5"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! threshold below which we treat mass fluxes as zero (mb/s)</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">xmbsth</code></a>
<a name="convectivetransporti6"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathering array</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ideep</code>(<code class="vardecl">ilong</code>)</a>
<a name="convectivetransporti7"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! index of planetary boundary layer</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">pbli</code>(<code class="vardecl">ilong</code>)</a>
<a name="convectivetransporti8"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mass detraining from updraft</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dui</code>(<code class="vardecl">ilong</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti9"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mass entraining into updraft</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">eui</code>(<code class="vardecl">ilong</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti10"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mass flux up</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mui</code>(<code class="vardecl">ilong</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti11"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mass flux down</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mdi</code>(<code class="vardecl">ilong</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti12"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! delta pressure between interfaces</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">dpi</code>(<code class="vardecl">ilong</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti13"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! insoluble fraction of tracer</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">fracis</code>(<code class="vardecl">i1</code>:<code class="vardecl">i2</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>, <code class="vardecl">numspecies</code>)</a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !INPUT/OUTPUT PARAMETERS:</code></a>
<a name="convectivetransporti14"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! tracer array including moisture (mixing ratio)</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">qq</code>(<code class="vardecl">i1</code>:<code class="vardecl">i2</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>, <code class="vardecl">numspecies</code>)</a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! This routine performs convective transport of trace species.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Note that we assume that the tracers are in a moist mixing ratio.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a name="convectivetransporti15"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !DEFINED PARAMETERS:</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">small</code>=<code class="constant">1.0d-36</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!-----------------------------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!BOC</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!</code></a>
<a name="convectivetransporti16"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! !LOCAL VARIABLES:</code></a>
<a name="convectivetransporti17"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">CHARACTER</code>(<code class="keyword">len</code>=<code class="constant">75</code>) :: <code class="vardecl">err_msg</code></a>
<a name="convectivetransporti18"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">il</code>, <code class="vardecl">ik</code>, <code class="vardecl">ic</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">km1</code>, <code class="vardecl">kp1</code></a>
<a name="convectivetransporti19"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! average mixing ratio in pbl</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">avg_pbl</code></a>
<a name="convectivetransporti20"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mix ratio of constituent above</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cabv</code></a>
<a name="convectivetransporti21"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mix ratio of constituent below</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cbel</code></a>
<a name="convectivetransporti22"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! normalized diff. between cabv and cbel</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cdifr</code></a>
<a name="convectivetransporti23"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! flux coming into  each box at a k level</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fluxin</code></a>
<a name="convectivetransporti24"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! flux going out of each box at a k level</code></a>
<a name="convectivetransporti25"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fluxout</code></a>
<a name="convectivetransporti26"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">maxc</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">minc</code></a>
<a name="convectivetransporti27"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mixing ratio of a scavenged tracer</code></a>
<a name="convectivetransporti28"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">scav</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">sqrt_fisg</code></a>
<a name="convectivetransporti29"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!.sds - new temp variable for updraft concen calc</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_conu</code></a>
<a name="convectivetransporti30"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mix ratio in env.      at interfaces</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">chat</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti31"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mix ratio in updraft   at interfaces</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">conu</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti32"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! mix ratio in downdraft at interfaces</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">cond</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti33"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathered tend.  array</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">dcondt</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti34"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathered downdraft entrainment</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">edi</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti35"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathered insoluble frac. of tracer</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">fisg</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti36"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! gathered tracer array</code></a>
<a name="convectivetransporti37"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">xconst</code>(<code class="vardecl">il2g</code>, <code class="vardecl">k1</code>:<code class="vardecl">k2</code>)</a>
<a name="convectivetransporti38"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="convectivetransporti39"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="convectivetransporti40"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
<a name="convectivetransporti41"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
<a name="convectivetransporti42"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
<a name="convectivetransporti43"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">min1</code></a>
<a name="convectivetransporti44"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs0</code></a>
<a name="convectivetransporti45"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">min2</code></a>
<a name="convectivetransporti46"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">min3</code></a>
<a name="convectivetransporti47"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">LOGICAL</code>, DIMENSION(il2g, k2-k1+<code class="constant">1</code>) :: <code class="vardecl">mask</code></a>
<a name="convectivetransporti48"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1</code></a>
<a name="convectivetransporti52"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">icloop:</code><code class="keyword">DO </code>ic=<code class="constant">1</code>,numspecies</a>
      <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.isfixedconcentration(ic)) <code class="keyword">THEN</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Gather up the constituent and set tend. to zero.</code></a>
<a name="convectivetransporti51"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ------------------------------------------------</code></a>
<a name="convectivetransporti49"></a>        <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">DO </code>ik=k1,k2</a>
<a name="convectivetransporti50"></a>          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">DO </code>il=<code class="constant">1</code>,il2g</a>
            <a href="null.html#convectivetransport_mod_bi1" target="diffFile">fisg(il, ik) = fracis(ideep(il), ik, ic)</a>
            <a href="null.html#convectivetransport_mod_bi0" target="diffFile">xconst(il, ik) = qq(ideep(il), ik, ic)</a>
<a name="convectivetransporti65"></a>          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -----------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! From now on work only with gathered data.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -----------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ----------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Interpolate environment tracer values to interfaces.</code></a>
<a name="convectivetransporti53"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ----------------------------------------------------</code></a>
<a name="convectivetransporti54"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">ikloop1:</code><code class="keyword">DO </code>ik=k1,k2</a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (k1 .LT. ik - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="convectivetransporti55"></a>            <a href="null.html#convectivetransport_mod_bi2" target="diffFile">km1 = ik - <code class="constant">1</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti56"></a>            <a href="null.html#convectivetransport_mod_bi3" target="diffFile">km1 = k1</a>
<a name="convectivetransporti57"></a>          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (k2 .GT. ik + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="convectivetransporti58"></a>            <a href="null.html#convectivetransport_mod_b" target="diffFile">kp1 = ik + <code class="constant">1</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti59"></a>            <a href="null.html#convectivetransport_mod_b" target="diffFile">kp1 = k2</a>
<a name="convectivetransporti64"></a>          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="convectivetransporti60"></a>          <a href="null.html#convectivetransport_mod_bi4" target="diffFile">edi(:, ik) = mdi(:, ik) - mdi(:, kp1)</a>
  <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">illoop1:</code><code class="keyword">DO </code>il=<code class="constant">1</code>,il2g</a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!minc = Min (xconst(il,km1), xconst(il,ik))</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!maxc = Max (xconst(il,km1), xconst(il,ik))</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!if (minc &lt; 0.0d0) then</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!cdifr = 0.0d0</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!else</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!cdifr = Abs (xconst(il,ik) - xconst(il,km1)) /  &</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!        Max (maxc, SMALL)</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!end if</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!if (cdifr &gt; 1.0d-6) then</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   ! -------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   ! The two layers differ significantly, so use a geometric</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   ! averaging procedure.</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   ! -------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   cabv = Max (xconst(il,km1), (maxc * 1.0d-12))</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   cbel = Max (xconst(il,ik),  (maxc * 1.0d-12))</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!   chat(il,ik) = Log (cabv/cbel) / (cabv - cbel) * cabv * cbel</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">!else</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">! ---------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">! The two layers have only a small difference, so use</code></a>
<a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">! arithmetic mean.</code></a>
<a name="convectivetransporti61"></a><a href="null.html#convectivetransport_mod_bi8" target="diffFile"><code class="comment">! ---------------------------------------------------</code></a>
            <a href="null.html#convectivetransport_mod_bi8" target="diffFile">chat(il, ik) = <code class="constant">0.5d0</code>*(xconst(il, ik)+xconst(il, km1))</a>
<a href="null.html#convectivetransport_mod_bi7" target="diffFile"><code class="comment">!end if</code></a>
<a href="null.html#convectivetransport_mod_bi7" target="diffFile"><code class="comment">! -------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi7" target="diffFile"><code class="comment">! Provisional up and down draft values.</code></a>
<a name="convectivetransporti62"></a><a href="null.html#convectivetransport_mod_bi7" target="diffFile"><code class="comment">! -------------------------------------</code></a>
<a name="convectivetransporti63"></a>            <a href="null.html#convectivetransport_mod_bi7" target="diffFile">conu(il, ik) = chat(il, ik)</a>
            <a href="null.html#convectivetransport_mod_bi6" target="diffFile">cond(il, ik) = chat(il, km1)</a>
<a href="null.html#convectivetransport_mod_bi5" target="diffFile"><code class="comment">! ------------------</code></a>
<a href="null.html#convectivetransport_mod_bi5" target="diffFile"><code class="comment">! Provisional tends.</code></a>
<a href="null.html#convectivetransport_mod_bi5" target="diffFile"><code class="comment">! ------------------</code></a>
            <a href="null.html#convectivetransport_mod_bi5" target="diffFile">dcondt(il, ik) = <code class="constant">0.0d0</code></a>
<a name="convectivetransporti66"></a>          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">illoop1</code></a>
<a name="convectivetransporti67"></a>        <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">ikloop1</code></a>
<a name="convectivetransporti68"></a>        <a href="null.html#convectivetransport_mod_bi10" target="diffFile">mask(:, :) = edi(:, :) .LT. <code class="constant">0.0d0</code></a>
<a name="convectivetransporti71"></a>        <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">WHERE </code>(mask(:, :)) </a><a href="null.html#convectivetransport_mod_bi9" target="diffFile">edi(:, :) = <code class="constant">0.0d0</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">illoop2:</code><code class="keyword">DO </code>il=<code class="constant">1</code>,il2g</a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ----------------------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Find the mixing ratio in the downdraft, top of atmosphere down.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! NOTE: mass flux   in downdraft (mdi) will be zero or negative.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!       entrainment in downdraft (edi) will be zero or positive.</code></a>
<a name="convectivetransporti69"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ----------------------------------------------------------------------</code></a>
<a name="convectivetransporti70"></a> <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">ikloopdd:</code><code class="keyword">DO </code>ik=<code class="constant">2</code>,k2</a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (mdi(il, ik-<code class="constant">1</code>) .LT. -xmbsth .OR. edi(il, ik) .GT. xmbsth<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">&           </code>) </a><a href="null.html#convectivetransport_mod_bi11" target="diffFile">cond(il, ik) = (cond(il, ik-<code class="constant">1</code>)*mdi(il, ik-<code class="constant">1</code>)-xconst(il, ik<code class="label">&</code></a>
<a name="convectivetransporti72"></a><a href="null.html#convectivetransport_mod_bi11" target="diffFile"><code class="label">&               </code>)*edi(il, ik))/(mdi(il, ik-<code class="constant">1</code>)-edi(il, ik))</a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">ikloopdd</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Calculate updrafts with scavenging from bottom to top.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Include the downdrafts.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -------------------------------------</code></a>
<a name="p0"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Do the bottom most levels in the pbl.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -------------------------------------</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p0" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="funcname">SUM</code>(dpi(il, k2:pbli(il):-<code class="constant">1</code>)) .EQ. <code class="constant">0.0d0</code>) <code class="keyword">THEN</code></a>
<a name="convectivetransporti73"></a>            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti74"></a>            <a href="null.html#convectivetransport_mod_bi15" target="diffFile">result1 = <code class="funcname">SUM</code>(xconst(il, k2:pbli(il):-<code class="constant">1</code>)*dpi(il, k2:pbli(il)<code class="label">&</code></a>
<a name="convectivetransporti75"></a><a href="null.html#convectivetransport_mod_bi15" target="diffFile"><code class="label">&             </code>:-<code class="constant">1</code>))</a>
<a name="convectivetransporti76"></a>            <a href="null.html#convectivetransport_mod_bi14" target="diffFile">avg_pbl = result1/<code class="funcname">SUM</code>(dpi(il, k2:pbli(il):-<code class="constant">1</code>))</a>
<a name="convectivetransporti77"></a>            <a href="null.html#convectivetransport_mod_bi13" target="diffFile">sqrt_fisg = <code class="funcname">SQRT</code>(fisg(il, pbli(il)))</a>
<a name="convectivetransporti78"></a>            <a href="null.html#convectivetransport_mod_b" target="diffFile">scav = avg_pbl*(<code class="constant">1.0d0</code>-sqrt_fisg)</a>
<a name="convectivetransporti79"></a>            <a href="null.html#convectivetransport_mod_bi12" target="diffFile">conu(il, pbli(il)) = avg_pbl*sqrt_fisg</a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (chat(il, pbli(il)) .GT. xconst(il, pbli(il)-<code class="constant">1</code>)) <code class="keyword">THEN</code></a>
<a name="convectivetransporti80"></a>              <a href="null.html#convectivetransport_mod_bi16" target="diffFile">min1 = xconst(il, pbli(il)-<code class="constant">1</code>)</a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti81"></a>              <a href="null.html#convectivetransport_mod_bi17" target="diffFile">min1 = chat(il, pbli(il))</a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="convectivetransporti82"></a>            <a href="null.html#convectivetransport_mod_bi20" target="diffFile">fluxin = (mui(il, pbli(il))+mdi(il, pbli(il)))*min1 - mdi(il<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi20" target="diffFile"><code class="label">&             </code>, pbli(il))*cond(il, pbli(il))</a>
<a name="convectivetransporti83"></a>            <a href="null.html#convectivetransport_mod_bi19" target="diffFile">fluxout = mui(il, pbli(il))*conu(il, pbli(il)) + mui(il, <code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi19" target="diffFile"><code class="label">&             </code>pbli(il))*scav</a>
<a name="convectivetransporti84"></a>            <a href="null.html#convectivetransport_mod_bi18" target="diffFile">dcondt(il, k2) = (fluxin-fluxout)/<code class="funcname">SUM</code>(dpi(il, k2:pbli(il):-<code class="constant">1</code><code class="label">&</code></a>
<a name="convectivetransporti86"></a><a href="null.html#convectivetransport_mod_bi18" target="diffFile"><code class="label">&             </code>))</a>
<a name="convectivetransporti85"></a>            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (avg_pbl .GT. <code class="constant">0.0d0</code>) <code class="keyword">THEN</code></a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">DO </code>ik=k2,pbli(il),-<code class="constant">1</code></a>
                <a href="null.html#convectivetransport_mod_bi21" target="diffFile">qq(ideep(il), ik, ic) = (avg_pbl+dcondt(il, k2)*delt)/<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi21" target="diffFile"><code class="label">&                 </code>avg_pbl*xconst(il, ik)</a>
<a name="convectivetransporti111"></a>              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ---------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Loop over all other levels.</code></a>
<a name="convectivetransporti87"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! ---------------------------</code></a>
<a name="convectivetransporti88"></a>    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">ikloop2:</code><code class="keyword">DO </code>ik=pbli(il)-<code class="constant">1</code>,<code class="constant">2</code>,-<code class="constant">1</code></a>
<a name="convectivetransporti89"></a>              <a href="null.html#convectivetransport_mod_bi87" target="diffFile">kp1 = ik + <code class="constant">1</code></a>
              <a href="null.html#convectivetransport_mod_bi22" target="diffFile">km1 = ik - <code class="constant">1</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -----------------------------</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! Find mixing ratio in updraft.</code></a>
<a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">! -----------------------------</code></a>
<a name="convectivetransporti90"></a>              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (mui(il, kp1) - dui(il, ik) + eui(il, ik) .GT. xmbsth) <code class="label">&</code></a>
<a name="convectivetransporti91"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">&             </code><code class="keyword">THEN</code></a>
<a name="convectivetransporti92"></a>                <a href="null.html#convectivetransport_mod_bi23" target="diffFile">sqrt_fisg = <code class="funcname">SQRT</code>(fisg(il, ik))</a>
                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (mui(il, kp1) + eui(il, ik) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="convectivetransporti93"></a>                  <a href="null.html#convectivetransport_mod_b" target="diffFile">abs0 = mui(il, kp1) + eui(il, ik)</a>
                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti94"></a>                  <a href="null.html#convectivetransport_mod_b" target="diffFile">abs0 = -(mui(il, kp1)+eui(il, ik))</a>
<a name="convectivetransporti95"></a>                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (abs0 .GE. xmbsth) <code class="keyword">THEN</code></a>
<a href="null.html#convectivetransport_mod_bi24" target="diffFile"><code class="comment">!... mix updraft and entrainment, then detrain this concentration</code></a>
                  <a href="null.html#convectivetransport_mod_bi24" target="diffFile">temp_conu = (mui(il, kp1)*conu(il, kp1)+eui(il, ik)*<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi24" target="diffFile"><code class="label">&                   </code>xconst(il, ik))/(mui(il, kp1)+eui(il, ik))</a>
<a name="convectivetransporti96"></a><a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="comment">!... if updraft and entrainment flux sum to 0.0, then take average concen</code></a>
                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti97"></a>                  <a href="null.html#convectivetransport_mod_bi25" target="diffFile">temp_conu = (xconst(il, ik)+conu(il, kp1))/<code class="constant">2.0d0</code></a>
                <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#convectivetransport_mod_bi27" target="diffFile"><code class="comment">!</code></a>
                <a href="null.html#convectivetransport_mod_bi27" target="diffFile">scav = ((mui(il, kp1)*conu(il, kp1)-dui(il, ik)*<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi27" target="diffFile"><code class="label">&                 </code>temp_conu)*(<code class="constant">1.0d0</code>-fisg(il, ik))+eui(il, ik)*xconst(il<code class="label">&</code></a>
<a name="convectivetransporti98"></a><a href="null.html#convectivetransport_mod_bi27" target="diffFile"><code class="label">&                 </code>, ik)*(<code class="constant">1.0d0</code>-sqrt_fisg))/(mui(il, kp1)-dui(il, ik)+eui<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi27" target="diffFile"><code class="label">&                 </code>(il, ik))</a>
                <a href="null.html#convectivetransport_mod_bi26" target="diffFile">conu(il, ik) = ((mui(il, kp1)*conu(il, kp1)-dui(il, ik)*<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi26" target="diffFile"><code class="label">&                 </code>temp_conu)*fisg(il, ik)+eui(il, ik)*xconst(il, ik)*<code class="label">&</code></a>
<a name="convectivetransporti99"></a><a href="null.html#convectivetransport_mod_bi26" target="diffFile"><code class="label">&                 </code>sqrt_fisg)/(mui(il, kp1)-dui(il, ik)+eui(il, ik))</a>
<a name="convectivetransporti100"></a>              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
                <a href="null.html#convectivetransport_mod_bi28" target="diffFile">conu(il, ik) = xconst(il, ik)</a>
<a name="convectivetransporti101"></a>                <a href="null.html#convectivetransport_mod_b" target="diffFile">scav = <code class="constant">0.0d0</code></a>
<a name="convectivetransporti102"></a>              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (chat(il, ik) .GT. xconst(il, km1)) <code class="keyword">THEN</code></a>
<a name="convectivetransporti103"></a>                <a href="null.html#convectivetransport_mod_bi29" target="diffFile">min2 = xconst(il, km1)</a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti104"></a>                <a href="null.html#convectivetransport_mod_bi30" target="diffFile">min2 = chat(il, ik)</a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! -------------------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! Calculate fluxes into and out of box.  With scavenging</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! included the net flux for the whole column is no longer</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! guaranteed to be zero.</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! Include the downdrafts.</code></a>
<a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="comment">! -------------------------------------------------------</code></a>
<a name="convectivetransporti105"></a>              <a href="null.html#convectivetransport_mod_bi31" target="diffFile">fluxin = mui(il, kp1)*conu(il, kp1) + (mui(il, ik)+mdi(il<code class="label">&</code></a>
<a name="convectivetransporti106"></a><a href="null.html#convectivetransport_mod_bi31" target="diffFile"><code class="label">&               </code>, ik))*min2 - mdi(il, ik)*cond(il, ik)</a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">IF</code> (chat(il, kp1) .GT. xconst(il, ik)) <code class="keyword">THEN</code></a>
<a name="convectivetransporti107"></a>                <a href="null.html#convectivetransport_mod_bi32" target="diffFile">min3 = xconst(il, ik)</a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="convectivetransporti108"></a>                <a href="null.html#convectivetransport_mod_bi33" target="diffFile">min3 = chat(il, kp1)</a>
              <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
              <a href="null.html#convectivetransport_mod_bi36" target="diffFile">fluxout = mui(il, ik)*conu(il, ik) + (mui(il, kp1)+mdi(il<code class="label">&</code></a>
<a name="convectivetransporti109"></a><a href="null.html#convectivetransport_mod_bi36" target="diffFile"><code class="label">&               </code>, kp1))*min3 + (mui(il, ik)+mui(il, kp1))*<code class="constant">0.5d0</code>*scav - <code class="label">&</code></a>
<a name="convectivetransporti110"></a><a href="null.html#convectivetransport_mod_bi36" target="diffFile"><code class="label">&               </code>mdi(il, kp1)*cond(il, kp1)</a>
              <a href="null.html#convectivetransport_mod_bi35" target="diffFile">dcondt(il, ik) = (fluxin-fluxout)/dpi(il, ik)</a>
<a href="null.html#convectivetransport_mod_bi34" target="diffFile"><code class="comment">! --------------------------------------------</code></a>
<a href="null.html#convectivetransport_mod_bi34" target="diffFile"><code class="comment">! Update and scatter data back to full arrays.</code></a>
<a href="null.html#convectivetransport_mod_bi34" target="diffFile"><code class="comment">! --------------------------------------------</code></a>
              <a href="null.html#convectivetransport_mod_bi34" target="diffFile">qq(ideep(il), ik, ic) = xconst(il, ik) + dcondt(il, ik)*<code class="label">&</code></a>
<a href="null.html#convectivetransport_mod_bi34" target="diffFile"><code class="label">&               </code>delt</a>
            <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">ikloop2</code></a>
          <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">illoop2</code></a>
      <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END DO </code><code class="label">icloop</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">RETURN</code></a>
<a name="convectivetransporti112"></a> <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="label">100 </code>err_msg = <code class="string">'Problem in convectiveTransport.'</code></a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">PRINT*</code>, err_msg</a>
    <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">STOP</code></a>
  <a href="null.html#convectivetransport_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">CONVECTIVETRANSPORT</code></a>
<code class="keyword">END MODULE </code><code class="funcname">CONVECTIVETRANSPORT_MOD</code>
</pre>
</body>
