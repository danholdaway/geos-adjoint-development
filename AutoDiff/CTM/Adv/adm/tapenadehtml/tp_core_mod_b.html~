<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Ecuador team)</code>
<code class="comment">!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30</code>
<code class="comment">!</code>
<code class="keyword">MODULE </code><code class="funcname">TP_CORE_MOD_B</code>
<code class="comment">!BOP</code>
<code class="comment">!</code>
<code class="comment">! !MODULE: tp_core --- A collection of routines to support FV transport</code>
<code class="comment">!</code>
  <code class="keyword">USE </code><code class="funcname">FV_ARRAYS_MOD</code>, <code class="keyword">ONLY </code>: fvprc, real4, real8, cnvt
  <code class="keyword">USE </code><code class="funcname">FV_MP_MOD_B</code>, <code class="keyword">ONLY </code>: is, js, ie, je, ng, isd, jsd, ied, jed
  <code class="keyword">USE </code><code class="funcname">FV_GRID_UTILS_MOD_B</code>, <code class="keyword">ONLY </code>: sw_corner, se_corner, ne_corner, <code class="label">&</code>
<code class="label">& </code>nw_corner, sin_sg =&gt; sin_sg, da_min =&gt; da_min, big_number_r8 =&gt; <code class="label">&</code>
<code class="label">& </code>big_number
  <code class="keyword">USE </code><code class="funcname">FV_GRID_TOOLS_MOD_B</code>, <code class="keyword">ONLY </code>: grid_type, dx =&gt; dx, dy =&gt; dy, rdxc =&gt;<code class="label">&</code>
<code class="label">& </code>rdxc, rdyc =&gt; rdyc, dxa =&gt; dxa, dya =&gt; dya, area =&gt; area, rarea =&gt; <code class="label">&</code>
<code class="label">& </code>rarea
  <code class="keyword">IMPLICIT NONE</code>
  PRIVATE 
  PUBLIC fv_tp_2d, pert_ppm, copy_corners
  PUBLIC fv_tp_2d_adm, copy_corners_adm
<code class="comment">!#ifdef MAPL_MODE</code>
  <code class="typename">LOGICAL</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">nested</code>=<code class="constant">.false.</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r3</code>=<code class="constant">1.</code>/<code class="constant">3.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">near_zero</code>=<code class="constant">1.e-25</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">ppm_limiter</code>=<code class="constant">2.0</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">big_number</code>=<code class="vardecl">big_number_r8</code>
<code class="comment">!#ifdef WAVE_FORM</code>
<code class="comment">!! Suresh & Huynh scheme 2.2 (purtabation form)</code>
<code class="comment">!! The wave-form is more diffusive than scheme 2.1</code>
<code class="comment">! real(FVPRC), parameter:: b1 =   0.0375</code>
<code class="comment">! real(FVPRC), parameter:: b2 =  -7./30.</code>
<code class="comment">! real(FVPRC), parameter:: b3 =  -23./120.</code>
<code class="comment">! real(FVPRC), parameter:: b4 =  13./30.</code>
<code class="comment">! real(FVPRC), parameter:: b5 = -11./240.</code>
<code class="comment">!#else</code>
<code class="comment">! scheme 2.1: perturbation form</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b1</code>=<code class="constant">1.</code>/<code class="constant">30.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b2</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b3</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b4</code>=<code class="constant">0.45</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b5</code>=-<code class="constant">0.05</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">t11</code>=<code class="constant">27.</code>/<code class="constant">28.</code>, <code class="vardecl">t12</code>=-(<code class="constant">13.</code>/<code class="constant">28.</code>), <code class="vardecl">t13</code>=<code class="constant">3.</code>/<code class="constant">7.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">s11</code>=<code class="constant">11.</code>/<code class="constant">14.</code>, <code class="vardecl">s14</code>=<code class="constant">4.</code>/<code class="constant">7.</code>, <code class="vardecl">s15</code>=<code class="constant">3.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! volume-conserving cubic with 2nd drv=0 at end point:</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! Non-monotonic</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c1</code>=-(<code class="constant">2.</code>/<code class="constant">14.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c2</code>=<code class="constant">11.</code>/<code class="constant">14.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c3</code>=<code class="constant">5.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------</code>
<code class="comment">! PPM volume mean form:</code>
<code class="comment">!----------------------</code>
<code class="comment">! 0.58333333</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p1</code>=<code class="constant">7.</code>/<code class="constant">12.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p2</code>=-(<code class="constant">1.</code>/<code class="constant">12.</code>)
<code class="comment">!#ifdef SINGLE_FV</code>
<code class="comment">!   MODULE PROCEDURE fv_tp_2d_r8</code>
<code class="comment">!#endif</code>
  <code class="keyword">INTERFACE </code><code class="funcname">FV_TP_2D</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">FV_TP_2D_R4</code>
  <code class="keyword">END INTERFACE</code>

  <code class="keyword">INTERFACE </code><code class="funcname">FV_TP_2D_ADM</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">FV_TP_2D_R4_ADM</code>
  <code class="keyword">END INTERFACE</code>

  <code class="keyword">INTERFACE </code><code class="funcname">COPY_CORNERS</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R4</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R8</code>
  <code class="keyword">END INTERFACE</code>

  <code class="keyword">INTERFACE </code><code class="funcname">COPY_CORNERS_ADM</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R8_ADM</code>
  <code class="keyword">END INTERFACE</code>

<a name="fv_tp_2d_r4_adm"></a>
<code class="keyword">CONTAINS</code>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of fv_tp_2d_r4 in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q fx fy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q fx fy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!EOP</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!-----------------------------------------------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef SINGLE_FV</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! subroutine fv_tp_2d_r8(qIN, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                     ra_x, ra_y, mfx, mfy, mass, nord, damp_c)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, intent(in):: npx, npy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, intent(in)::hord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  crx(is:ie+1,jsd:jed)  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  xfx(is:ie+1,jsd:jed)  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  cry(isd:ied,js:je+1 )  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  yfx(isd:ied,js:je+1 )  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in):: ra_x(is:ie,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in):: ra_y(isd:ied,js:je)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(REAL8), intent(in)::  qIN(isd:ied,jsd:jed)  ! transported scalar</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(out)::fx(is:ie+1 ,js:je)    ! Flux in x ( E )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(out)::fy(is:ie,   js:je+1 )    ! Flux in y ( N )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! optional Arguments:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfx(is:ie+1,js:je  )  ! Mass Flux X-Dir</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfy(is:ie  ,js:je+1)  ! Mass Flux Y-Dir</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mass(isd:ied,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: damp_c</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, OPTIONAL, intent(in):: nord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Local:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC)   q(isd:ied,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   q = CNVT(qIN)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   call fv_tp_2d(q, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                     ra_x, ra_y, mfx=mfx, mfy=mfy, mass=mass, nord=nord, damp_c=damp_c)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end subroutine fv_tp_2d_r8</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FV_TP_2D_R4_ADM</code>(<code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">crx</code>, <code class="vardecl">cry</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">hord</code>, <code class="vardecl">fx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">fx_ad</code>, <code class="vardecl">fy</code>, <code class="vardecl">fy_ad</code>, <code class="vardecl">xfx</code>, <code class="vardecl">yfx</code>, <code class="vardecl">ra_x</code>, <code class="vardecl">ra_y</code>, <code class="vardecl">mfx</code>, <code class="vardecl">mfy</code>, <code class="vardecl">mass</code>, <code class="vardecl">nord</code>, <code class="vardecl">damp_c</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">& </code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_modi373" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi374" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">hord</code></a>
<a href="null_p.html#tp_core_modi375" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_modi375" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">crx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_modi376" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_modi376" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">xfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_modi377" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_modi377" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cry</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi378" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_modi378" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">yfx</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi379" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_x</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi380" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_y</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_modi381" target="origFile"><code class="comment">! transported scalar</code></a>
    <a href="null_p.html#tp_core_modi381" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_modi382" target="origFile"><code class="comment">! Flux in x ( E )</code></a>
    <a href="null_p.html#tp_core_modi382" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_modi383" target="origFile"><code class="comment">! Flux in y ( N )</code></a>
    <a href="null_p.html#tp_core_modi383" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi384" target="origFile"><code class="comment">! optional Arguments:</code></a>
<a href="null_p.html#tp_core_modi384" target="origFile"><code class="comment">! Mass Flux X-Dir</code></a>
    <a href="null_p.html#tp_core_modi384" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_modi385" target="origFile"><code class="comment">! Mass Flux Y-Dir</code></a>
    <a href="null_p.html#tp_core_modi385" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi386" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi387" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp_c</code></a>
    <a href="null_p.html#tp_core_modi388" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
<a href="null_p.html#tp_core_modi389" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_modi389" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ord</code>, <code class="vardecl">ord_in</code></a>
    <a href="null_p.html#tp_core_modi390" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_i</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_i_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_modi391" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_j</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_j_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi392" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx1_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_modi393" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy1_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi394" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi395" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy2_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi396" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fyy</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fyy_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi397" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fxx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fxx_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi398" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp</code></a>
    <a href="null_p.html#tp_core_modi399" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_modi400" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_modi401" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi402" target="origFile"><code class="keyword">IF</code> (hord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi403" target="origFile"><code class="comment">! more dissipation</code></a>
      <a href="null_p.html#tp_core_modi403" target="origFile">ord_in = <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_modi404" target="origFile"><code class="keyword">IF</code> (hord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi404" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi405" target="origFile">ord = hord</a>
      <a href="null_p.html#tp_core_modi404" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi404" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi406" target="origFile">ord = -hord</a>
      <a href="null_p.html#tp_core_modi404" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi402" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi402" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi407" target="origFile">ord_in = hord</a>
      <a href="null_p.html#tp_core_modi408" target="origFile">ord = hord</a>
    <a href="null_p.html#tp_core_modi402" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi409" target="origFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi409" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi409" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi409" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi409" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi419" target="origFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi419" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi419" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi419" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi419" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi424" target="origFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi424" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi424" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi424" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi424" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi433" target="origFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi433" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi433" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi433" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi433" target="origFile"><code class="keyword">END IF</code></a>
<a href="null_p.html#tp_core_modi438" target="origFile"><code class="comment">!----------------</code></a>
<a href="null_p.html#tp_core_modi438" target="origFile"><code class="comment">! Flux averaging:</code></a>
<a href="null_p.html#tp_core_modi438" target="origFile"><code class="comment">!----------------</code></a>
    <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mfx) .AND. <code class="funcname">PRESENT</code>(mfy)) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi445" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c) .AND. <code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4_admi124"></a>        <a href="null_p.html#tp_core_modi446" target="origFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi447" target="origFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi448" target="origFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX_ADM</code>(nord, npx, npy, damp, q, q_ad, fx, fx_ad, <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi448" target="origFile"><code class="label">&                      </code>fy, fy_ad, mass)</a>
        <a href="null_p.html#tp_core_modi446" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi445" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fy1_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fy2_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi123"></a>      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>j=je+<code class="constant">1</code>,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>i=ie,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi442" target="origFile">temp_ad2 = mfy(i, j)*<code class="constant">0.5</code>*fy_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi442" target="origFile">fy1_ad(i, j) = fy1_ad(i, j) + temp_ad2</a>
          <a href="null_p.html#tp_core_modi442" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + temp_ad2</a>
          <a href="null_p.html#tp_core_modi442" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fx1_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fx2_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi122"></a>      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>j=je,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>i=ie+<code class="constant">1</code>,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi439" target="origFile">temp_ad1 = mfx(i, j)*<code class="constant">0.5</code>*fx_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi439" target="origFile">fx1_ad(i, j) = fx1_ad(i, j) + temp_ad1</a>
          <a href="null_p.html#tp_core_modi439" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + temp_ad1</a>
          <a href="null_p.html#tp_core_modi439" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi455" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c)) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4_admi127"></a>        <a href="null_p.html#tp_core_modi456" target="origFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi457" target="origFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi458" target="origFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX_ADM</code>(nord, npx, npy, damp, q, q_ad, fx, fx_ad, <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi458" target="origFile"><code class="label">&                      </code>fy, fy_ad)</a>
        <a href="null_p.html#tp_core_modi456" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi455" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fy1_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fy2_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi126"></a>      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>j=je+<code class="constant">1</code>,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>i=ie,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi452" target="origFile">temp_ad4 = yfx(i, j)*<code class="constant">0.5</code>*fy_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi452" target="origFile">fy1_ad(i, j) = fy1_ad(i, j) + temp_ad4</a>
          <a href="null_p.html#tp_core_modi452" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + temp_ad4</a>
          <a href="null_p.html#tp_core_modi452" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fx1_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile">fx2_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi125"></a>      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>j=je,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">DO </code>i=ie+<code class="constant">1</code>,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi449" target="origFile">temp_ad3 = xfx(i, j)*<code class="constant">0.5</code>*fx_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi449" target="origFile">fx1_ad(i, j) = fx1_ad(i, j) + temp_ad3</a>
          <a href="null_p.html#tp_core_modi449" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + temp_ad3</a>
          <a href="null_p.html#tp_core_modi449" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi438" target="origFile"><code class="keyword">END IF</code></a>
<a name="fv_tp_2d_r4_admi120"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="p13"></a><a name="p12"></a><a name="p11"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi434" target="origFile">q_j_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi435" target="origFile"><code class="keyword">CALL </code><code class="funcname">YPPM0_ADM</code>(</a><a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi435" target="origFile">fy1, fy1_ad, </a><a href="msg.html#p12" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi435" target="origFile">q_j, q_j_ad, </a><a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi435" target="origFile">cry, ord, is, ie, js, je<code class="label">&</code></a>
<a name="fv_tp_2d_r4_admi121"></a><a href="null_p.html#tp_core_modi435" target="origFile"><code class="label">&              </code>, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi436" target="origFile">q_j_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi437" target="origFile"><code class="keyword">CALL </code><code class="funcname">YTP_ADM</code>(fy1, fy1_ad, q_j, q_j_ad, cry, ord, is, ie, js, je, <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi437" target="origFile"><code class="label">&            </code>npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">fxx_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi119"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jed,jsd,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ie,is,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi430" target="origFile">temp_ad0 = q_j_ad(i, j)/ra_x(i, j)</a>
        <a href="null_p.html#tp_core_modi430" target="origFile">q_ad(i, j) = q_ad(i, j) + area(i, j)*temp_ad0</a>
        <a href="null_p.html#tp_core_modi430" target="origFile">fxx_ad(i) = fxx_ad(i) + temp_ad0</a>
        <a href="null_p.html#tp_core_modi430" target="origFile">fxx_ad(i+<code class="constant">1</code>) = fxx_ad(i+<code class="constant">1</code>) - temp_ad0</a>
        <a href="null_p.html#tp_core_modi430" target="origFile">q_j_ad(i, j) = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi118"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ie+<code class="constant">1</code>,is,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi428" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + xfx(i, j)*fxx_ad(i)</a>
        <a href="null_p.html#tp_core_modi428" target="origFile">fxx_ad(i) = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4_admi117"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi427" target="origFile"><code class="keyword">CALL </code><code class="funcname">XTP_ADM</code>(fx2, fx2_ad, q, q_ad, crx, ord_in, is, ie, jsd, jed, <code class="label">&</code></a>
<a name="p10"></a><a name="p9"></a><a name="p8"></a><a name="fv_tp_2d_r4_admi116"></a><a href="null_p.html#tp_core_modi427" target="origFile"><code class="label">&            </code>npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi426" target="origFile"><code class="keyword">CALL </code><code class="funcname">XPPM0_ADM</code>(</a><a href="msg.html#p8" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi426" target="origFile">fx2, fx2_ad, </a><a href="msg.html#p9" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi426" target="origFile">q, q_ad, </a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi426" target="origFile">crx, ord_in, is, ie, jsd, jed<code class="label">&</code></a>
<a name="fv_tp_2d_r4_admi115"></a><a href="null_p.html#tp_core_modi426" target="origFile"><code class="label">&              </code>, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi425" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(q, q_ad, npx, npy, <code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4_admi113"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="p6"></a><a name="p5"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi420" target="origFile">q_i_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi421" target="origFile"><code class="keyword">CALL </code><code class="funcname">XPPM0_ADM</code>(</a><a href="msg.html#p5" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi421" target="origFile">fx1, fx1_ad, </a><a href="msg.html#p6" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi421" target="origFile">q_i, q_i_ad, crx(is, js), ord, is, ie<code class="label">&</code></a>
<a name="fv_tp_2d_r4_admi114"></a><a href="null_p.html#tp_core_modi421" target="origFile"><code class="label">&              </code>, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi422" target="origFile">q_i_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi423" target="origFile"><code class="keyword">CALL </code><code class="funcname">XTP_ADM</code>(fx1, fx1_ad, q_i, q_i_ad, crx(is, js), ord, is, ie, <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi423" target="origFile"><code class="label">&            </code>js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">fyy_ad = <code class="constant">0.0_8</code></a>
<a name="fv_tp_2d_r4_admi112"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=je,js,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ied,isd,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi416" target="origFile">temp_ad = q_i_ad(i, j)/ra_y(i, j)</a>
        <a href="null_p.html#tp_core_modi416" target="origFile">q_ad(i, j) = q_ad(i, j) + area(i, j)*temp_ad</a>
        <a href="null_p.html#tp_core_modi416" target="origFile">fyy_ad(i, j) = fyy_ad(i, j) + temp_ad</a>
        <a href="null_p.html#tp_core_modi416" target="origFile">fyy_ad(i, j+<code class="constant">1</code>) = fyy_ad(i, j+<code class="constant">1</code>) - temp_ad</a>
        <a href="null_p.html#tp_core_modi416" target="origFile">q_i_ad(i, j) = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4_admi111"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=je+<code class="constant">1</code>,js,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ied,isd,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi413" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + yfx(i, j)*fyy_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi413" target="origFile">fyy_ad(i, j) = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4_admi110"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi412" target="origFile"><code class="keyword">CALL </code><code class="funcname">YTP_ADM</code>(fy2, fy2_ad, q, q_ad, cry, ord_in, isd, ied, js, je, <code class="label">&</code></a>
<a name="p4"></a><a name="p3"></a><a name="p2"></a><a name="fv_tp_2d_r4_admi109"></a><a href="null_p.html#tp_core_modi412" target="origFile"><code class="label">&            </code>npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi411" target="origFile"><code class="keyword">CALL </code><code class="funcname">YPPM0_ADM</code>(</a><a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi411" target="origFile">fy2, fy2_ad, </a><a href="msg.html#p3" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi411" target="origFile">q, q_ad, </a><a href="msg.html#p4" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi411" target="origFile">cry, ord_in, isd, ied, js, je<code class="label">&</code></a>
<a name="fv_tp_2d_r4_admi108"></a><a href="null_p.html#tp_core_modi411" target="origFile"><code class="label">&              </code>, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi410" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(q, q_ad, npx, npy, <code class="constant">2</code>)</a>
<a name="fv_tp_2d_r4"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FV_TP_2D_R4_ADM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!EOP</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!-----------------------------------------------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef SINGLE_FV</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! subroutine fv_tp_2d_r8(qIN, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                     ra_x, ra_y, mfx, mfy, mass, nord, damp_c)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, intent(in):: npx, npy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, intent(in)::hord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  crx(is:ie+1,jsd:jed)  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  xfx(is:ie+1,jsd:jed)  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  cry(isd:ied,js:je+1 )  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in)::  yfx(isd:ied,js:je+1 )  !</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in):: ra_x(is:ie,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(in):: ra_y(isd:ied,js:je)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(REAL8), intent(in)::  qIN(isd:ied,jsd:jed)  ! transported scalar</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(out)::fx(is:ie+1 ,js:je)    ! Flux in x ( E )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), intent(out)::fy(is:ie,   js:je+1 )    ! Flux in y ( N )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! optional Arguments:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfx(is:ie+1,js:je  )  ! Mass Flux X-Dir</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfy(is:ie  ,js:je+1)  ! Mass Flux Y-Dir</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mass(isd:ied,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: damp_c</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   integer, OPTIONAL, intent(in):: nord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Local:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   real(FVPRC)   q(isd:ied,jsd:jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   q = CNVT(qIN)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   call fv_tp_2d(q, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                     ra_x, ra_y, mfx=mfx, mfy=mfy, mass=mass, nord=nord, damp_c=damp_c)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end subroutine fv_tp_2d_r8</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">crx</code>, <code class="vardecl">cry</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">hord</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">xfx</code>, <code class="vardecl">yfx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">ra_x</code>, <code class="vardecl">ra_y</code>, <code class="vardecl">mfx</code>, <code class="vardecl">mfy</code>, <code class="vardecl">mass</code>, <code class="vardecl">nord</code>, <code class="vardecl">damp_c</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">hord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">crx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">xfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cry</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">yfx</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_x</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_y</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! transported scalar</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Flux in x ( E )</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Flux in y ( N )</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! optional Arguments:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Mass Flux X-Dir</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Mass Flux Y-Dir</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp_c</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ord</code>, <code class="vardecl">ord_in</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_i</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_j</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fyy</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fxx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (hord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! more dissipation</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ord_in = <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (hord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ord = hord</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ord = -hord</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ord_in = hord</a>
      <a href="null_p.html#tp_core_mod" target="origFile">ord = hord</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p4"></a><a name="p3"></a><a name="p2"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">fy2, </a><a href="msg.html#p3" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">q, </a><a href="msg.html#p4" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">cry, ord_in, isd, ied, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy2, q, cry, ord_in, isd, ied, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null_p.html#tp_core_mod" target="origFile">fyy(i, j) = yfx(i, j)*fy2(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null_p.html#tp_core_mod" target="origFile">q_i(i, j) = (q(i, j)*area(i, j)+fyy(i, j)-fyy(i, j+<code class="constant">1</code>))/ra_y(i, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&         </code>)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p7"></a><a name="p6"></a><a name="p5"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p5" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">fx1, </a><a href="msg.html#p6" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">q_i, </a><a href="msg.html#p7" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">crx(is, js), ord, is, ie, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx1, q_i, crx(is, js), ord, is, ie, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p10"></a><a name="p9"></a><a name="p8"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p8" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">fx2, </a><a href="msg.html#p9" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">q, </a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx2, q, crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jsd,jed</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">fxx(i) = xfx(i, j)*fx2(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie</a>
        <a href="null_p.html#tp_core_mod" target="origFile">q_j(i, j) = (q(i, j)*area(i, j)+fxx(i)-fxx(i+<code class="constant">1</code>))/ra_x(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p13"></a><a name="p12"></a><a name="p11"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">fy1, </a><a href="msg.html#p12" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">q_j, </a><a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">cry, ord, is, ie, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy1, q_j, cry, ord, is, ie, js, je, npx, npy)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!----------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Flux averaging:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!----------------</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mfx) .AND. <code class="funcname">PRESENT</code>(mfy)) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! For transport of pt and tracers</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*mfx(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*mfy(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c) .AND. <code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy, mass)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! For transport of delp, vorticity</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*xfx(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*yfx(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c)) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r4"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real4</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p14"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! XDir:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p15"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p16"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p17"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p18"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! YDir:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p18" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p19"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p19" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p20"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p21"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p21" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="xtp_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of xtp in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q fx</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XTP_ADM</code>(<code class="vardecl">fx</code>, <code class="vardecl">fx_ad</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi350" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi350" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi351" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi351" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi352" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi353" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a href="null_p.html#tp_core_modi354" target="origFile"><code class="comment">! Courant numbers</code></a>
    <a href="null_p.html#tp_core_modi354" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_modi355" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_modi356" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi357" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_modi357" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">is</code>-<code class="constant">2</code>:<code class="vardecl">ie</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi358" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null_p.html#tp_core_modi359" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi365" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null_p.html#tp_core_modi364" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi361" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi361" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi361" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi361" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi361" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi364" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi365" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">DO </code>j=jlast,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">DO </code>i=ilast+<code class="constant">1</code>,ifirst,<code class="constant">-1</code></a>
<a name="xtp_admi104"></a>          <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi363" target="origFile">q_ad(i, j) = q_ad(i, j) + fx_ad(i, j)</a>
<a name="xtp_admi103"></a>            <a href="null_p.html#tp_core_modi363" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi362" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + fx_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi362" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">ELSE </code></a><a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi371" target="origFile"><code class="comment">!Advection using third order scheme</code></a>
      <a href="null_p.html#tp_core_modi371" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null_p.html#tp_core_modi370" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi367" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi367" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi367" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi367" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi367" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi370" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi371" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">DO </code>j=jlast,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">DO </code>i=ilast+<code class="constant">1</code>,ifirst,<code class="constant">-1</code></a>
<a name="xtp_admi106"></a>          <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi369" target="origFile">temp_ad2 = fx_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi369" target="origFile">temp_ad3 = -(c(i, j)*<code class="constant">0.5</code>*fx_ad(i, j))</a>
            <a href="null_p.html#tp_core_modi369" target="origFile">temp_ad4 = c(i, j)**<code class="constant">2</code>*fx_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi369" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + temp_ad4 - temp_ad3 + <code class="constant">2.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi369" target="origFile"><code class="label">&             </code>temp_ad2</a>
            <a href="null_p.html#tp_core_modi369" target="origFile">q_ad(i, j) = q_ad(i, j) + temp_ad3 - <code class="constant">2.0</code>*temp_ad4 + <code class="constant">5.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi369" target="origFile"><code class="label">&             </code>temp_ad2</a>
            <a href="null_p.html#tp_core_modi369" target="origFile">q_ad(i+<code class="constant">1</code>, j) = q_ad(i+<code class="constant">1</code>, j) + temp_ad4 - temp_ad2</a>
<a name="xtp_admi105"></a>            <a href="null_p.html#tp_core_modi369" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi368" target="origFile">temp_ad = fx_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi368" target="origFile">temp_ad0 = -(c(i, j)*<code class="constant">0.5</code>*fx_ad(i, j))</a>
            <a href="null_p.html#tp_core_modi368" target="origFile">temp_ad1 = c(i, j)**<code class="constant">2</code>*fx_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi368" target="origFile">q_ad(i, j) = q_ad(i, j) + temp_ad1 + temp_ad0 + <code class="constant">2.0</code>*temp_ad</a>
            <a href="null_p.html#tp_core_modi368" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + <code class="constant">5.0</code>*temp_ad - temp_ad0 - <code class="constant">2.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi368" target="origFile"><code class="label">&             </code>temp_ad1</a>
            <a href="null_p.html#tp_core_modi368" target="origFile">q_ad(i-<code class="constant">2</code>, j) = q_ad(i-<code class="constant">2</code>, j) + temp_ad1 - temp_ad</a>
            <a href="null_p.html#tp_core_modi368" target="origFile">fx_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">END DO</code></a>
<a name="xtp_admi107"></a>      <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi366" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi372" target="origFile"><code class="keyword">CALL </code><code class="funcname">FXPPM_ADM</code>(c, q, q_ad, fx, fx_ad, iord, ifirst, ilast, jfirst<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi372" target="origFile"><code class="label">&              </code>, jlast, npx, npy)</a>
<a name="xtp"></a>    <a href="null_p.html#tp_core_modi360" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XTP_ADM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XTP</code>(<code class="vardecl">fx</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant numbers</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">is</code>-<code class="constant">2</code>:<code class="vardecl">ie</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = q(i-<code class="constant">1</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = q(i, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (iord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!Advection using third order scheme</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i-<code class="constant">1</code>, j)-q(i-<code class="constant">2</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+q(i-<code class="constant">2</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = (<code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+<code class="constant">5.0</code>*q(i, j)-q(i+<code class="constant">1</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i-<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">FXPPM</code>(c, q, fx, iord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="ytp_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XTP</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of ytp in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q fy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YTP_ADM</code>(<code class="vardecl">fy</code>, <code class="vardecl">fy_ad</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_modi327" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
<a href="null_p.html#tp_core_modi328" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi328" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi329" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi329" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi330" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_modi331" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_modi332" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_modi332" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi333" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_modi333" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi334" target="origFile"><code class="comment">! !LOCAL VARIABLES:</code></a>
    <a href="null_p.html#tp_core_modi334" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi335" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null_p.html#tp_core_modi336" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi342" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_modi341" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_modi338" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi338" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi338" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi338" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi338" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi341" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi342" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">DO </code>j=jlast+<code class="constant">1</code>,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
<a name="ytp_admi99"></a>          <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi340" target="origFile">q_ad(i, j) = q_ad(i, j) + fy_ad(i, j)</a>
<a name="ytp_admi98"></a>            <a href="null_p.html#tp_core_modi340" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi339" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + fy_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi339" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">ELSE </code></a><a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi348" target="origFile"><code class="comment">!Advected using third order scheme</code></a>
      <a href="null_p.html#tp_core_modi348" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_modi347" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_modi344" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi344" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi344" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi344" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi344" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi347" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi348" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">DO </code>j=jlast+<code class="constant">1</code>,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
<a name="ytp_admi101"></a>          <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi346" target="origFile">temp_ad2 = fy_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi346" target="origFile">temp_ad3 = -(c(i, j)*<code class="constant">0.5</code>*fy_ad(i, j))</a>
            <a href="null_p.html#tp_core_modi346" target="origFile">temp_ad4 = c(i, j)**<code class="constant">2</code>*fy_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi346" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + temp_ad4 - temp_ad3 + <code class="constant">2.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi346" target="origFile"><code class="label">&             </code>temp_ad2</a>
            <a href="null_p.html#tp_core_modi346" target="origFile">q_ad(i, j) = q_ad(i, j) + temp_ad3 - <code class="constant">2.0</code>*temp_ad4 + <code class="constant">5.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi346" target="origFile"><code class="label">&             </code>temp_ad2</a>
            <a href="null_p.html#tp_core_modi346" target="origFile">q_ad(i, j+<code class="constant">1</code>) = q_ad(i, j+<code class="constant">1</code>) + temp_ad4 - temp_ad2</a>
<a name="ytp_admi100"></a>            <a href="null_p.html#tp_core_modi346" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi345" target="origFile">temp_ad = fy_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi345" target="origFile">temp_ad0 = -(c(i, j)*<code class="constant">0.5</code>*fy_ad(i, j))</a>
            <a href="null_p.html#tp_core_modi345" target="origFile">temp_ad1 = c(i, j)**<code class="constant">2</code>*fy_ad(i, j)/<code class="constant">6.0</code></a>
            <a href="null_p.html#tp_core_modi345" target="origFile">q_ad(i, j) = q_ad(i, j) + temp_ad1 + temp_ad0 + <code class="constant">2.0</code>*temp_ad</a>
            <a href="null_p.html#tp_core_modi345" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + <code class="constant">5.0</code>*temp_ad - temp_ad0 - <code class="constant">2.0</code>*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi345" target="origFile"><code class="label">&             </code>temp_ad1</a>
            <a href="null_p.html#tp_core_modi345" target="origFile">q_ad(i, j-<code class="constant">2</code>) = q_ad(i, j-<code class="constant">2</code>) + temp_ad1 - temp_ad</a>
            <a href="null_p.html#tp_core_modi345" target="origFile">fy_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">END DO</code></a>
<a name="ytp_admi102"></a>      <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi343" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi349" target="origFile"><code class="keyword">CALL </code><code class="funcname">FYPPM_ADM</code>(c, q, q_ad, fy, fy_ad, jord, ifirst, ilast, jfirst<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi349" target="origFile"><code class="label">&              </code>, jlast, npx, npy)</a>
<a name="ytp"></a>    <a href="null_p.html#tp_core_modi337" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YTP_ADM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YTP</code>(<code class="vardecl">fy</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !LOCAL VARIABLES:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = q(i, j-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = q(i, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (jord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!Advected using third order scheme</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i, j-<code class="constant">1</code>)-q(i, j-<code class="constant">2</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+q(i, j-<code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+<code class="constant">5.0</code>*q(i, j)-q(i, j+<code class="constant">1</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j+<code class="constant">1</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i, j-<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">FYPPM</code>(c, q, fy, jord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="xppm0_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YTP</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of xppm0 in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef XPPM_2D</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! subroutine xppm0(flux, q, c, iord, ifirst, ilast, jfirst, jlast, npx, npy, bd, dxa, nested, grid_type)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! type(fv_grid_bounds_type), intent(IN) :: bd</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: ifirst, ilast               !  X-Dir strip</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: jfirst, jlast               !  Y-Dir strip</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: iord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: npx, npy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , INTENT(IN) :: q(ifirst-ng:ilast+ng,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , INTENT(IN) :: c(ifirst   :ilast+1 ,jfirst:jlast) ! Courant   N (like FLUX)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , intent(IN) :: dxa(bd%isd:bd%ied,bd%jsd:bd%jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! logical, intent(IN) :: nested</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, intent(IN) :: grid_type</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  , INTENT(OUT) :: flux(ifirst:ilast+1,jfirst:jlast) !  Flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Local</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real, dimension(3*jfirst:3*jlast+2) :: q_tmp, bl_tmp, br_tmp</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real, dimension(ifirst-1:ilast+1,jfirst:jlast):: bl, br</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  al(ifirst-1:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  dm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  dq(ifirst-3:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! logical extm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer i, j, ie3, is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real xt, pmp_1, lac_1, pmp_2, lac_2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    is1 = max(3,is-1);  ie3 = min(npx-2,ie+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                        ie1 = min(npx-3,ie+1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    is1 = is-1;         ie3 = ie+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                        ie1 = ie+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end if</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! if ( abs(iord) &lt; 8 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is1, ie3</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          al(i,j) = p1*(q(i-1,j)+q(i,j)) + p2*(q(i-2,j)+q(i+1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(0,j) = c1*q(-2,j) + c2*q(-1,j) + c3*q(0,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(1,j) = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(2,j) = c3*q(1,j) + c2*q(2,j) +c1*q(3,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(0,j) = max(0., al(0,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(1,j) = max(0., al(1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(2,j) = max(0., al(2,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( (ie+1)==npx ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx-1,j) = c1*q(npx-3,j) + c2*q(npx-2,j) + c3*q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx,j) = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j)-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx+1,j) = c3*q(npx,j) + c2*q(npx+1,j) + c1*q(npx+2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx-1,j) = max(0., al(npx-1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx,  j) = max(0., al(npx  ,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx+1,j) = max(0., al(npx+1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( iord==-5 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-3,ilast+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-2, ilast+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( dq(i-1,j)*dq(i,j) &gt; 0. ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                extm(i,j) = .false.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                extm(i,j) = .true.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( extm(i-1,j).and.extm(i,j).and.extm(i+1,j) ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       ! Additional positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if(iord==-7) call pert_ppm(ilast-ifirst+3, q(ifirst-1,j), bl(ifirst-1,j), br(ifirst-1,j), 0)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Monotonic constraints:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 8: PPM with Lin's PPM fast monotone constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 10: PPM with Lin's modification of Huynh 2nd constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 13: 10 plus positive definite constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is-2,ie+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          xt = 0.25*(q(i+1,j) - q(i-1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          dm(i,j) = sign(min(abs(xt), max(q(i-1,j), q(i,j), q(i+1,j)) - q(i,j),  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!               q(i,j) - min(q(i-1,j), q(i,j), q(i+1,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is1,ie1+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          al(i,j) = 0.5*(q(i-1,j)+q(i,j)) + r3*(dm(i-1,j)-dm(i,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( iord==-8 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = 2.*dm(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = -sign(min(abs(xt), abs(al(i,j  )-q(i,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) =  sign(min(abs(xt), abs(al(i+1,j)-q(i,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1-2, ie1+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = al(i,j  ) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( abs(dm(i-1,j))+abs(dm(i,j))+abs(dm(i+1,j)) &lt; near_zero ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             elseif( abs(3.*(bl(i,j)+br(i,j))) &gt; abs(bl(i,j)-br(i,j)) ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                pmp_1 = -(dq(i,j) + dq(i,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                lac_1 = pmp_1 + 1.5*dq(i+1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = min( max(0., pmp_1, lac_1), max(bl(i,j), min(0., pmp_1, lac_1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                pmp_2 = dq(i-1,j) + dq(i-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                lac_2 = pmp_2 - 1.5*dq(i-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = min( max(0., pmp_2, lac_2), max(br(i,j), min(0., pmp_2, lac_2)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! Positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if(iord==-9 .or. iord==-13) call pert_ppm(ie1-is1+1, q(is1,j), bl(is1,j), br(is1,j), 0)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if (.not. nested .and. grid_type&lt;3) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j) = s14*dm(-1,j) + s11*(q(-1,j)-q(0,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j) = xt - q(0,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = s15*q(1,j) + s11*q(2,j) - s14*dm(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j+2) = xt - q(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j+2) = al(3,j) - q(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             q_tmp(j*3:j*3+2) = q(0:2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(0:2,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(0:2,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      if ( (ie+1)==npx ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j) = al(npx-2,j) - q(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = s15*q(npx-1,j) + s11*q(npx-2,j) + s14*dm(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j) = xt - q(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!               +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j  )-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j+2) = xt - q(npx,j  )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j+2) = s11*(q(npx+1,j)-q(npx,j)) - s14*dm(npx+1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            q_tmp(j*3:j*3+2) = q(npx-2:npx,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl(npx-2:npx,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br(npx-2:npx,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!     do i=ifirst,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        if( c(i,j)&gt;0. ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           flux(i,j) = q(i-1,j) + (1.-c(i,j))*(br(i-1,j)-c(i,j)*(bl(i-1,j)+br(i-1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           flux(i,j) = q(i,j  ) + (1.+c(i,j))*(bl(i,j  )+c(i,j)*(bl(i,j  )+br(i,j  )))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!     enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end subroutine xppm0</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#else</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XPPM0_ADM</code>(<code class="vardecl">flux</code>, <code class="vardecl">flux_ad</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi273" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi273" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi274" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi274" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi275" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null_p.html#tp_core_modi276" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi277" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi278" target="origFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null_p.html#tp_core_modi278" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi279" target="origFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_modi279" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_modi279" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">flux_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi280" target="origFile"><code class="comment">! Local</code></a>
    <a href="null_p.html#tp_core_modi280" target="origFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-ng:ilast+ng<code class="typename">) </code>:: <code class="vardecl">q1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, DIMENSION(ifirst-ng:ilast+ng) :: <code class="vardecl">q1_ad</code></a>
    <a href="null_p.html#tp_core_modi281" target="origFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-<code class="constant">1</code>:ilast+<code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">bl</code>, <code class="vardecl">br</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, DIMENSION(ifirst-<code class="constant">1</code>:ilast+<code class="constant">1</code>) :: <code class="vardecl">bl_ad</code>, <code class="vardecl">br_ad</code></a>
    <a href="null_p.html#tp_core_modi282" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al_ad</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi283" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi284" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi285" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi286" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ie3</code>, <code class="vardecl">is1</code>, <code class="vardecl">ie1</code></a>
    <a href="null_p.html#tp_core_modi287" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_modi288" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_modi289" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_modi290" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_modi291" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi292" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi293" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi294" target="origFile">is1 = is - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi293" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi295" target="origFile">is1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_modi293" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi296" target="origFile"><code class="keyword">IF</code> (npx - <code class="constant">2 </code>.GT. ie + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi296" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi297" target="origFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_modi296" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi296" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi298" target="origFile">ie3 = npx - <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_modi296" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi292" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi292" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi299" target="origFile">is1 = is - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi300" target="origFile">ie3 = ie + <code class="constant">2</code></a>
    <a href="null_p.html#tp_core_modi292" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi326" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
      <a href="null_p.html#tp_core_modi303" target="origFile"><code class="keyword">IF</code> (iord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi304" target="origFile">abs0 = iord</a>
      <a href="null_p.html#tp_core_modi303" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi305" target="origFile">abs0 = -iord</a>
      <a href="null_p.html#tp_core_modi303" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi306" target="origFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi309" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi310" target="origFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi310" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi310" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi310" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi310" target="origFile"><code class="keyword">END IF</code></a>
          <a href="null_p.html#tp_core_modi314" target="origFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi314" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi314" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi314" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi314" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi309" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi309" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_modi309" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi318" target="origFile"><code class="keyword">IF</code> (iord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi318" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_modi318" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi318" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi318" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi306" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi306" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi306" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi325" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_modi322" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi322" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi322" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi322" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi322" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi325" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi326" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">al_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">bl_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">br_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">q1_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jlast,jfirst,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast+<code class="constant">1</code>,ifirst,<code class="constant">-1</code></a>
<a name="xppm0_admi97"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi324" target="origFile">temp_ad5 = (c(i, j)+<code class="constant">1.</code>)*flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi324" target="origFile">temp_ad6 = c(i, j)*temp_ad5</a>
          <a href="null_p.html#tp_core_modi324" target="origFile">q1_ad(i) = q1_ad(i) + flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi324" target="origFile">bl_ad(i) = bl_ad(i) + temp_ad6 + temp_ad5</a>
          <a href="null_p.html#tp_core_modi324" target="origFile">br_ad(i) = br_ad(i) + temp_ad6</a>
<a name="xppm0_admi96"></a>          <a href="null_p.html#tp_core_modi324" target="origFile">flux_ad(i, j) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi323" target="origFile">temp_ad3 = (<code class="constant">1.</code>-c(i, j))*flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi323" target="origFile">temp_ad4 = -(c(i, j)*temp_ad3)</a>
          <a href="null_p.html#tp_core_modi323" target="origFile">q1_ad(i-<code class="constant">1</code>) = q1_ad(i-<code class="constant">1</code>) + flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi323" target="origFile">br_ad(i-<code class="constant">1</code>) = br_ad(i-<code class="constant">1</code>) + temp_ad4 + temp_ad3</a>
          <a href="null_p.html#tp_core_modi323" target="origFile">bl_ad(i-<code class="constant">1</code>) = bl_ad(i-<code class="constant">1</code>) + temp_ad4</a>
          <a href="null_p.html#tp_core_modi323" target="origFile">flux_ad(i, j) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="xppm0_admi94"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast+<code class="constant">1</code>,ifirst-<code class="constant">1</code>,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi319" target="origFile">al_ad(i+<code class="constant">1</code>) = al_ad(i+<code class="constant">1</code>) + br_ad(i)</a>
<a name="xppm0_admi95"></a>            <a href="null_p.html#tp_core_modi319" target="origFile">q1_ad(i) = q1_ad(i) - bl_ad(i) - br_ad(i)</a>
            <a href="null_p.html#tp_core_modi319" target="origFile">br_ad(i) = <code class="constant">0.0</code></a>
            <a href="null_p.html#tp_core_modi320" target="origFile">al_ad(i) = al_ad(i) + bl_ad(i)</a>
            <a href="null_p.html#tp_core_modi320" target="origFile">bl_ad(i) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="xppm0_admi91"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi315" target="origFile">q1_ad(npx) = q1_ad(npx) + c3*al_ad(npx+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi315" target="origFile">q1_ad(npx+<code class="constant">1</code>) = q1_ad(npx+<code class="constant">1</code>) + c2*al_ad(npx+<code class="constant">1</code>)</a>
<a name="xppm0_admi92"></a>          <a href="null_p.html#tp_core_modi315" target="origFile">q1_ad(npx+<code class="constant">2</code>) = q1_ad(npx+<code class="constant">2</code>) + c1*al_ad(npx+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi315" target="origFile">al_ad(npx+<code class="constant">1</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi316" target="origFile">temp_ad1 = <code class="constant">0.5</code>*al_ad(npx)/(dxa(npx-<code class="constant">2</code>, j)+dxa(npx-<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_modi316" target="origFile">temp_ad2 = <code class="constant">0.5</code>*al_ad(npx)/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_modi316" target="origFile">q1_ad(npx-<code class="constant">1</code>) = q1_ad(npx-<code class="constant">1</code>) + (dxa(npx-<code class="constant">1</code>, j)*<code class="constant">2.</code>+dxa(npx-<code class="constant">2</code>, j))<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi316" target="origFile"><code class="label">&           </code>*temp_ad1</a>
          <a href="null_p.html#tp_core_modi316" target="origFile">q1_ad(npx-<code class="constant">2</code>) = q1_ad(npx-<code class="constant">2</code>) - dxa(npx-<code class="constant">1</code>, j)*temp_ad1</a>
          <a href="null_p.html#tp_core_modi316" target="origFile">q1_ad(npx) = q1_ad(npx) + (dxa(npx, j)*<code class="constant">2.</code>+dxa(npx+<code class="constant">1</code>, j))*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi316" target="origFile"><code class="label">&           </code>temp_ad2</a>
<a name="xppm0_admi93"></a>          <a href="null_p.html#tp_core_modi316" target="origFile">q1_ad(npx+<code class="constant">1</code>) = q1_ad(npx+<code class="constant">1</code>) - dxa(npx, j)*temp_ad2</a>
          <a href="null_p.html#tp_core_modi316" target="origFile">al_ad(npx) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi317" target="origFile">q1_ad(npx-<code class="constant">3</code>) = q1_ad(npx-<code class="constant">3</code>) + c1*al_ad(npx-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi317" target="origFile">q1_ad(npx-<code class="constant">2</code>) = q1_ad(npx-<code class="constant">2</code>) + c2*al_ad(npx-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi317" target="origFile">q1_ad(npx-<code class="constant">1</code>) = q1_ad(npx-<code class="constant">1</code>) + c3*al_ad(npx-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi317" target="origFile">al_ad(npx-<code class="constant">1</code>) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (branch .NE. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="xppm0_admi88"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi311" target="origFile">q1_ad(<code class="constant">1</code>) = q1_ad(<code class="constant">1</code>) + c3*al_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi311" target="origFile">q1_ad(<code class="constant">2</code>) = q1_ad(<code class="constant">2</code>) + c2*al_ad(<code class="constant">2</code>)</a>
<a name="xppm0_admi89"></a>          <a href="null_p.html#tp_core_modi311" target="origFile">q1_ad(<code class="constant">3</code>) = q1_ad(<code class="constant">3</code>) + c1*al_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi311" target="origFile">al_ad(<code class="constant">2</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi312" target="origFile">temp_ad = <code class="constant">0.5</code>*al_ad(<code class="constant">1</code>)/(dxa(-<code class="constant">1</code>, j)+dxa(<code class="constant">0</code>, j))</a>
          <a href="null_p.html#tp_core_modi312" target="origFile">temp_ad0 = <code class="constant">0.5</code>*al_ad(<code class="constant">1</code>)/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))</a>
          <a href="null_p.html#tp_core_modi312" target="origFile">q1_ad(<code class="constant">0</code>) = q1_ad(<code class="constant">0</code>) + (dxa(<code class="constant">0</code>, j)*<code class="constant">2.</code>+dxa(-<code class="constant">1</code>, j))*temp_ad</a>
          <a href="null_p.html#tp_core_modi312" target="origFile">q1_ad(-<code class="constant">1</code>) = q1_ad(-<code class="constant">1</code>) - dxa(<code class="constant">0</code>, j)*temp_ad</a>
          <a href="null_p.html#tp_core_modi312" target="origFile">q1_ad(<code class="constant">1</code>) = q1_ad(<code class="constant">1</code>) + (dxa(<code class="constant">1</code>, j)*<code class="constant">2.</code>+dxa(<code class="constant">2</code>, j))*temp_ad0</a>
<a name="xppm0_admi90"></a>          <a href="null_p.html#tp_core_modi312" target="origFile">q1_ad(<code class="constant">2</code>) = q1_ad(<code class="constant">2</code>) - dxa(<code class="constant">1</code>, j)*temp_ad0</a>
          <a href="null_p.html#tp_core_modi312" target="origFile">al_ad(<code class="constant">1</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi313" target="origFile">q1_ad(-<code class="constant">2</code>) = q1_ad(-<code class="constant">2</code>) + c1*al_ad(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi313" target="origFile">q1_ad(-<code class="constant">1</code>) = q1_ad(-<code class="constant">1</code>) + c2*al_ad(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi313" target="origFile">q1_ad(<code class="constant">0</code>) = q1_ad(<code class="constant">0</code>) + c3*al_ad(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi313" target="origFile">al_ad(<code class="constant">0</code>) = <code class="constant">0.0</code></a>
<a name="xppm0_admi87"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
 <a href="null_p.html#tp_core_mod" target="origFile"><code class="label">100    </code><code class="keyword">DO </code>i=ie3,is1,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi307" target="origFile">q1_ad(i-<code class="constant">1</code>) = q1_ad(i-<code class="constant">1</code>) + p1*al_ad(i)</a>
          <a href="null_p.html#tp_core_modi307" target="origFile">q1_ad(i) = q1_ad(i) + p1*al_ad(i)</a>
          <a href="null_p.html#tp_core_modi307" target="origFile">q1_ad(i-<code class="constant">2</code>) = q1_ad(i-<code class="constant">2</code>) + p2*al_ad(i)</a>
          <a href="null_p.html#tp_core_modi307" target="origFile">q1_ad(i+<code class="constant">1</code>) = q1_ad(i+<code class="constant">1</code>) + p2*al_ad(i)</a>
          <a href="null_p.html#tp_core_modi307" target="origFile">al_ad(i) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="xppm0_admi86"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast+ng,ifirst-ng,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi301" target="origFile">q_ad(i, j) = q_ad(i, j) + q1_ad(i)</a>
        <a href="null_p.html#tp_core_modi301" target="origFile">q1_ad(i) = <code class="constant">0.0</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="xppm0"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XPPM0_ADM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef XPPM_2D</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! subroutine xppm0(flux, q, c, iord, ifirst, ilast, jfirst, jlast, npx, npy, bd, dxa, nested, grid_type)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! type(fv_grid_bounds_type), intent(IN) :: bd</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: ifirst, ilast               !  X-Dir strip</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: jfirst, jlast               !  Y-Dir strip</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: iord</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, INTENT(IN) :: npx, npy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , INTENT(IN) :: q(ifirst-ng:ilast+ng,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , INTENT(IN) :: c(ifirst   :ilast+1 ,jfirst:jlast) ! Courant   N (like FLUX)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real   , intent(IN) :: dxa(bd%isd:bd%ied,bd%jsd:bd%jed)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! logical, intent(IN) :: nested</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer, intent(IN) :: grid_type</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  , INTENT(OUT) :: flux(ifirst:ilast+1,jfirst:jlast) !  Flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Local</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real, dimension(3*jfirst:3*jlast+2) :: q_tmp, bl_tmp, br_tmp</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real, dimension(ifirst-1:ilast+1,jfirst:jlast):: bl, br</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  al(ifirst-1:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  dm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real  dq(ifirst-3:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! logical extm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! integer i, j, ie3, is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real xt, pmp_1, lac_1, pmp_2, lac_2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    is1 = max(3,is-1);  ie3 = min(npx-2,ie+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                        ie1 = min(npx-3,ie+1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    is1 = is-1;         ie3 = ie+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                        ie1 = ie+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end if</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! if ( abs(iord) &lt; 8 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is1, ie3</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          al(i,j) = p1*(q(i-1,j)+q(i,j)) + p2*(q(i-2,j)+q(i+1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(0,j) = c1*q(-2,j) + c2*q(-1,j) + c3*q(0,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(1,j) = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(2,j) = c3*q(1,j) + c2*q(2,j) +c1*q(3,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(0,j) = max(0., al(0,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(1,j) = max(0., al(1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(2,j) = max(0., al(2,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( (ie+1)==npx ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx-1,j) = c1*q(npx-3,j) + c2*q(npx-2,j) + c3*q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx,j) = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j)-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             al(npx+1,j) = c3*q(npx,j) + c2*q(npx+1,j) + c1*q(npx+2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx-1,j) = max(0., al(npx-1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx,  j) = max(0., al(npx  ,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                al(npx+1,j) = max(0., al(npx+1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( iord==-5 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-3,ilast+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-2, ilast+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( dq(i-1,j)*dq(i,j) &gt; 0. ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                extm(i,j) = .false.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                extm(i,j) = .true.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( extm(i-1,j).and.extm(i,j).and.extm(i+1,j) ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       ! Additional positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if(iord==-7) call pert_ppm(ilast-ifirst+3, q(ifirst-1,j), bl(ifirst-1,j), br(ifirst-1,j), 0)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! Monotonic constraints:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 8: PPM with Lin's PPM fast monotone constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 10: PPM with Lin's modification of Huynh 2nd constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!! ord = 13: 10 plus positive definite constraint</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is-2,ie+2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          xt = 0.25*(q(i+1,j) - q(i-1,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          dm(i,j) = sign(min(abs(xt), max(q(i-1,j), q(i,j), q(i+1,j)) - q(i,j),  &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!               q(i,j) - min(q(i-1,j), q(i,j), q(i+1,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do i=is1,ie1+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          al(i,j) = 0.5*(q(i-1,j)+q(i,j)) + r3*(dm(i-1,j)-dm(i,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if ( iord==-8 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = 2.*dm(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = -sign(min(abs(xt), abs(al(i,j  )-q(i,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) =  sign(min(abs(xt), abs(al(i+1,j)-q(i,j))), xt)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1-2, ie1+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(i,j) = al(i,j  ) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             if ( abs(dm(i-1,j))+abs(dm(i,j))+abs(dm(i+1,j)) &lt; near_zero ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             elseif( abs(3.*(bl(i,j)+br(i,j))) &gt; abs(bl(i,j)-br(i,j)) ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                pmp_1 = -(dq(i,j) + dq(i,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                lac_1 = pmp_1 + 1.5*dq(i+1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                bl(i,j) = min( max(0., pmp_1, lac_1), max(bl(i,j), min(0., pmp_1, lac_1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                pmp_2 = dq(i-1,j) + dq(i-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                lac_2 = pmp_2 - 1.5*dq(i-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                br(i,j) = min( max(0., pmp_2, lac_2), max(br(i,j), min(0., pmp_2, lac_2)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    ! Positive definite constraint:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if(iord==-9 .or. iord==-13) call pert_ppm(ie1-is1+1, q(is1,j), bl(is1,j), br(is1,j), 0)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    if (.not. nested .and. grid_type&lt;3) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j) = s14*dm(-1,j) + s11*(q(-1,j)-q(0,j))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j) = xt - q(0,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = s15*q(1,j) + s11*q(2,j) - s14*dm(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl_tmp(3*j+2) = xt - q(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br_tmp(3*j+2) = al(3,j) - q(2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             q_tmp(j*3:j*3+2) = q(0:2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             bl(0:2,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             br(0:2,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!          enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      if ( (ie+1)==npx ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j) = al(npx-2,j) - q(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = s15*q(npx-1,j) + s11*q(npx-2,j) + s14*dm(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j) = xt - q(npx-2,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!               +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j  )-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl_tmp(3*j+2) = xt - q(npx,j  )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br_tmp(3*j+2) = s11*(q(npx+1,j)-q(npx,j)) - s14*dm(npx+1,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            q_tmp(j*3:j*3+2) = q(npx-2:npx,j)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            bl(npx-2:npx,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            br(npx-2:npx,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!         enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  do j=jfirst,jlast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!     do i=ifirst,ilast+1</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        if( c(i,j)&gt;0. ) then</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           flux(i,j) = q(i-1,j) + (1.-c(i,j))*(br(i-1,j)-c(i,j)*(bl(i-1,j)+br(i-1,j)))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        else</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           flux(i,j) = q(i,j  ) + (1.+c(i,j))*(bl(i,j  )+c(i,j)*(bl(i,j  )+br(i,j  )))</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!        endif</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!     enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  enddo</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! end subroutine xppm0</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#else</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-ng:ilast+ng<code class="typename">) </code>:: <code class="vardecl">q1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-<code class="constant">1</code>:ilast+<code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">bl</code>, <code class="vardecl">br</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ie3</code>, <code class="vardecl">is1</code>, <code class="vardecl">ie1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">is1 = is - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">is1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npx - <code class="constant">2 </code>.GT. ie + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ie3 = npx - <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ie1 = ie + <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">ie1 = npx - <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">is1 = is - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ie1 = ie + <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst-ng,ilast+ng</a>
        <a href="null_p.html#tp_core_mod" target="origFile">q1(i) = q(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (iord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">abs0 = iord</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">abs0 = -iord</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a name="p30"></a><a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is1,ie3</a>
          <a href="msg.html#p30" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i) = p1*(q1(i-<code class="constant">1</code>)+q1(i)) + p2*(q1(i-<code class="constant">2</code>)+q1(i+<code class="constant">1</code>))</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p31"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p32"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
            <a href="msg.html#p31" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(<code class="constant">0</code>) = c1*q1(-<code class="constant">2</code>) + c2*q1(-<code class="constant">1</code>) + c3*q1(<code class="constant">0</code>)</a>
            <a href="msg.html#p32" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(<code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q1(<code class="constant">0</code>)-dxa(<code class="constant">0</code>, j)*q1(-<code class="label">&</code></a>
<a name="p33"></a><a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code><code class="constant">1</code>))/(dxa(-<code class="constant">1</code>, j)+dxa(<code class="constant">0</code>, j))+((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q1(<code class="constant">1</code>)<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>-dxa(<code class="constant">1</code>, j)*q1(<code class="constant">2</code>))/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j)))</a>
            <a href="msg.html#p33" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(<code class="constant">2</code>) = c3*q1(<code class="constant">1</code>) + c2*q1(<code class="constant">2</code>) + c1*q1(<code class="constant">3</code>)</a>
<a name="p34"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p35"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
            <a href="msg.html#p34" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(npx-<code class="constant">1</code>) = c1*q1(npx-<code class="constant">3</code>) + c2*q1(npx-<code class="constant">2</code>) + c3*q1(npx-<code class="constant">1</code>)</a>
            <a href="msg.html#p35" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(npx) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q1(npx-<code class="constant">1</code>)-<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>dxa(npx-<code class="constant">1</code>, j)*q1(npx-<code class="constant">2</code>))/(dxa(npx-<code class="constant">2</code>, j)+dxa(npx-<code class="constant">1</code>, j))+((<code class="label">&</code></a>
<a name="p36"></a><a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code><code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q1(npx)-dxa(npx, j)*q1(npx+<code class="constant">1</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j)))</a>
            <a href="msg.html#p36" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(npx+<code class="constant">1</code>) = c3*q1(npx) + c2*q1(npx+<code class="constant">1</code>) + c1*q1(npx+<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (iord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst-<code class="constant">1</code>,ilast+<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">bl(i) = al(i) - q1(i)</a>
            <a href="null_p.html#tp_core_mod" target="origFile">br(i) = al(i+<code class="constant">1</code>) - q1(i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q1(i-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i-<code class="constant">1</code>)+<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>br(i-<code class="constant">1</code>)))</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q1(i) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br(i))<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="yppm0_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XPPM0</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of yppm0 in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YPPM0_ADM</code>(<code class="vardecl">flux</code>, <code class="vardecl">flux_ad</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi217" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi217" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi218" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi218" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi219" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_modi220" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi221" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_modi222" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_modi222" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi223" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_modi223" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">flux_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi224" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_modi224" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi225" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi226" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">bl_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi227" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">br_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi228" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi229" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi230" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_modi231" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js1</code>, <code class="vardecl">je3</code>, <code class="vardecl">je1</code></a>
    <a href="null_p.html#tp_core_modi232" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_modi233" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_modi234" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_modi235" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">temp_ad6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi236" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi237" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi238" target="origFile">js1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi237" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi239" target="origFile">js1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_modi237" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi240" target="origFile"><code class="keyword">IF</code> (npy - <code class="constant">2 </code>.GT. je + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi240" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi241" target="origFile">je3 = je + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_modi240" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi240" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi242" target="origFile">je3 = npy - <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_modi240" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi236" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi236" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
<a href="null_p.html#tp_core_modi243" target="origFile"><code class="comment">! Nested grid OR Doubly periodic domain:</code></a>
      <a href="null_p.html#tp_core_modi243" target="origFile">js1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi244" target="origFile">je3 = je + <code class="constant">2</code></a>
    <a href="null_p.html#tp_core_modi236" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi245" target="origFile"><code class="keyword">IF</code> (jord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi246" target="origFile">abs0 = jord</a>
    <a href="null_p.html#tp_core_modi245" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi247" target="origFile">abs0 = -jord</a>
    <a href="null_p.html#tp_core_modi245" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi248" target="origFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi252" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi253" target="origFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi253" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi253" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi253" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi253" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi258" target="origFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi258" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi258" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi258" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi258" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi252" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi252" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
      <a href="null_p.html#tp_core_modi252" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi263" target="origFile"><code class="keyword">IF</code> (jord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi263" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">2</code>)</a>
      <a href="null_p.html#tp_core_modi263" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi263" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi263" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi248" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi248" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL2B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi248" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi272" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi271" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
        <a href="null_p.html#tp_core_modi268" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi268" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi268" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi268" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi268" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi271" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi272" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">bl_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">br_ad = <code class="constant">0.0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jlast+<code class="constant">1</code>,jfirst,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
<a name="yppm0_admi85"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi270" target="origFile">temp_ad5 = (c(i, j)+<code class="constant">1.</code>)*flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi270" target="origFile">temp_ad6 = c(i, j)*temp_ad5</a>
          <a href="null_p.html#tp_core_modi270" target="origFile">q_ad(i, j) = q_ad(i, j) + flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi270" target="origFile">bl_ad(i, j) = bl_ad(i, j) + temp_ad6 + temp_ad5</a>
          <a href="null_p.html#tp_core_modi270" target="origFile">br_ad(i, j) = br_ad(i, j) + temp_ad6</a>
<a name="yppm0_admi84"></a>          <a href="null_p.html#tp_core_modi270" target="origFile">flux_ad(i, j) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi269" target="origFile">temp_ad3 = (<code class="constant">1.</code>-c(i, j))*flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi269" target="origFile">temp_ad4 = -(c(i, j)*temp_ad3)</a>
          <a href="null_p.html#tp_core_modi269" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + flux_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi269" target="origFile">br_ad(i, j-<code class="constant">1</code>) = br_ad(i, j-<code class="constant">1</code>) + temp_ad4 + temp_ad3</a>
          <a href="null_p.html#tp_core_modi269" target="origFile">bl_ad(i, j-<code class="constant">1</code>) = bl_ad(i, j-<code class="constant">1</code>) + temp_ad4</a>
          <a href="null_p.html#tp_core_modi269" target="origFile">flux_ad(i, j) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">al_ad = <code class="constant">0.0</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">al_ad = <code class="constant">0.0</code></a>
<a name="yppm0_admi82"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jlast+<code class="constant">1</code>,jfirst-<code class="constant">1</code>,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi264" target="origFile">al_ad(i, j+<code class="constant">1</code>) = al_ad(i, j+<code class="constant">1</code>) + br_ad(i, j)</a>
<a name="yppm0_admi83"></a>            <a href="null_p.html#tp_core_modi264" target="origFile">q_ad(i, j) = q_ad(i, j) - bl_ad(i, j) - br_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi264" target="origFile">br_ad(i, j) = <code class="constant">0.0</code></a>
            <a href="null_p.html#tp_core_modi265" target="origFile">al_ad(i, j) = al_ad(i, j) + bl_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi265" target="origFile">bl_ad(i, j) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL2B</code>(branch)</a>
<a name="yppm0_admi79"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi259" target="origFile">q_ad(i, npy) = q_ad(i, npy) + c3*al_ad(i, npy+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi259" target="origFile">q_ad(i, npy+<code class="constant">1</code>) = q_ad(i, npy+<code class="constant">1</code>) + c2*al_ad(i, npy+<code class="constant">1</code>)</a>
<a name="yppm0_admi80"></a>          <a href="null_p.html#tp_core_modi259" target="origFile">q_ad(i, npy+<code class="constant">2</code>) = q_ad(i, npy+<code class="constant">2</code>) + c1*al_ad(i, npy+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi259" target="origFile">al_ad(i, npy+<code class="constant">1</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi260" target="origFile">temp_ad1 = <code class="constant">0.5</code>*al_ad(i, npy)/(dya(i, npy-<code class="constant">2</code>)+dya(i, npy-<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_modi260" target="origFile">temp_ad2 = <code class="constant">0.5</code>*al_ad(i, npy)/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_modi260" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) + (dya(i, npy-<code class="constant">1</code>)*<code class="constant">2.</code>+dya(i, npy<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi260" target="origFile"><code class="label">&           </code>-<code class="constant">2</code>))*temp_ad1</a>
          <a href="null_p.html#tp_core_modi260" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) - dya(i, npy-<code class="constant">1</code>)*temp_ad1</a>
          <a href="null_p.html#tp_core_modi260" target="origFile">q_ad(i, npy) = q_ad(i, npy) + (dya(i, npy)*<code class="constant">2.</code>+dya(i, npy+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi260" target="origFile"><code class="label">&           </code>temp_ad2</a>
<a name="yppm0_admi81"></a>          <a href="null_p.html#tp_core_modi260" target="origFile">q_ad(i, npy+<code class="constant">1</code>) = q_ad(i, npy+<code class="constant">1</code>) - dya(i, npy)*temp_ad2</a>
          <a href="null_p.html#tp_core_modi260" target="origFile">al_ad(i, npy) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi261" target="origFile">q_ad(i, npy-<code class="constant">3</code>) = q_ad(i, npy-<code class="constant">3</code>) + c1*al_ad(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi261" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) + c2*al_ad(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi261" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) + c3*al_ad(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi261" target="origFile">al_ad(i, npy-<code class="constant">1</code>) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (branch .NE. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="yppm0_admi76"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi254" target="origFile">q_ad(i, <code class="constant">1</code>) = q_ad(i, <code class="constant">1</code>) + c3*al_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi254" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) + c2*al_ad(i, <code class="constant">2</code>)</a>
<a name="yppm0_admi77"></a>          <a href="null_p.html#tp_core_modi254" target="origFile">q_ad(i, <code class="constant">3</code>) = q_ad(i, <code class="constant">3</code>) + c1*al_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi254" target="origFile">al_ad(i, <code class="constant">2</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi255" target="origFile">temp_ad = <code class="constant">0.5</code>*al_ad(i, <code class="constant">1</code>)/(dya(i, -<code class="constant">1</code>)+dya(i, <code class="constant">0</code>))</a>
          <a href="null_p.html#tp_core_modi255" target="origFile">temp_ad0 = <code class="constant">0.5</code>*al_ad(i, <code class="constant">1</code>)/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_modi255" target="origFile">q_ad(i, <code class="constant">0</code>) = q_ad(i, <code class="constant">0</code>) + (dya(i, <code class="constant">0</code>)*<code class="constant">2.</code>+dya(i, -<code class="constant">1</code>))*temp_ad</a>
          <a href="null_p.html#tp_core_modi255" target="origFile">q_ad(i, -<code class="constant">1</code>) = q_ad(i, -<code class="constant">1</code>) - dya(i, <code class="constant">0</code>)*temp_ad</a>
          <a href="null_p.html#tp_core_modi255" target="origFile">q_ad(i, <code class="constant">1</code>) = q_ad(i, <code class="constant">1</code>) + (dya(i, <code class="constant">1</code>)*<code class="constant">2.</code>+dya(i, <code class="constant">2</code>))*temp_ad0</a>
<a name="yppm0_admi78"></a>          <a href="null_p.html#tp_core_modi255" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) - dya(i, <code class="constant">1</code>)*temp_ad0</a>
          <a href="null_p.html#tp_core_modi255" target="origFile">al_ad(i, <code class="constant">1</code>) = <code class="constant">0.0</code></a>
          <a href="null_p.html#tp_core_modi256" target="origFile">q_ad(i, -<code class="constant">2</code>) = q_ad(i, -<code class="constant">2</code>) + c1*al_ad(i, <code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi256" target="origFile">q_ad(i, -<code class="constant">1</code>) = q_ad(i, -<code class="constant">1</code>) + c2*al_ad(i, <code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi256" target="origFile">q_ad(i, <code class="constant">0</code>) = q_ad(i, <code class="constant">0</code>) + c3*al_ad(i, <code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi256" target="origFile">al_ad(i, <code class="constant">0</code>) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="yppm0_admi75"></a> <a href="null_p.html#tp_core_mod" target="origFile"><code class="label">100  </code><code class="keyword">DO </code>j=je3,js1,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi249" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + p1*al_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi249" target="origFile">q_ad(i, j) = q_ad(i, j) + p1*al_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi249" target="origFile">q_ad(i, j-<code class="constant">2</code>) = q_ad(i, j-<code class="constant">2</code>) + p2*al_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi249" target="origFile">q_ad(i, j+<code class="constant">1</code>) = q_ad(i, j+<code class="constant">1</code>) + p2*al_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi249" target="origFile">al_ad(i, j) = <code class="constant">0.0</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="yppm0"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YPPM0_ADM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js1</code>, <code class="vardecl">je3</code>, <code class="vardecl">je1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">js1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">js1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npy - <code class="constant">2 </code>.GT. je + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">je3 = je + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">je3 = npy - <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">je1 = je + <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">je1 = npy - <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Nested grid OR Doubly periodic domain:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">js1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">je3 = je + <code class="constant">2</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">je1 = je + <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (jord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">abs0 = jord</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">abs0 = -jord</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a name="p37"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js1,je3</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="msg.html#p37" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, j) = p1*(q(i, j-<code class="constant">1</code>)+q(i, j)) + p2*(q(i, j-<code class="constant">2</code>)+q(i, j+<code class="constant">1</code>))</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p38"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="p39"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="msg.html#p38" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, <code class="constant">0</code>) = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
            <a href="msg.html#p39" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, <code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)<code class="label">&</code></a>
<a name="p40"></a><a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>*q(i, -<code class="constant">1</code>))/(dya(i, -<code class="constant">1</code>)+dya(i, <code class="constant">0</code>))+((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>)*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)))</a>
            <a href="msg.html#p40" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, <code class="constant">2</code>) = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p41"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a name="p42"></a>            <a href="msg.html#p41" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, npy-<code class="constant">1</code>) = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>-<code class="constant">1</code>)</a>
            <a href="msg.html#p42" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, npy) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>-<code class="constant">1</code>)-dya(i, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">2</code>)+dya(i, npy-<code class="constant">1</code><code class="label">&</code></a>
<a name="p43"></a><a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>))+((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy)*q<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>)))</a>
            <a href="msg.html#p43" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">al(i, npy+<code class="constant">1</code>) = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (jord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst-<code class="constant">1</code>,jlast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="null_p.html#tp_core_mod" target="origFile">bl(i, j) = al(i, j) - q(i, j)</a>
            <a href="null_p.html#tp_core_mod" target="origFile">br(i, j) = al(i, j+<code class="constant">1</code>) - q(i, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(bl(<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)+br(i, j)))</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="fxppm_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YPPM0</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of fxppm in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FXPPM_ADM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">flux</code>, <code class="vardecl">flux_ad</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi159" target="origFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_modi159" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi159" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi160" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi160" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi161" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null_p.html#tp_core_modi162" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi163" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi164" target="origFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null_p.html#tp_core_modi164" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi165" target="origFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_modi165" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_modi165" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">flux_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_modi166" target="origFile"><code class="comment">! Local</code></a>
    <a href="null_p.html#tp_core_modi166" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi167" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm1</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi168" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi169" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl_ad</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi170" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br_ad</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi171" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi172" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null_p.html#tp_core_modi173" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_modi174" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt_ad</code>, <code class="vardecl">x0l_ad</code>, <code class="vardecl">x0r_ad</code></a>
    <a href="null_p.html#tp_core_modi175" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">is3</code>, <code class="vardecl">ie3</code>, <code class="vardecl">it</code></a>
    <a href="null_p.html#tp_core_modi176" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_modi177" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi178" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi179" target="origFile">is3 = is - <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_modi178" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi180" target="origFile">is3 = <code class="constant">3</code></a>
    <a href="null_p.html#tp_core_modi178" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi181" target="origFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi182" target="origFile">ie3 = ie + <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_modi181" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi183" target="origFile">ie3 = npx - <code class="constant">3</code></a>
    <a href="null_p.html#tp_core_modi181" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi216" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
<a href="null_p.html#tp_core_modi188" target="origFile"><code class="comment">!--------------</code></a>
<a href="null_p.html#tp_core_modi188" target="origFile"><code class="comment">! fix the edges</code></a>
<a href="null_p.html#tp_core_modi188" target="origFile"><code class="comment">!--------------</code></a>
        <a href="null_p.html#tp_core_modi188" target="origFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi188" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi188" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi188" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi188" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi200" target="origFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi200" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi200" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_modi200" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
        <a href="null_p.html#tp_core_modi200" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi215" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi212" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi212" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi212" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi212" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi212" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi215" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi216" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi184" target="origFile">bl_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi184" target="origFile">br_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">DO </code>j=jlast,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">DO </code>i=ilast+<code class="constant">1</code>,ifirst,<code class="constant">-1</code></a>
<a name="fxppm_admi74"></a>          <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi214" target="origFile">temp_ad5 = (c(i, j)+<code class="constant">1.</code>)*flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi214" target="origFile">temp_ad6 = c(i, j)*temp_ad5</a>
            <a href="null_p.html#tp_core_modi214" target="origFile">q_ad(i, j) = q_ad(i, j) + flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi214" target="origFile">bl_ad(i) = bl_ad(i) + temp_ad6 + temp_ad5</a>
            <a href="null_p.html#tp_core_modi214" target="origFile">br_ad(i) = br_ad(i) + temp_ad6</a>
<a name="fxppm_admi73"></a>            <a href="null_p.html#tp_core_modi214" target="origFile">flux_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi213" target="origFile">temp_ad3 = (<code class="constant">1.</code>-c(i, j))*flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi213" target="origFile">temp_ad4 = -(c(i, j)*temp_ad3)</a>
            <a href="null_p.html#tp_core_modi213" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi213" target="origFile">br_ad(i-<code class="constant">1</code>) = br_ad(i-<code class="constant">1</code>) + temp_ad4 + temp_ad3</a>
            <a href="null_p.html#tp_core_modi213" target="origFile">bl_ad(i-<code class="constant">1</code>) = bl_ad(i-<code class="constant">1</code>) + temp_ad4</a>
            <a href="null_p.html#tp_core_modi213" target="origFile">flux_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END DO</code></a>
<a name="fxppm_admi62"></a>        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi201" target="origFile">xt_ad = br_ad(npx-<code class="constant">2</code>) + bl_ad(npx-<code class="constant">1</code>)</a>
<a name="fxppm_admi63"></a>          <a href="null_p.html#tp_core_modi201" target="origFile">q_ad(npx-<code class="constant">1</code>, j) = q_ad(npx-<code class="constant">1</code>, j) - bl_ad(npx-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi201" target="origFile">bl_ad(npx-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi64"></a>          <a href="null_p.html#tp_core_modi202" target="origFile">q_ad(npx-<code class="constant">2</code>, j) = q_ad(npx-<code class="constant">2</code>, j) - br_ad(npx-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi202" target="origFile">br_ad(npx-<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi203" target="origFile">q_ad(npx-<code class="constant">3</code>, j) = q_ad(npx-<code class="constant">3</code>, j) + c1*xt_ad</a>
<a name="fxppm_admi65"></a>          <a href="null_p.html#tp_core_modi203" target="origFile">q_ad(npx-<code class="constant">2</code>, j) = q_ad(npx-<code class="constant">2</code>, j) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi203" target="origFile">q_ad(npx-<code class="constant">1</code>, j) = q_ad(npx-<code class="constant">1</code>, j) + c3*xt_ad</a>
          <a href="null_p.html#tp_core_modi204" target="origFile">xt_ad = br_ad(npx)</a>
<a name="fxppm_admi66"></a>          <a href="null_p.html#tp_core_modi204" target="origFile">q_ad(npx, j) = q_ad(npx, j) + c3*xt_ad - br_ad(npx)</a>
          <a href="null_p.html#tp_core_modi204" target="origFile">br_ad(npx) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi67"></a>          <a href="null_p.html#tp_core_modi205" target="origFile">q_ad(npx+<code class="constant">1</code>, j) = q_ad(npx+<code class="constant">1</code>, j) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi205" target="origFile">q_ad(npx+<code class="constant">2</code>, j) = q_ad(npx+<code class="constant">2</code>, j) + c1*xt_ad</a>
          <a href="null_p.html#tp_core_modi206" target="origFile">xt_ad = br_ad(npx-<code class="constant">1</code>) + bl_ad(npx)</a>
<a name="fxppm_admi68"></a>          <a href="null_p.html#tp_core_modi206" target="origFile">q_ad(npx, j) = q_ad(npx, j) - bl_ad(npx)</a>
          <a href="null_p.html#tp_core_modi206" target="origFile">bl_ad(npx) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi69"></a>          <a href="null_p.html#tp_core_modi207" target="origFile">q_ad(npx-<code class="constant">1</code>, j) = q_ad(npx-<code class="constant">1</code>, j) - br_ad(npx-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi207" target="origFile">br_ad(npx-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi70"></a>          <a href="null_p.html#tp_core_modi208" target="origFile">x0l_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi208" target="origFile">x0r_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi209" target="origFile">q_ad(npx-<code class="constant">2</code>, j) = q_ad(npx-<code class="constant">2</code>, j) + (p1-<code class="constant">1.0</code>)*bl_ad(npx-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi209" target="origFile">q_ad(npx-<code class="constant">3</code>, j) = q_ad(npx-<code class="constant">3</code>, j) + p1*bl_ad(npx-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi209" target="origFile">q_ad(npx-<code class="constant">4</code>, j) = q_ad(npx-<code class="constant">4</code>, j) + p2*bl_ad(npx-<code class="constant">2</code>)</a>
<a name="fxppm_admi71"></a>          <a href="null_p.html#tp_core_modi209" target="origFile">q_ad(npx-<code class="constant">1</code>, j) = q_ad(npx-<code class="constant">1</code>, j) + p2*bl_ad(npx-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi209" target="origFile">bl_ad(npx-<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi210" target="origFile">temp_ad1 = <code class="constant">0.5</code>*x0r_ad/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_modi210" target="origFile">q_ad(npx, j) = q_ad(npx, j) + (dxa(npx, j)*<code class="constant">2.</code>+dxa(npx+<code class="constant">1</code>, j))*<code class="label">&</code></a>
<a name="fxppm_admi72"></a><a href="null_p.html#tp_core_modi210" target="origFile"><code class="label">&           </code>temp_ad1</a>
          <a href="null_p.html#tp_core_modi210" target="origFile">q_ad(npx+<code class="constant">1</code>, j) = q_ad(npx+<code class="constant">1</code>, j) - dxa(npx, j)*temp_ad1</a>
          <a href="null_p.html#tp_core_modi211" target="origFile">temp_ad2 = <code class="constant">0.5</code>*x0l_ad/(dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))</a>
          <a href="null_p.html#tp_core_modi211" target="origFile">q_ad(npx-<code class="constant">1</code>, j) = q_ad(npx-<code class="constant">1</code>, j) + (dxa(npx-<code class="constant">1</code>, j)*<code class="constant">2.</code>+dxa(npx-<code class="constant">2</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_modi211" target="origFile"><code class="label">&           </code>, j))*temp_ad2</a>
          <a href="null_p.html#tp_core_modi211" target="origFile">q_ad(npx-<code class="constant">2</code>, j) = q_ad(npx-<code class="constant">2</code>, j) - dxa(npx-<code class="constant">1</code>, j)*temp_ad2</a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END IF</code></a>
<a name="fxppm_admi51"></a>        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_modi189" target="origFile">xt_ad = br_ad(<code class="constant">1</code>) + bl_ad(<code class="constant">2</code>)</a>
<a name="fxppm_admi52"></a>          <a href="null_p.html#tp_core_modi189" target="origFile">q_ad(<code class="constant">2</code>, j) = q_ad(<code class="constant">2</code>, j) - bl_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi189" target="origFile">bl_ad(<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi53"></a>          <a href="null_p.html#tp_core_modi190" target="origFile">q_ad(<code class="constant">1</code>, j) = q_ad(<code class="constant">1</code>, j) + c3*xt_ad - br_ad(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi190" target="origFile">br_ad(<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi54"></a>          <a href="null_p.html#tp_core_modi191" target="origFile">q_ad(<code class="constant">2</code>, j) = q_ad(<code class="constant">2</code>, j) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi191" target="origFile">q_ad(<code class="constant">3</code>, j) = q_ad(<code class="constant">3</code>, j) + c1*xt_ad</a>
          <a href="null_p.html#tp_core_modi192" target="origFile">xt_ad = bl_ad(<code class="constant">0</code>)</a>
<a name="fxppm_admi55"></a>          <a href="null_p.html#tp_core_modi192" target="origFile">q_ad(<code class="constant">0</code>, j) = q_ad(<code class="constant">0</code>, j) - bl_ad(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi192" target="origFile">bl_ad(<code class="constant">0</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi193" target="origFile">q_ad(-<code class="constant">2</code>, j) = q_ad(-<code class="constant">2</code>, j) + c1*xt_ad</a>
<a name="fxppm_admi56"></a>          <a href="null_p.html#tp_core_modi193" target="origFile">q_ad(-<code class="constant">1</code>, j) = q_ad(-<code class="constant">1</code>, j) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi193" target="origFile">q_ad(<code class="constant">0</code>, j) = q_ad(<code class="constant">0</code>, j) + c3*xt_ad - br_ad(<code class="constant">0</code>)</a>
<a name="fxppm_admi57"></a>          <a href="null_p.html#tp_core_modi194" target="origFile">xt_ad = bl_ad(<code class="constant">1</code>) + br_ad(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi194" target="origFile">br_ad(<code class="constant">0</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi58"></a>          <a href="null_p.html#tp_core_modi195" target="origFile">q_ad(<code class="constant">1</code>, j) = q_ad(<code class="constant">1</code>, j) - bl_ad(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi195" target="origFile">bl_ad(<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fxppm_admi59"></a>          <a href="null_p.html#tp_core_modi196" target="origFile">x0l_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi196" target="origFile">x0r_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi197" target="origFile">q_ad(<code class="constant">2</code>, j) = q_ad(<code class="constant">2</code>, j) + (p1-<code class="constant">1.0</code>)*br_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi197" target="origFile">q_ad(<code class="constant">3</code>, j) = q_ad(<code class="constant">3</code>, j) + p1*br_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi197" target="origFile">q_ad(<code class="constant">1</code>, j) = q_ad(<code class="constant">1</code>, j) + p2*br_ad(<code class="constant">2</code>)</a>
<a name="fxppm_admi60"></a>          <a href="null_p.html#tp_core_modi197" target="origFile">q_ad(<code class="constant">4</code>, j) = q_ad(<code class="constant">4</code>, j) + p2*br_ad(<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi197" target="origFile">br_ad(<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi198" target="origFile">temp_ad = <code class="constant">0.5</code>*x0r_ad/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))</a>
<a name="fxppm_admi61"></a>          <a href="null_p.html#tp_core_modi198" target="origFile">q_ad(<code class="constant">1</code>, j) = q_ad(<code class="constant">1</code>, j) + (dxa(<code class="constant">1</code>, j)*<code class="constant">2.</code>+dxa(<code class="constant">2</code>, j))*temp_ad</a>
          <a href="null_p.html#tp_core_modi198" target="origFile">q_ad(<code class="constant">2</code>, j) = q_ad(<code class="constant">2</code>, j) - dxa(<code class="constant">1</code>, j)*temp_ad</a>
          <a href="null_p.html#tp_core_modi199" target="origFile">temp_ad0 = <code class="constant">0.5</code>*x0l_ad/(dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_modi199" target="origFile">q_ad(<code class="constant">0</code>, j) = q_ad(<code class="constant">0</code>, j) + (dxa(<code class="constant">0</code>, j)*<code class="constant">2.</code>+dxa(-<code class="constant">1</code>, j))*temp_ad0</a>
          <a href="null_p.html#tp_core_modi199" target="origFile">q_ad(-<code class="constant">1</code>, j) = q_ad(-<code class="constant">1</code>, j) - dxa(<code class="constant">0</code>, j)*temp_ad0</a>
<a name="fxppm_admi49"></a>        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">DO </code>i=ie3,is3,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi185" target="origFile">q_ad(i-<code class="constant">2</code>, j) = q_ad(i-<code class="constant">2</code>, j) + b1*br_ad(i)</a>
          <a href="null_p.html#tp_core_modi185" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + b2*br_ad(i)</a>
          <a href="null_p.html#tp_core_modi185" target="origFile">q_ad(i, j) = q_ad(i, j) + b3*br_ad(i)</a>
          <a href="null_p.html#tp_core_modi185" target="origFile">q_ad(i+<code class="constant">1</code>, j) = q_ad(i+<code class="constant">1</code>, j) + b4*br_ad(i)</a>
<a name="fxppm_admi50"></a>          <a href="null_p.html#tp_core_modi185" target="origFile">q_ad(i+<code class="constant">2</code>, j) = q_ad(i+<code class="constant">2</code>, j) + b5*br_ad(i)</a>
          <a href="null_p.html#tp_core_modi185" target="origFile">br_ad(i) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi186" target="origFile">q_ad(i-<code class="constant">2</code>, j) = q_ad(i-<code class="constant">2</code>, j) + b5*bl_ad(i)</a>
          <a href="null_p.html#tp_core_modi186" target="origFile">q_ad(i-<code class="constant">1</code>, j) = q_ad(i-<code class="constant">1</code>, j) + b4*bl_ad(i)</a>
          <a href="null_p.html#tp_core_modi186" target="origFile">q_ad(i, j) = q_ad(i, j) + b3*bl_ad(i)</a>
          <a href="null_p.html#tp_core_modi186" target="origFile">q_ad(i+<code class="constant">1</code>, j) = q_ad(i+<code class="constant">1</code>, j) + b2*bl_ad(i)</a>
          <a href="null_p.html#tp_core_modi186" target="origFile">q_ad(i+<code class="constant">2</code>, j) = q_ad(i+<code class="constant">2</code>, j) + b1*bl_ad(i)</a>
          <a href="null_p.html#tp_core_modi186" target="origFile">bl_ad(i) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END DO</code></a>
<a name="fxppm"></a>    <a href="null_p.html#tp_core_modi184" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FXPPM_ADM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FXPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm1</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">is3</code>, <code class="vardecl">ie3</code>, <code class="vardecl">it</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">x0 = big_number</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">is3 = is - <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">is3 = <code class="constant">3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ie3 = ie + <code class="constant">1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">ie3 = npx - <code class="constant">3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is3,ie3</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i) = b5*q(i-<code class="constant">2</code>, j) + b4*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b2*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>) + b1*q(i+<code class="constant">2</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i) = b1*q(i-<code class="constant">2</code>, j) + b2*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b4*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>) + b5*q(i+<code class="constant">2</code>, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!--------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! fix the edges</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!--------------</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q(<code class="constant">0</code>, j)-dxa(<code class="constant">0</code>, j)*q(-<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>))/(dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q(<code class="constant">1</code>, j)-dxa(<code class="constant">1</code>, j)*q(<code class="constant">2</code>, j))<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(<code class="constant">2</code>) = p1*(q(<code class="constant">2</code>, j)+q(<code class="constant">3</code>, j)) + p2*(q(<code class="constant">1</code>, j)+q(<code class="constant">4</code>, j)) - q(<code class="constant">2</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = x0l + x0r</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c1*q(-<code class="constant">2</code>, j) + c2*q(-<code class="constant">1</code>, j) + c3*q(<code class="constant">0</code>, j)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = max( xt, min(q(-1,j),q(0,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = min( xt, max(q(-1,j),q(0,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c3*q(<code class="constant">1</code>, j) + c2*q(<code class="constant">2</code>, j) + c1*q(<code class="constant">3</code>, j)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = max( xt, min(q(1,j),q(2,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = min( xt, max(q(1,j),q(2,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(<code class="constant">2</code>) = xt - q(<code class="constant">2</code>, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q(npx-<code class="constant">1</code>, j)-dxa(<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)*q(npx-<code class="constant">2</code>, j))/(dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q(npx, j)-dxa(npx, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)*q(npx+<code class="constant">1</code>, j))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(npx-<code class="constant">2</code>) = p1*(q(npx-<code class="constant">2</code>, j)+q(npx-<code class="constant">3</code>, j)) + p2*(q(npx-<code class="constant">4</code>, j)+q(<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)) - q(npx-<code class="constant">2</code>, j)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = x0L*sin_sg(npx-1,j,3) + x0R*sin_sg(npx,j,1)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = 2.*xt / (sin_sg(npx,j,1) + sin_sg(npx-1,j,3))</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = x0l + x0r</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(npx) = xt - q(npx, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c3*q(npx, j) + c2*q(npx+<code class="constant">1</code>, j) + c1*q(npx+<code class="constant">2</code>, j)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = max( xt, min(q(npx,j),q(npx+1,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = min( xt, max(q(npx,j),q(npx+1,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(npx) = xt - q(npx, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c1*q(npx-<code class="constant">3</code>, j) + c2*q(npx-<code class="constant">2</code>, j) + c3*q(npx-<code class="constant">1</code>, j)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = max( xt, min(q(npx-2,j),q(npx-1,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!             xt = min( xt, max(q(npx-2,j),q(npx-1,j)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(npx-<code class="constant">2</code>) = xt - q(npx-<code class="constant">2</code>, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i-<code class="constant">1</code>, j) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>-<code class="constant">1</code>)+br(i-<code class="constant">1</code>)))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>(i)))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="fyppm_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FXPPM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of fyppm in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q flux</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FYPPM_ADM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">flux</code>, <code class="vardecl">flux_ad</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi97" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi97" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_modi98" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_modi98" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_modi99" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_modi100" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi101" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_modi102" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_modi102" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi103" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_modi103" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">flux_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi104" target="origFile"><code class="comment">! real(FVPRC)   , INTENT(OUT)::   dm(ifirst:ilast,jfirst-2:jlast+2)</code></a>
<a href="null_p.html#tp_core_modi104" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_modi104" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi105" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi106" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi107" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br_ad</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi108" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_modi109" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null_p.html#tp_core_modi110" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_modi111" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x0</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt_ad</code>, <code class="vardecl">x0l_ad</code>, <code class="vardecl">x0r_ad</code></a>
    <a href="null_p.html#tp_core_modi112" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js3</code>, <code class="vardecl">je3</code>, <code class="vardecl">jt</code></a>
    <a href="null_p.html#tp_core_modi113" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_modi114" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_modi115" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">max1</code></a>
    <a href="null_p.html#tp_core_modi116" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">min1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi118" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi119" target="origFile">max1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi118" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi120" target="origFile">max1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_modi118" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi121" target="origFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi122" target="origFile">min1 = je + <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_modi121" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi123" target="origFile">min1 = npy - <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_modi121" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi128" target="origFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi128" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi128" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi128" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi128" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi141" target="origFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi141" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi141" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_modi141" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi141" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi158" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_modi157" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_modi154" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi154" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi154" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi154" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi154" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi157" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi158" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile">bl_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile">br_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>j=jlast+<code class="constant">1</code>,jfirst,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
<a name="fyppm_admi48"></a>          <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
          <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_modi156" target="origFile">temp_ad5 = (c(i, j)+<code class="constant">1.</code>)*flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi156" target="origFile">temp_ad6 = c(i, j)*temp_ad5</a>
            <a href="null_p.html#tp_core_modi156" target="origFile">q_ad(i, j) = q_ad(i, j) + flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi156" target="origFile">bl_ad(i, j) = bl_ad(i, j) + temp_ad6 + temp_ad5</a>
            <a href="null_p.html#tp_core_modi156" target="origFile">br_ad(i, j) = br_ad(i, j) + temp_ad6</a>
<a name="fyppm_admi47"></a>            <a href="null_p.html#tp_core_modi156" target="origFile">flux_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_modi155" target="origFile">temp_ad3 = (<code class="constant">1.</code>-c(i, j))*flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi155" target="origFile">temp_ad4 = -(c(i, j)*temp_ad3)</a>
            <a href="null_p.html#tp_core_modi155" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + flux_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi155" target="origFile">br_ad(i, j-<code class="constant">1</code>) = br_ad(i, j-<code class="constant">1</code>) + temp_ad4 + temp_ad3</a>
            <a href="null_p.html#tp_core_modi155" target="origFile">bl_ad(i, j-<code class="constant">1</code>) = bl_ad(i, j-<code class="constant">1</code>) + temp_ad4</a>
            <a href="null_p.html#tp_core_modi155" target="origFile">flux_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="fyppm_admi36"></a>      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi142" target="origFile">xt_ad = br_ad(i, npy-<code class="constant">2</code>) + bl_ad(i, npy-<code class="constant">1</code>)</a>
<a name="fyppm_admi37"></a>          <a href="null_p.html#tp_core_modi142" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) - bl_ad(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi142" target="origFile">bl_ad(i, npy-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi38"></a>          <a href="null_p.html#tp_core_modi143" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) - br_ad(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi143" target="origFile">br_ad(i, npy-<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi144" target="origFile">q_ad(i, npy-<code class="constant">3</code>) = q_ad(i, npy-<code class="constant">3</code>) + c1*xt_ad</a>
<a name="fyppm_admi39"></a>          <a href="null_p.html#tp_core_modi144" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi144" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) + c3*xt_ad</a>
          <a href="null_p.html#tp_core_modi145" target="origFile">xt_ad = br_ad(i, npy)</a>
<a name="fyppm_admi40"></a>          <a href="null_p.html#tp_core_modi145" target="origFile">q_ad(i, npy) = q_ad(i, npy) + c3*xt_ad - br_ad(i, npy)</a>
          <a href="null_p.html#tp_core_modi145" target="origFile">br_ad(i, npy) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi41"></a>          <a href="null_p.html#tp_core_modi146" target="origFile">q_ad(i, npy+<code class="constant">1</code>) = q_ad(i, npy+<code class="constant">1</code>) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi146" target="origFile">q_ad(i, npy+<code class="constant">2</code>) = q_ad(i, npy+<code class="constant">2</code>) + c1*xt_ad</a>
          <a href="null_p.html#tp_core_modi147" target="origFile">xt_ad = br_ad(i, npy-<code class="constant">1</code>) + bl_ad(i, npy)</a>
<a name="fyppm_admi42"></a>          <a href="null_p.html#tp_core_modi147" target="origFile">q_ad(i, npy) = q_ad(i, npy) - bl_ad(i, npy)</a>
          <a href="null_p.html#tp_core_modi147" target="origFile">bl_ad(i, npy) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi43"></a>          <a href="null_p.html#tp_core_modi148" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) - br_ad(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi148" target="origFile">br_ad(i, npy-<code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi44"></a>          <a href="null_p.html#tp_core_modi149" target="origFile">x0l_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi149" target="origFile">x0r_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi150" target="origFile">temp_ad1 = <code class="constant">0.5</code>*x0r_ad/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_modi150" target="origFile">q_ad(i, npy) = q_ad(i, npy) + (dya(i, npy)*<code class="constant">2.</code>+dya(i, npy+<code class="constant">1</code>))*<code class="label">&</code></a>
<a name="fyppm_admi45"></a><a href="null_p.html#tp_core_modi150" target="origFile"><code class="label">&           </code>temp_ad1</a>
          <a href="null_p.html#tp_core_modi150" target="origFile">q_ad(i, npy+<code class="constant">1</code>) = q_ad(i, npy+<code class="constant">1</code>) - dya(i, npy)*temp_ad1</a>
          <a href="null_p.html#tp_core_modi151" target="origFile">temp_ad2 = <code class="constant">0.5</code>*x0l_ad/(dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_modi151" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) + (dya(i, npy-<code class="constant">1</code>)*<code class="constant">2.</code>+dya(i, npy<code class="label">&</code></a>
<a name="fyppm_admi46"></a><a href="null_p.html#tp_core_modi151" target="origFile"><code class="label">&           </code>-<code class="constant">2</code>))*temp_ad2</a>
          <a href="null_p.html#tp_core_modi151" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) - dya(i, npy-<code class="constant">1</code>)*temp_ad2</a>
          <a href="null_p.html#tp_core_modi152" target="origFile">q_ad(i, npy-<code class="constant">3</code>) = q_ad(i, npy-<code class="constant">3</code>) + p1*bl_ad(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi152" target="origFile">q_ad(i, npy-<code class="constant">2</code>) = q_ad(i, npy-<code class="constant">2</code>) + (p1-<code class="constant">1.0</code>)*bl_ad(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi152" target="origFile">q_ad(i, npy-<code class="constant">4</code>) = q_ad(i, npy-<code class="constant">4</code>) + p2*bl_ad(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi152" target="origFile">q_ad(i, npy-<code class="constant">1</code>) = q_ad(i, npy-<code class="constant">1</code>) + p2*bl_ad(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi152" target="origFile">bl_ad(i, npy-<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
<a name="fyppm_admi25"></a>      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi129" target="origFile">xt_ad = br_ad(i, <code class="constant">1</code>) + bl_ad(i, <code class="constant">2</code>)</a>
<a name="fyppm_admi26"></a>          <a href="null_p.html#tp_core_modi129" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) - bl_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi129" target="origFile">bl_ad(i, <code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi27"></a>          <a href="null_p.html#tp_core_modi130" target="origFile">q_ad(i, <code class="constant">1</code>) = q_ad(i, <code class="constant">1</code>) + c3*xt_ad - br_ad(i, <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi130" target="origFile">br_ad(i, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi28"></a>          <a href="null_p.html#tp_core_modi131" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi131" target="origFile">q_ad(i, <code class="constant">3</code>) = q_ad(i, <code class="constant">3</code>) + c1*xt_ad</a>
          <a href="null_p.html#tp_core_modi132" target="origFile">xt_ad = bl_ad(i, <code class="constant">0</code>)</a>
<a name="fyppm_admi29"></a>          <a href="null_p.html#tp_core_modi132" target="origFile">q_ad(i, <code class="constant">0</code>) = q_ad(i, <code class="constant">0</code>) - bl_ad(i, <code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi132" target="origFile">bl_ad(i, <code class="constant">0</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi133" target="origFile">q_ad(i, -<code class="constant">2</code>) = q_ad(i, -<code class="constant">2</code>) + c1*xt_ad</a>
<a name="fyppm_admi30"></a>          <a href="null_p.html#tp_core_modi133" target="origFile">q_ad(i, -<code class="constant">1</code>) = q_ad(i, -<code class="constant">1</code>) + c2*xt_ad</a>
          <a href="null_p.html#tp_core_modi133" target="origFile">q_ad(i, <code class="constant">0</code>) = q_ad(i, <code class="constant">0</code>) + c3*xt_ad - br_ad(i, <code class="constant">0</code>)</a>
<a name="fyppm_admi32"></a>          <a href="null_p.html#tp_core_modi134" target="origFile">xt_ad = bl_ad(i, <code class="constant">1</code>) + br_ad(i, <code class="constant">0</code>)</a>
          <a href="null_p.html#tp_core_modi134" target="origFile">br_ad(i, <code class="constant">0</code>) = <code class="constant">0.0_8</code></a>
<a name="fyppm_admi33"></a>          <a href="null_p.html#tp_core_modi136" target="origFile">x0l_ad = xt_ad</a>
<a name="fyppm_admi31"></a>          <a href="null_p.html#tp_core_modi136" target="origFile">x0r_ad = xt_ad</a>
          <a href="null_p.html#tp_core_modi137" target="origFile">temp_ad = <code class="constant">0.5</code>*x0r_ad/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_modi135" target="origFile">q_ad(i, <code class="constant">1</code>) = q_ad(i, <code class="constant">1</code>) + (dya(i, <code class="constant">1</code>)*<code class="constant">2.</code>+dya(i, <code class="constant">2</code>))*temp_ad - <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi135" target="origFile"><code class="label">&           </code>bl_ad(i, <code class="constant">1</code>)</a>
<a name="fyppm_admi34"></a>          <a href="null_p.html#tp_core_modi135" target="origFile">bl_ad(i, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi137" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) - dya(i, <code class="constant">1</code>)*temp_ad</a>
          <a href="null_p.html#tp_core_modi138" target="origFile">temp_ad0 = <code class="constant">0.5</code>*x0l_ad/(dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))</a>
<a name="fyppm_admi35"></a>          <a href="null_p.html#tp_core_modi138" target="origFile">q_ad(i, <code class="constant">0</code>) = q_ad(i, <code class="constant">0</code>) + (dya(i, <code class="constant">0</code>)*<code class="constant">2.</code>+dya(i, -<code class="constant">1</code>))*temp_ad0</a>
          <a href="null_p.html#tp_core_modi138" target="origFile">q_ad(i, -<code class="constant">1</code>) = q_ad(i, -<code class="constant">1</code>) - dya(i, <code class="constant">0</code>)*temp_ad0</a>
          <a href="null_p.html#tp_core_modi139" target="origFile">q_ad(i, <code class="constant">2</code>) = q_ad(i, <code class="constant">2</code>) + (p1-<code class="constant">1.0</code>)*br_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi139" target="origFile">q_ad(i, <code class="constant">3</code>) = q_ad(i, <code class="constant">3</code>) + p1*br_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi139" target="origFile">q_ad(i, <code class="constant">1</code>) = q_ad(i, <code class="constant">1</code>) + p2*br_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi139" target="origFile">q_ad(i, <code class="constant">4</code>) = q_ad(i, <code class="constant">4</code>) + p2*br_ad(i, <code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_modi139" target="origFile">br_ad(i, <code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END IF</code></a>
<a name="fyppm_admi23"></a>      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>j=min1,max1,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">DO </code>i=ilast,ifirst,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi124" target="origFile">q_ad(i, j-<code class="constant">2</code>) = q_ad(i, j-<code class="constant">2</code>) + b1*br_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi124" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + b2*br_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi124" target="origFile">q_ad(i, j) = q_ad(i, j) + b3*br_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi124" target="origFile">q_ad(i, j+<code class="constant">1</code>) = q_ad(i, j+<code class="constant">1</code>) + b4*br_ad(i, j)</a>
<a name="fyppm_admi24"></a>          <a href="null_p.html#tp_core_modi124" target="origFile">q_ad(i, j+<code class="constant">2</code>) = q_ad(i, j+<code class="constant">2</code>) + b5*br_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi124" target="origFile">br_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_modi125" target="origFile">q_ad(i, j-<code class="constant">2</code>) = q_ad(i, j-<code class="constant">2</code>) + b5*bl_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi125" target="origFile">q_ad(i, j-<code class="constant">1</code>) = q_ad(i, j-<code class="constant">1</code>) + b4*bl_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi125" target="origFile">q_ad(i, j) = q_ad(i, j) + b3*bl_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi125" target="origFile">q_ad(i, j+<code class="constant">1</code>) = q_ad(i, j+<code class="constant">1</code>) + b2*bl_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi125" target="origFile">q_ad(i, j+<code class="constant">2</code>) = q_ad(i, j+<code class="constant">2</code>) + b1*bl_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi125" target="origFile">bl_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END DO</code></a>
<a name="fyppm"></a>    <a href="null_p.html#tp_core_modi117" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FYPPM_ADM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FYPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Courant number</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Flux</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! real(FVPRC)   , INTENT(OUT)::   dm(ifirst:ilast,jfirst-2:jlast+2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x0</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js3</code>, <code class="vardecl">je3</code>, <code class="vardecl">jt</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">max1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">min1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">max1 = js - <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">max1 = <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">min1 = je + <code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">min1 = npy - <code class="constant">3</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=max1,min1</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, j) = b5*q(i, j-<code class="constant">2</code>) + b4*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b2*q(i, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b1*q(i, j+<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, j) = b1*q(i, j-<code class="constant">2</code>) + b2*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b4*q(i, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b5*q(i, j+<code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           br(i,2) = al(i,3) - q(i,2)</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, <code class="constant">2</code>) = p1*(q(i, <code class="constant">2</code>)+q(i, <code class="constant">3</code>)) + p2*(q(i, <code class="constant">1</code>)+q(i, <code class="constant">4</code>)) - q(i, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code><code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)*q(i, -<code class="constant">1</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>))/(dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = x0l + x0r</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = ( x0L*sin_sg(i,0,4) + x0R*sin_sg(i,1,2) ) </code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = 2.*xt / ( sin_sg(i,0,4) + sin_sg(i,1,2) )</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           xt = s14*0.25*(q(i,0)-q(i,-2)) - s11*(q(i,0)-q(i,-1)) + q(i,0)</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = min( xt, max(q(i,-1), q(i,0)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = max( xt, min(q(i,-1), q(i,0)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           xt = s15*q(i,1) + s11*q(i,2) - s14*0.25*(q(i,3)-q(i,1))</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = min( xt, max(q(i,1), q(i,2)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = max( xt, min(q(i,1), q(i,2)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, <code class="constant">2</code>) = xt - q(i, <code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           bl(i,npy-2) = al(i,npy-2) - q(i,npy-2)</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, npy-<code class="constant">2</code>) = p1*(q(i, npy-<code class="constant">3</code>)+q(i, npy-<code class="constant">2</code>)) + p2*(q(i, npy-<code class="constant">4</code>)+<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>q(i, npy-<code class="constant">1</code>)) - q(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy-<code class="constant">1</code>)-dya(i<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)*q(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = x0l + x0r</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = x0L*sin_sg(i,npy-1,4) + x0R*sin_sg(i,npy,2)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = 2.*xt /( sin_sg(i,npy-1,4) + sin_sg(i,npy,2) )</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, npy) = xt - q(i, npy)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           xt = s11*(q(i,npy+1)-q(i,npy)) - s14*0.25*(q(i,npy+2)-q(i,npy)) + q(i,npy)</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = min( xt, max(q(i,npy), q(i,npy+1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = max( xt, min(q(i,npy), q(i,npy+1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, npy) = xt - q(i, npy)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!           xt = s15*q(i,npy-1) + s11*q(i,npy-2) + s14*0.25*(q(i,npy-1)-q(i,npy-3))</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">xt = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy-<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = min( xt, max(q(i,npy-2), q(i,npy-1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!            xt = max( xt, min(q(i,npy-2), q(i,npy-1)) )</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!#endif</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">br(i, npy-<code class="constant">2</code>) = xt - q(i, npy-<code class="constant">2</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">bl(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>bl(i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>, j)+br(i, j)))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="mp_ghost_ew"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FYPPM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code>(<code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">kfirst</code>, <code class="vardecl">klast</code>, <code class="vardecl">ng_w</code>, <code class="vardecl">ng_e</code>, <code class="vardecl">ng_s</code>, <code class="vardecl">ng_n</code>, <code class="vardecl">q_ghst</code>, <code class="vardecl">q</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kfirst</code>, <code class="vardecl">klast</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! eastern  zones to ghost</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_e</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! western  zones to ghost</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_w</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! southern zones to ghost</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_s</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! northern zones to ghost</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_n</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q_ghst</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng_w</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng_e</code>, <code class="vardecl">jfirst</code>-<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">ng_s</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng_n</code>, <code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code><code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!     Ghost 4d east/west </code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!    2005.08.22   Putman</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!EOP</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!------------------------------------------------------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!BOC</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">n</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(q)) q_ghst(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&     </code>nq) = q(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:nq)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!      Assume Periodicity in X-dir and not overlapping</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nq</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>k=kfirst,klast</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=jfirst-ng_s,jlast+ng_n</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_w</a>
            <a href="null_p.html#tp_core_mod" target="origFile">q_ghst(ifirst-i, j, k, n) = q_ghst(ilast-i+<code class="constant">1</code>, j, k, n)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_e</a>
            <a href="null_p.html#tp_core_mod" target="origFile">q_ghst(ilast+i, j, k, n) = q_ghst(ifirst+i-<code class="constant">1</code>, j, k, n)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="pert_ppm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">PERT_PPM</code>(<code class="vardecl">im</code>, <code class="vardecl">a0</code>, <code class="vardecl">al</code>, <code class="vardecl">ar</code>, <code class="vardecl">iv</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iv</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">a0</code>(<code class="vardecl">im</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">al</code>(<code class="vardecl">im</code>), <code class="vardecl">ar</code>(<code class="vardecl">im</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">a4</code>, <code class="vardecl">da1</code>, <code class="vardecl">da2</code>, <code class="vardecl">a6da</code>, <code class="vardecl">fmin</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r12</code>=<code class="constant">1.</code>/<code class="constant">12.</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs0</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!-----------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Optimized PPM in perturbation form:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!-----------------------------------</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (iv .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Positive definite constraint</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (a0(i) .LE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">al(i) = <code class="constant">0.</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">a4 = -(<code class="constant">3.</code>*(ar(i)+al(i)))</a>
          <a href="null_p.html#tp_core_mod" target="origFile">da1 = ar(i) - al(i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (da1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">abs0 = da1</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">abs0 = -da1</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (abs0 .LT. -a4) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fmin = a0(i) + <code class="constant">0.25</code>/a4*da1**<code class="constant">2 </code>+ a4*r12</a>
            <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (fmin .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
              <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (ar(i) .GT. <code class="constant">0. </code>.AND. al(i) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null_p.html#tp_core_mod" target="origFile">ar(i) = <code class="constant">0.</code></a>
                <a href="null_p.html#tp_core_mod" target="origFile">al(i) = <code class="constant">0.</code></a>
              <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (da1 .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null_p.html#tp_core_mod" target="origFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
              <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
                <a href="null_p.html#tp_core_mod" target="origFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
              <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Standard PPM constraint</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (al(i)*ar(i) .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">da1 = al(i) - ar(i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile">da2 = da1**<code class="constant">2</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">a6da = <code class="constant">3.</code>*(al(i)+ar(i))*da1</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (a6da .LT. -da2) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (a6da .GT. da2) <code class="keyword">THEN</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! effect of dm=0 included here</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">al(i) = <code class="constant">0.</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="deln_flux_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">PERT_PPM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of deln_flux in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q fx fy</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q fx fy</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DELN_FLUX_ADM</code>(<code class="vardecl">nord</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">damp</code>, <code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">fx</code>, <code class="vardecl">fx_ad</code>, <code class="vardecl">fy</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code>, <code class="vardecl">fy_ad</code>, <code class="vardecl">mass</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! Del-n damping for the cell-mean values (A grid)</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">!------------------</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! nord = 0:   del-2</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! nord = 1:   del-4</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! nord = 2:   del-6</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! nord = 3:   del-8 --&gt; requires more ghosting than current</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">!------------------</code></a>
<a href="null_p.html#tp_core_modi37" target="origFile"><code class="comment">! del-n</code></a>
    <a href="null_p.html#tp_core_modi37" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
    <a href="null_p.html#tp_core_modi38" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_modi39" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp</code></a>
<a href="null_p.html#tp_core_modi40" target="origFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null_p.html#tp_core_modi40" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">is</code>-<code class="vardecl">ng</code>:<code class="vardecl">ie</code>+<code class="vardecl">ng</code>, <code class="vardecl">js</code>-<code class="vardecl">ng</code>:<code class="vardecl">je</code>+<code class="vardecl">ng</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">is</code>-<code class="vardecl">ng</code>:<code class="vardecl">ie</code>+<code class="vardecl">ng</code>, <code class="vardecl">js</code>-<code class="vardecl">ng</code>:<code class="vardecl">je</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_modi41" target="origFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null_p.html#tp_core_modi41" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_modi42" target="origFile"><code class="comment">! diffusive fluxes:</code></a>
    <a href="null_p.html#tp_core_modi42" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>), <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">fx_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>), <code class="vardecl">fy_ad</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_modi43" target="origFile"><code class="comment">! local:</code></a>
    <a href="null_p.html#tp_core_modi43" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>), <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>), <code class="vardecl">fy2_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>+<code class="constant">1</code><code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&   </code>)</a>
    <a href="null_p.html#tp_core_modi44" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">d2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">d2_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi45" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp2</code></a>
    <a href="null_p.html#tp_core_modi46" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">n</code>, <code class="vardecl">nt</code>, <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">j1</code>, <code class="vardecl">j2</code></a>
    <a href="null_p.html#tp_core_modi47" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">temp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_from4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ad_to4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
    <a href="null_p.html#tp_core_modi48" target="origFile">i1 = is - <code class="constant">1 </code>- nord</a>
    <a href="null_p.html#tp_core_modi49" target="origFile">i2 = ie + <code class="constant">1 </code>+ nord</a>
    <a href="null_p.html#tp_core_modi50" target="origFile">j1 = js - <code class="constant">1 </code>- nord</a>
    <a href="null_p.html#tp_core_modi51" target="origFile">j2 = je + <code class="constant">1 </code>+ nord</a>
    <a href="null_p.html#tp_core_modi52" target="origFile"><code class="keyword">IF</code> (.NOT.<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi52" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi52" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi52" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi52" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi59" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi59" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi59" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi59" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi59" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi64" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_modi64" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi64" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi64" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi64" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_modi69" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi82" target="origFile"><code class="comment">!----------</code></a>
<a href="null_p.html#tp_core_modi82" target="origFile"><code class="comment">! high-order</code></a>
<a href="null_p.html#tp_core_modi82" target="origFile"><code class="comment">!----------</code></a>
      <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nord</a>
        <a href="null_p.html#tp_core_modi70" target="origFile">nt = nord - n</a>
        <a href="null_p.html#tp_core_modi82" target="origFile">ad_from0 = js - nt - <code class="constant">1</code></a>
        <a href="null_p.html#tp_core_modi73" target="origFile"><code class="keyword">DO </code>j=ad_from0,je+nt+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi73" target="origFile">ad_from = is - nt - <code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi73" target="origFile">i = ie + nt + <code class="constant">2</code></a>
          <a href="null_p.html#tp_core_modi73" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(i - <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi73" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from)</a>
        <a href="null_p.html#tp_core_modi73" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(j - <code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from0)</a>
        <a href="null_p.html#tp_core_modi82" target="origFile">ad_from2 = js - nt</a>
        <a href="null_p.html#tp_core_modi77" target="origFile"><code class="keyword">DO </code>j=ad_from2,je+nt</a>
          <a href="null_p.html#tp_core_modi77" target="origFile">ad_from1 = is - nt</a>
          <a href="null_p.html#tp_core_modi77" target="origFile">i = ie + nt + <code class="constant">2</code></a>
          <a href="null_p.html#tp_core_modi77" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(i - <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi77" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from1)</a>
        <a href="null_p.html#tp_core_modi77" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(j - <code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from2)</a>
        <a href="null_p.html#tp_core_modi82" target="origFile">ad_from4 = js - nt</a>
        <a href="null_p.html#tp_core_modi81" target="origFile"><code class="keyword">DO </code>j=ad_from4,je+nt+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi81" target="origFile">ad_from3 = is - nt</a>
          <a href="null_p.html#tp_core_modi81" target="origFile">i = ie + nt + <code class="constant">1</code></a>
          <a href="null_p.html#tp_core_modi81" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(i - <code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_modi81" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from3)</a>
        <a href="null_p.html#tp_core_modi81" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(j - <code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHINTEGER4</code>(ad_from4)</a>
      <a href="null_p.html#tp_core_modi82" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi69" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
    <a href="null_p.html#tp_core_modi69" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi69" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_modi69" target="origFile"><code class="keyword">END IF</code></a>
<a href="null_p.html#tp_core_modi83" target="origFile"><code class="comment">!---------------------------------------------</code></a>
<a href="null_p.html#tp_core_modi83" target="origFile"><code class="comment">! Add the diffusive fluxes to the flux arrays:</code></a>
<a href="null_p.html#tp_core_modi83" target="origFile"><code class="comment">!---------------------------------------------</code></a>
    <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi84" target="origFile"><code class="comment">! Apply mass weighting to diffusive fluxes:</code></a>
      <a href="null_p.html#tp_core_modi84" target="origFile">damp2 = <code class="constant">0.5</code>*damp</a>
      <a href="null_p.html#tp_core_modi83" target="origFile">fy2_ad = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi20"></a>      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>j=je+<code class="constant">1</code>,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>i=ie,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi88" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + (mass(i, j-<code class="constant">1</code>)+mass(i, j))*damp2*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi88" target="origFile"><code class="label">&           </code>fy_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile">fx2_ad = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi19"></a>      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>j=je,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>i=ie+<code class="constant">1</code>,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi85" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + (mass(i-<code class="constant">1</code>, j)+mass(i, j))*damp2*<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi85" target="origFile"><code class="label">&           </code>fx_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile">fy2_ad = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi22"></a>      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>j=je+<code class="constant">1</code>,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>i=ie,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi94" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + fy_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile">fx2_ad = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi21"></a>      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>j=je,js,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">DO </code>i=ie+<code class="constant">1</code>,is,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi91" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + fx_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_modi83" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">d2_ad = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>n=nord,<code class="constant">1</code>,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from4)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to4)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=ad_to4,ad_from4,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from3)</a>
<a name="deln_flux_admi18"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to3)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ad_to3,ad_from3,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi79" target="origFile">temp_ad3 = dx(i, j)*<code class="constant">0.5</code>*rdyc(i, j)*(sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi79" target="origFile"><code class="label">&             </code>(i, j, <code class="constant">2</code>))*fy2_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi79" target="origFile">d2_ad(i, j) = d2_ad(i, j) + temp_ad3</a>
            <a href="null_p.html#tp_core_modi79" target="origFile">d2_ad(i, j-<code class="constant">1</code>) = d2_ad(i, j-<code class="constant">1</code>) - temp_ad3</a>
            <a href="null_p.html#tp_core_modi79" target="origFile">fy2_ad(i, j) = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi17"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi78" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(d2, d2_ad, npx, npy, <code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from2)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to2)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=ad_to2,ad_from2,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from1)</a>
<a name="deln_flux_admi16"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to1)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ad_to1,ad_from1,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi75" target="origFile">temp_ad2 = dy(i, j)*<code class="constant">0.5</code>*rdxc(i, j)*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi75" target="origFile"><code class="label">&             </code>(i, j, <code class="constant">1</code>))*fx2_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi75" target="origFile">d2_ad(i, j) = d2_ad(i, j) + temp_ad2</a>
            <a href="null_p.html#tp_core_modi75" target="origFile">d2_ad(i-<code class="constant">1</code>, j) = d2_ad(i-<code class="constant">1</code>, j) - temp_ad2</a>
            <a href="null_p.html#tp_core_modi75" target="origFile">fx2_ad(i, j) = <code class="constant">0.0_8</code></a>
<a name="deln_flux_admi15"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi74" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(d2, d2_ad, npx, npy, <code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from0)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to0)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=ad_to0,ad_from0,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_from)</a>
<a name="deln_flux_admi14"></a>          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPINTEGER4</code>(ad_to)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ad_to,ad_from,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi71" target="origFile">temp_ad1 = rarea(i, j)*d2_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi71" target="origFile">fx2_ad(i, j) = fx2_ad(i, j) + temp_ad1</a>
            <a href="null_p.html#tp_core_modi71" target="origFile">fx2_ad(i+<code class="constant">1</code>, j) = fx2_ad(i+<code class="constant">1</code>, j) - temp_ad1</a>
            <a href="null_p.html#tp_core_modi71" target="origFile">fy2_ad(i, j) = fy2_ad(i, j) + temp_ad1</a>
            <a href="null_p.html#tp_core_modi71" target="origFile">fy2_ad(i, j+<code class="constant">1</code>) = fy2_ad(i, j+<code class="constant">1</code>) - temp_ad1</a>
            <a href="null_p.html#tp_core_modi71" target="origFile">d2_ad(i, j) = <code class="constant">0.0_8</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">d2_ad = <code class="constant">0.0_8</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="deln_flux_admi13"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=je+nord+<code class="constant">1</code>,js-nord,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ie+nord,is-nord,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi66" target="origFile">temp_ad0 = dx(i, j)*<code class="constant">0.5</code>*rdyc(i, j)*(sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, <code class="label">&</code></a>
<a href="null_p.html#tp_core_modi66" target="origFile"><code class="label">&         </code>j, <code class="constant">2</code>))*fy2_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi66" target="origFile">d2_ad(i, j-<code class="constant">1</code>) = d2_ad(i, j-<code class="constant">1</code>) + temp_ad0</a>
        <a href="null_p.html#tp_core_modi66" target="origFile">d2_ad(i, j) = d2_ad(i, j) - temp_ad0</a>
        <a href="null_p.html#tp_core_modi66" target="origFile">fy2_ad(i, j) = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="deln_flux_admi12"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) </a><a href="null_p.html#tp_core_modi65" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(d2, d2_ad, npx, npy, <code class="constant">2</code>)</a>
<a name="deln_flux_admi11"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=je+nord,js-nord,<code class="constant">-1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=ie+nord+<code class="constant">1</code>,is-nord,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_modi61" target="origFile">temp_ad = dy(i, j)*<code class="constant">0.5</code>*rdxc(i, j)*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_modi61" target="origFile"><code class="label">&         </code>, <code class="constant">1</code>))*fx2_ad(i, j)</a>
        <a href="null_p.html#tp_core_modi61" target="origFile">d2_ad(i-<code class="constant">1</code>, j) = d2_ad(i-<code class="constant">1</code>, j) + temp_ad</a>
        <a href="null_p.html#tp_core_modi61" target="origFile">d2_ad(i, j) = d2_ad(i, j) - temp_ad</a>
        <a href="null_p.html#tp_core_modi61" target="origFile">fx2_ad(i, j) = <code class="constant">0.0_8</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="deln_flux_admi10"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .NE. <code class="constant">0</code>) </a><a href="null_p.html#tp_core_modi60" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS_ADM</code>(d2, d2_ad, npx, npy, <code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="deln_flux_admi8"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=j2,j1,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=i2,i1,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi53" target="origFile">q_ad(i, j) = q_ad(i, j) + damp*d2_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi53" target="origFile">d2_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
<a name="deln_flux_admi9"></a>      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=j2,j1,<code class="constant">-1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=i2,i1,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi56" target="origFile">q_ad(i, j) = q_ad(i, j) + d2_ad(i, j)</a>
          <a href="null_p.html#tp_core_modi56" target="origFile">d2_ad(i, j) = <code class="constant">0.0_8</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8_adm"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DELN_FLUX_ADM</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!  Differentiation of copy_corners_r8 in reverse (adjoint) mode:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   gradient     of useful results: q</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!   with respect to varying inputs: q</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8_ADM</code>(<code class="vardecl">q</code>, <code class="vardecl">q_ad</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_modi0" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null_p.html#tp_core_modi1" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q_ad</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_modi2" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad0</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad1</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad3</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad4</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad5</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">) </code>:: <code class="vardecl">tmp_ad6</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">branch</code></a>
<a name="p22"></a>    <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi4" target="origFile"><code class="comment">! XDir:</code></a>
      <a href="null_p.html#tp_core_modi4" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p22" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi4" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi4" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi4" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p23"></a>        <a href="null_p.html#tp_core_modi4" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi4" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi8" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p23" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi8" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi8" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi8" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p24"></a>        <a href="null_p.html#tp_core_modi8" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi8" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi12" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi12" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi12" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi12" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p25"></a>        <a href="null_p.html#tp_core_modi12" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi12" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p25" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi16" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi3"></a>        <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">DO </code>j=npy+ng-<code class="constant">1</code>,npy,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">DO </code>i=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi17" target="origFile">tmp_ad2 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi17" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi17" target="origFile">q_ad(npy-j, i-<code class="constant">1</code>+npx) = q_ad(npy-j, i-<code class="constant">1</code>+npx) + tmp_ad2</a>
          <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi16" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi2"></a>        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>j=npy+ng-<code class="constant">1</code>,npy,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>i=npx+ng-<code class="constant">1</code>,npx,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi13" target="origFile">tmp_ad1 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi13" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi13" target="origFile">q_ad(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i) = q_ad(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i) + tmp_ad1</a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi1"></a>        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>j=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>i=npx+ng-<code class="constant">1</code>,npx,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi9" target="origFile">tmp_ad0 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi9" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi9" target="origFile">q_ad(npy-j, i-npx+<code class="constant">1</code>) = q_ad(npy-j, i-npx+<code class="constant">1</code>) + tmp_ad0</a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi0"></a>        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>j=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">DO </code>i=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi5" target="origFile">tmp_ad = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi5" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi5" target="origFile">q_ad(j, <code class="constant">1</code>-i) = q_ad(j, <code class="constant">1</code>-i) + tmp_ad</a>
          <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END IF</code></a>
<a name="p26"></a>    <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">ELSE </code></a><a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_modi21" target="origFile"><code class="comment">! YDir:</code></a>
      <a href="null_p.html#tp_core_modi21" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p26" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi21" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi21" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi21" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p27"></a>        <a href="null_p.html#tp_core_modi21" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi21" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi25" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p27" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi25" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi25" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi25" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p28"></a>        <a href="null_p.html#tp_core_modi25" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi25" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi29" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p28" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi29" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_modi29" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">0</code>)</a>
      <a href="null_p.html#tp_core_modi29" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p29"></a>        <a href="null_p.html#tp_core_modi29" target="origFile"><code class="keyword">CALL </code><code class="funcname">PUSHCONTROL1B</code>(<code class="constant">1</code>)</a>
      <a href="null_p.html#tp_core_modi29" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p29" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_modi33" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi7"></a>        <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">DO </code>j=npy+ng-<code class="constant">1</code>,npy,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">DO </code>i=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi34" target="origFile">tmp_ad6 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi34" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi34" target="origFile">q_ad(j+<code class="constant">1</code>-npx, npy-i) = q_ad(j+<code class="constant">1</code>-npx, npy-i) + tmp_ad6</a>
          <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi33" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi6"></a>        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>j=npy+ng-<code class="constant">1</code>,npy,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>i=npx+ng-<code class="constant">1</code>,npx,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi30" target="origFile">tmp_ad5 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi30" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi30" target="origFile">q_ad(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i) = q_ad(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i) + tmp_ad5</a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi5"></a>        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>j=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>i=npx+ng-<code class="constant">1</code>,npx,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi26" target="origFile">tmp_ad4 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi26" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi26" target="origFile">q_ad(npy+j-<code class="constant">1</code>, npx-i) = q_ad(npy+j-<code class="constant">1</code>, npx-i) + tmp_ad4</a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">CALL </code><code class="funcname">POPCONTROL1B</code>(branch)</a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">IF</code> (branch .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8_admi4"></a>        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>j=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">DO </code>i=<code class="constant">0</code>,<code class="constant">1</code>-ng,<code class="constant">-1</code></a>
            <a href="null_p.html#tp_core_modi22" target="origFile">tmp_ad3 = q_ad(i, j)</a>
            <a href="null_p.html#tp_core_modi22" target="origFile">q_ad(i, j) = <code class="constant">0.0_8</code></a>
            <a href="null_p.html#tp_core_modi22" target="origFile">q_ad(<code class="constant">1</code>-j, i) = q_ad(<code class="constant">1</code>-j, i) + tmp_ad3</a>
          <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_modi20" target="origFile"><code class="keyword">END IF</code></a>
<a name="deln_flux"></a>    <a href="null_p.html#tp_core_modi3" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8_ADM</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DELN_FLUX</code>(<code class="vardecl">nord</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">damp</code>, <code class="vardecl">q</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">mass</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Del-n damping for the cell-mean values (A grid)</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! nord = 0:   del-2</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! nord = 1:   del-4</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! nord = 2:   del-6</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! nord = 3:   del-8 --&gt; requires more ghosting than current</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! del-n</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">is</code>-<code class="vardecl">ng</code>:<code class="vardecl">ie</code>+<code class="vardecl">ng</code>, <code class="vardecl">js</code>-<code class="vardecl">ng</code>:<code class="vardecl">je</code>+<code class="vardecl">ng</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! diffusive fluxes:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>), <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! local:</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>), <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>+<code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">d2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">n</code>, <code class="vardecl">nt</code>, <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">j1</code>, <code class="vardecl">j2</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile">i1 = is - <code class="constant">1 </code>- nord</a>
    <a href="null_p.html#tp_core_mod" target="origFile">i2 = ie + <code class="constant">1 </code>+ nord</a>
    <a href="null_p.html#tp_core_mod" target="origFile">j1 = js - <code class="constant">1 </code>- nord</a>
    <a href="null_p.html#tp_core_mod" target="origFile">j2 = je + <code class="constant">1 </code>+ nord</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (.NOT.<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null_p.html#tp_core_mod" target="origFile">d2(i, j) = damp*q(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null_p.html#tp_core_mod" target="origFile">d2(i, j) = q(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js-nord,je+nord</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is-nord,ie+nord+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)*(d2<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&         </code>(i-<code class="constant">1</code>, j)-d2(i, j))*rdxc(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js-nord,je+nord+<code class="constant">1</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is-nord,ie+nord</a>
        <a href="null_p.html#tp_core_mod" target="origFile">fy2(i, j) = <code class="constant">0.5</code>*(sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))*dx(i, j)*(d2<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&         </code>(i, j-<code class="constant">1</code>)-d2(i, j))*rdyc(i, j)</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!----------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! high-order</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!----------</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nord</a>
        <a href="null_p.html#tp_core_mod" target="origFile">nt = nord - n</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js-nt-<code class="constant">1</code>,je+nt+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is-nt-<code class="constant">1</code>,ie+nt+<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">d2(i, j) = (fx2(i, j)-fx2(i+<code class="constant">1</code>, j)+fy2(i, j)-fy2(i, j+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>rarea(i, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js-nt,je+nt</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is-nt,ie+nt+<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>*(d2(i, j)-d2(i-<code class="constant">1</code>, j))*rdxc(i, j)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js-nt,je+nt+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is-nt,ie+nt</a>
            <a href="null_p.html#tp_core_mod" target="origFile">fy2(i, j) = dx(i, j)*(d2(i, j)-d2(i, j-<code class="constant">1</code>))*rdyc(i, j)*<code class="constant">0.5</code>*(<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&             </code>sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------------------</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Add the diffusive fluxes to the flux arrays:</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">!---------------------------------------------</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! Apply mass weighting to diffusive fluxes:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile">damp2 = <code class="constant">0.5</code>*damp</a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = fx(i, j) + damp2*(mass(i-<code class="constant">1</code>, j)+mass(i, j))*fx2(i, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = fy(i, j) + damp2*(mass(i, j-<code class="constant">1</code>)+mass(i, j))*fy2(i, j<code class="label">&</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="label">&           </code>)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile">fx(i, j) = fx(i, j) + fx2(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null_p.html#tp_core_mod" target="origFile">fy(i, j) = fy(i, j) + fy2(i, j)</a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DELN_FLUX</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p22"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! XDir:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p22" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p23"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p23" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p24"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p25"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p25" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
<a name="p26"></a>    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null_p.html#tp_core_mod" target="origFile"><code class="comment">! YDir:</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p26" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p27"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p27" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p28"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p28" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
<a name="p29"></a>        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p29" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null_p.html#tp_core_mod" target="origFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null_p.html#tp_core_mod" target="origFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
        <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END DO</code></a>
      <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
    <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END IF</code></a>
  <a href="null_p.html#tp_core_mod" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code></a>
<code class="keyword">END MODULE </code><code class="funcname">TP_CORE_MOD_B</code>
</pre>
</body>
