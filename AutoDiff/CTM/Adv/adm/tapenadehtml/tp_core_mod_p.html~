<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Ecuador team)</code>
<code class="comment">!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30</code>
<code class="comment">!</code>
<code class="keyword">MODULE </code><code class="funcname">TP_CORE_MOD</code>
<code class="comment">!BOP</code>
<code class="comment">!</code>
<code class="comment">! !MODULE: tp_core --- A collection of routines to support FV transport</code>
<code class="comment">!</code>
  <code class="keyword">USE </code><code class="funcname">FV_ARRAYS_MOD</code>, <code class="keyword">ONLY </code>: fvprc, real4, real8, cnvt
  <code class="keyword">USE </code><code class="funcname">FV_MP_MOD</code>, <code class="keyword">ONLY </code>: is, js, ie, je, ng, isd, jsd, ied, jed
  <code class="keyword">USE </code><code class="funcname">FV_GRID_UTILS_MOD</code>, <code class="keyword">ONLY </code>: sw_corner, se_corner, ne_corner, <code class="label">&</code>
<code class="label">& </code>nw_corner, sin_sg =&gt; sin_sg, da_min =&gt; da_min, big_number_r8 =&gt; <code class="label">&</code>
<code class="label">& </code>big_number
  <code class="keyword">USE </code><code class="funcname">FV_GRID_TOOLS_MOD</code>, <code class="keyword">ONLY </code>: grid_type, dx =&gt; dx, dy =&gt; dy, rdxc =&gt; <code class="label">&</code>
<code class="label">& </code>rdxc, rdyc =&gt; rdyc, dxa =&gt; dxa, dya =&gt; dya, area =&gt; area, rarea =&gt; <code class="label">&</code>
<code class="label">& </code>rarea
  <code class="keyword">IMPLICIT NONE</code>
  PRIVATE 
  PUBLIC fv_tp_2d, pert_ppm, copy_corners
<code class="comment">!#ifdef MAPL_MODE</code>
  <code class="typename">LOGICAL</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">nested</code>=<code class="constant">.false.</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r3</code>=<code class="constant">1.</code>/<code class="constant">3.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">near_zero</code>=<code class="constant">1.e-25</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">ppm_limiter</code>=<code class="constant">2.0</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">big_number</code>=<code class="vardecl">big_number_r8</code>
<code class="comment">!#ifdef WAVE_FORM</code>
<code class="comment">!! Suresh & Huynh scheme 2.2 (purtabation form)</code>
<code class="comment">!! The wave-form is more diffusive than scheme 2.1</code>
<code class="comment">! real(FVPRC), parameter:: b1 =   0.0375</code>
<code class="comment">! real(FVPRC), parameter:: b2 =  -7./30.</code>
<code class="comment">! real(FVPRC), parameter:: b3 =  -23./120.</code>
<code class="comment">! real(FVPRC), parameter:: b4 =  13./30.</code>
<code class="comment">! real(FVPRC), parameter:: b5 = -11./240.</code>
<code class="comment">!#else</code>
<code class="comment">! scheme 2.1: perturbation form</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b1</code>=<code class="constant">1.</code>/<code class="constant">30.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b2</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b3</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b4</code>=<code class="constant">0.45</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b5</code>=-<code class="constant">0.05</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">t11</code>=<code class="constant">27.</code>/<code class="constant">28.</code>, <code class="vardecl">t12</code>=-(<code class="constant">13.</code>/<code class="constant">28.</code>), <code class="vardecl">t13</code>=<code class="constant">3.</code>/<code class="constant">7.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">s11</code>=<code class="constant">11.</code>/<code class="constant">14.</code>, <code class="vardecl">s14</code>=<code class="constant">4.</code>/<code class="constant">7.</code>, <code class="vardecl">s15</code>=<code class="constant">3.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! volume-conserving cubic with 2nd drv=0 at end point:</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! Non-monotonic</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c1</code>=-(<code class="constant">2.</code>/<code class="constant">14.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c2</code>=<code class="constant">11.</code>/<code class="constant">14.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c3</code>=<code class="constant">5.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------</code>
<code class="comment">! PPM volume mean form:</code>
<code class="comment">!----------------------</code>
<code class="comment">! 0.58333333</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p1</code>=<code class="constant">7.</code>/<code class="constant">12.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p2</code>=-(<code class="constant">1.</code>/<code class="constant">12.</code>)
<code class="comment">!#ifdef SINGLE_FV</code>
<code class="comment">!   MODULE PROCEDURE fv_tp_2d_r8</code>
<code class="comment">!#endif</code>
  <code class="keyword">INTERFACE </code><code class="funcname">FV_TP_2D</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">FV_TP_2D_R4</code>
  <code class="keyword">END INTERFACE</code>

  <code class="keyword">INTERFACE </code><code class="funcname">COPY_CORNERS</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R4</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R8</code>
  <code class="keyword">END INTERFACE</code>

<a name="fv_tp_2d_r4"></a>
<code class="keyword">CONTAINS</code>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!-----------------------------------------------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!#ifdef SINGLE_FV</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! subroutine fv_tp_2d_r8(qIN, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                     ra_x, ra_y, mfx, mfy, mass, nord, damp_c)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   integer, intent(in):: npx, npy</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   integer, intent(in)::hord</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  crx(is:ie+1,jsd:jed)  !</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  xfx(is:ie+1,jsd:jed)  !</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  cry(isd:ied,js:je+1 )  !</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  yfx(isd:ied,js:je+1 )  !</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in):: ra_x(is:ie,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(in):: ra_y(isd:ied,js:je)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(REAL8), intent(in)::  qIN(isd:ied,jsd:jed)  ! transported scalar</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(out)::fx(is:ie+1 ,js:je)    ! Flux in x ( E )</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), intent(out)::fy(is:ie,   js:je+1 )    ! Flux in y ( N )</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! optional Arguments:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfx(is:ie+1,js:je  )  ! Mass Flux X-Dir</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfy(is:ie  ,js:je+1)  ! Mass Flux Y-Dir</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mass(isd:ied,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: damp_c</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   integer, OPTIONAL, intent(in):: nord</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! Local:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   real(FVPRC)   q(isd:ied,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   q = CNVT(qIN)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!   call fv_tp_2d(q, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                     ra_x, ra_y, mfx=mfx, mfy=mfy, mass=mass, nord=nord, damp_c=damp_c)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! end subroutine fv_tp_2d_r8</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!#endif</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">crx</code>, <code class="vardecl">cry</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">hord</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">xfx</code>, <code class="vardecl">yfx</code>, <code class="label">&</code></a>
<a name="fv_tp_2d_r4i373"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">ra_x</code>, <code class="vardecl">ra_y</code>, <code class="vardecl">mfx</code>, <code class="vardecl">mfy</code>, <code class="vardecl">mass</code>, <code class="vardecl">nord</code>, <code class="vardecl">damp_c</code>)</a>
<a name="fv_tp_2d_r4i374"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="fv_tp_2d_r4i375"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">hord</code></a>
<a name="fv_tp_2d_r4i376"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">crx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i377"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">xfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i378"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cry</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i379"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a name="fv_tp_2d_r4i380"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">yfx</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i381"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_x</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_y</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a name="fv_tp_2d_r4i382"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! transported scalar</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i383"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Flux in x ( E )</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a name="fv_tp_2d_r4i384"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Flux in y ( N )</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! optional Arguments:</code></a>
<a name="fv_tp_2d_r4i385"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Mass Flux X-Dir</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a name="fv_tp_2d_r4i386"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Mass Flux Y-Dir</code></a>
<a name="fv_tp_2d_r4i387"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i388"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i389"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp_c</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
<a name="fv_tp_2d_r4i390"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local:</code></a>
<a name="fv_tp_2d_r4i391"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ord</code>, <code class="vardecl">ord_in</code></a>
<a name="fv_tp_2d_r4i392"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_i</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a name="fv_tp_2d_r4i393"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_j</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i394"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a name="fv_tp_2d_r4i395"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i396"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="fv_tp_2d_r4i397"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i398"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fyy</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i399"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fxx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>)</a>
<a name="fv_tp_2d_r4i400"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp</code></a>
<a name="fv_tp_2d_r4i401"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="fv_tp_2d_r4i402"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
<a name="fv_tp_2d_r4i403"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (hord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i404"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! more dissipation</code></a>
<a name="fv_tp_2d_r4i405"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">ord_in = <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (hord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i406"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">ord = hord</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">ord = -hord</a>
<a name="fv_tp_2d_r4i407"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fv_tp_2d_r4i408"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile">ord_in = hord</a>
<a name="fv_tp_2d_r4i410"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">ord = hord</a>
<a name="fv_tp_2d_r4i409"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p4"></a><a name="p3"></a><a name="p2"></a><a name="fv_tp_2d_r4i411"></a>    <a href="null.html#tp_core_mod_bi108" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i412"></a>      <a href="null.html#tp_core_mod_bi109" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi109" target="diffFile">fy2, </a><a href="msg.html#p3" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi109" target="diffFile">q, </a><a href="msg.html#p4" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi109" target="diffFile">cry, ord_in, isd, ied, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fv_tp_2d_r4i415"></a>      <a href="null.html#tp_core_mod_bi110" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy2, q, cry, ord_in, isd, ied, js, je, npx, npy)</a>
<a name="fv_tp_2d_r4i414"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fv_tp_2d_r4i413"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null.html#tp_core_mod_bi111" target="diffFile">fyy(i, j) = yfx(i, j)*fy2(i, j)</a>
<a name="fv_tp_2d_r4i418"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i417"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i416"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null.html#tp_core_mod_bi112" target="diffFile">q_i(i, j) = (q(i, j)*area(i, j)+fyy(i, j)-fyy(i, j+<code class="constant">1</code>))/ra_y(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi112" target="diffFile"><code class="label">&         </code>)</a>
<a name="fv_tp_2d_r4i419"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p7"></a><a name="p6"></a><a name="p5"></a><a name="fv_tp_2d_r4i421"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i423"></a>      <a href="null.html#tp_core_mod_bi113" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p5" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi113" target="diffFile">fx1, </a><a href="msg.html#p6" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi113" target="diffFile">q_i, </a><a href="msg.html#p7" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi113" target="diffFile">crx(is, js), ord, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fv_tp_2d_r4i425"></a>      <a href="null.html#tp_core_mod_bi114" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx1, q_i, crx(is, js), ord, is, ie, js, je, npx, npy)</a>
<a name="fv_tp_2d_r4i424"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p10"></a><a name="p9"></a><a name="p8"></a><a name="fv_tp_2d_r4i426"></a>    <a href="null.html#tp_core_mod_bi115" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i427"></a>      <a href="null.html#tp_core_mod_bi116" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p8" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi116" target="diffFile">fx2, </a><a href="msg.html#p9" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi116" target="diffFile">q, </a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi116" target="diffFile">crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fv_tp_2d_r4i432"></a>      <a href="null.html#tp_core_mod_bi117" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx2, q, crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
<a name="fv_tp_2d_r4i429"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fv_tp_2d_r4i428"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jsd,jed</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
<a name="fv_tp_2d_r4i431"></a>        <a href="null.html#tp_core_mod_bi118" target="diffFile">fxx(i) = xfx(i, j)*fx2(i, j)</a>
<a name="fv_tp_2d_r4i430"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
        <a href="null.html#tp_core_mod_bi119" target="diffFile">q_j(i, j) = (q(i, j)*area(i, j)+fxx(i)-fxx(i+<code class="constant">1</code>))/ra_x(i, j)</a>
<a name="fv_tp_2d_r4i433"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p13"></a><a name="p12"></a><a name="p11"></a><a name="fv_tp_2d_r4i435"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ord .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i437"></a>      <a href="null.html#tp_core_mod_bi120" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi120" target="diffFile">fy1, </a><a href="msg.html#p12" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi120" target="diffFile">q_j, </a><a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi120" target="diffFile">cry, ord, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fv_tp_2d_r4i438"></a>      <a href="null.html#tp_core_mod_bi121" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy1, q_j, cry, ord, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!----------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Flux averaging:</code></a>
<a name="fv_tp_2d_r4i441"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!----------------</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mfx) .AND. <code class="funcname">PRESENT</code>(mfy)) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! For transport of pt and tracers</code></a>
<a name="fv_tp_2d_r4i440"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a name="fv_tp_2d_r4i439"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_bi122" target="diffFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*mfx(i, j)</a>
<a name="fv_tp_2d_r4i444"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i443"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i442"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_bi123" target="diffFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*mfy(i, j)</a>
<a name="fv_tp_2d_r4i445"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i446"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i447"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c) .AND. <code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i448"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_bi124" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy, mass)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fv_tp_2d_r4i451"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! For transport of delp, vorticity</code></a>
<a name="fv_tp_2d_r4i450"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a name="fv_tp_2d_r4i449"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_bi125" target="diffFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*xfx(i, j)</a>
<a name="fv_tp_2d_r4i454"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i453"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i452"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_bi126" target="diffFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*yfx(i, j)</a>
<a name="fv_tp_2d_r4i455"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i456"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fv_tp_2d_r4i457"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c)) <code class="keyword">THEN</code></a>
<a name="fv_tp_2d_r4i458"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">damp = (damp_c*da_min)**(nord+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_bi127" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r4"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">real4</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p14"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! XDir:</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p15"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p16"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p17"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p18"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! YDir:</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p18" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p19"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p19" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p20"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p21"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p21" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xtp"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code></a>
<a name="xtpi350"></a>  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XTP</code>(<code class="vardecl">fx</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="xtpi351"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="xtpi352"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="xtpi353"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="xtpi354"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a name="xtpi355"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant numbers</code></a>
<a name="xtpi356"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="xtpi357"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="xtpi358"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local:</code></a>
<a name="xtpi359"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">is</code>-<code class="constant">2</code>:<code class="vardecl">ie</code>+<code class="constant">2</code>)</a>
<a name="xtpi360"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
<a name="xtpi365"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="xtpi364"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="xtpi361"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
<a name="xtpi362"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="xtpi363"></a>            <a href="null.html#tp_core_mod_bi103" target="diffFile">fx(i, j) = q(i-<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi104" target="diffFile">fx(i, j) = q(i, j)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xtpi366"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="xtpi371"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (iord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a name="xtpi370"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!Advection using third order scheme</code></a>
<a name="xtpi367"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
<a name="xtpi368"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_bi105" target="diffFile">fx(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i-<code class="constant">1</code>, j)-q(i-<code class="constant">2</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi105" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a name="xtpi369"></a><a href="null.html#tp_core_mod_bi105" target="diffFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+q(i-<code class="constant">2</code>, j))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi106" target="diffFile">fx(i, j) = (<code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+<code class="constant">5.0</code>*q(i, j)-q(i+<code class="constant">1</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi106" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi106" target="diffFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i-<code class="constant">1</code>, j))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="xtpi372"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_bi107" target="diffFile"><code class="keyword">CALL </code><code class="funcname">FXPPM</code>(c, q, fx, iord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="ytp"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XTP</code></a>
<a name="ytpi327"></a>  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YTP</code>(<code class="vardecl">fy</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
<a name="ytpi328"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
<a name="ytpi329"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="ytpi330"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="ytpi331"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="ytpi332"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a name="ytpi333"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="ytpi334"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="ytpi335"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !LOCAL VARIABLES:</code></a>
<a name="ytpi336"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="ytpi337"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
<a name="ytpi342"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="ytpi341"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="ytpi338"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
<a name="ytpi339"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="ytpi340"></a>            <a href="null.html#tp_core_mod_bi98" target="diffFile">fy(i, j) = q(i, j-<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi99" target="diffFile">fy(i, j) = q(i, j)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="ytpi343"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="ytpi348"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (jord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a name="ytpi347"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!Advected using third order scheme</code></a>
<a name="ytpi344"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
<a name="ytpi345"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_bi100" target="diffFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i, j-<code class="constant">1</code>)-q(i, j-<code class="constant">2</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi100" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a name="ytpi346"></a><a href="null.html#tp_core_mod_bi100" target="diffFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+q(i, j-<code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi101" target="diffFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+<code class="constant">5.0</code>*q(i, j)-q(i, j+<code class="constant">1</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi101" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j+<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi101" target="diffFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i, j-<code class="constant">1</code>))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="ytpi349"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_bi102" target="diffFile"><code class="keyword">CALL </code><code class="funcname">FYPPM</code>(c, q, fy, jord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="xppm0"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YTP</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!#ifdef XPPM_2D</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! subroutine xppm0(flux, q, c, iord, ifirst, ilast, jfirst, jlast, npx, npy, bd, dxa, nested, grid_type)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! type(fv_grid_bounds_type), intent(IN) :: bd</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer, INTENT(IN) :: ifirst, ilast               !  X-Dir strip</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer, INTENT(IN) :: jfirst, jlast               !  Y-Dir strip</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer, INTENT(IN) :: iord</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer, INTENT(IN) :: npx, npy</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real   , INTENT(IN) :: q(ifirst-ng:ilast+ng,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real   , INTENT(IN) :: c(ifirst   :ilast+1 ,jfirst:jlast) ! Courant   N (like FLUX)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real   , intent(IN) :: dxa(bd%isd:bd%ied,bd%jsd:bd%jed)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! logical, intent(IN) :: nested</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer, intent(IN) :: grid_type</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! !OUTPUT PARAMETERS:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real  , INTENT(OUT) :: flux(ifirst:ilast+1,jfirst:jlast) !  Flux</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! Local</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real, dimension(3*jfirst:3*jlast+2) :: q_tmp, bl_tmp, br_tmp</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real, dimension(ifirst-1:ilast+1,jfirst:jlast):: bl, br</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real  al(ifirst-1:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real  dm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real  dq(ifirst-3:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! logical extm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! integer i, j, ie3, is1, ie1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real xt, pmp_1, lac_1, pmp_2, lac_2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    is1 = max(3,is-1);  ie3 = min(npx-2,ie+2)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                        ie1 = min(npx-3,ie+1)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    is1 = is-1;         ie3 = ie+2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                        ie1 = ie+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! end if</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! if ( abs(iord) &lt; 8 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    ! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    ! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    ! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do i=is1, ie3</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          al(i,j) = p1*(q(i-1,j)+q(i,j)) + p2*(q(i-2,j)+q(i+1,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(0,j) = c1*q(-2,j) + c2*q(-1,j) + c3*q(0,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(1,j) = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(2,j) = c3*q(1,j) + c2*q(2,j) +c1*q(3,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(0,j) = max(0., al(0,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(1,j) = max(0., al(1,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(2,j) = max(0., al(2,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       if ( (ie+1)==npx ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(npx-1,j) = c1*q(npx-3,j) + c2*q(npx-2,j) + c3*q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(npx,j) = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                  +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j)-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             al(npx+1,j) = c3*q(npx,j) + c2*q(npx+1,j) + c1*q(npx+2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(npx-1,j) = max(0., al(npx-1,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(npx,  j) = max(0., al(npx  ,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                al(npx+1,j) = max(0., al(npx+1,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    if ( iord==-5 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=ifirst-3,ilast+2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=ifirst-2, ilast+2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             if ( dq(i-1,j)*dq(i,j) &gt; 0. ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                extm(i,j) = .false.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                extm(i,j) = .true.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             if ( extm(i-1,j).and.extm(i,j).and.extm(i+1,j) ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       ! Additional positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       if(iord==-7) call pert_ppm(ilast-ifirst+3, q(ifirst-1,j), bl(ifirst-1,j), br(ifirst-1,j), 0)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! Monotonic constraints:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! ord = 8: PPM with Lin's PPM fast monotone constraint</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! ord = 10: PPM with Lin's modification of Huynh 2nd constraint</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!! ord = 13: 10 plus positive definite constraint</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do i=is-2,ie+2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          xt = 0.25*(q(i+1,j) - q(i-1,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          dm(i,j) = sign(min(abs(xt), max(q(i-1,j), q(i,j), q(i+1,j)) - q(i,j),  &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!               q(i,j) - min(q(i-1,j), q(i,j), q(i+1,j))), xt)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do i=is1,ie1+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          al(i,j) = 0.5*(q(i-1,j)+q(i,j)) + r3*(dm(i-1,j)-dm(i,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    if ( iord==-8 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             xt = 2.*dm(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl(i,j) = -sign(min(abs(xt), abs(al(i,j  )-q(i,j))), xt)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br(i,j) =  sign(min(abs(xt), abs(al(i+1,j)-q(i,j))), xt)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=is1-2, ie1+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl(i,j) = al(i,j  ) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             if ( abs(dm(i-1,j))+abs(dm(i,j))+abs(dm(i+1,j)) &lt; near_zero ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             elseif( abs(3.*(bl(i,j)+br(i,j))) &gt; abs(bl(i,j)-br(i,j)) ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                pmp_1 = -(dq(i,j) + dq(i,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                lac_1 = pmp_1 + 1.5*dq(i+1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                bl(i,j) = min( max(0., pmp_1, lac_1), max(bl(i,j), min(0., pmp_1, lac_1)) )</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                pmp_2 = dq(i-1,j) + dq(i-1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                lac_2 = pmp_2 - 1.5*dq(i-2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                br(i,j) = min( max(0., pmp_2, lac_2), max(br(i,j), min(0., pmp_2, lac_2)) )</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    ! Positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    if(iord==-9 .or. iord==-13) call pert_ppm(ie1-is1+1, q(is1,j), bl(is1,j), br(is1,j), 0)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    if (.not. nested .and. grid_type&lt;3) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl_tmp(3*j) = s14*dm(-1,j) + s11*(q(-1,j)-q(0,j))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             xt = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br_tmp(3*j) = xt - q(0,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             xt = s15*q(1,j) + s11*q(2,j) - s14*dm(2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl_tmp(3*j+2) = xt - q(2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br_tmp(3*j+2) = al(3,j) - q(2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             q_tmp(j*3:j*3+2) = q(0:2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             bl(0:2,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!             br(0:2,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!      endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!      if ( (ie+1)==npx ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            bl_tmp(3*j) = al(npx-2,j) - q(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            xt = s15*q(npx-1,j) + s11*q(npx-2,j) + s14*dm(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            br_tmp(3*j) = xt - q(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            bl_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            xt = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!               +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j  )-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            br_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            bl_tmp(3*j+2) = xt - q(npx,j  )</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            br_tmp(3*j+2) = s11*(q(npx+1,j)-q(npx,j)) - s14*dm(npx+1,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            q_tmp(j*3:j*3+2) = q(npx-2:npx,j)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!         enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!         call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            bl(npx-2:npx,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!            br(npx-2:npx,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!         enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!      endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!     do i=ifirst,ilast+1</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!        if( c(i,j)&gt;0. ) then</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!           flux(i,j) = q(i-1,j) + (1.-c(i,j))*(br(i-1,j)-c(i,j)*(bl(i-1,j)+br(i-1,j)))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!        else</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!           flux(i,j) = q(i,j  ) + (1.+c(i,j))*(bl(i,j  )+c(i,j)*(bl(i,j  )+br(i,j  )))</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!        endif</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!     enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  enddo</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! end subroutine xppm0</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!#else</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a name="xppm0i273"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="xppm0i274"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="xppm0i275"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="xppm0i276"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="xppm0i277"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a name="xppm0i278"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="xppm0i279"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a name="xppm0i280"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="xppm0i281"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local</code></a>
<a name="xppm0i282"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-ng:ilast+ng<code class="typename">) </code>:: <code class="vardecl">q1</code></a>
<a name="xppm0i283"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-<code class="constant">1</code>:ilast+<code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">bl</code>, <code class="vardecl">br</code></a>
<a name="xppm0i284"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="xppm0i285"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="xppm0i286"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="xppm0i287"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="xppm0i288"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ie3</code>, <code class="vardecl">is1</code>, <code class="vardecl">ie1</code></a>
<a name="xppm0i289"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
<a name="xppm0i290"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="xppm0i291"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="xppm0i292"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
<a name="xppm0i293"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
<a name="xppm0i294"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="xppm0i295"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">is1 = is - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="xppm0i296"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">is1 = <code class="constant">3</code></a>
<a name="xppm0i297"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">2 </code>.GT. ie + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a name="xppm0i298"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">ie3 = npx - <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">ie1 = ie + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">ie1 = npx - <code class="constant">3</code></a>
<a name="xppm0i299"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i300"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile">is1 = is - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile">ie3 = ie + <code class="constant">2</code></a>
<a name="xppm0i326"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">ie1 = ie + <code class="constant">1</code></a>
<a name="xppm0i302"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i301"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst-ng,ilast+ng</a>
<a name="xppm0i303"></a>        <a href="null.html#tp_core_mod_bi86" target="diffFile">q1(i) = q(i, j)</a>
<a name="xppm0i304"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (iord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="xppm0i305"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = iord</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="xppm0i306"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = -iord</a>
<a name="xppm0i308"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a name="p30"></a><a name="xppm0i307"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is1,ie3</a>
<a name="xppm0i309"></a>          <a href="msg.html#p30" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi87" target="diffFile">al(i) = p1*(q1(i-<code class="constant">1</code>)+q1(i)) + p2*(q1(i-<code class="constant">2</code>)+q1(i+<code class="constant">1</code>))</a>
<a name="xppm0i310"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p31"></a><a name="xppm0i313"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p32"></a><a name="xppm0i312"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
            <a href="msg.html#p31" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi90" target="diffFile">al(<code class="constant">0</code>) = c1*q1(-<code class="constant">2</code>) + c2*q1(-<code class="constant">1</code>) + c3*q1(<code class="constant">0</code>)</a>
            <a href="msg.html#p32" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi89" target="diffFile">al(<code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q1(<code class="constant">0</code>)-dxa(<code class="constant">0</code>, j)*q1(-<code class="label">&</code></a>
<a name="p33"></a><a name="xppm0i311"></a><a href="null.html#tp_core_mod_bi89" target="diffFile"><code class="label">&             </code><code class="constant">1</code>))/(dxa(-<code class="constant">1</code>, j)+dxa(<code class="constant">0</code>, j))+((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q1(<code class="constant">1</code>)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi89" target="diffFile"><code class="label">&             </code>-dxa(<code class="constant">1</code>, j)*q1(<code class="constant">2</code>))/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j)))</a>
<a name="xppm0i314"></a>            <a href="msg.html#p33" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi88" target="diffFile">al(<code class="constant">2</code>) = c3*q1(<code class="constant">1</code>) + c2*q1(<code class="constant">2</code>) + c1*q1(<code class="constant">3</code>)</a>
<a name="p34"></a><a name="xppm0i317"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p35"></a><a name="xppm0i316"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
            <a href="msg.html#p34" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi93" target="diffFile">al(npx-<code class="constant">1</code>) = c1*q1(npx-<code class="constant">3</code>) + c2*q1(npx-<code class="constant">2</code>) + c3*q1(npx-<code class="constant">1</code>)</a>
            <a href="msg.html#p35" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi92" target="diffFile">al(npx) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q1(npx-<code class="constant">1</code>)-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi92" target="diffFile"><code class="label">&             </code>dxa(npx-<code class="constant">1</code>, j)*q1(npx-<code class="constant">2</code>))/(dxa(npx-<code class="constant">2</code>, j)+dxa(npx-<code class="constant">1</code>, j))+((<code class="label">&</code></a>
<a name="p36"></a><a name="xppm0i315"></a><a href="null.html#tp_core_mod_bi92" target="diffFile"><code class="label">&             </code><code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q1(npx)-dxa(npx, j)*q1(npx+<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi92" target="diffFile"><code class="label">&             </code>))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j)))</a>
            <a href="msg.html#p36" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi91" target="diffFile">al(npx+<code class="constant">1</code>) = c3*q1(npx) + c2*q1(npx+<code class="constant">1</code>) + c1*q1(npx+<code class="constant">2</code>)</a>
<a name="xppm0i318"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i321"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i320"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (iord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
<a name="xppm0i319"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst-<code class="constant">1</code>,ilast+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi95" target="diffFile">bl(i) = al(i) - q1(i)</a>
            <a href="null.html#tp_core_mod_bi94" target="diffFile">br(i) = al(i+<code class="constant">1</code>) - q1(i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="xppm0i325"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i322"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xppm0i323"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_bi96" target="diffFile">flux(i, j) = q1(i-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i-<code class="constant">1</code>)+<code class="label">&</code></a>
<a name="xppm0i324"></a><a href="null.html#tp_core_mod_bi96" target="diffFile"><code class="label">&           </code>br(i-<code class="constant">1</code>)))</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_bi97" target="diffFile">flux(i, j) = q1(i) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br(i))<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi97" target="diffFile"><code class="label">&           </code>)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XPPM0</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!#endif</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a name="yppm0i217"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="yppm0i218"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="yppm0i219"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="yppm0i220"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="yppm0i221"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
<a name="yppm0i222"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a name="yppm0i223"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="yppm0i224"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="yppm0i225"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local:</code></a>
<a name="yppm0i226"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="yppm0i227"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="yppm0i228"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="yppm0i229"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="yppm0i230"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="yppm0i231"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="yppm0i232"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
<a name="yppm0i233"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js1</code>, <code class="vardecl">je3</code>, <code class="vardecl">je1</code></a>
<a name="yppm0i234"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="yppm0i235"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="yppm0i236"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
<a name="yppm0i237"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
<a name="yppm0i238"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="yppm0i239"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">js1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="yppm0i240"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">js1 = <code class="constant">3</code></a>
<a name="yppm0i241"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">2 </code>.GT. je + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a name="yppm0i242"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">je3 = je + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">je3 = npy - <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">je1 = je + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile">je1 = npy - <code class="constant">3</code></a>
<a name="yppm0i243"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="yppm0i244"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Nested grid OR Doubly periodic domain:</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile">js1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile">je3 = je + <code class="constant">2</code></a>
<a name="yppm0i245"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">je1 = je + <code class="constant">1</code></a>
<a name="yppm0i246"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (jord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="yppm0i247"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = jord</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="yppm0i248"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = -jord</a>
<a name="yppm0i251"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a name="yppm0i250"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a name="p37"></a><a name="yppm0i249"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js1,je3</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="msg.html#p37" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi75" target="diffFile">al(i, j) = p1*(q(i, j-<code class="constant">1</code>)+q(i, j)) + p2*(q(i, j-<code class="constant">2</code>)+q(i, j+<code class="constant">1</code>))</a>
<a name="yppm0i252"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0i253"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0i257"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p38"></a><a name="yppm0i256"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="p39"></a><a name="yppm0i255"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="msg.html#p38" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi78" target="diffFile">al(i, <code class="constant">0</code>) = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
            <a href="msg.html#p39" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi77" target="diffFile">al(i, <code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)<code class="label">&</code></a>
<a name="p40"></a><a name="yppm0i254"></a><a href="null.html#tp_core_mod_bi77" target="diffFile"><code class="label">&             </code>*q(i, -<code class="constant">1</code>))/(dya(i, -<code class="constant">1</code>)+dya(i, <code class="constant">0</code>))+((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi77" target="diffFile"><code class="label">&             </code>)*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)))</a>
            <a href="msg.html#p40" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi76" target="diffFile">al(i, <code class="constant">2</code>) = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
<a name="yppm0i258"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0i262"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p41"></a><a name="yppm0i261"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a name="p42"></a><a name="yppm0i260"></a>            <a href="msg.html#p41" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi81" target="diffFile">al(i, npy-<code class="constant">1</code>) = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi81" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)</a>
            <a href="msg.html#p42" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi80" target="diffFile">al(i, npy) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi80" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)-dya(i, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">2</code>)+dya(i, npy-<code class="constant">1</code><code class="label">&</code></a>
<a name="p43"></a><a name="yppm0i259"></a><a href="null.html#tp_core_mod_bi80" target="diffFile"><code class="label">&             </code>))+((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy)*q<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi80" target="diffFile"><code class="label">&             </code>(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>)))</a>
            <a href="msg.html#p43" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_bi79" target="diffFile">al(i, npy+<code class="constant">1</code>) = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi79" target="diffFile"><code class="label">&             </code>)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0i263"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="yppm0i267"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="yppm0i266"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (jord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
<a name="yppm0i265"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst-<code class="constant">1</code>,jlast+<code class="constant">1</code></a>
<a name="yppm0i264"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="null.html#tp_core_mod_bi83" target="diffFile">bl(i, j) = al(i, j) - q(i, j)</a>
            <a href="null.html#tp_core_mod_bi82" target="diffFile">br(i, j) = al(i, j+<code class="constant">1</code>) - q(i, j)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0i272"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="yppm0i271"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="yppm0i268"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
<a name="yppm0i269"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_bi84" target="diffFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(bl(<code class="label">&</code></a>
<a name="yppm0i270"></a><a href="null.html#tp_core_mod_bi84" target="diffFile"><code class="label">&           </code>i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_bi85" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi85" target="diffFile"><code class="label">&           </code>)+br(i, j)))</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fxppm"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YPPM0</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FXPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a name="fxppmi159"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
<a name="fxppmi160"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="fxppmi161"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="fxppmi162"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="fxppmi163"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a name="fxppmi164"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="fxppmi165"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a name="fxppmi166"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a name="fxppmi167"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local</code></a>
<a name="fxppmi168"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="fxppmi169"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm1</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="fxppmi170"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="fxppmi171"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
<a name="fxppmi172"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
<a name="fxppmi173"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
<a name="fxppmi174"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
<a name="fxppmi175"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
<a name="fxppmi176"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
<a name="fxppmi177"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">is3</code>, <code class="vardecl">ie3</code>, <code class="vardecl">it</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="fxppmi178"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="fxppmi179"></a>    <a href="null.html#tp_core_mod_b" target="diffFile">x0 = big_number</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="fxppmi180"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">is3 = is - <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fxppmi181"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">is3 = <code class="constant">3</code></a>
<a name="fxppmi182"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="fxppmi183"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">ie3 = ie + <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fxppmi184"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">ie3 = npx - <code class="constant">3</code></a>
<a name="fxppmi216"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fxppmi187"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
<a name="fxppmi186"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is3,ie3</a>
<a name="fxppmi185"></a>          <a href="null.html#tp_core_mod_bi50" target="diffFile">bl(i) = b5*q(i-<code class="constant">2</code>, j) + b4*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b2*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi50" target="diffFile"><code class="label">&           </code>) + b1*q(i+<code class="constant">2</code>, j)</a>
          <a href="null.html#tp_core_mod_bi49" target="diffFile">br(i) = b1*q(i-<code class="constant">2</code>, j) + b2*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b4*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a name="fxppmi188"></a><a href="null.html#tp_core_mod_bi49" target="diffFile"><code class="label">&           </code>) + b5*q(i+<code class="constant">2</code>, j)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!--------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! fix the edges</code></a>
<a name="fxppmi199"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!--------------</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="fxppmi198"></a>          <a href="null.html#tp_core_mod_bi61" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q(<code class="constant">0</code>, j)-dxa(<code class="constant">0</code>, j)*q(-<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi61" target="diffFile"><code class="label">&           </code>))/(dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))</a>
<a name="fxppmi197"></a>          <a href="null.html#tp_core_mod_bi60" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q(<code class="constant">1</code>, j)-dxa(<code class="constant">1</code>, j)*q(<code class="constant">2</code>, j))<code class="label">&</code></a>
<a name="fxppmi196"></a><a href="null.html#tp_core_mod_bi60" target="diffFile"><code class="label">&           </code>/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))</a>
<a name="fxppmi195"></a>          <a href="null.html#tp_core_mod_bi59" target="diffFile">br(<code class="constant">2</code>) = p1*(q(<code class="constant">2</code>, j)+q(<code class="constant">3</code>, j)) + p2*(q(<code class="constant">1</code>, j)+q(<code class="constant">4</code>, j)) - q(<code class="constant">2</code>, j)</a>
<a name="fxppmi194"></a>          <a href="null.html#tp_core_mod_bi58" target="diffFile">xt = x0l + x0r</a>
<a name="fxppmi193"></a>          <a href="null.html#tp_core_mod_bi57" target="diffFile">bl(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
<a name="fxppmi192"></a>          <a href="null.html#tp_core_mod_bi56" target="diffFile">br(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null.html#tp_core_mod_bi55" target="diffFile">xt = c1*q(-<code class="constant">2</code>, j) + c2*q(-<code class="constant">1</code>, j) + c3*q(<code class="constant">0</code>, j)</a>
<a href="null.html#tp_core_mod_bi54" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi54" target="diffFile"><code class="comment">!             xt = max( xt, min(q(-1,j),q(0,j)) )</code></a>
<a href="null.html#tp_core_mod_bi54" target="diffFile"><code class="comment">!             xt = min( xt, max(q(-1,j),q(0,j)) )</code></a>
<a name="fxppmi191"></a><a href="null.html#tp_core_mod_bi54" target="diffFile"><code class="comment">!#endif</code></a>
<a name="fxppmi190"></a>          <a href="null.html#tp_core_mod_bi54" target="diffFile">bl(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null.html#tp_core_mod_bi53" target="diffFile">xt = c3*q(<code class="constant">1</code>, j) + c2*q(<code class="constant">2</code>, j) + c1*q(<code class="constant">3</code>, j)</a>
<a href="null.html#tp_core_mod_bi52" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi52" target="diffFile"><code class="comment">!             xt = max( xt, min(q(1,j),q(2,j)) )</code></a>
<a href="null.html#tp_core_mod_bi52" target="diffFile"><code class="comment">!             xt = min( xt, max(q(1,j),q(2,j)) )</code></a>
<a name="fxppmi189"></a><a href="null.html#tp_core_mod_bi52" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi52" target="diffFile">br(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
<a name="fxppmi200"></a>          <a href="null.html#tp_core_mod_bi51" target="diffFile">bl(<code class="constant">2</code>) = xt - q(<code class="constant">2</code>, j)</a>
<a name="fxppmi211"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
<a name="fxppmi210"></a>          <a href="null.html#tp_core_mod_bi72" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q(npx-<code class="constant">1</code>, j)-dxa(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi72" target="diffFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)*q(npx-<code class="constant">2</code>, j))/(dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))</a>
<a name="fxppmi209"></a>          <a href="null.html#tp_core_mod_bi71" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q(npx, j)-dxa(npx, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi71" target="diffFile"><code class="label">&           </code>)*q(npx+<code class="constant">1</code>, j))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))</a>
<a name="fxppmi208"></a>          <a href="null.html#tp_core_mod_bi70" target="diffFile">bl(npx-<code class="constant">2</code>) = p1*(q(npx-<code class="constant">2</code>, j)+q(npx-<code class="constant">3</code>, j)) + p2*(q(npx-<code class="constant">4</code>, j)+q(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi70" target="diffFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)) - q(npx-<code class="constant">2</code>, j)</a>
<a href="null.html#tp_core_mod_bi69" target="diffFile"><code class="comment">!             xt = x0L*sin_sg(npx-1,j,3) + x0R*sin_sg(npx,j,1)</code></a>
<a name="fxppmi207"></a><a href="null.html#tp_core_mod_bi69" target="diffFile"><code class="comment">!             xt = 2.*xt / (sin_sg(npx,j,1) + sin_sg(npx-1,j,3))</code></a>
<a name="fxppmi206"></a>          <a href="null.html#tp_core_mod_bi69" target="diffFile">xt = x0l + x0r</a>
<a name="fxppmi205"></a>          <a href="null.html#tp_core_mod_bi68" target="diffFile">br(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
<a name="fxppmi204"></a>          <a href="null.html#tp_core_mod_bi67" target="diffFile">bl(npx) = xt - q(npx, j)</a>
          <a href="null.html#tp_core_mod_bi66" target="diffFile">xt = c3*q(npx, j) + c2*q(npx+<code class="constant">1</code>, j) + c1*q(npx+<code class="constant">2</code>, j)</a>
<a href="null.html#tp_core_mod_bi65" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi65" target="diffFile"><code class="comment">!             xt = max( xt, min(q(npx,j),q(npx+1,j)) )</code></a>
<a href="null.html#tp_core_mod_bi65" target="diffFile"><code class="comment">!             xt = min( xt, max(q(npx,j),q(npx+1,j)) )</code></a>
<a name="fxppmi203"></a><a href="null.html#tp_core_mod_bi65" target="diffFile"><code class="comment">!#endif</code></a>
<a name="fxppmi202"></a>          <a href="null.html#tp_core_mod_bi65" target="diffFile">br(npx) = xt - q(npx, j)</a>
          <a href="null.html#tp_core_mod_bi64" target="diffFile">xt = c1*q(npx-<code class="constant">3</code>, j) + c2*q(npx-<code class="constant">2</code>, j) + c3*q(npx-<code class="constant">1</code>, j)</a>
<a href="null.html#tp_core_mod_bi63" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi63" target="diffFile"><code class="comment">!             xt = max( xt, min(q(npx-2,j),q(npx-1,j)) )</code></a>
<a href="null.html#tp_core_mod_bi63" target="diffFile"><code class="comment">!             xt = min( xt, max(q(npx-2,j),q(npx-1,j)) )</code></a>
<a name="fxppmi201"></a><a href="null.html#tp_core_mod_bi63" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi63" target="diffFile">br(npx-<code class="constant">2</code>) = xt - q(npx-<code class="constant">2</code>, j)</a>
<a name="fxppmi215"></a>          <a href="null.html#tp_core_mod_bi62" target="diffFile">bl(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
<a name="fxppmi212"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fxppmi213"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_bi73" target="diffFile">flux(i, j) = q(i-<code class="constant">1</code>, j) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i<code class="label">&</code></a>
<a name="fxppmi214"></a><a href="null.html#tp_core_mod_bi73" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)+br(i-<code class="constant">1</code>)))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi74" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi74" target="diffFile"><code class="label">&             </code>(i)))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppm"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FXPPM</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FYPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a name="fyppmi97"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="fyppmi98"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a name="fyppmi99"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
<a name="fyppmi100"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
<a name="fyppmi101"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
<a name="fyppmi102"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a name="fyppmi103"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="fyppmi104"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! real(FVPRC)   , INTENT(OUT)::   dm(ifirst:ilast,jfirst-2:jlast+2)</code></a>
<a name="fyppmi105"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local:</code></a>
<a name="fyppmi106"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="fyppmi107"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="fyppmi108"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="fyppmi109"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a name="fyppmi110"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
<a name="fyppmi111"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
<a name="fyppmi112"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
<a name="fyppmi113"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x0</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
<a name="fyppmi114"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js3</code>, <code class="vardecl">je3</code>, <code class="vardecl">jt</code></a>
<a name="fyppmi115"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="fyppmi116"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
<a name="fyppmi117"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">max1</code></a>
<a name="fyppmi118"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">min1</code></a>
<a name="fyppmi119"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="fyppmi120"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">max1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fyppmi121"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">max1 = <code class="constant">3</code></a>
<a name="fyppmi122"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="fyppmi123"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">min1 = je + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="fyppmi127"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">min1 = npy - <code class="constant">3</code></a>
<a name="fyppmi126"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fyppmi125"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=max1,min1</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a name="fyppmi124"></a>          <a href="null.html#tp_core_mod_bi24" target="diffFile">bl(i, j) = b5*q(i, j-<code class="constant">2</code>) + b4*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b2*q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi24" target="diffFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b1*q(i, j+<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_bi23" target="diffFile">br(i, j) = b1*q(i, j-<code class="constant">2</code>) + b2*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b4*q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi23" target="diffFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b5*q(i, j+<code class="constant">2</code>)</a>
<a name="fyppmi128"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppmi140"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppmi139"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null.html#tp_core_mod_bi35" target="diffFile"><code class="comment">!           br(i,2) = al(i,3) - q(i,2)</code></a>
<a name="fyppmi138"></a>          <a href="null.html#tp_core_mod_bi35" target="diffFile">br(i, <code class="constant">2</code>) = p1*(q(i, <code class="constant">2</code>)+q(i, <code class="constant">3</code>)) + p2*(q(i, <code class="constant">1</code>)+q(i, <code class="constant">4</code>)) - q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi35" target="diffFile"><code class="label">&           </code><code class="constant">2</code>)</a>
<a name="fyppmi137"></a>          <a href="null.html#tp_core_mod_bi34" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)*q(i, -<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi34" target="diffFile"><code class="label">&           </code>))/(dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))</a>
<a name="fyppmi136"></a>          <a href="null.html#tp_core_mod_bi33" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))<code class="label">&</code></a>
<a name="fyppmi135"></a><a href="null.html#tp_core_mod_bi33" target="diffFile"><code class="label">&           </code>/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_bi32" target="diffFile">xt = x0l + x0r</a>
<a href="null.html#tp_core_mod_bi31" target="diffFile"><code class="comment">!            xt = ( x0L*sin_sg(i,0,4) + x0R*sin_sg(i,1,2) ) </code></a>
<a name="fyppmi134"></a><a href="null.html#tp_core_mod_bi31" target="diffFile"><code class="comment">!            xt = 2.*xt / ( sin_sg(i,0,4) + sin_sg(i,1,2) )</code></a>
<a name="fyppmi133"></a>          <a href="null.html#tp_core_mod_bi31" target="diffFile">bl(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_bi30" target="diffFile">br(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a name="fyppmi132"></a><a href="null.html#tp_core_mod_bi29" target="diffFile"><code class="comment">!           xt = s14*0.25*(q(i,0)-q(i,-2)) - s11*(q(i,0)-q(i,-1)) + q(i,0)</code></a>
          <a href="null.html#tp_core_mod_bi29" target="diffFile">xt = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
<a href="null.html#tp_core_mod_bi28" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi28" target="diffFile"><code class="comment">!            xt = min( xt, max(q(i,-1), q(i,0)) )</code></a>
<a href="null.html#tp_core_mod_bi28" target="diffFile"><code class="comment">!            xt = max( xt, min(q(i,-1), q(i,0)) )</code></a>
<a name="fyppmi131"></a><a href="null.html#tp_core_mod_bi28" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi28" target="diffFile">bl(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a name="fyppmi130"></a><a href="null.html#tp_core_mod_bi27" target="diffFile"><code class="comment">!           xt = s15*q(i,1) + s11*q(i,2) - s14*0.25*(q(i,3)-q(i,1))</code></a>
          <a href="null.html#tp_core_mod_bi27" target="diffFile">xt = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
<a href="null.html#tp_core_mod_bi26" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi26" target="diffFile"><code class="comment">!            xt = min( xt, max(q(i,1), q(i,2)) )</code></a>
<a href="null.html#tp_core_mod_bi26" target="diffFile"><code class="comment">!            xt = max( xt, min(q(i,1), q(i,2)) )</code></a>
<a name="fyppmi129"></a><a href="null.html#tp_core_mod_bi26" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi26" target="diffFile">br(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_bi25" target="diffFile">bl(i, <code class="constant">2</code>) = xt - q(i, <code class="constant">2</code>)</a>
<a name="fyppmi141"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppmi153"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fyppmi152"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null.html#tp_core_mod_bi46" target="diffFile"><code class="comment">!           bl(i,npy-2) = al(i,npy-2) - q(i,npy-2)</code></a>
<a name="fyppmi151"></a>          <a href="null.html#tp_core_mod_bi46" target="diffFile">bl(i, npy-<code class="constant">2</code>) = p1*(q(i, npy-<code class="constant">3</code>)+q(i, npy-<code class="constant">2</code>)) + p2*(q(i, npy-<code class="constant">4</code>)+<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi46" target="diffFile"><code class="label">&           </code>q(i, npy-<code class="constant">1</code>)) - q(i, npy-<code class="constant">2</code>)</a>
<a name="fyppmi150"></a>          <a href="null.html#tp_core_mod_bi45" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy-<code class="constant">1</code>)-dya(i<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi45" target="diffFile"><code class="label">&           </code>, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))</a>
<a name="fyppmi149"></a>          <a href="null.html#tp_core_mod_bi44" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy<code class="label">&</code></a>
<a name="fyppmi148"></a><a href="null.html#tp_core_mod_bi44" target="diffFile"><code class="label">&           </code>)*q(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>))</a>
          <a href="null.html#tp_core_mod_bi43" target="diffFile">xt = x0l + x0r</a>
<a href="null.html#tp_core_mod_bi42" target="diffFile"><code class="comment">!            xt = x0L*sin_sg(i,npy-1,4) + x0R*sin_sg(i,npy,2)</code></a>
<a name="fyppmi147"></a><a href="null.html#tp_core_mod_bi42" target="diffFile"><code class="comment">!            xt = 2.*xt /( sin_sg(i,npy-1,4) + sin_sg(i,npy,2) )</code></a>
<a name="fyppmi146"></a>          <a href="null.html#tp_core_mod_bi42" target="diffFile">br(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_bi41" target="diffFile">bl(i, npy) = xt - q(i, npy)</a>
<a name="fyppmi145"></a><a href="null.html#tp_core_mod_bi40" target="diffFile"><code class="comment">!           xt = s11*(q(i,npy+1)-q(i,npy)) - s14*0.25*(q(i,npy+2)-q(i,npy)) + q(i,npy)</code></a>
          <a href="null.html#tp_core_mod_bi40" target="diffFile">xt = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code>)</a>
<a href="null.html#tp_core_mod_bi39" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi39" target="diffFile"><code class="comment">!            xt = min( xt, max(q(i,npy), q(i,npy+1)) )</code></a>
<a href="null.html#tp_core_mod_bi39" target="diffFile"><code class="comment">!            xt = max( xt, min(q(i,npy), q(i,npy+1)) )</code></a>
<a name="fyppmi144"></a><a href="null.html#tp_core_mod_bi39" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi39" target="diffFile">br(i, npy) = xt - q(i, npy)</a>
<a name="fyppmi143"></a><a href="null.html#tp_core_mod_bi38" target="diffFile"><code class="comment">!           xt = s15*q(i,npy-1) + s11*q(i,npy-2) + s14*0.25*(q(i,npy-1)-q(i,npy-3))</code></a>
          <a href="null.html#tp_core_mod_bi38" target="diffFile">xt = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy-<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_bi37" target="diffFile"><code class="comment">!#ifdef DO_MONO_EDGE</code></a>
<a href="null.html#tp_core_mod_bi37" target="diffFile"><code class="comment">!            xt = min( xt, max(q(i,npy-2), q(i,npy-1)) )</code></a>
<a href="null.html#tp_core_mod_bi37" target="diffFile"><code class="comment">!            xt = max( xt, min(q(i,npy-2), q(i,npy-1)) )</code></a>
<a name="fyppmi142"></a><a href="null.html#tp_core_mod_bi37" target="diffFile"><code class="comment">!#endif</code></a>
          <a href="null.html#tp_core_mod_bi37" target="diffFile">br(i, npy-<code class="constant">2</code>) = xt - q(i, npy-<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_bi36" target="diffFile">bl(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
<a name="fyppmi158"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppmi157"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="fyppmi154"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
<a name="fyppmi155"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_bi47" target="diffFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(<code class="label">&</code></a>
<a name="fyppmi156"></a><a href="null.html#tp_core_mod_bi47" target="diffFile"><code class="label">&             </code>bl(i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_bi48" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi48" target="diffFile"><code class="label">&             </code>, j)+br(i, j)))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="mp_ghost_ew"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FYPPM</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code>(<code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">kfirst</code>, <code class="vardecl">klast</code>, <code class="vardecl">ng_w</code>, <code class="vardecl">ng_e</code>, <code class="vardecl">ng_s</code>, <code class="vardecl">ng_n</code>, <code class="vardecl">q_ghst</code>, <code class="vardecl">q</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kfirst</code>, <code class="vardecl">klast</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! eastern  zones to ghost</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_e</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! western  zones to ghost</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_w</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! southern zones to ghost</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_s</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! northern zones to ghost</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_n</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q_ghst</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng_w</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng_e</code>, <code class="vardecl">jfirst</code>-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">ng_s</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng_n</code>, <code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&   </code><code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!     Ghost 4d east/west </code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!    2005.08.22   Putman</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!------------------------------------------------------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!BOC</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">n</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(q)) q_ghst(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:<code class="label">&</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="label">&     </code>nq) = q(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:nq)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!      Assume Periodicity in X-dir and not overlapping</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nq</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>k=kfirst,klast</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=jfirst-ng_s,jlast+ng_n</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_w</a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q_ghst(ifirst-i, j, k, n) = q_ghst(ilast-i+<code class="constant">1</code>, j, k, n)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_e</a>
            <a href="null.html#tp_core_mod_b" target="diffFile">q_ghst(ilast+i, j, k, n) = q_ghst(ifirst+i-<code class="constant">1</code>, j, k, n)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="pert_ppm"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">PERT_PPM</code>(<code class="vardecl">im</code>, <code class="vardecl">a0</code>, <code class="vardecl">al</code>, <code class="vardecl">ar</code>, <code class="vardecl">iv</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iv</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">a0</code>(<code class="vardecl">im</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">al</code>(<code class="vardecl">im</code>), <code class="vardecl">ar</code>(<code class="vardecl">im</code>)</a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">a4</code>, <code class="vardecl">da1</code>, <code class="vardecl">da2</code>, <code class="vardecl">a6da</code>, <code class="vardecl">fmin</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r12</code>=<code class="constant">1.</code>/<code class="constant">12.</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs0</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!-----------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Optimized PPM in perturbation form:</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!-----------------------------------</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (iv .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Positive definite constraint</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (a0(i) .LE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">al(i) = <code class="constant">0.</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">a4 = -(<code class="constant">3.</code>*(ar(i)+al(i)))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile">da1 = ar(i) - al(i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (da1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = da1</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">abs0 = -da1</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. -a4) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">fmin = a0(i) + <code class="constant">0.25</code>/a4*da1**<code class="constant">2 </code>+ a4*r12</a>
            <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (fmin .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
              <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (ar(i) .GT. <code class="constant">0. </code>.AND. al(i) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null.html#tp_core_mod_b" target="diffFile">ar(i) = <code class="constant">0.</code></a>
                <a href="null.html#tp_core_mod_b" target="diffFile">al(i) = <code class="constant">0.</code></a>
              <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (da1 .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null.html#tp_core_mod_b" target="diffFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
              <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
                <a href="null.html#tp_core_mod_b" target="diffFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
              <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Standard PPM constraint</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (al(i)*ar(i) .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">da1 = al(i) - ar(i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile">da2 = da1**<code class="constant">2</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">a6da = <code class="constant">3.</code>*(al(i)+ar(i))*da1</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (a6da .LT. -da2) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (a6da .GT. da2) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_b" target="diffFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! effect of dm=0 included here</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">al(i) = <code class="constant">0.</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_flux"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">PERT_PPM</code></a>
<a name="deln_fluxi37"></a>  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DELN_FLUX</code>(<code class="vardecl">nord</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">damp</code>, <code class="vardecl">q</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">mass</code>)</a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Del-n damping for the cell-mean values (A grid)</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! nord = 0:   del-2</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! nord = 1:   del-4</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! nord = 2:   del-6</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! nord = 3:   del-8 --&gt; requires more ghosting than current</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!------------------</code></a>
<a name="deln_fluxi38"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! del-n</code></a>
<a name="deln_fluxi39"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
<a name="deln_fluxi40"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp</code></a>
<a name="deln_fluxi41"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">is</code>-<code class="vardecl">ng</code>:<code class="vardecl">ie</code>+<code class="vardecl">ng</code>, <code class="vardecl">js</code>-<code class="vardecl">ng</code>:<code class="vardecl">je</code>+<code class="vardecl">ng</code>)</a>
<a name="deln_fluxi42"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="deln_fluxi43"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! diffusive fluxes:</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>), <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a name="deln_fluxi44"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! local:</code></a>
<a name="deln_fluxi45"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>), <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>+<code class="constant">1</code>)</a>
<a name="deln_fluxi46"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">d2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="deln_fluxi47"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp2</code></a>
<a name="deln_fluxi48"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">n</code>, <code class="vardecl">nt</code>, <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">j1</code>, <code class="vardecl">j2</code></a>
<a name="deln_fluxi49"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
<a name="deln_fluxi50"></a>    <a href="null.html#tp_core_mod_b" target="diffFile">i1 = is - <code class="constant">1 </code>- nord</a>
<a name="deln_fluxi51"></a>    <a href="null.html#tp_core_mod_b" target="diffFile">i2 = ie + <code class="constant">1 </code>+ nord</a>
<a name="deln_fluxi52"></a>    <a href="null.html#tp_core_mod_b" target="diffFile">j1 = js - <code class="constant">1 </code>- nord</a>
<a name="deln_fluxi55"></a>    <a href="null.html#tp_core_mod_b" target="diffFile">j2 = je + <code class="constant">1 </code>+ nord</a>
<a name="deln_fluxi54"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (.NOT.<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a name="deln_fluxi53"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null.html#tp_core_mod_bi8" target="diffFile">d2(i, j) = damp*q(i, j)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi58"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi57"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="deln_fluxi56"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null.html#tp_core_mod_bi9" target="diffFile">d2(i, j) = q(i, j)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi60"></a><a name="deln_fluxi59"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi63"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="deln_fluxi62"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) </a><a href="null.html#tp_core_mod_bi10" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
<a name="deln_fluxi61"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js-nord,je+nord</a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is-nord,ie+nord+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_bi11" target="diffFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)*(d2<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi11" target="diffFile"><code class="label">&         </code>(i-<code class="constant">1</code>, j)-d2(i, j))*rdxc(i, j)</a>
<a name="deln_fluxi65"></a><a name="deln_fluxi64"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi68"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi67"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) </a><a href="null.html#tp_core_mod_bi12" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
<a name="deln_fluxi66"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js-nord,je+nord+<code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is-nord,ie+nord</a>
        <a href="null.html#tp_core_mod_bi13" target="diffFile">fy2(i, j) = <code class="constant">0.5</code>*(sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))*dx(i, j)*(d2<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi13" target="diffFile"><code class="label">&         </code>(i, j-<code class="constant">1</code>)-d2(i, j))*rdyc(i, j)</a>
<a name="deln_fluxi69"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi82"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!----------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! high-order</code></a>
<a name="deln_fluxi70"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!----------</code></a>
<a name="deln_fluxi73"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nord</a>
<a name="deln_fluxi72"></a>        <a href="null.html#tp_core_mod_b" target="diffFile">nt = nord - n</a>
<a name="deln_fluxi71"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js-nt-<code class="constant">1</code>,je+nt+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is-nt-<code class="constant">1</code>,ie+nt+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi14" target="diffFile">d2(i, j) = (fx2(i, j)-fx2(i+<code class="constant">1</code>, j)+fy2(i, j)-fy2(i, j+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi14" target="diffFile"><code class="label">&             </code>rarea(i, j)</a>
<a name="deln_fluxi74"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi77"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi76"></a>        <a href="null.html#tp_core_mod_bi15" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
<a name="deln_fluxi75"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js-nt,je+nt</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is-nt,ie+nt+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi16" target="diffFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi16" target="diffFile"><code class="label">&             </code>*(d2(i, j)-d2(i-<code class="constant">1</code>, j))*rdxc(i, j)</a>
<a name="deln_fluxi78"></a>          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi81"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi80"></a>        <a href="null.html#tp_core_mod_bi17" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
<a name="deln_fluxi79"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js-nt,je+nt+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is-nt,ie+nt</a>
            <a href="null.html#tp_core_mod_bi18" target="diffFile">fy2(i, j) = dx(i, j)*(d2(i, j)-d2(i, j-<code class="constant">1</code>))*rdyc(i, j)*<code class="constant">0.5</code>*(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi18" target="diffFile"><code class="label">&             </code>sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi83"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------------------</code></a>
<a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Add the diffusive fluxes to the flux arrays:</code></a>
<a name="deln_fluxi84"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">!---------------------------------------------</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a name="deln_fluxi87"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! Apply mass weighting to diffusive fluxes:</code></a>
<a name="deln_fluxi86"></a>      <a href="null.html#tp_core_mod_b" target="diffFile">damp2 = <code class="constant">0.5</code>*damp</a>
<a name="deln_fluxi85"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_bi19" target="diffFile">fx(i, j) = fx(i, j) + damp2*(mass(i-<code class="constant">1</code>, j)+mass(i, j))*fx2(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi19" target="diffFile"><code class="label">&           </code>)</a>
<a name="deln_fluxi90"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi89"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi88"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_bi20" target="diffFile">fy(i, j) = fy(i, j) + damp2*(mass(i, j-<code class="constant">1</code>)+mass(i, j))*fy2(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_bi20" target="diffFile"><code class="label">&           </code>)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi93"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi92"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="deln_fluxi91"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_bi21" target="diffFile">fx(i, j) = fx(i, j) + fx2(i, j)</a>
<a name="deln_fluxi96"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi95"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_fluxi94"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_bi22" target="diffFile">fy(i, j) = fy(i, j) + fy2(i, j)</a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DELN_FLUX</code></a>
<a name="copy_corners_r8i0"></a>  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
<a name="copy_corners_r8i1"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="copy_corners_r8i2"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
<a name="copy_corners_r8i3"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a name="copy_corners_r8i4"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p22"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i7"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! XDir:</code></a>
<a name="copy_corners_r8i6"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p22" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i5"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_bi0" target="diffFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p23"></a><a name="copy_corners_r8i8"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i11"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i10"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p23" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i9"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi1" target="diffFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p24"></a><a name="copy_corners_r8i12"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i15"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i14"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i13"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi2" target="diffFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p25"></a><a name="copy_corners_r8i16"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i19"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i18"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p25" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i17"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_bi3" target="diffFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i20"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i21"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p26"></a>    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i24"></a><a href="null.html#tp_core_mod_b" target="diffFile"><code class="comment">! YDir:</code></a>
<a name="copy_corners_r8i23"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p26" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i22"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_bi4" target="diffFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p27"></a><a name="copy_corners_r8i25"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i28"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i27"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p27" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i26"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi5" target="diffFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p28"></a><a name="copy_corners_r8i29"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i32"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i31"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p28" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i30"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_bi6" target="diffFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p29"></a><a name="copy_corners_r8i33"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8i36"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r8i35"></a>      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p29" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_b" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
<a name="copy_corners_r8i34"></a>        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_bi7" target="diffFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_b" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code></a>
<code class="keyword">END MODULE </code><code class="funcname">TP_CORE_MOD</code>
</pre>
</body>
