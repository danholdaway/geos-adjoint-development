<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Ecuador team)</code>
<code class="comment">!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30</code>
<code class="comment">!</code>
<code class="keyword">MODULE </code><code class="funcname">TP_CORE_MOD</code>
<code class="comment">!BOP</code>
<code class="comment">!</code>
<code class="comment">! !MODULE: tp_core --- A collection of routines to support FV transport</code>
<code class="comment">!</code>
  <code class="keyword">USE </code><code class="funcname">FV_ARRAYS_MOD</code>, <code class="keyword">ONLY </code>: fvprc, real4, real8, cnvt
  <code class="keyword">USE </code><code class="funcname">FV_MP_MOD</code>, <code class="keyword">ONLY </code>: is, js, ie, je, ng, isd, jsd, ied, jed
  <code class="keyword">USE </code><code class="funcname">FV_GRID_UTILS_MOD</code>, <code class="keyword">ONLY </code>: sw_corner, se_corner, ne_corner, <code class="label">&</code>
<code class="label">& </code>nw_corner, sin_sg =&gt; sin_sg, da_min =&gt; da_min, big_number_r8 =&gt; <code class="label">&</code>
<code class="label">& </code>big_number
  <code class="keyword">USE </code><code class="funcname">FV_GRID_TOOLS_MOD</code>, <code class="keyword">ONLY </code>: grid_type, dx =&gt; dx, dy =&gt; dy, rdxc =&gt; <code class="label">&</code>
<code class="label">& </code>rdxc, rdyc =&gt; rdyc, dxa =&gt; dxa, dya =&gt; dya, area =&gt; area, rarea =&gt; <code class="label">&</code>
<code class="label">& </code>rarea
  <code class="keyword">IMPLICIT NONE</code>
  PRIVATE 
  PUBLIC fv_tp_2d, pert_ppm, copy_corners
<code class="comment">!#ifdef MAPL_MODE</code>
  <code class="typename">LOGICAL</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">nested</code>=<code class="constant">.false.</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r3</code>=<code class="constant">1.</code>/<code class="constant">3.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">near_zero</code>=<code class="constant">1.e-25</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">ppm_limiter</code>=<code class="constant">2.0</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">big_number</code>=<code class="vardecl">big_number_r8</code>
<code class="comment">!#ifdef WAVE_FORM</code>
<code class="comment">!! Suresh & Huynh scheme 2.2 (purtabation form)</code>
<code class="comment">!! The wave-form is more diffusive than scheme 2.1</code>
<code class="comment">! real(FVPRC), parameter:: b1 =   0.0375</code>
<code class="comment">! real(FVPRC), parameter:: b2 =  -7./30.</code>
<code class="comment">! real(FVPRC), parameter:: b3 =  -23./120.</code>
<code class="comment">! real(FVPRC), parameter:: b4 =  13./30.</code>
<code class="comment">! real(FVPRC), parameter:: b5 = -11./240.</code>
<code class="comment">!#else</code>
<code class="comment">! scheme 2.1: perturbation form</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b1</code>=<code class="constant">1.</code>/<code class="constant">30.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b2</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b3</code>=-(<code class="constant">13.</code>/<code class="constant">60.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b4</code>=<code class="constant">0.45</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">b5</code>=-<code class="constant">0.05</code>
<code class="comment">!#endif</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">t11</code>=<code class="constant">27.</code>/<code class="constant">28.</code>, <code class="vardecl">t12</code>=-(<code class="constant">13.</code>/<code class="constant">28.</code>), <code class="vardecl">t13</code>=<code class="constant">3.</code>/<code class="constant">7.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">s11</code>=<code class="constant">11.</code>/<code class="constant">14.</code>, <code class="vardecl">s14</code>=<code class="constant">4.</code>/<code class="constant">7.</code>, <code class="vardecl">s15</code>=<code class="constant">3.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! volume-conserving cubic with 2nd drv=0 at end point:</code>
<code class="comment">!----------------------------------------------------</code>
<code class="comment">! Non-monotonic</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c1</code>=-(<code class="constant">2.</code>/<code class="constant">14.</code>)
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c2</code>=<code class="constant">11.</code>/<code class="constant">14.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">c3</code>=<code class="constant">5.</code>/<code class="constant">14.</code>
<code class="comment">!----------------------</code>
<code class="comment">! PPM volume mean form:</code>
<code class="comment">!----------------------</code>
<code class="comment">! 0.58333333</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p1</code>=<code class="constant">7.</code>/<code class="constant">12.</code>
  <code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">p2</code>=-(<code class="constant">1.</code>/<code class="constant">12.</code>)
<code class="comment">!#ifdef SINGLE_FV</code>
<code class="comment">!   MODULE PROCEDURE fv_tp_2d_r8</code>
<code class="comment">!#endif</code>
  <code class="keyword">INTERFACE </code><code class="funcname">FV_TP_2D</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">FV_TP_2D_R4</code>
  <code class="keyword">END INTERFACE</code>

  <code class="keyword">INTERFACE </code><code class="funcname">COPY_CORNERS</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R4</code>
      <code class="keyword">MODULE PROCEDURE </code><code class="funcname">COPY_CORNERS_R8</code>
  <code class="keyword">END INTERFACE</code>

<a name="fv_tp_2d_r4"></a>
<code class="keyword">CONTAINS</code>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!-----------------------------------------------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!#ifdef SINGLE_FV</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! subroutine fv_tp_2d_r8(qIN, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                     ra_x, ra_y, mfx, mfy, mass, nord, damp_c)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   integer, intent(in):: npx, npy</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   integer, intent(in)::hord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  crx(is:ie+1,jsd:jed)  !</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  xfx(is:ie+1,jsd:jed)  !</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  cry(isd:ied,js:je+1 )  !</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in)::  yfx(isd:ied,js:je+1 )  !</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in):: ra_x(is:ie,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(in):: ra_y(isd:ied,js:je)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(REAL8), intent(in)::  qIN(isd:ied,jsd:jed)  ! transported scalar</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(out)::fx(is:ie+1 ,js:je)    ! Flux in x ( E )</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), intent(out)::fy(is:ie,   js:je+1 )    ! Flux in y ( N )</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! optional Arguments:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfx(is:ie+1,js:je  )  ! Mass Flux X-Dir</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mfy(is:ie  ,js:je+1)  ! Mass Flux Y-Dir</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: mass(isd:ied,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC), OPTIONAL, intent(in):: damp_c</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   integer, OPTIONAL, intent(in):: nord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! Local:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   real(FVPRC)   q(isd:ied,jsd:jed)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   q = CNVT(qIN)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!   call fv_tp_2d(q, crx, cry, npx, npy, hord, fx, fy, xfx, yfx,  &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                     ra_x, ra_y, mfx=mfx, mfy=mfy, mass=mass, nord=nord, damp_c=damp_c)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! end subroutine fv_tp_2d_r8</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!#endif</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">crx</code>, <code class="vardecl">cry</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">hord</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">xfx</code>, <code class="vardecl">yfx</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">ra_x</code>, <code class="vardecl">ra_y</code>, <code class="vardecl">mfx</code>, <code class="vardecl">mfy</code>, <code class="vardecl">mass</code>, <code class="vardecl">nord</code>, <code class="vardecl">damp_c</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">hord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">crx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">xfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">cry</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">yfx</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_x</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ra_y</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! transported scalar</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Flux in x ( E )</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Flux in y ( N )</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! optional Arguments:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Mass Flux X-Dir</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Mass Flux Y-Dir</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mfy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp_c</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ord_in</code>, <code class="vardecl">ord_ou</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_i</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">q_j</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy1</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fyy</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fxx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pwx1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">pwy1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile">ord_in = hord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile">ord_ou = hord</a>
<a name="p4"></a><a name="p3"></a><a name="p2"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">fy2, </a><a href="msg.html#p3" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">q, </a><a href="msg.html#p4" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">cry, ord_in, isd, ied, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy2, q, cry, ord_in, isd, ied, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">fyy(i, j) = yfx(i, j)*fy2(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=isd,ied</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">q_i(i, j) = (q(i, j)*area(i, j)+fyy(i, j)-fyy(i, j+<code class="constant">1</code>))/ra_y(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&         </code>)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p7"></a><a name="p6"></a><a name="p5"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ord_ou .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p5" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">fx1, </a><a href="msg.html#p6" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">q_i, </a><a href="msg.html#p7" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">crx(is, js), ord_ou, is, ie, js, je, npx, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&         </code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx1, q_i, crx(is, js), ord_ou, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p10"></a><a name="p9"></a><a name="p8"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(q, npx, npy, <code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ord_in .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XPPM0</code>(</a><a href="msg.html#p8" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">fx2, </a><a href="msg.html#p9" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">q, </a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">XTP</code>(fx2, q, crx, ord_in, is, ie, jsd, jed, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jsd,jed</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">fxx(i) = xfx(i, j)*fx2(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">q_j(i, j) = (q(i, j)*area(i, j)+fxx(i)-fxx(i+<code class="constant">1</code>))/ra_x(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p13"></a><a name="p12"></a><a name="p11"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ord_ou .LT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YPPM0</code>(</a><a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">fy1, </a><a href="msg.html#p12" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">q_j, </a><a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">cry, ord_ou, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">YTP</code>(fy1, q_j, cry, ord_ou, is, ie, js, je, npx, npy)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!----------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Flux averaging:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!----------------</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mfx) .AND. <code class="funcname">PRESENT</code>(mfy)) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! For transport of pt and tracers</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*mfx(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*mfy(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c) .AND. <code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">pwx1 = damp_c*da_min</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">pwy1 = nord + <code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">damp = pwx1**pwy1</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy, mass)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! For transport of delp, vorticity</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = <code class="constant">0.5</code>*(fx1(i, j)+fx2(i, j))*xfx(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = <code class="constant">0.5</code>*(fy1(i, j)+fy2(i, j))*yfx(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(nord) .AND. <code class="funcname">PRESENT</code>(damp_c)) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (damp_c .GT. <code class="constant">1.e-4</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">pwx1 = damp_c*da_min</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">pwy1 = nord + <code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">damp = pwx1**pwy1</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">DELN_FLUX</code>(nord, npx, npy, damp, q, fx, fy)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="copy_corners_r4"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FV_TP_2D_R4</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">real4</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p14"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! XDir:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p15"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p16"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p17"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p18"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! YDir:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p18" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p19"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p19" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p20"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p21"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p21" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="xtp"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R4</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XTP</code>(<code class="vardecl">fx</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant numbers</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">is</code>-<code class="constant">2</code>:<code class="vardecl">ie</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = q(i-<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = q(i, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (iord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!Advection using third order scheme</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i-<code class="constant">1</code>, j)-q(i-<code class="constant">2</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+q(i-<code class="constant">2</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = (<code class="constant">2.0</code>*q(i-<code class="constant">1</code>, j)+<code class="constant">5.0</code>*q(i, j)-q(i+<code class="constant">1</code>, j))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i-<code class="constant">1</code>, j)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i-<code class="constant">1</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">FXPPM</code>(c, q, fx, iord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="ytp"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XTP</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YTP</code>(<code class="vardecl">fy</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fy</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !LOCAL VARIABLES:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code>, <code class="vardecl">x1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = q(i, j-<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = q(i, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (jord .EQ. <code class="constant">333</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!Advected using third order scheme</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j)+<code class="constant">5.0</code>*q(i, j-<code class="constant">1</code>)-q(i, j-<code class="constant">2</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j)-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code><code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+q(i, j-<code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = (<code class="constant">2.0</code>*q(i, j-<code class="constant">1</code>)+<code class="constant">5.0</code>*q(i, j)-q(i, j+<code class="constant">1</code>))/<code class="constant">6.0 </code>- <code class="constant">0.5</code>*c<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i, j)*(q(i, j)-q(i, j-<code class="constant">1</code>)) + c(i, j)*c(i, j)/<code class="constant">6.0</code>*(q(i, j+<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>)-<code class="constant">2.0</code>*q(i, j)+q(i, j-<code class="constant">1</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">FYPPM</code>(c, q, fy, jord, ifirst, ilast, jfirst, jlast, npx, npy)</a>
<a name="xppm0"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YTP</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!#ifdef XPPM_2D</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! subroutine xppm0(flux, q, c, iord, ifirst, ilast, jfirst, jlast, npx, npy, bd, dxa, nested, grid_type)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! type(fv_grid_bounds_type), intent(IN) :: bd</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer, INTENT(IN) :: ifirst, ilast               !  X-Dir strip</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer, INTENT(IN) :: jfirst, jlast               !  Y-Dir strip</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer, INTENT(IN) :: iord</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer, INTENT(IN) :: npx, npy</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real   , INTENT(IN) :: q(ifirst-ng:ilast+ng,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real   , INTENT(IN) :: c(ifirst   :ilast+1 ,jfirst:jlast) ! Courant   N (like FLUX)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real   , intent(IN) :: dxa(bd%isd:bd%ied,bd%jsd:bd%jed)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! logical, intent(IN) :: nested</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer, intent(IN) :: grid_type</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! !OUTPUT PARAMETERS:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real  , INTENT(OUT) :: flux(ifirst:ilast+1,jfirst:jlast) !  Flux</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! Local</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real, dimension(3*jfirst:3*jlast+2) :: q_tmp, bl_tmp, br_tmp</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real, dimension(ifirst-1:ilast+1,jfirst:jlast):: bl, br</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real  al(ifirst-1:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real  dm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real  dq(ifirst-3:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! logical extm(ifirst-2:ilast+2,jfirst:jlast)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! integer i, j, ie3, is1, ie1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real xt, pmp_1, lac_1, pmp_2, lac_2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    is1 = max(3,is-1);  ie3 = min(npx-2,ie+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                        ie1 = min(npx-3,ie+1)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    is1 = is-1;         ie3 = ie+2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                        ie1 = ie+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! end if</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! if ( abs(iord) &lt; 8 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    ! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    ! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    ! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do i=is1, ie3</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          al(i,j) = p1*(q(i-1,j)+q(i,j)) + p2*(q(i-2,j)+q(i+1,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    if ( .not. nested .and. grid_type&lt;3 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(0,j) = c1*q(-2,j) + c2*q(-1,j) + c3*q(0,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(1,j) = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(2,j) = c3*q(1,j) + c2*q(2,j) +c1*q(3,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(0,j) = max(0., al(0,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(1,j) = max(0., al(1,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(2,j) = max(0., al(2,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       if ( (ie+1)==npx ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(npx-1,j) = c1*q(npx-3,j) + c2*q(npx-2,j) + c3*q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(npx,j) = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                  +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j)-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             al(npx+1,j) = c3*q(npx,j) + c2*q(npx+1,j) + c1*q(npx+2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          if(iord==-7) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(npx-1,j) = max(0., al(npx-1,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(npx,  j) = max(0., al(npx  ,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                al(npx+1,j) = max(0., al(npx+1,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    if ( iord==-5 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=ifirst-3,ilast+2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=ifirst-2, ilast+2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             if ( dq(i-1,j)*dq(i,j) &gt; 0. ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                extm(i,j) = .false.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                extm(i,j) = .true.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=ifirst-1,ilast+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             if ( extm(i-1,j).and.extm(i,j).and.extm(i+1,j) ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                bl(i,j) = al(i,j)   - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       ! Additional positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       if(iord==-7) call pert_ppm(ilast-ifirst+3, q(ifirst-1,j), bl(ifirst-1,j), br(ifirst-1,j), 0)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! Monotonic constraints:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! ord = 8: PPM with Lin's PPM fast monotone constraint</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! ord = 10: PPM with Lin's modification of Huynh 2nd constraint</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!! ord = 13: 10 plus positive definite constraint</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do i=is-2,ie+2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          xt = 0.25*(q(i+1,j) - q(i-1,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          dm(i,j) = sign(min(abs(xt), max(q(i-1,j), q(i,j), q(i+1,j)) - q(i,j),  &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!               q(i,j) - min(q(i-1,j), q(i,j), q(i+1,j))), xt)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do i=is1,ie1+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          al(i,j) = 0.5*(q(i-1,j)+q(i,j)) + r3*(dm(i-1,j)-dm(i,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    if ( iord==-8 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             xt = 2.*dm(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl(i,j) = -sign(min(abs(xt), abs(al(i,j  )-q(i,j))), xt)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br(i,j) =  sign(min(abs(xt), abs(al(i+1,j)-q(i,j))), xt)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=is1-2, ie1+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             dq(i,j) = q(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do i=is1, ie1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl(i,j) = al(i,j  ) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br(i,j) = al(i+1,j) - q(i,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             if ( abs(dm(i-1,j))+abs(dm(i,j))+abs(dm(i+1,j)) &lt; near_zero ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                bl(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                br(i,j) = 0.</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             elseif( abs(3.*(bl(i,j)+br(i,j))) &gt; abs(bl(i,j)-br(i,j)) ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                pmp_1 = -(dq(i,j) + dq(i,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                lac_1 = pmp_1 + 1.5*dq(i+1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                bl(i,j) = min( max(0., pmp_1, lac_1), max(bl(i,j), min(0., pmp_1, lac_1)) )</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                pmp_2 = dq(i-1,j) + dq(i-1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                lac_2 = pmp_2 - 1.5*dq(i-2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                br(i,j) = min( max(0., pmp_2, lac_2), max(br(i,j), min(0., pmp_2, lac_2)) )</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    ! Positive definite constraint:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    if(iord==-9 .or. iord==-13) call pert_ppm(ie1-is1+1, q(is1,j), bl(is1,j), br(is1,j), 0)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    if (.not. nested .and. grid_type&lt;3) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!       if ( is==1 ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl_tmp(3*j) = s14*dm(-1,j) + s11*(q(-1,j)-q(0,j))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             xt = 0.5*(((2.*dxa(0,j)+dxa(-1,j))*q(0,j)-dxa(0,j)*q(-1,j))/(dxa(-1,j)+dxa(0,j)) &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!                  +      ((2.*dxa(1,j)+dxa( 2,j))*q(1,j)-dxa(1,j)*q(2,j))/(dxa(1, j)+dxa(2,j)))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br_tmp(3*j) = xt - q(0,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             xt = s15*q(1,j) + s11*q(2,j) - s14*dm(2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br_tmp(3*j+1) = xt - q(1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl_tmp(3*j+2) = xt - q(2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br_tmp(3*j+2) = al(3,j) - q(2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             q_tmp(j*3:j*3+2) = q(0:2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             bl(0:2,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             br(0:2,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!          enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!      endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!      if ( (ie+1)==npx ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            bl_tmp(3*j) = al(npx-2,j) - q(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = s15*q(npx-1,j) + s11*q(npx-2,j) + s14*dm(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            br_tmp(3*j) = xt - q(npx-2,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            bl_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = 0.5*(((2.*dxa(npx-1,j)+dxa(npx-2,j))*q(npx-1,j)-dxa(npx-1,j)*q(npx-2,j))/(dxa(npx-2,j)+dxa(npx-1,j)) &</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!               +      ((2.*dxa(npx,  j)+dxa(npx+1,j))*q(npx,j  )-dxa(npx,  j)*q(npx+1,j))/(dxa(npx,  j)+dxa(npx+1,j)))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            br_tmp(3*j+1) = xt - q(npx-1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            bl_tmp(3*j+2) = xt - q(npx,j  )</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            br_tmp(3*j+2) = s11*(q(npx+1,j)-q(npx,j)) - s14*dm(npx+1,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            q_tmp(j*3:j*3+2) = q(npx-2:npx,j)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!         enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!         call pert_ppm(3*(jlast-jfirst+1), q_tmp, bl_tmp, br_tmp, 1)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!         do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            bl(npx-2:npx,j) = bl_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            br(npx-2:npx,j) = br_tmp(j*3:j*3+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!         enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!      endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  do j=jfirst,jlast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!!DEC$ VECTOR ALWAYS</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!     do i=ifirst,ilast+1</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!        if( c(i,j)&gt;0. ) then</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           flux(i,j) = q(i-1,j) + (1.-c(i,j))*(br(i-1,j)-c(i,j)*(bl(i-1,j)+br(i-1,j)))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!        else</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           flux(i,j) = q(i,j  ) + (1.+c(i,j))*(bl(i,j  )+c(i,j)*(bl(i,j  )+br(i,j  )))</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!        endif</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!     enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  enddo</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! end subroutine xppm0</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!#else</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">XPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-ng:ilast+ng<code class="typename">) </code>:: <code class="vardecl">q1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>ifirst-<code class="constant">1</code>:ilast+<code class="constant">1</code><code class="typename">) </code>:: <code class="vardecl">bl</code>, <code class="vardecl">br</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ie3</code>, <code class="vardecl">is1</code>, <code class="vardecl">ie1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">is1 = is - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">is1 = <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">2 </code>.GT. ie + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">ie3 = npx - <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">ie1 = ie + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">ie1 = npx - <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">is1 = is - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">ie3 = ie + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">ie1 = ie + <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst-ng,ilast+ng</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">q1(i) = q(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (iord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = iord</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = -iord</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a name="p30"></a><a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is1,ie3</a>
          <a href="msg.html#p30" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i) = p1*(q1(i-<code class="constant">1</code>)+q1(i)) + p2*(q1(i-<code class="constant">2</code>)+q1(i+<code class="constant">1</code>))</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p31"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p32"></a>          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
            <a href="msg.html#p31" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(<code class="constant">0</code>) = c1*q1(-<code class="constant">2</code>) + c2*q1(-<code class="constant">1</code>) + c3*q1(<code class="constant">0</code>)</a>
            <a href="msg.html#p32" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(<code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q1(<code class="constant">0</code>)-dxa(<code class="constant">0</code>, j)*q1(-<code class="label">&</code></a>
<a name="p33"></a><a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code><code class="constant">1</code>))/(dxa(-<code class="constant">1</code>, j)+dxa(<code class="constant">0</code>, j))+((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q1(<code class="constant">1</code>)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>-dxa(<code class="constant">1</code>, j)*q1(<code class="constant">2</code>))/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j)))</a>
            <a href="msg.html#p33" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(<code class="constant">2</code>) = c3*q1(<code class="constant">1</code>) + c2*q1(<code class="constant">2</code>) + c1*q1(<code class="constant">3</code>)</a>
<a name="p34"></a>          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p35"></a>          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
            <a href="msg.html#p34" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(npx-<code class="constant">1</code>) = c1*q1(npx-<code class="constant">3</code>) + c2*q1(npx-<code class="constant">2</code>) + c3*q1(npx-<code class="constant">1</code>)</a>
            <a href="msg.html#p35" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(npx) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q1(npx-<code class="constant">1</code>)-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>dxa(npx-<code class="constant">1</code>, j)*q1(npx-<code class="constant">2</code>))/(dxa(npx-<code class="constant">2</code>, j)+dxa(npx-<code class="constant">1</code>, j))+((<code class="label">&</code></a>
<a name="p36"></a><a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code><code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q1(npx)-dxa(npx, j)*q1(npx+<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j)))</a>
            <a href="msg.html#p36" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(npx+<code class="constant">1</code>) = c3*q1(npx) + c2*q1(npx+<code class="constant">1</code>) + c1*q1(npx+<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (iord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst-<code class="constant">1</code>,ilast+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">bl(i) = al(i) - q1(i)</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">br(i) = al(i+<code class="constant">1</code>) - q1(i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q1(i-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i-<code class="constant">1</code>)+<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>br(i-<code class="constant">1</code>)))</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q1(i) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br(i))<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="yppm0"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">XPPM0</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!#endif</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">YPPM0</code>(<code class="vardecl">flux</code>, <code class="vardecl">q</code>, <code class="vardecl">c</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">xt</code>, <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js1</code>, <code class="vardecl">je3</code>, <code class="vardecl">je1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">abs0</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">js1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">js1 = <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">2 </code>.GT. je + <code class="constant">2</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">je3 = je + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">je3 = npy - <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">je1 = je + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">je1 = npy - <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Nested grid OR Doubly periodic domain:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">js1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">je3 = je + <code class="constant">2</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">je1 = je + <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (jord .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = jord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = -jord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. <code class="constant">8</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -5: linear scheme based on PPM 4th order interpolation</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -6: linear PPM with 2-delta filter</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! ord = -7: (-6) with additional Positive definite constraint:</code></a>
<a name="p37"></a>      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js1,je3</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="msg.html#p37" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, j) = p1*(q(i, j-<code class="constant">1</code>)+q(i, j)) + p2*(q(i, j-<code class="constant">2</code>)+q(i, j+<code class="constant">1</code>))</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (.NOT.nested .AND. grid_type .LT. <code class="constant">3</code>) <code class="keyword">THEN</code></a>
<a name="p38"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a name="p39"></a>          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="msg.html#p38" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, <code class="constant">0</code>) = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
            <a href="msg.html#p39" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, <code class="constant">1</code>) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)<code class="label">&</code></a>
<a name="p40"></a><a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>*q(i, -<code class="constant">1</code>))/(dya(i, -<code class="constant">1</code>)+dya(i, <code class="constant">0</code>))+((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>)*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>)))</a>
            <a href="msg.html#p40" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, <code class="constant">2</code>) = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p41"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a name="p42"></a>            <a href="msg.html#p41" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, npy-<code class="constant">1</code>) = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)</a>
            <a href="msg.html#p42" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, npy) = <code class="constant">0.5</code>*(((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)-dya(i, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">2</code>)+dya(i, npy-<code class="constant">1</code><code class="label">&</code></a>
<a name="p43"></a><a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>))+((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy)*q<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>)))</a>
            <a href="msg.html#p43" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">al(i, npy+<code class="constant">1</code>) = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (jord .EQ. -<code class="constant">5</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst-<code class="constant">1</code>,jlast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, j) = al(i, j) - q(i, j)</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">br(i, j) = al(i, j+<code class="constant">1</code>) - q(i, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(bl(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)+br(i, j)))</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fxppm"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">YPPM0</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FXPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">iord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant   N (like FLUX)</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !OUTPUT PARAMETERS:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dm1</code>(<code class="vardecl">ifirst</code>-<code class="constant">2</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>-<code class="constant">1</code>:<code class="vardecl">ilast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>-<code class="constant">3</code>:<code class="vardecl">ilast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">is3</code>, <code class="vardecl">ie3</code>, <code class="vardecl">it</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile">x0 = big_number</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. is - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">is3 = is - <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">is3 = <code class="constant">3</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npx - <code class="constant">3 </code>.GT. ie + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">ie3 = ie + <code class="constant">1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">ie3 = npx - <code class="constant">3</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (iord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!From NCEP dynamics version</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is3,ie3</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i) = b5*q(i-<code class="constant">2</code>, j) + b4*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b2*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>) + b1*q(i+<code class="constant">2</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i) = b1*q(i-<code class="constant">2</code>, j) + b2*q(i-<code class="constant">1</code>, j) + b3*q(i, j) + b4*q(i+<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>) + b5*q(i+<code class="constant">2</code>, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!--------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! fix the edges</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!--------------</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (is .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))*q(<code class="constant">0</code>, j)-dxa(<code class="constant">0</code>, j)*q(-<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>))/(dxa(<code class="constant">0</code>, j)+dxa(-<code class="constant">1</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))*q(<code class="constant">1</code>, j)-dxa(<code class="constant">1</code>, j)*q(<code class="constant">2</code>, j))<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>/(dxa(<code class="constant">1</code>, j)+dxa(<code class="constant">2</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(<code class="constant">2</code>) = p1*(q(<code class="constant">2</code>, j)+q(<code class="constant">3</code>, j)) + p2*(q(<code class="constant">1</code>, j)+q(<code class="constant">4</code>, j)) - q(<code class="constant">2</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = x0l + x0r</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c1*q(-<code class="constant">2</code>, j) + c2*q(-<code class="constant">1</code>, j) + c3*q(<code class="constant">0</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(<code class="constant">0</code>) = xt - q(<code class="constant">0</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c3*q(<code class="constant">1</code>, j) + c2*q(<code class="constant">2</code>, j) + c1*q(<code class="constant">3</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(<code class="constant">1</code>) = xt - q(<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(<code class="constant">2</code>) = xt - q(<code class="constant">2</code>, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ie + <code class="constant">1 </code>.EQ. npx) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))*q(npx-<code class="constant">1</code>, j)-dxa(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)*q(npx-<code class="constant">2</code>, j))/(dxa(npx-<code class="constant">1</code>, j)+dxa(npx-<code class="constant">2</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))*q(npx, j)-dxa(npx, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)*q(npx+<code class="constant">1</code>, j))/(dxa(npx, j)+dxa(npx+<code class="constant">1</code>, j))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(npx-<code class="constant">2</code>) = p1*(q(npx-<code class="constant">2</code>, j)+q(npx-<code class="constant">3</code>, j)) + p2*(q(npx-<code class="constant">4</code>, j)+q(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>npx-<code class="constant">1</code>, j)) - q(npx-<code class="constant">2</code>, j)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             xt = x0L*sin_sg(npx-1,j,3) + x0R*sin_sg(npx,j,1)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!             xt = 2.*xt / (sin_sg(npx,j,1) + sin_sg(npx-1,j,3))</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = x0l + x0r</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(npx) = xt - q(npx, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c3*q(npx, j) + c2*q(npx+<code class="constant">1</code>, j) + c1*q(npx+<code class="constant">2</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(npx) = xt - q(npx, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c1*q(npx-<code class="constant">3</code>, j) + c2*q(npx-<code class="constant">2</code>, j) + c3*q(npx-<code class="constant">1</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(npx-<code class="constant">2</code>) = xt - q(npx-<code class="constant">2</code>, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(npx-<code class="constant">1</code>) = xt - q(npx-<code class="constant">1</code>, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i-<code class="constant">1</code>, j) + (<code class="constant">1.</code>-c(i, j))*(br(i-<code class="constant">1</code>)-c(i, j)*(bl(i<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>-<code class="constant">1</code>)+br(i-<code class="constant">1</code>)))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i)+c(i, j)*(bl(i)+br<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>(i)))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="fyppm"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FXPPM</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">FYPPM</code>(<code class="vardecl">c</code>, <code class="vardecl">q</code>, <code class="vardecl">flux</code>, <code class="vardecl">jord</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="vardecl">npx</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">npy</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  X-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Y-Dir strip</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="vardecl">ng</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Courant number</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">c</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!  Flux</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! real(FVPRC)   , INTENT(OUT)::   dm(ifirst:ilast,jfirst-2:jlast+2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">extm</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">2</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">al</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">bl</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">br</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">1</code>:<code class="vardecl">jlast</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dq</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>-<code class="constant">3</code>:<code class="vardecl">jlast</code>+<code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">dl</code>, <code class="vardecl">dr</code>, <code class="vardecl">pmp</code>, <code class="vardecl">lac</code>, <code class="vardecl">ct</code>, <code class="vardecl">qe</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">pmp_1</code>, <code class="vardecl">lac_1</code>, <code class="vardecl">pmp_2</code>, <code class="vardecl">lac_2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">xt</code>, <code class="vardecl">x0</code>, <code class="vardecl">x1</code>, <code class="vardecl">x0l</code>, <code class="vardecl">x0r</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">js3</code>, <code class="vardecl">je3</code>, <code class="vardecl">jt</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">max1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">min1</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (jord .EQ. <code class="constant">666</code>) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="constant">3 </code>.LT. js - <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">max1 = js - <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">max1 = <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (npy - <code class="constant">3 </code>.GT. je + <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">min1 = je + <code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">min1 = npy - <code class="constant">3</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=max1,min1</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, j) = b5*q(i, j-<code class="constant">2</code>) + b4*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b2*q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b1*q(i, j+<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, j) = b1*q(i, j-<code class="constant">2</code>) + b2*q(i, j-<code class="constant">1</code>) + b3*q(i, j) + b4*q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>j+<code class="constant">1</code>) + b5*q(i, j+<code class="constant">2</code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (js .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           br(i,2) = al(i,3) - q(i,2)</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, <code class="constant">2</code>) = p1*(q(i, <code class="constant">2</code>)+q(i, <code class="constant">3</code>)) + p2*(q(i, <code class="constant">1</code>)+q(i, <code class="constant">4</code>)) - q(i, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code><code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))*q(i, <code class="constant">0</code>)-dya(i, <code class="constant">0</code>)*q(i, -<code class="constant">1</code><code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>))/(dya(i, <code class="constant">0</code>)+dya(i, -<code class="constant">1</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))*q(i, <code class="constant">1</code>)-dya(i, <code class="constant">1</code>)*q(i, <code class="constant">2</code>))<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>/(dya(i, <code class="constant">1</code>)+dya(i, <code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = x0l + x0r</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = ( x0L*sin_sg(i,0,4) + x0R*sin_sg(i,1,2) ) </code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = 2.*xt / ( sin_sg(i,0,4) + sin_sg(i,1,2) )</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           xt = s14*0.25*(q(i,0)-q(i,-2)) - s11*(q(i,0)-q(i,-1)) + q(i,0)</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c1*q(i, -<code class="constant">2</code>) + c2*q(i, -<code class="constant">1</code>) + c3*q(i, <code class="constant">0</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, <code class="constant">0</code>) = xt - q(i, <code class="constant">0</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           xt = s15*q(i,1) + s11*q(i,2) - s14*0.25*(q(i,3)-q(i,1))</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c3*q(i, <code class="constant">1</code>) + c2*q(i, <code class="constant">2</code>) + c1*q(i, <code class="constant">3</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, <code class="constant">1</code>) = xt - q(i, <code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, <code class="constant">2</code>) = xt - q(i, <code class="constant">2</code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (je + <code class="constant">1 </code>.EQ. npy) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           bl(i,npy-2) = al(i,npy-2) - q(i,npy-2)</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, npy-<code class="constant">2</code>) = p1*(q(i, npy-<code class="constant">3</code>)+q(i, npy-<code class="constant">2</code>)) + p2*(q(i, npy-<code class="constant">4</code>)+<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>q(i, npy-<code class="constant">1</code>)) - q(i, npy-<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0l = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))*q(i, npy-<code class="constant">1</code>)-dya(i<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>, npy-<code class="constant">1</code>)*q(i, npy-<code class="constant">2</code>))/(dya(i, npy-<code class="constant">1</code>)+dya(i, npy-<code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">x0r = <code class="constant">0.5</code>*((<code class="constant">2.</code>*dya(i, npy)+dya(i, npy+<code class="constant">1</code>))*q(i, npy)-dya(i, npy<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)*q(i, npy+<code class="constant">1</code>))/(dya(i, npy)+dya(i, npy+<code class="constant">1</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = x0l + x0r</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = x0L*sin_sg(i,npy-1,4) + x0R*sin_sg(i,npy,2)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!            xt = 2.*xt /( sin_sg(i,npy-1,4) + sin_sg(i,npy,2) )</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, npy) = xt - q(i, npy)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           xt = s11*(q(i,npy+1)-q(i,npy)) - s14*0.25*(q(i,npy+2)-q(i,npy)) + q(i,npy)</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c3*q(i, npy) + c2*q(i, npy+<code class="constant">1</code>) + c1*q(i, npy+<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, npy) = xt - q(i, npy)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!           xt = s15*q(i,npy-1) + s11*q(i,npy-2) + s14*0.25*(q(i,npy-1)-q(i,npy-3))</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">xt = c1*q(i, npy-<code class="constant">3</code>) + c2*q(i, npy-<code class="constant">2</code>) + c3*q(i, npy-<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">br(i, npy-<code class="constant">2</code>) = xt - q(i, npy-<code class="constant">2</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">bl(i, npy-<code class="constant">1</code>) = xt - q(i, npy-<code class="constant">1</code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst,jlast+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=ifirst,ilast</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (c(i, j) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i, j-<code class="constant">1</code>) + (<code class="constant">1.</code>-c(i, j))*(br(i, j-<code class="constant">1</code>)-c(i, j)*(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>bl(i, j-<code class="constant">1</code>)+br(i, j-<code class="constant">1</code>)))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">flux(i, j) = q(i, j) + (<code class="constant">1.</code>+c(i, j))*(bl(i, j)+c(i, j)*(bl(i<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>, j)+br(i, j)))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="mp_ghost_ew"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">FYPPM</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code>(<code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code>, <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">kfirst</code>, <code class="vardecl">klast</code>, <code class="vardecl">ng_w</code>, <code class="vardecl">ng_e</code>, <code class="vardecl">ng_s</code>, <code class="vardecl">ng_n</code>, <code class="vardecl">q_ghst</code>, <code class="vardecl">q</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !INPUT PARAMETERS:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code>, <code class="vardecl">jm</code>, <code class="vardecl">km</code>, <code class="vardecl">nq</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ifirst</code>, <code class="vardecl">ilast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">jfirst</code>, <code class="vardecl">jlast</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kfirst</code>, <code class="vardecl">klast</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! eastern  zones to ghost</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_e</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! western  zones to ghost</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_w</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! southern zones to ghost</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_s</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! northern zones to ghost</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ng_n</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q_ghst</code>(<code class="vardecl">ifirst</code>-<code class="vardecl">ng_w</code>:<code class="vardecl">ilast</code>+<code class="vardecl">ng_e</code>, <code class="vardecl">jfirst</code>-<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">ng_s</code>:<code class="vardecl">jlast</code>+<code class="vardecl">ng_n</code>, <code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">ifirst</code>:<code class="vardecl">ilast</code>, <code class="vardecl">jfirst</code>:<code class="vardecl">jlast</code>, <code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&   </code><code class="vardecl">kfirst</code>:<code class="vardecl">klast</code>, <code class="vardecl">nq</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !DESCRIPTION:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!     Ghost 4d east/west </code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! !REVISION HISTORY:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!    2005.08.22   Putman</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!EOP</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!------------------------------------------------------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!BOC</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">n</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(q)) q_ghst(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&     </code>nq) = q(ifirst:ilast, jfirst:jlast, kfirst:klast, <code class="constant">1</code>:nq)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!      Assume Periodicity in X-dir and not overlapping</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nq</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>k=kfirst,klast</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=jfirst-ng_s,jlast+ng_n</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_w</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q_ghst(ifirst-i, j, k, n) = q_ghst(ilast-i+<code class="constant">1</code>, j, k, n)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ng_e</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q_ghst(ilast+i, j, k, n) = q_ghst(ifirst+i-<code class="constant">1</code>, j, k, n)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="pert_ppm"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">MP_GHOST_EW</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">PERT_PPM</code>(<code class="vardecl">im</code>, <code class="vardecl">a0</code>, <code class="vardecl">al</code>, <code class="vardecl">ar</code>, <code class="vardecl">iv</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">im</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">iv</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">a0</code>(<code class="vardecl">im</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">al</code>(<code class="vardecl">im</code>), <code class="vardecl">ar</code>(<code class="vardecl">im</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">a4</code>, <code class="vardecl">da1</code>, <code class="vardecl">da2</code>, <code class="vardecl">a6da</code>, <code class="vardecl">fmin</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">r12</code>=<code class="constant">1.</code>/<code class="constant">12.</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs0</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!-----------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Optimized PPM in perturbation form:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!-----------------------------------</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (iv .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Positive definite constraint</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (a0(i) .LE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">al(i) = <code class="constant">0.</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">a4 = -(<code class="constant">3.</code>*(ar(i)+al(i)))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">da1 = ar(i) - al(i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (da1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = da1</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">abs0 = -da1</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (abs0 .LT. -a4) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fmin = a0(i) + <code class="constant">0.25</code>/a4*da1**<code class="constant">2 </code>+ a4*r12</a>
            <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (fmin .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
              <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (ar(i) .GT. <code class="constant">0. </code>.AND. al(i) .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null.html#tp_core_mod_d" target="diffFile">ar(i) = <code class="constant">0.</code></a>
                <a href="null.html#tp_core_mod_d" target="diffFile">al(i) = <code class="constant">0.</code></a>
              <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (da1 .GT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
                <a href="null.html#tp_core_mod_d" target="diffFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
              <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
                <a href="null.html#tp_core_mod_d" target="diffFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
              <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Standard PPM constraint</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,im</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (al(i)*ar(i) .LT. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">da1 = al(i) - ar(i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">da2 = da1**<code class="constant">2</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">a6da = <code class="constant">3.</code>*(al(i)+ar(i))*da1</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (a6da .LT. -da2) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">ar(i) = -(<code class="constant">2.</code>*al(i))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (a6da .GT. da2) <code class="keyword">THEN</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">al(i) = -(<code class="constant">2.</code>*ar(i))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! effect of dm=0 included here</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">al(i) = <code class="constant">0.</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">ar(i) = <code class="constant">0.</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="deln_flux"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">PERT_PPM</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">DELN_FLUX</code>(<code class="vardecl">nord</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">damp</code>, <code class="vardecl">q</code>, <code class="vardecl">fx</code>, <code class="vardecl">fy</code>, <code class="vardecl">mass</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Del-n damping for the cell-mean values (A grid)</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! nord = 0:   del-2</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! nord = 1:   del-4</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! nord = 2:   del-6</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! nord = 3:   del-8 --&gt; requires more ghosting than current</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! del-n</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nord</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">damp</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">q</code>(<code class="vardecl">is</code>-<code class="vardecl">ng</code>:<code class="vardecl">ie</code>+<code class="vardecl">ng</code>, <code class="vardecl">js</code>-<code class="vardecl">ng</code>:<code class="vardecl">je</code>+<code class="vardecl">ng</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! q ghosted on input</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">OPTIONAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">mass</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! diffusive fluxes:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">fx</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>+<code class="constant">1</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>), <code class="vardecl">fy</code>(<code class="vardecl">is</code>:<code class="vardecl">ie</code>, <code class="vardecl">js</code>:<code class="vardecl">je</code>+<code class="constant">1</code>)</a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! local:</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">fx2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>+<code class="constant">1</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>), <code class="vardecl">fy2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>+<code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">d2</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">fvprc</code><code class="typename">) </code>:: <code class="vardecl">damp2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">n</code>, <code class="vardecl">nt</code>, <code class="vardecl">i1</code>, <code class="vardecl">i2</code>, <code class="vardecl">j1</code>, <code class="vardecl">j2</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">PRESENT</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile">i1 = is - <code class="constant">1 </code>- nord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile">i2 = ie + <code class="constant">1 </code>+ nord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile">j1 = js - <code class="constant">1 </code>- nord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile">j2 = je + <code class="constant">1 </code>+ nord</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (.NOT.<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">d2(i, j) = damp*q(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=j1,j2</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=i1,i2</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">d2(i, j) = q(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js-nord,je+nord</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is-nord,ie+nord+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)*(d2<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&         </code>(i-<code class="constant">1</code>, j)-d2(i, j))*rdxc(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js-nord,je+nord+<code class="constant">1</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is-nord,ie+nord</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">fy2(i, j) = <code class="constant">0.5</code>*(sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))*dx(i, j)*(d2<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&         </code>(i, j-<code class="constant">1</code>)-d2(i, j))*rdyc(i, j)</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (nord .GT. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!----------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! high-order</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!----------</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>n=<code class="constant">1</code>,nord</a>
        <a href="null.html#tp_core_mod_d" target="diffFile">nt = nord - n</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js-nt-<code class="constant">1</code>,je+nt+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is-nt-<code class="constant">1</code>,ie+nt+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">d2(i, j) = (fx2(i, j)-fx2(i+<code class="constant">1</code>, j)+fy2(i, j)-fy2(i, j+<code class="constant">1</code>))*<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>rarea(i, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">1</code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js-nt,je+nt</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is-nt,ie+nt+<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fx2(i, j) = <code class="constant">0.5</code>*(sin_sg(i-<code class="constant">1</code>, j, <code class="constant">3</code>)+sin_sg(i, j, <code class="constant">1</code>))*dy(i, j)<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>*(d2(i, j)-d2(i-<code class="constant">1</code>, j))*rdxc(i, j)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">CALL </code><code class="funcname">COPY_CORNERS</code>(d2, npx, npy, <code class="constant">2</code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js-nt,je+nt+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is-nt,ie+nt</a>
            <a href="null.html#tp_core_mod_d" target="diffFile">fy2(i, j) = dx(i, j)*(d2(i, j)-d2(i, j-<code class="constant">1</code>))*rdyc(i, j)*<code class="constant">0.5</code>*(<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&             </code>sin_sg(i, j-<code class="constant">1</code>, <code class="constant">4</code>)+sin_sg(i, j, <code class="constant">2</code>))</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------------------</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Add the diffusive fluxes to the flux arrays:</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">!---------------------------------------------</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">PRESENT</code>(mass)) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! Apply mass weighting to diffusive fluxes:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile">damp2 = <code class="constant">0.5</code>*damp</a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = fx(i, j) + damp2*(mass(i-<code class="constant">1</code>, j)+mass(i, j))*fx2(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = fy(i, j) + damp2*(mass(i, j-<code class="constant">1</code>)+mass(i, j))*fy2(i, j<code class="label">&</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="label">&           </code>)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie+<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fx(i, j) = fx(i, j) + fx2(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=js,je+<code class="constant">1</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=is,ie</a>
          <a href="null.html#tp_core_mod_d" target="diffFile">fy(i, j) = fy(i, j) + fy2(i, j)</a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="copy_corners_r8"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">DELN_FLUX</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code>(<code class="vardecl">q</code>, <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npx</code>, <code class="vardecl">npy</code>, <code class="vardecl">dir</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">REAL(</code><code class="modifier">real8</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">q</code>(<code class="vardecl">isd</code>:<code class="vardecl">ied</code>, <code class="vardecl">jsd</code>:<code class="vardecl">jed</code>)</a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
<a name="p22"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (dir .EQ. <code class="constant">1</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! XDir:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p22" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j, <code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p23"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p23" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy-j, i-npx+<code class="constant">1</code>)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p24"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j, <code class="constant">2</code>*npx-<code class="constant">1</code>-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p25"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p25" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy-j, i-<code class="constant">1</code>+npx)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p26"></a>    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">ELSE IF</code> (dir .EQ. <code class="constant">2</code>) <code class="keyword">THEN</code></a>
<a href="null.html#tp_core_mod_d" target="diffFile"><code class="comment">! YDir:</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p26" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">sw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p27"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p27" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">se_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(npy+j-<code class="constant">1</code>, npx-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p28"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p28" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">ne_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=npx,npx+ng-<code class="constant">1</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(<code class="constant">2</code>*npy-<code class="constant">1</code>-j, i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
<a name="p29"></a>        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p29" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="null.html#tp_core_mod_d" target="diffFile">nw_corner) <code class="keyword">THEN</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>j=npy,npy+ng-<code class="constant">1</code></a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>-ng,<code class="constant">0</code></a>
            <a href="null.html#tp_core_mod_d" target="diffFile">q(i, j) = q(j+<code class="constant">1</code>-npx, npy-i)</a>
          <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="null.html#tp_core_mod_d" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COPY_CORNERS_R8</code></a>
<code class="keyword">END MODULE </code><code class="funcname">TP_CORE_MOD</code>
</pre>
</body>
