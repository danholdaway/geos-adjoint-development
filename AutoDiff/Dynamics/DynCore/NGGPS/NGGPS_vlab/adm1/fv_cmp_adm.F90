!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30
!
MODULE FV_CMP_MOD_B
  USE FV_ARRAYS_MOD_B, ONLY : r_grid
  IMPLICIT NONE
  PRIVATE 
  PUBLIC fv_sat_adj, qs_init

CONTAINS
  SUBROUTINE FV_SAT_ADJ(mdt, zvir, is, ie, js, je, ng, hydrostatic, &
&   consv_te, te0, qv, ql, qi, qr, qs, qg, dpln, delz, pt, dp, q_con, &
&   cappa, area, dtdt, out_dt, last_step, do_qa, qa)
    IMPLICIT NONE
! This is designed for 6-class micro-physics schemes; handles the heat release
! due to in situ phase changes
! input pt is T_vir
    INTEGER, INTENT(IN) :: is, ie, js, je, ng
! remapping time step
    REAL, INTENT(IN) :: mdt
    REAL, INTENT(IN) :: zvir
    LOGICAL, INTENT(IN) :: hydrostatic, consv_te, out_dt
    LOGICAL, INTENT(IN) :: last_step
    LOGICAL, INTENT(IN) :: do_qa
    REAL, DIMENSION(is-ng:ie+ng, js-ng:je+ng), INTENT(IN) :: dp, delz
    REAL, INTENT(IN) :: dpln(is:ie, js:je)
    REAL, DIMENSION(is-ng:ie+ng, js-ng:je+ng), INTENT(INOUT) :: pt, qv, &
&   ql, qi, qr, qs, qg
    REAL, INTENT(OUT) :: qa(is-ng:ie+ng, js-ng:je+ng)
    REAL(kind=r_grid), DIMENSION(is-ng:ie+ng, js-ng:je+ng), INTENT(IN) &
&   :: area
    REAL, DIMENSION(is-ng:, js-ng:), INTENT(INOUT) :: q_con
    REAL, DIMENSION(is-ng:, js-ng:), INTENT(INOUT) :: cappa
    REAL, INTENT(INOUT) :: dtdt(is:ie, js:je)
    REAL, INTENT(OUT) :: te0(is-ng:ie+ng, js-ng:je+ng)
!---
    REAL, DIMENSION(is:ie) :: wqsat, dq2dt, qpz, cvm, t0, pt1, icp2, &
&   lcp2, tcp2, tcp3, den, q_liq, q_sol, src, hvar
! latent heat
    REAL, DIMENSION(is:ie) :: mc_air, lhl, lhi
    REAL :: sink, qsw, rh, fac_v2l, fac_l2v
    REAL :: tc, qsi, dqsdt, dq, dq0, pidep, qi_crt, tmp, dtmp
    REAL :: condensates, tin, qstar, rqi, q_plus, q_minus
    REAL :: sdt, dt_bigg, adj_fac, fac_s, fac_r, fac_i2s, fac_mlt, &
&   fac_l2r
    REAL :: factor, qim, tice0, c_air, c_vap
    INTEGER :: i, j
  END SUBROUTINE FV_SAT_ADJ
  SUBROUTINE QS_INIT(kmp)
    IMPLICIT NONE
!Stubbed, nonlinear?
    INTEGER, INTENT(IN) :: kmp
    INTEGER, PARAMETER :: length=2621
! LFO83
    REAL, PARAMETER :: rhor=1.0e3
    REAL, PARAMETER :: vdifu=2.11e-5
    REAL, PARAMETER :: tcond=2.36e-2
    REAL, PARAMETER :: visk=1.259e-5
    REAL, PARAMETER :: hltc=2.5e6
    REAL, PARAMETER :: gam290=1.827363
    REAL, PARAMETER :: gam380=4.694155
    REAL, PARAMETER :: alin=842.0
!Intercept parameters
    REAL, PARAMETER :: rnzr=8.0e6
! rain accretion efficiency
    REAL, PARAMETER :: c_cracw=0.9
    REAL :: scm3, act2
    INTEGER :: i
  END SUBROUTINE QS_INIT
END MODULE FV_CMP_MOD_B
