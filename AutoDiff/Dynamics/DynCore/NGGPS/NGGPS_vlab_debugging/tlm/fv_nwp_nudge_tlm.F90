!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.12 (r6213) - 13 Oct 2016 10:30
!
MODULE FV_NWP_NUDGE_MOD_D
  USE FV_ARRAYS_MOD_D, ONLY : fv_grid_bounds_type, fv_grid_type
  USE MPP_DOMAINS_MOD_D, ONLY : domain2d
  USE FV_MP_MOD_D, ONLY : is, ie, js, je, isd, ied, jsd, jed
  IMPLICIT NONE
  PRIVATE 
  PUBLIC do_adiabatic_init, breed_slp_inline
  LOGICAL, PARAMETER :: do_adiabatic_init=.false.

CONTAINS
  SUBROUTINE BREED_SLP_INLINE(nstep, dt, npz, ak, bk, phis, pe, pk, peln&
&   , pkz, delp, u, v, pt, q, nwat, zvir, gridstruct, ks, domain_local, &
&   bd, hydrostatic)
    IMPLICIT NONE
!Stubbed, nonlinear
!------------------------------------------------------------------------------------------
! Purpose:  Vortex-breeding by nudging sea-level-pressure towards single point observations
! Note: conserve water mass, geopotential, and momentum at the expense of dry air mass
!------------------------------------------------------------------------------------------
! Input
    INTEGER, INTENT(IN) :: nstep, npz, nwat, ks
! (small) time step in seconds
    REAL, INTENT(IN) :: dt
    REAL, INTENT(IN) :: zvir
    REAL, DIMENSION(npz+1), INTENT(IN) :: ak, bk
    LOGICAL, INTENT(IN) :: hydrostatic
    TYPE(FV_GRID_BOUNDS_TYPE), INTENT(IN) :: bd
    REAL, INTENT(IN) :: phis(isd:ied, jsd:jed)
    TYPE(DOMAIN2D), INTENT(INOUT) :: domain_local
! Input/Output
    REAL, INTENT(INOUT) :: u(isd:ied, jsd:jed+1, npz)
    REAL, INTENT(INOUT) :: v(isd:ied+1, jsd:jed, npz)
    REAL, DIMENSION(isd:ied, jsd:jed, npz), INTENT(INOUT) :: delp, pt
    REAL, INTENT(INOUT) :: q(isd:ied, jsd:jed, npz, *)
! pe**kappa
    REAL, INTENT(INOUT) :: pk(is:ie, js:je, npz+1)
! edge pressure (pascal)
    REAL, INTENT(INOUT) :: pe(is-1:ie+1, npz+1, js-1:je+1)
    REAL, INTENT(INOUT) :: pkz(is:ie, js:je, npz)
! ln(pe)
    REAL, INTENT(OUT) :: peln(is:ie, npz+1, js:je)
    TYPE(FV_GRID_TYPE), TARGET :: gridstruct
  END SUBROUTINE BREED_SLP_INLINE
END MODULE FV_NWP_NUDGE_MOD_D
